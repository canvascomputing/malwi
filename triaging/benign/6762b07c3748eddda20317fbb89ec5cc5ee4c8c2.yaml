statistics:
  total_files: 1
  skipped_files: 0.0
  processed_objects: 1
  malicious_objects: 0
details:
- path: .repo_cache/malicious_repos/pypi_malregistry/urlib3/1.21.1/urlib3-1.21.1/urlib3-1.21.1/test/with_dummyserver/test_poolmanager.py
  contents:
  - name: TestPoolManager.test_http_with_ssl_keywords
    score: 0.0
    code: |-
      def test_http_with_ssl_keywords(self):
              http = PoolManager(ca_certs='REQUIRED')
              self.addCleanup(http.clear)

              r = http.request('GET', 'http://%s:%s/' % (self.host, self.port))
              self.assertEqual(r.status, 200)
    tokens: 'resume load_global PoolManager load_const REQUIRED kw_names ca_certs call store_fast http load_fast self load_attr addCleanup load_fast http load_attr clear call pop_top load_fast http load_attr request load_const GET load_const http:// load_fast self load_attr host format_value INTEGER load_const : load_fast self load_attr port format_value INTEGER load_const / build_string call store_fast r load_fast self load_attr assertEqual load_fast r load_attr status load_const INTEGER call pop_top return_const None'
    hash: 5aa38081b8c8657d3affa6113b36586bb924354f1f2d1dbea3eea5f8104588fc
sources:
  ? .repo_cache/malicious_repos/pypi_malregistry/urlib3/1.21.1/urlib3-1.21.1/urlib3-1.21.1/test/with_dummyserver/test_poolmanager.py
  : aW1wb3J0IHVuaXR0ZXN0CmltcG9ydCBqc29uCgpmcm9tIG5vc2UucGx1Z2lucy5za2lwIGltcG9ydCBTa2lwVGVzdApmcm9tIGR1bW15c2VydmVyLnNlcnZlciBpbXBvcnQgSEFTX0lQVjYKZnJvbSBkdW1teXNlcnZlci50ZXN0Y2FzZSBpbXBvcnQgKEhUVFBEdW1teVNlcnZlclRlc3RDYXNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSVB2NkhUVFBEdW1teVNlcnZlclRlc3RDYXNlKQpmcm9tIHVybGxpYjMucG9vbG1hbmFnZXIgaW1wb3J0IFBvb2xNYW5hZ2VyCmZyb20gdXJsbGliMy5jb25uZWN0aW9ucG9vbCBpbXBvcnQgcG9ydF9ieV9zY2hlbWUKZnJvbSB1cmxsaWIzLmV4Y2VwdGlvbnMgaW1wb3J0IE1heFJldHJ5RXJyb3IKZnJvbSB1cmxsaWIzLnV0aWwucmV0cnkgaW1wb3J0IFJldHJ5CgoKY2xhc3MgVGVzdFBvb2xNYW5hZ2VyKEhUVFBEdW1teVNlcnZlclRlc3RDYXNlKToKCiAgICBkZWYgc2V0VXAoc2VsZik6CiAgICAgICAgc2VsZi5iYXNlX3VybCA9ICdodHRwOi8vJXM6JWQnICUgKHNlbGYuaG9zdCwgc2VsZi5wb3J0KQogICAgICAgIHNlbGYuYmFzZV91cmxfYWx0ID0gJ2h0dHA6Ly8lczolZCcgJSAoc2VsZi5ob3N0X2FsdCwgc2VsZi5wb3J0KQoKICAgIGRlZiB0ZXN0X3JlZGlyZWN0KHNlbGYpOgogICAgICAgIGh0dHAgPSBQb29sTWFuYWdlcigpCiAgICAgICAgc2VsZi5hZGRDbGVhbnVwKGh0dHAuY2xlYXIpCgogICAgICAgIHIgPSBodHRwLnJlcXVlc3QoJ0dFVCcsICclcy9yZWRpcmVjdCcgJSBzZWxmLmJhc2VfdXJsLAogICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRzPXsndGFyZ2V0JzogJyVzLycgJSBzZWxmLmJhc2VfdXJsfSwKICAgICAgICAgICAgICAgICAgICAgICAgIHJlZGlyZWN0PUZhbHNlKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHIuc3RhdHVzLCAzMDMpCgogICAgICAgIHIgPSBodHRwLnJlcXVlc3QoJ0dFVCcsICclcy9yZWRpcmVjdCcgJSBzZWxmLmJhc2VfdXJsLAogICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRzPXsndGFyZ2V0JzogJyVzLycgJSBzZWxmLmJhc2VfdXJsfSkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyLnN0YXR1cywgMjAwKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoci5kYXRhLCBiJ0R1bW15IHNlcnZlciEnKQoKICAgIGRlZiB0ZXN0X3JlZGlyZWN0X3R3aWNlKHNlbGYpOgogICAgICAgIGh0dHAgPSBQb29sTWFuYWdlcigpCiAgICAgICAgc2VsZi5hZGRDbGVhbnVwKGh0dHAuY2xlYXIpCgogICAgICAgIHIgPSBodHRwLnJlcXVlc3QoJ0dFVCcsICclcy9yZWRpcmVjdCcgJSBzZWxmLmJhc2VfdXJsLAogICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRzPXsndGFyZ2V0JzogJyVzL3JlZGlyZWN0JyAlIHNlbGYuYmFzZV91cmx9LAogICAgICAgICAgICAgICAgICAgICAgICAgcmVkaXJlY3Q9RmFsc2UpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoci5zdGF0dXMsIDMwMykKCiAgICAgICAgciA9IGh0dHAucmVxdWVzdCgnR0VUJywgJyVzL3JlZGlyZWN0JyAlIHNlbGYuYmFzZV91cmwsCiAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZHM9eyd0YXJnZXQnOiAnJXMvcmVkaXJlY3Q/dGFyZ2V0PSVzLycgJSAoc2VsZi5iYXNlX3VybCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmJhc2VfdXJsKX0pCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoci5zdGF0dXMsIDIwMCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHIuZGF0YSwgYidEdW1teSBzZXJ2ZXIhJykKCiAgICBkZWYgdGVzdF9yZWRpcmVjdF90b19yZWxhdGl2ZV91cmwoc2VsZik6CiAgICAgICAgaHR0cCA9IFBvb2xNYW5hZ2VyKCkKICAgICAgICBzZWxmLmFkZENsZWFudXAoaHR0cC5jbGVhcikKCiAgICAgICAgciA9IGh0dHAucmVxdWVzdCgnR0VUJywgJyVzL3JlZGlyZWN0JyAlIHNlbGYuYmFzZV91cmwsCiAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZHM9eyd0YXJnZXQnOiAnL3JlZGlyZWN0J30sCiAgICAgICAgICAgICAgICAgICAgICAgICByZWRpcmVjdD1GYWxzZSkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyLnN0YXR1cywgMzAzKQoKICAgICAgICByID0gaHR0cC5yZXF1ZXN0KCdHRVQnLCAnJXMvcmVkaXJlY3QnICUgc2VsZi5iYXNlX3VybCwKICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkcz17J3RhcmdldCc6ICcvcmVkaXJlY3QnfSkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyLnN0YXR1cywgMjAwKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoci5kYXRhLCBiJ0R1bW15IHNlcnZlciEnKQoKICAgIGRlZiB0ZXN0X2Nyb3NzX2hvc3RfcmVkaXJlY3Qoc2VsZik6CiAgICAgICAgaHR0cCA9IFBvb2xNYW5hZ2VyKCkKICAgICAgICBzZWxmLmFkZENsZWFudXAoaHR0cC5jbGVhcikKCiAgICAgICAgY3Jvc3NfaG9zdF9sb2NhdGlvbiA9ICclcy9lY2hvP2E9YicgJSBzZWxmLmJhc2VfdXJsX2FsdAogICAgICAgIHRyeToKICAgICAgICAgICAgaHR0cC5yZXF1ZXN0KCdHRVQnLCAnJXMvcmVkaXJlY3QnICUgc2VsZi5iYXNlX3VybCwKICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkcz17J3RhcmdldCc6IGNyb3NzX2hvc3RfbG9jYXRpb259LAogICAgICAgICAgICAgICAgICAgICAgICAgdGltZW91dD0xLCByZXRyaWVzPTApCiAgICAgICAgICAgIHNlbGYuZmFpbCgiUmVxdWVzdCBzdWNjZWVkZWQgaW5zdGVhZCBvZiByYWlzaW5nIGFuIGV4Y2VwdGlvbiBsaWtlIGl0IHNob3VsZC4iKQoKICAgICAgICBleGNlcHQgTWF4UmV0cnlFcnJvcjoKICAgICAgICAgICAgcGFzcwoKICAgICAgICByID0gaHR0cC5yZXF1ZXN0KCdHRVQnLCAnJXMvcmVkaXJlY3QnICUgc2VsZi5iYXNlX3VybCwKICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkcz17J3RhcmdldCc6ICclcy9lY2hvP2E9YicgJSBzZWxmLmJhc2VfdXJsX2FsdH0sCiAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lb3V0PTEsIHJldHJpZXM9MSkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyLl9wb29sLmhvc3QsIHNlbGYuaG9zdF9hbHQpCgogICAgZGVmIHRlc3RfdG9vX21hbnlfcmVkaXJlY3RzKHNlbGYpOgogICAgICAgIGh0dHAgPSBQb29sTWFuYWdlcigpCiAgICAgICAgc2VsZi5hZGRDbGVhbnVwKGh0dHAuY2xlYXIpCgogICAgICAgIHRyeToKICAgICAgICAgICAgciA9IGh0dHAucmVxdWVzdCgnR0VUJywgJyVzL3JlZGlyZWN0JyAlIHNlbGYuYmFzZV91cmwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRzPXsndGFyZ2V0JzogJyVzL3JlZGlyZWN0P3RhcmdldD0lcy8nICUgKHNlbGYuYmFzZV91cmwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYmFzZV91cmwpfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXRyaWVzPTEpCiAgICAgICAgICAgIHNlbGYuZmFpbCgiRmFpbGVkIHRvIHJhaXNlIE1heFJldHJ5RXJyb3IgZXhjZXB0aW9uLCByZXR1cm5lZCAlciIgJSByLnN0YXR1cykKICAgICAgICBleGNlcHQgTWF4UmV0cnlFcnJvcjoKICAgICAgICAgICAgcGFzcwoKICAgICAgICB0cnk6CiAgICAgICAgICAgIHIgPSBodHRwLnJlcXVlc3QoJ0dFVCcsICclcy9yZWRpcmVjdCcgJSBzZWxmLmJhc2VfdXJsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkcz17J3RhcmdldCc6ICclcy9yZWRpcmVjdD90YXJnZXQ9JXMvJyAlIChzZWxmLmJhc2VfdXJsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmJhc2VfdXJsKX0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0cmllcz1SZXRyeSh0b3RhbD1Ob25lLCByZWRpcmVjdD0xKSkKICAgICAgICAgICAgc2VsZi5mYWlsKCJGYWlsZWQgdG8gcmFpc2UgTWF4UmV0cnlFcnJvciBleGNlcHRpb24sIHJldHVybmVkICVyIiAlIHIuc3RhdHVzKQogICAgICAgIGV4Y2VwdCBNYXhSZXRyeUVycm9yOgogICAgICAgICAgICBwYXNzCgogICAgZGVmIHRlc3RfcmFpc2Vfb25fcmVkaXJlY3Qoc2VsZik6CiAgICAgICAgaHR0cCA9IFBvb2xNYW5hZ2VyKCkKICAgICAgICBzZWxmLmFkZENsZWFudXAoaHR0cC5jbGVhcikKCiAgICAgICAgciA9IGh0dHAucmVxdWVzdCgnR0VUJywgJyVzL3JlZGlyZWN0JyAlIHNlbGYuYmFzZV91cmwsCiAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZHM9eyd0YXJnZXQnOiAnJXMvcmVkaXJlY3Q/dGFyZ2V0PSVzLycgJSAoc2VsZi5iYXNlX3VybCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmJhc2VfdXJsKX0sCiAgICAgICAgICAgICAgICAgICAgICAgICByZXRyaWVzPVJldHJ5KHRvdGFsPU5vbmUsIHJlZGlyZWN0PTEsIHJhaXNlX29uX3JlZGlyZWN0PUZhbHNlKSkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyLnN0YXR1cywgMzAzKQoKICAgIGRlZiB0ZXN0X3JhaXNlX29uX3N0YXR1cyhzZWxmKToKICAgICAgICBodHRwID0gUG9vbE1hbmFnZXIoKQogICAgICAgIHNlbGYuYWRkQ2xlYW51cChodHRwLmNsZWFyKQoKICAgICAgICB0cnk6CiAgICAgICAgICAgICMgdGhlIGRlZmF1bHQgaXMgdG8gcmFpc2UKICAgICAgICAgICAgciA9IGh0dHAucmVxdWVzdCgnR0VUJywgJyVzL3N0YXR1cycgJSBzZWxmLmJhc2VfdXJsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkcz17J3N0YXR1cyc6ICc1MDAgSW50ZXJuYWwgU2VydmVyIEVycm9yJ30sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0cmllcz1SZXRyeSh0b3RhbD0xLCBzdGF0dXNfZm9yY2VsaXN0PXJhbmdlKDUwMCwgNjAwKSkpCiAgICAgICAgICAgIHNlbGYuZmFpbCgiRmFpbGVkIHRvIHJhaXNlIE1heFJldHJ5RXJyb3IgZXhjZXB0aW9uLCByZXR1cm5lZCAlciIgJSByLnN0YXR1cykKICAgICAgICBleGNlcHQgTWF4UmV0cnlFcnJvcjoKICAgICAgICAgICAgcGFzcwoKICAgICAgICB0cnk6CiAgICAgICAgICAgICMgcmFpc2UgZXhwbGljaXRseQogICAgICAgICAgICByID0gaHR0cC5yZXF1ZXN0KCdHRVQnLCAnJXMvc3RhdHVzJyAlIHNlbGYuYmFzZV91cmwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRzPXsnc3RhdHVzJzogJzUwMCBJbnRlcm5hbCBTZXJ2ZXIgRXJyb3InfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXRyaWVzPVJldHJ5KHRvdGFsPTEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXNfZm9yY2VsaXN0PXJhbmdlKDUwMCwgNjAwKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhaXNlX29uX3N0YXR1cz1UcnVlKSkKICAgICAgICAgICAgc2VsZi5mYWlsKCJGYWlsZWQgdG8gcmFpc2UgTWF4UmV0cnlFcnJvciBleGNlcHRpb24sIHJldHVybmVkICVyIiAlIHIuc3RhdHVzKQogICAgICAgIGV4Y2VwdCBNYXhSZXRyeUVycm9yOgogICAgICAgICAgICBwYXNzCgogICAgICAgICMgZG9uJ3QgcmFpc2UKICAgICAgICByID0gaHR0cC5yZXF1ZXN0KCdHRVQnLCAnJXMvc3RhdHVzJyAlIHNlbGYuYmFzZV91cmwsCiAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZHM9eydzdGF0dXMnOiAnNTAwIEludGVybmFsIFNlcnZlciBFcnJvcid9LAogICAgICAgICAgICAgICAgICAgICAgICAgcmV0cmllcz1SZXRyeSh0b3RhbD0xLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXNfZm9yY2VsaXN0PXJhbmdlKDUwMCwgNjAwKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFpc2Vfb25fc3RhdHVzPUZhbHNlKSkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyLnN0YXR1cywgNTAwKQoKICAgIGRlZiB0ZXN0X21pc3NpbmdfcG9ydChzZWxmKToKICAgICAgICAjIENhbiBhIFVSTCB0aGF0IGxhY2tzIGFuIGV4cGxpY2l0IHBvcnQgbGlrZSAnOjgwJyBzdWNjZWVkLCBvcgogICAgICAgICMgd2lsbCBhbGwgc3VjaCBVUkxzIGZhaWwgd2l0aCBhbiBlcnJvcj8KCiAgICAgICAgaHR0cCA9IFBvb2xNYW5hZ2VyKCkKICAgICAgICBzZWxmLmFkZENsZWFudXAoaHR0cC5jbGVhcikKCiAgICAgICAgIyBCeSBnbG9iYWxseSBhZGp1c3RpbmcgYHBvcnRfYnlfc2NoZW1lYCB3ZSBwcmV0ZW5kIGZvciBhIG1vbWVudAogICAgICAgICMgdGhhdCBIVFRQJ3MgZGVmYXVsdCBwb3J0IGlzIG5vdCA4MCwgYnV0IGlzIHRoZSBwb3J0IGF0IHdoaWNoCiAgICAgICAgIyBvdXIgdGVzdCBzZXJ2ZXIgaGFwcGVucyB0byBiZSBsaXN0ZW5pbmcuCiAgICAgICAgcG9ydF9ieV9zY2hlbWVbJ2h0dHAnXSA9IHNlbGYucG9ydAogICAgICAgIHRyeToKICAgICAgICAgICAgciA9IGh0dHAucmVxdWVzdCgnR0VUJywgJ2h0dHA6Ly8lcy8nICUgc2VsZi5ob3N0LCByZXRyaWVzPTApCiAgICAgICAgZmluYWxseToKICAgICAgICAgICAgcG9ydF9ieV9zY2hlbWVbJ2h0dHAnXSA9IDgwCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoci5zdGF0dXMsIDIwMCkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHIuZGF0YSwgYidEdW1teSBzZXJ2ZXIhJykKCiAgICBkZWYgdGVzdF9oZWFkZXJzKHNlbGYpOgogICAgICAgIGh0dHAgPSBQb29sTWFuYWdlcihoZWFkZXJzPXsnRm9vJzogJ2Jhcid9KQogICAgICAgIHNlbGYuYWRkQ2xlYW51cChodHRwLmNsZWFyKQoKICAgICAgICByID0gaHR0cC5yZXF1ZXN0KCdHRVQnLCAnJXMvaGVhZGVycycgJSBzZWxmLmJhc2VfdXJsKQogICAgICAgIHJldHVybmVkX2hlYWRlcnMgPSBqc29uLmxvYWRzKHIuZGF0YS5kZWNvZGUoKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJldHVybmVkX2hlYWRlcnMuZ2V0KCdGb28nKSwgJ2JhcicpCgogICAgICAgIHIgPSBodHRwLnJlcXVlc3QoJ1BPU1QnLCAnJXMvaGVhZGVycycgJSBzZWxmLmJhc2VfdXJsKQogICAgICAgIHJldHVybmVkX2hlYWRlcnMgPSBqc29uLmxvYWRzKHIuZGF0YS5kZWNvZGUoKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJldHVybmVkX2hlYWRlcnMuZ2V0KCdGb28nKSwgJ2JhcicpCgogICAgICAgIHIgPSBodHRwLnJlcXVlc3RfZW5jb2RlX3VybCgnR0VUJywgJyVzL2hlYWRlcnMnICUgc2VsZi5iYXNlX3VybCkKICAgICAgICByZXR1cm5lZF9oZWFkZXJzID0ganNvbi5sb2FkcyhyLmRhdGEuZGVjb2RlKCkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXR1cm5lZF9oZWFkZXJzLmdldCgnRm9vJyksICdiYXInKQoKICAgICAgICByID0gaHR0cC5yZXF1ZXN0X2VuY29kZV9ib2R5KCdQT1NUJywgJyVzL2hlYWRlcnMnICUgc2VsZi5iYXNlX3VybCkKICAgICAgICByZXR1cm5lZF9oZWFkZXJzID0ganNvbi5sb2FkcyhyLmRhdGEuZGVjb2RlKCkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXR1cm5lZF9oZWFkZXJzLmdldCgnRm9vJyksICdiYXInKQoKICAgICAgICByID0gaHR0cC5yZXF1ZXN0X2VuY29kZV91cmwoJ0dFVCcsICclcy9oZWFkZXJzJyAlIHNlbGYuYmFzZV91cmwsIGhlYWRlcnM9eydCYXonOiAncXV1eCd9KQogICAgICAgIHJldHVybmVkX2hlYWRlcnMgPSBqc29uLmxvYWRzKHIuZGF0YS5kZWNvZGUoKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJldHVybmVkX2hlYWRlcnMuZ2V0KCdGb28nKSwgTm9uZSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHJldHVybmVkX2hlYWRlcnMuZ2V0KCdCYXonKSwgJ3F1dXgnKQoKICAgICAgICByID0gaHR0cC5yZXF1ZXN0X2VuY29kZV9ib2R5KCdHRVQnLCAnJXMvaGVhZGVycycgJSBzZWxmLmJhc2VfdXJsLCBoZWFkZXJzPXsnQmF6JzogJ3F1dXgnfSkKICAgICAgICByZXR1cm5lZF9oZWFkZXJzID0ganNvbi5sb2FkcyhyLmRhdGEuZGVjb2RlKCkpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXR1cm5lZF9oZWFkZXJzLmdldCgnRm9vJyksIE5vbmUpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChyZXR1cm5lZF9oZWFkZXJzLmdldCgnQmF6JyksICdxdXV4JykKCiAgICBkZWYgdGVzdF9odHRwX3dpdGhfc3NsX2tleXdvcmRzKHNlbGYpOgogICAgICAgIGh0dHAgPSBQb29sTWFuYWdlcihjYV9jZXJ0cz0nUkVRVUlSRUQnKQogICAgICAgIHNlbGYuYWRkQ2xlYW51cChodHRwLmNsZWFyKQoKICAgICAgICByID0gaHR0cC5yZXF1ZXN0KCdHRVQnLCAnaHR0cDovLyVzOiVzLycgJSAoc2VsZi5ob3N0LCBzZWxmLnBvcnQpKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoci5zdGF0dXMsIDIwMCkKCiAgICBkZWYgdGVzdF9odHRwX3dpdGhfY2FfY2VydF9kaXIoc2VsZik6CiAgICAgICAgaHR0cCA9IFBvb2xNYW5hZ2VyKGNhX2NlcnRzPSdSRVFVSVJFRCcsIGNhX2NlcnRfZGlyPScvbm9zdWNoZGlyJykKCiAgICAgICAgciA9IGh0dHAucmVxdWVzdCgnR0VUJywgJ2h0dHA6Ly8lczolcy8nICUgKHNlbGYuaG9zdCwgc2VsZi5wb3J0KSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHIuc3RhdHVzLCAyMDApCgoKY2xhc3MgVGVzdElQdjZQb29sTWFuYWdlcihJUHY2SFRUUER1bW15U2VydmVyVGVzdENhc2UpOgogICAgaWYgbm90IEhBU19JUFY2OgogICAgICAgIHJhaXNlIFNraXBUZXN0KCJJUHY2IGlzIG5vdCBzdXBwb3J0ZWQgb24gdGhpcyBzeXN0ZW0uIikKCiAgICBkZWYgc2V0VXAoc2VsZik6CiAgICAgICAgc2VsZi5iYXNlX3VybCA9ICdodHRwOi8vWyVzXTolZCcgJSAoc2VsZi5ob3N0LCBzZWxmLnBvcnQpCgogICAgZGVmIHRlc3RfaXB2NihzZWxmKToKICAgICAgICBodHRwID0gUG9vbE1hbmFnZXIoKQogICAgICAgIHNlbGYuYWRkQ2xlYW51cChodHRwLmNsZWFyKQogICAgICAgIGh0dHAucmVxdWVzdCgnR0VUJywgc2VsZi5iYXNlX3VybCkKCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgdW5pdHRlc3QubWFpbigpCg==
