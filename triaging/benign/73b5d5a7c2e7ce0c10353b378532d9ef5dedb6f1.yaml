statistics:
  total_files: 1
  skipped_files: 0.0
  processed_objects: 1
  malicious_objects: 0
details:
- path: .repo_cache/malicious_repos/pypi_malregistry/discord-py-v13/1.3/discord_py_v13-1.3-py3-none-any/discord-py-v13/audit_logs.py
  contents:
  - name: AuditLogEntry.created_at
    score: 0.0
    code: |-
      @utils.cached_property
          def created_at(self):
              """:class:`datetime.datetime`: Returns the entry's creation time in UTC."""
              return utils.snowflake_time(self.id)
    tokens: resume load_global utils load_attr snowflake_time load_fast self load_attr id call return_value
    hash: 6527cda703e828faca016c25d0c8ca584b9e751d6e064c99bbc5b7b3eb39e6e4
sources:
  ? .repo_cache/malicious_repos/pypi_malregistry/discord-py-v13/1.3/discord_py_v13-1.3-py3-none-any/discord-py-v13/audit_logs.py
  : IyAtKi0gY29kaW5nOiB1dGYtOCAtKi0KCiIiIgpUaGUgTUlUIExpY2Vuc2UgKE1JVCkKCkNvcHlyaWdodCAoYykgMjAxNS1wcmVzZW50IFJhcHB0egoKUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEKY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwKdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbgp0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwKYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlClNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6CgpUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbgphbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KClRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMgSVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTCk9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLApGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUKQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUgpMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORwpGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSCkRFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS4KIiIiCgpmcm9tIC4gaW1wb3J0IHV0aWxzLCBlbnVtcwpmcm9tIC5vYmplY3QgaW1wb3J0IE9iamVjdApmcm9tIC5wZXJtaXNzaW9ucyBpbXBvcnQgUGVybWlzc2lvbk92ZXJ3cml0ZSwgUGVybWlzc2lvbnMKZnJvbSAuY29sb3VyIGltcG9ydCBDb2xvdXIKZnJvbSAuaW52aXRlIGltcG9ydCBJbnZpdGUKZnJvbSAubWl4aW5zIGltcG9ydCBIYXNoYWJsZQoKZGVmIF90cmFuc2Zvcm1fdmVyaWZpY2F0aW9uX2xldmVsKGVudHJ5LCBkYXRhKToKICAgIHJldHVybiBlbnVtcy50cnlfZW51bShlbnVtcy5WZXJpZmljYXRpb25MZXZlbCwgZGF0YSkKCmRlZiBfdHJhbnNmb3JtX2RlZmF1bHRfbm90aWZpY2F0aW9ucyhlbnRyeSwgZGF0YSk6CiAgICByZXR1cm4gZW51bXMudHJ5X2VudW0oZW51bXMuTm90aWZpY2F0aW9uTGV2ZWwsIGRhdGEpCgpkZWYgX3RyYW5zZm9ybV9leHBsaWNpdF9jb250ZW50X2ZpbHRlcihlbnRyeSwgZGF0YSk6CiAgICByZXR1cm4gZW51bXMudHJ5X2VudW0oZW51bXMuQ29udGVudEZpbHRlciwgZGF0YSkKCmRlZiBfdHJhbnNmb3JtX3Blcm1pc3Npb25zKGVudHJ5LCBkYXRhKToKICAgIHJldHVybiBQZXJtaXNzaW9ucyhkYXRhKQoKZGVmIF90cmFuc2Zvcm1fY29sb3IoZW50cnksIGRhdGEpOgogICAgcmV0dXJuIENvbG91cihkYXRhKQoKZGVmIF90cmFuc2Zvcm1fc25vd2ZsYWtlKGVudHJ5LCBkYXRhKToKICAgIHJldHVybiBpbnQoZGF0YSkKCmRlZiBfdHJhbnNmb3JtX2NoYW5uZWwoZW50cnksIGRhdGEpOgogICAgaWYgZGF0YSBpcyBOb25lOgogICAgICAgIHJldHVybiBOb25lCiAgICByZXR1cm4gZW50cnkuZ3VpbGQuZ2V0X2NoYW5uZWwoaW50KGRhdGEpKSBvciBPYmplY3QoaWQ9ZGF0YSkKCmRlZiBfdHJhbnNmb3JtX293bmVyX2lkKGVudHJ5LCBkYXRhKToKICAgIGlmIGRhdGEgaXMgTm9uZToKICAgICAgICByZXR1cm4gTm9uZQogICAgcmV0dXJuIGVudHJ5Ll9nZXRfbWVtYmVyKGludChkYXRhKSkKCmRlZiBfdHJhbnNmb3JtX2ludml0ZXJfaWQoZW50cnksIGRhdGEpOgogICAgaWYgZGF0YSBpcyBOb25lOgogICAgICAgIHJldHVybiBOb25lCiAgICByZXR1cm4gZW50cnkuX2dldF9tZW1iZXIoaW50KGRhdGEpKQoKZGVmIF90cmFuc2Zvcm1fb3ZlcndyaXRlcyhlbnRyeSwgZGF0YSk6CiAgICBvdmVyd3JpdGVzID0gW10KICAgIGZvciBlbGVtIGluIGRhdGE6CiAgICAgICAgYWxsb3cgPSBQZXJtaXNzaW9ucyhlbGVtWydhbGxvdyddKQogICAgICAgIGRlbnkgPSBQZXJtaXNzaW9ucyhlbGVtWydkZW55J10pCiAgICAgICAgb3cgPSBQZXJtaXNzaW9uT3ZlcndyaXRlLmZyb21fcGFpcihhbGxvdywgZGVueSkKCiAgICAgICAgb3dfdHlwZSA9IGVsZW1bJ3R5cGUnXQogICAgICAgIG93X2lkID0gaW50KGVsZW1bJ2lkJ10pCiAgICAgICAgaWYgb3dfdHlwZSA9PSAncm9sZSc6CiAgICAgICAgICAgIHRhcmdldCA9IGVudHJ5Lmd1aWxkLmdldF9yb2xlKG93X2lkKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHRhcmdldCA9IGVudHJ5Ll9nZXRfbWVtYmVyKG93X2lkKQoKICAgICAgICBpZiB0YXJnZXQgaXMgTm9uZToKICAgICAgICAgICAgdGFyZ2V0ID0gT2JqZWN0KGlkPW93X2lkKQoKICAgICAgICBvdmVyd3JpdGVzLmFwcGVuZCgodGFyZ2V0LCBvdykpCgogICAgcmV0dXJuIG92ZXJ3cml0ZXMKCmNsYXNzIEF1ZGl0TG9nRGlmZjoKICAgIGRlZiBfX2xlbl9fKHNlbGYpOgogICAgICAgIHJldHVybiBsZW4oc2VsZi5fX2RpY3RfXykKCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIGl0ZXIoc2VsZi5fX2RpY3RfXy5pdGVtcygpKQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICB2YWx1ZXMgPSAnICcuam9pbignJXM9JXInICUgaXRlbSBmb3IgaXRlbSBpbiBzZWxmLl9fZGljdF9fLml0ZW1zKCkpCiAgICAgICAgcmV0dXJuICc8QXVkaXRMb2dEaWZmICVzPicgJSB2YWx1ZXMKCmNsYXNzIEF1ZGl0TG9nQ2hhbmdlczoKICAgIFRSQU5TRk9STUVSUyA9IHsKICAgICAgICAndmVyaWZpY2F0aW9uX2xldmVsJzogICAgICAgICAgICAoTm9uZSwgX3RyYW5zZm9ybV92ZXJpZmljYXRpb25fbGV2ZWwpLAogICAgICAgICdleHBsaWNpdF9jb250ZW50X2ZpbHRlcic6ICAgICAgIChOb25lLCBfdHJhbnNmb3JtX2V4cGxpY2l0X2NvbnRlbnRfZmlsdGVyKSwKICAgICAgICAnYWxsb3cnOiAgICAgICAgICAgICAgICAgICAgICAgICAoTm9uZSwgX3RyYW5zZm9ybV9wZXJtaXNzaW9ucyksCiAgICAgICAgJ2RlbnknOiAgICAgICAgICAgICAgICAgICAgICAgICAgKE5vbmUsIF90cmFuc2Zvcm1fcGVybWlzc2lvbnMpLAogICAgICAgICdwZXJtaXNzaW9ucyc6ICAgICAgICAgICAgICAgICAgIChOb25lLCBfdHJhbnNmb3JtX3Blcm1pc3Npb25zKSwKICAgICAgICAnaWQnOiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoTm9uZSwgX3RyYW5zZm9ybV9zbm93Zmxha2UpLAogICAgICAgICdjb2xvcic6ICAgICAgICAgICAgICAgICAgICAgICAgICgnY29sb3VyJywgX3RyYW5zZm9ybV9jb2xvciksCiAgICAgICAgJ293bmVyX2lkJzogICAgICAgICAgICAgICAgICAgICAgKCdvd25lcicsIF90cmFuc2Zvcm1fb3duZXJfaWQpLAogICAgICAgICdpbnZpdGVyX2lkJzogICAgICAgICAgICAgICAgICAgICgnaW52aXRlcicsIF90cmFuc2Zvcm1faW52aXRlcl9pZCksCiAgICAgICAgJ2NoYW5uZWxfaWQnOiAgICAgICAgICAgICAgICAgICAgKCdjaGFubmVsJywgX3RyYW5zZm9ybV9jaGFubmVsKSwKICAgICAgICAnYWZrX2NoYW5uZWxfaWQnOiAgICAgICAgICAgICAgICAoJ2Fma19jaGFubmVsJywgX3RyYW5zZm9ybV9jaGFubmVsKSwKICAgICAgICAnc3lzdGVtX2NoYW5uZWxfaWQnOiAgICAgICAgICAgICAoJ3N5c3RlbV9jaGFubmVsJywgX3RyYW5zZm9ybV9jaGFubmVsKSwKICAgICAgICAnd2lkZ2V0X2NoYW5uZWxfaWQnOiAgICAgICAgICAgICAoJ3dpZGdldF9jaGFubmVsJywgX3RyYW5zZm9ybV9jaGFubmVsKSwKICAgICAgICAncGVybWlzc2lvbl9vdmVyd3JpdGVzJzogICAgICAgICAoJ292ZXJ3cml0ZXMnLCBfdHJhbnNmb3JtX292ZXJ3cml0ZXMpLAogICAgICAgICdzcGxhc2hfaGFzaCc6ICAgICAgICAgICAgICAgICAgICgnc3BsYXNoJywgTm9uZSksCiAgICAgICAgJ2ljb25faGFzaCc6ICAgICAgICAgICAgICAgICAgICAgKCdpY29uJywgTm9uZSksCiAgICAgICAgJ2F2YXRhcl9oYXNoJzogICAgICAgICAgICAgICAgICAgKCdhdmF0YXInLCBOb25lKSwKICAgICAgICAncmF0ZV9saW1pdF9wZXJfdXNlcic6ICAgICAgICAgICAoJ3Nsb3dtb2RlX2RlbGF5JywgTm9uZSksCiAgICAgICAgJ2RlZmF1bHRfbWVzc2FnZV9ub3RpZmljYXRpb25zJzogKCdkZWZhdWx0X25vdGlmaWNhdGlvbnMnLCBfdHJhbnNmb3JtX2RlZmF1bHRfbm90aWZpY2F0aW9ucyksCiAgICB9CgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGVudHJ5LCBkYXRhKToKICAgICAgICBzZWxmLmJlZm9yZSA9IEF1ZGl0TG9nRGlmZigpCiAgICAgICAgc2VsZi5hZnRlciA9IEF1ZGl0TG9nRGlmZigpCgogICAgICAgIGZvciBlbGVtIGluIGRhdGE6CiAgICAgICAgICAgIGF0dHIgPSBlbGVtWydrZXknXQoKICAgICAgICAgICAgIyBzcGVjaWFsIGNhc2VzIGZvciByb2xlIGFkZC9yZW1vdmUKICAgICAgICAgICAgaWYgYXR0ciA9PSAnJGFkZCc6CiAgICAgICAgICAgICAgICBzZWxmLl9oYW5kbGVfcm9sZShzZWxmLmJlZm9yZSwgc2VsZi5hZnRlciwgZW50cnksIGVsZW1bJ25ld192YWx1ZSddKQogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgZWxpZiBhdHRyID09ICckcmVtb3ZlJzoKICAgICAgICAgICAgICAgIHNlbGYuX2hhbmRsZV9yb2xlKHNlbGYuYWZ0ZXIsIHNlbGYuYmVmb3JlLCBlbnRyeSwgZWxlbVsnbmV3X3ZhbHVlJ10pCiAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAgICAgdHJhbnNmb3JtZXIgPSBzZWxmLlRSQU5TRk9STUVSUy5nZXQoYXR0cikKICAgICAgICAgICAgaWYgdHJhbnNmb3JtZXI6CiAgICAgICAgICAgICAgICBrZXksIHRyYW5zZm9ybWVyID0gdHJhbnNmb3JtZXIKICAgICAgICAgICAgICAgIGlmIGtleToKICAgICAgICAgICAgICAgICAgICBhdHRyID0ga2V5CgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBiZWZvcmUgPSBlbGVtWydvbGRfdmFsdWUnXQogICAgICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgICAgICBiZWZvcmUgPSBOb25lCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBpZiB0cmFuc2Zvcm1lcjoKICAgICAgICAgICAgICAgICAgICBiZWZvcmUgPSB0cmFuc2Zvcm1lcihlbnRyeSwgYmVmb3JlKQoKICAgICAgICAgICAgc2V0YXR0cihzZWxmLmJlZm9yZSwgYXR0ciwgYmVmb3JlKQoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgYWZ0ZXIgPSBlbGVtWyduZXdfdmFsdWUnXQogICAgICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgICAgICBhZnRlciA9IE5vbmUKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGlmIHRyYW5zZm9ybWVyOgogICAgICAgICAgICAgICAgICAgIGFmdGVyID0gdHJhbnNmb3JtZXIoZW50cnksIGFmdGVyKQoKICAgICAgICAgICAgc2V0YXR0cihzZWxmLmFmdGVyLCBhdHRyLCBhZnRlcikKCiAgICAgICAgIyBhZGQgYW4gYWxpYXMKICAgICAgICBpZiBoYXNhdHRyKHNlbGYuYWZ0ZXIsICdjb2xvdXInKToKICAgICAgICAgICAgc2VsZi5hZnRlci5jb2xvciA9IHNlbGYuYWZ0ZXIuY29sb3VyCiAgICAgICAgICAgIHNlbGYuYmVmb3JlLmNvbG9yID0gc2VsZi5iZWZvcmUuY29sb3VyCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIHJldHVybiAnPEF1ZGl0TG9nQ2hhbmdlcyBiZWZvcmU9JXIgYWZ0ZXI9JXI+JyAlIChzZWxmLmJlZm9yZSwgc2VsZi5hZnRlcikKCiAgICBkZWYgX2hhbmRsZV9yb2xlKHNlbGYsIGZpcnN0LCBzZWNvbmQsIGVudHJ5LCBlbGVtKToKICAgICAgICBpZiBub3QgaGFzYXR0cihmaXJzdCwgJ3JvbGVzJyk6CiAgICAgICAgICAgIHNldGF0dHIoZmlyc3QsICdyb2xlcycsIFtdKQoKICAgICAgICBkYXRhID0gW10KICAgICAgICBnID0gZW50cnkuZ3VpbGQKCiAgICAgICAgZm9yIGUgaW4gZWxlbToKICAgICAgICAgICAgcm9sZV9pZCA9IGludChlWydpZCddKQogICAgICAgICAgICByb2xlID0gZy5nZXRfcm9sZShyb2xlX2lkKQoKICAgICAgICAgICAgaWYgcm9sZSBpcyBOb25lOgogICAgICAgICAgICAgICAgcm9sZSA9IE9iamVjdChpZD1yb2xlX2lkKQogICAgICAgICAgICAgICAgcm9sZS5uYW1lID0gZVsnbmFtZSddCgogICAgICAgICAgICBkYXRhLmFwcGVuZChyb2xlKQoKICAgICAgICBzZXRhdHRyKHNlY29uZCwgJ3JvbGVzJywgZGF0YSkKCmNsYXNzIEF1ZGl0TG9nRW50cnkoSGFzaGFibGUpOgogICAgciIiIlJlcHJlc2VudHMgYW4gQXVkaXQgTG9nIGVudHJ5LgoKICAgIFlvdSByZXRyaWV2ZSB0aGVzZSB2aWEgOm1ldGg6YEd1aWxkLmF1ZGl0X2xvZ3NgLgoKICAgIC4uIGNvbnRhaW5lcjo6IG9wZXJhdGlvbnMKCiAgICAgICAgLi4gZGVzY3JpYmU6OiB4ID09IHkKCiAgICAgICAgICAgIENoZWNrcyBpZiB0d28gZW50cmllcyBhcmUgZXF1YWwuCgogICAgICAgIC4uIGRlc2NyaWJlOjogeCAhPSB5CgogICAgICAgICAgICBDaGVja3MgaWYgdHdvIGVudHJpZXMgYXJlIG5vdCBlcXVhbC4KCiAgICAgICAgLi4gZGVzY3JpYmU6OiBoYXNoKHgpCgogICAgICAgICAgICBSZXR1cm5zIHRoZSBlbnRyeSdzIGhhc2guCgogICAgLi4gdmVyc2lvbmNoYW5nZWQ6OiAxLjcKICAgICAgICBBdWRpdCBsb2cgZW50cmllcyBhcmUgbm93IGNvbXBhcmFibGUgYW5kIGhhc2hhYmxlLgoKICAgIEF0dHJpYnV0ZXMKICAgIC0tLS0tLS0tLS0tCiAgICBhY3Rpb246IDpjbGFzczpgQXVkaXRMb2dBY3Rpb25gCiAgICAgICAgVGhlIGFjdGlvbiB0aGF0IHdhcyBkb25lLgogICAgdXNlcjogOmNsYXNzOmBhYmMuVXNlcmAKICAgICAgICBUaGUgdXNlciB3aG8gaW5pdGlhdGVkIHRoaXMgYWN0aW9uLiBVc3VhbGx5IGEgOmNsYXNzOmBNZW1iZXJgXCwgdW5sZXNzIGdvbmUKICAgICAgICB0aGVuIGl0J3MgYSA6Y2xhc3M6YFVzZXJgLgogICAgaWQ6IDpjbGFzczpgaW50YAogICAgICAgIFRoZSBlbnRyeSBJRC4KICAgIHRhcmdldDogQW55CiAgICAgICAgVGhlIHRhcmdldCB0aGF0IGdvdCBjaGFuZ2VkLiBUaGUgZXhhY3QgdHlwZSBvZiB0aGlzIGRlcGVuZHMgb24KICAgICAgICB0aGUgYWN0aW9uIGJlaW5nIGRvbmUuCiAgICByZWFzb246IE9wdGlvbmFsWzpjbGFzczpgc3RyYF0KICAgICAgICBUaGUgcmVhc29uIHRoaXMgYWN0aW9uIHdhcyBkb25lLgogICAgZXh0cmE6IEFueQogICAgICAgIEV4dHJhIGluZm9ybWF0aW9uIHRoYXQgdGhpcyBlbnRyeSBoYXMgdGhhdCBtaWdodCBiZSB1c2VmdWwuCiAgICAgICAgRm9yIG1vc3QgYWN0aW9ucywgdGhpcyBpcyBgYE5vbmVgYC4gSG93ZXZlciBpbiBzb21lIGNhc2VzIGl0CiAgICAgICAgY29udGFpbnMgZXh0cmEgaW5mb3JtYXRpb24uIFNlZSA6Y2xhc3M6YEF1ZGl0TG9nQWN0aW9uYCBmb3IKICAgICAgICB3aGljaCBhY3Rpb25zIGhhdmUgdGhpcyBmaWVsZCBmaWxsZWQgb3V0LgogICAgIiIiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsICosIHVzZXJzLCBkYXRhLCBndWlsZCk6CiAgICAgICAgc2VsZi5fc3RhdGUgPSBndWlsZC5fc3RhdGUKICAgICAgICBzZWxmLmd1aWxkID0gZ3VpbGQKICAgICAgICBzZWxmLl91c2VycyA9IHVzZXJzCiAgICAgICAgc2VsZi5fZnJvbV9kYXRhKGRhdGEpCgogICAgZGVmIF9mcm9tX2RhdGEoc2VsZiwgZGF0YSk6CiAgICAgICAgc2VsZi5hY3Rpb24gPSBlbnVtcy50cnlfZW51bShlbnVtcy5BdWRpdExvZ0FjdGlvbiwgZGF0YVsnYWN0aW9uX3R5cGUnXSkKICAgICAgICBzZWxmLmlkID0gaW50KGRhdGFbJ2lkJ10pCgogICAgICAgICMgdGhpcyBrZXkgaXMgdGVjaG5pY2FsbHkgbm90IHVzdWFsbHkgcHJlc2VudAogICAgICAgIHNlbGYucmVhc29uID0gZGF0YS5nZXQoJ3JlYXNvbicpCiAgICAgICAgc2VsZi5leHRyYSA9IGRhdGEuZ2V0KCdvcHRpb25zJykKCiAgICAgICAgaWYgaXNpbnN0YW5jZShzZWxmLmFjdGlvbiwgZW51bXMuQXVkaXRMb2dBY3Rpb24pIGFuZCBzZWxmLmV4dHJhOgogICAgICAgICAgICBpZiBzZWxmLmFjdGlvbiBpcyBlbnVtcy5BdWRpdExvZ0FjdGlvbi5tZW1iZXJfcHJ1bmU6CiAgICAgICAgICAgICAgICAjIG1lbWJlciBwcnVuZSBoYXMgdHdvIGtleXMgd2l0aCB1c2VmdWwgaW5mb3JtYXRpb24KICAgICAgICAgICAgICAgIHNlbGYuZXh0cmEgPSB0eXBlKCdfQXVkaXRMb2dQcm94eScsICgpLCB7azogaW50KHYpIGZvciBrLCB2IGluIHNlbGYuZXh0cmEuaXRlbXMoKX0pKCkKICAgICAgICAgICAgZWxpZiBzZWxmLmFjdGlvbiBpcyBlbnVtcy5BdWRpdExvZ0FjdGlvbi5tZW1iZXJfbW92ZSBvciBzZWxmLmFjdGlvbiBpcyBlbnVtcy5BdWRpdExvZ0FjdGlvbi5tZXNzYWdlX2RlbGV0ZToKICAgICAgICAgICAgICAgIGNoYW5uZWxfaWQgPSBpbnQoc2VsZi5leHRyYVsnY2hhbm5lbF9pZCddKQogICAgICAgICAgICAgICAgZWxlbXMgPSB7CiAgICAgICAgICAgICAgICAgICAgJ2NvdW50JzogaW50KHNlbGYuZXh0cmFbJ2NvdW50J10pLAogICAgICAgICAgICAgICAgICAgICdjaGFubmVsJzogc2VsZi5ndWlsZC5nZXRfY2hhbm5lbChjaGFubmVsX2lkKSBvciBPYmplY3QoaWQ9Y2hhbm5lbF9pZCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHNlbGYuZXh0cmEgPSB0eXBlKCdfQXVkaXRMb2dQcm94eScsICgpLCBlbGVtcykoKQogICAgICAgICAgICBlbGlmIHNlbGYuYWN0aW9uIGlzIGVudW1zLkF1ZGl0TG9nQWN0aW9uLm1lbWJlcl9kaXNjb25uZWN0OgogICAgICAgICAgICAgICAgIyBUaGUgbWVtYmVyIGRpc2Nvbm5lY3QgYWN0aW9uIGhhcyBhIGRpY3Qgd2l0aCBzb21lIGluZm9ybWF0aW9uCiAgICAgICAgICAgICAgICBlbGVtcyA9IHsKICAgICAgICAgICAgICAgICAgICAnY291bnQnOiBpbnQoc2VsZi5leHRyYVsnY291bnQnXSksCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBzZWxmLmV4dHJhID0gdHlwZSgnX0F1ZGl0TG9nUHJveHknLCAoKSwgZWxlbXMpKCkKICAgICAgICAgICAgZWxpZiBzZWxmLmFjdGlvbi5uYW1lLmVuZHN3aXRoKCdwaW4nKToKICAgICAgICAgICAgICAgICMgdGhlIHBpbiBhY3Rpb25zIGhhdmUgYSBkaWN0IHdpdGggc29tZSBpbmZvcm1hdGlvbgogICAgICAgICAgICAgICAgY2hhbm5lbF9pZCA9IGludChzZWxmLmV4dHJhWydjaGFubmVsX2lkJ10pCiAgICAgICAgICAgICAgICBtZXNzYWdlX2lkID0gaW50KHNlbGYuZXh0cmFbJ21lc3NhZ2VfaWQnXSkKICAgICAgICAgICAgICAgIGVsZW1zID0gewogICAgICAgICAgICAgICAgICAgICdjaGFubmVsJzogc2VsZi5ndWlsZC5nZXRfY2hhbm5lbChjaGFubmVsX2lkKSBvciBPYmplY3QoaWQ9Y2hhbm5lbF9pZCksCiAgICAgICAgICAgICAgICAgICAgJ21lc3NhZ2VfaWQnOiBtZXNzYWdlX2lkCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBzZWxmLmV4dHJhID0gdHlwZSgnX0F1ZGl0TG9nUHJveHknLCAoKSwgZWxlbXMpKCkKICAgICAgICAgICAgZWxpZiBzZWxmLmFjdGlvbi5uYW1lLnN0YXJ0c3dpdGgoJ292ZXJ3cml0ZV8nKToKICAgICAgICAgICAgICAgICMgdGhlIG92ZXJ3cml0ZV8gYWN0aW9ucyBoYXZlIGEgZGljdCB3aXRoIHNvbWUgaW5mb3JtYXRpb24KICAgICAgICAgICAgICAgIGluc3RhbmNlX2lkID0gaW50KHNlbGYuZXh0cmFbJ2lkJ10pCiAgICAgICAgICAgICAgICB0aGVfdHlwZSA9IHNlbGYuZXh0cmEuZ2V0KCd0eXBlJykKICAgICAgICAgICAgICAgIGlmIHRoZV90eXBlID09ICdtZW1iZXInOgogICAgICAgICAgICAgICAgICAgIHNlbGYuZXh0cmEgPSBzZWxmLl9nZXRfbWVtYmVyKGluc3RhbmNlX2lkKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICByb2xlID0gc2VsZi5ndWlsZC5nZXRfcm9sZShpbnN0YW5jZV9pZCkKICAgICAgICAgICAgICAgICAgICBpZiByb2xlIGlzIE5vbmU6CiAgICAgICAgICAgICAgICAgICAgICAgIHJvbGUgPSBPYmplY3QoaWQ9aW5zdGFuY2VfaWQpCiAgICAgICAgICAgICAgICAgICAgICAgIHJvbGUubmFtZSA9IHNlbGYuZXh0cmEuZ2V0KCdyb2xlX25hbWUnKQogICAgICAgICAgICAgICAgICAgIHNlbGYuZXh0cmEgPSByb2xlCgogICAgICAgICMgdGhpcyBrZXkgaXMgbm90IHByZXNlbnQgd2hlbiB0aGUgYWJvdmUgaXMgcHJlc2VudCwgdHlwaWNhbGx5LgogICAgICAgICMgSXQncyBhIGxpc3Qgb2YgeyBuZXdfdmFsdWU6IGEsIG9sZF92YWx1ZTogYiwga2V5OiBjIH0KICAgICAgICAjIHdoZXJlIG5ld192YWx1ZSBhbmQgb2xkX3ZhbHVlIGFyZSBub3QgZ3VhcmFudGVlZCB0byBiZSB0aGVyZSBkZXBlbmRpbmcKICAgICAgICAjIG9uIHRoZSBhY3Rpb24gdHlwZSwgc28gbGV0J3MganVzdCBmZXRjaCBpdCBmb3Igbm93IGFuZCBvbmx5IHR1cm4gaXQKICAgICAgICAjIGludG8gbWVhbmluZ2Z1bCBkYXRhIHdoZW4gcmVxdWVzdGVkCiAgICAgICAgc2VsZi5fY2hhbmdlcyA9IGRhdGEuZ2V0KCdjaGFuZ2VzJywgW10pCgogICAgICAgIHNlbGYudXNlciA9IHNlbGYuX2dldF9tZW1iZXIodXRpbHMuX2dldF9hc19zbm93Zmxha2UoZGF0YSwgJ3VzZXJfaWQnKSkKICAgICAgICBzZWxmLl90YXJnZXRfaWQgPSB1dGlscy5fZ2V0X2FzX3Nub3dmbGFrZShkYXRhLCAndGFyZ2V0X2lkJykKCiAgICBkZWYgX2dldF9tZW1iZXIoc2VsZiwgdXNlcl9pZCk6CiAgICAgICAgcmV0dXJuIHNlbGYuZ3VpbGQuZ2V0X21lbWJlcih1c2VyX2lkKSBvciBzZWxmLl91c2Vycy5nZXQodXNlcl9pZCkKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgcmV0dXJuICc8QXVkaXRMb2dFbnRyeSBpZD17MC5pZH0gYWN0aW9uPXswLmFjdGlvbn0gdXNlcj17MC51c2VyIXJ9PicuZm9ybWF0KHNlbGYpCgogICAgQHV0aWxzLmNhY2hlZF9wcm9wZXJ0eQogICAgZGVmIGNyZWF0ZWRfYXQoc2VsZik6CiAgICAgICAgIiIiOmNsYXNzOmBkYXRldGltZS5kYXRldGltZWA6IFJldHVybnMgdGhlIGVudHJ5J3MgY3JlYXRpb24gdGltZSBpbiBVVEMuIiIiCiAgICAgICAgcmV0dXJuIHV0aWxzLnNub3dmbGFrZV90aW1lKHNlbGYuaWQpCgogICAgQHV0aWxzLmNhY2hlZF9wcm9wZXJ0eQogICAgZGVmIHRhcmdldChzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIGNvbnZlcnRlciA9IGdldGF0dHIoc2VsZiwgJ19jb252ZXJ0X3RhcmdldF8nICsgc2VsZi5hY3Rpb24udGFyZ2V0X3R5cGUpCiAgICAgICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yOgogICAgICAgICAgICByZXR1cm4gT2JqZWN0KGlkPXNlbGYuX3RhcmdldF9pZCkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gY29udmVydGVyKHNlbGYuX3RhcmdldF9pZCkKCiAgICBAdXRpbHMuY2FjaGVkX3Byb3BlcnR5CiAgICBkZWYgY2F0ZWdvcnkoc2VsZik6CiAgICAgICAgIiIiT3B0aW9uYWxbOmNsYXNzOmBBdWRpdExvZ0FjdGlvbkNhdGVnb3J5YF06IFRoZSBjYXRlZ29yeSBvZiB0aGUgYWN0aW9uLCBpZiBhcHBsaWNhYmxlLiIiIgogICAgICAgIHJldHVybiBzZWxmLmFjdGlvbi5jYXRlZ29yeQoKICAgIEB1dGlscy5jYWNoZWRfcHJvcGVydHkKICAgIGRlZiBjaGFuZ2VzKHNlbGYpOgogICAgICAgICIiIjpjbGFzczpgQXVkaXRMb2dDaGFuZ2VzYDogVGhlIGxpc3Qgb2YgY2hhbmdlcyB0aGlzIGVudHJ5IGhhcy4iIiIKICAgICAgICBvYmogPSBBdWRpdExvZ0NoYW5nZXMoc2VsZiwgc2VsZi5fY2hhbmdlcykKICAgICAgICBkZWwgc2VsZi5fY2hhbmdlcwogICAgICAgIHJldHVybiBvYmoKCiAgICBAdXRpbHMuY2FjaGVkX3Byb3BlcnR5CiAgICBkZWYgYmVmb3JlKHNlbGYpOgogICAgICAgICIiIjpjbGFzczpgQXVkaXRMb2dEaWZmYDogVGhlIHRhcmdldCdzIHByaW9yIHN0YXRlLiIiIgogICAgICAgIHJldHVybiBzZWxmLmNoYW5nZXMuYmVmb3JlCgogICAgQHV0aWxzLmNhY2hlZF9wcm9wZXJ0eQogICAgZGVmIGFmdGVyKHNlbGYpOgogICAgICAgICIiIjpjbGFzczpgQXVkaXRMb2dEaWZmYDogVGhlIHRhcmdldCdzIHN1YnNlcXVlbnQgc3RhdGUuIiIiCiAgICAgICAgcmV0dXJuIHNlbGYuY2hhbmdlcy5hZnRlcgoKICAgIGRlZiBfY29udmVydF90YXJnZXRfZ3VpbGQoc2VsZiwgdGFyZ2V0X2lkKToKICAgICAgICByZXR1cm4gc2VsZi5ndWlsZAoKICAgIGRlZiBfY29udmVydF90YXJnZXRfY2hhbm5lbChzZWxmLCB0YXJnZXRfaWQpOgogICAgICAgIGNoID0gc2VsZi5ndWlsZC5nZXRfY2hhbm5lbCh0YXJnZXRfaWQpCiAgICAgICAgaWYgY2ggaXMgTm9uZToKICAgICAgICAgICAgcmV0dXJuIE9iamVjdChpZD10YXJnZXRfaWQpCiAgICAgICAgcmV0dXJuIGNoCgogICAgZGVmIF9jb252ZXJ0X3RhcmdldF91c2VyKHNlbGYsIHRhcmdldF9pZCk6CiAgICAgICAgcmV0dXJuIHNlbGYuX2dldF9tZW1iZXIodGFyZ2V0X2lkKQoKICAgIGRlZiBfY29udmVydF90YXJnZXRfcm9sZShzZWxmLCB0YXJnZXRfaWQpOgogICAgICAgIHJvbGUgPSBzZWxmLmd1aWxkLmdldF9yb2xlKHRhcmdldF9pZCkKICAgICAgICBpZiByb2xlIGlzIE5vbmU6CiAgICAgICAgICAgIHJldHVybiBPYmplY3QoaWQ9dGFyZ2V0X2lkKQogICAgICAgIHJldHVybiByb2xlCgogICAgZGVmIF9jb252ZXJ0X3RhcmdldF9pbnZpdGUoc2VsZiwgdGFyZ2V0X2lkKToKICAgICAgICAjIGludml0ZXMgaGF2ZSB0YXJnZXRfaWQgc2V0IHRvIG51bGwKICAgICAgICAjIHNvIGZpZ3VyZSBvdXQgd2hpY2ggY2hhbmdlIGhhcyB0aGUgZnVsbCBpbnZpdGUgZGF0YQogICAgICAgIGNoYW5nZXNldCA9IHNlbGYuYmVmb3JlIGlmIHNlbGYuYWN0aW9uIGlzIGVudW1zLkF1ZGl0TG9nQWN0aW9uLmludml0ZV9kZWxldGUgZWxzZSBzZWxmLmFmdGVyCgogICAgICAgIGZha2VfcGF5bG9hZCA9IHsKICAgICAgICAgICAgJ21heF9hZ2UnOiBjaGFuZ2VzZXQubWF4X2FnZSwKICAgICAgICAgICAgJ21heF91c2VzJzogY2hhbmdlc2V0Lm1heF91c2VzLAogICAgICAgICAgICAnY29kZSc6IGNoYW5nZXNldC5jb2RlLAogICAgICAgICAgICAndGVtcG9yYXJ5JzogY2hhbmdlc2V0LnRlbXBvcmFyeSwKICAgICAgICAgICAgJ2NoYW5uZWwnOiBjaGFuZ2VzZXQuY2hhbm5lbCwKICAgICAgICAgICAgJ3VzZXMnOiBjaGFuZ2VzZXQudXNlcywKICAgICAgICAgICAgJ2d1aWxkJzogc2VsZi5ndWlsZCwKICAgICAgICB9CgogICAgICAgIG9iaiA9IEludml0ZShzdGF0ZT1zZWxmLl9zdGF0ZSwgZGF0YT1mYWtlX3BheWxvYWQpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBvYmouaW52aXRlciA9IGNoYW5nZXNldC5pbnZpdGVyCiAgICAgICAgZXhjZXB0IEF0dHJpYnV0ZUVycm9yOgogICAgICAgICAgICBwYXNzCiAgICAgICAgcmV0dXJuIG9iagoKICAgIGRlZiBfY29udmVydF90YXJnZXRfZW1vamkoc2VsZiwgdGFyZ2V0X2lkKToKICAgICAgICByZXR1cm4gc2VsZi5fc3RhdGUuZ2V0X2Vtb2ppKHRhcmdldF9pZCkgb3IgT2JqZWN0KGlkPXRhcmdldF9pZCkKCiAgICBkZWYgX2NvbnZlcnRfdGFyZ2V0X21lc3NhZ2Uoc2VsZiwgdGFyZ2V0X2lkKToKICAgICAgICByZXR1cm4gc2VsZi5fZ2V0X21lbWJlcih0YXJnZXRfaWQpCg==
