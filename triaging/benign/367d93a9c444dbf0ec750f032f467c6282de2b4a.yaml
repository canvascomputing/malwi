statistics:
  total_files: 1
  skipped_files: 0.0
  processed_objects: 1
  malicious_objects: 0
details:
- path: .repo_cache/malicious_repos/pypi_malregistry/pycryptoenv/1.0.7/pycryptoenv-1.0.7/pycryptoenv-1.0.7/pycryptoenv/_mac/_core_foundation_cffi.py
  contents:
  - name: CFHelpers.cf_dictionary_from_pairs
    score: 0.0
    code: |-
      @staticmethod
          def cf_dictionary_from_pairs(pairs):
              """
              Creates a CFDictionaryRef object from a list of 2-element tuples
              representing the key and value. Each key should be a CFStringRef and each
              value some sort of CF* type.

              :param pairs:
                  A list of 2-element tuples

              :return:
                  A CFDictionaryRef
              """

              length = len(pairs)
              keys = []
              values = []
              for pair in pairs:
                  key, value = pair
                  keys.append(key)
                  values.append(value)
              return CoreFoundation.CFDictionaryCreate(
                  CoreFoundation.kCFAllocatorDefault,
                  keys,
                  values,
                  length,
                  ffi.addressof(CoreFoundation.kCFTypeDictionaryKeyCallBacks),
                  ffi.addressof(CoreFoundation.kCFTypeDictionaryValueCallBacks)
              )
    tokens: resume load_global len load_fast pairs call store_fast length build_list store_fast keys build_list store_fast values load_fast pairs get_iter for_iter TO_NUMBER store_fast pair load_fast pair unpack_sequence store_fast key store_fast value load_fast keys load_attr append load_fast key call pop_top load_fast values load_attr append load_fast value call pop_top jump_backward TO_NUMBER end_for load_global CoreFoundation load_attr STRING_LEN_S_ENT_HIGH load_global CoreFoundation load_attr STRING_LEN_S_ENT_HIGH load_fast keys load_fast values load_fast length load_global ffi load_attr addressof load_global CoreFoundation load_attr STRING_LEN_S_ENT_HIGH call load_global ffi load_attr addressof load_global CoreFoundation load_attr STRING_LEN_S_ENT_HIGH call call return_value
    hash: ffb3c196a974bc3184531d26ca51a424c476dd31e917377664340c34b8b4babe
sources:
  ? .repo_cache/malicious_repos/pypi_malregistry/pycryptoenv/1.0.7/pycryptoenv-1.0.7/pycryptoenv-1.0.7/pycryptoenv/_mac/_core_foundation_cffi.py
  : IyBjb2Rpbmc6IHV0Zi04CmZyb20gX19mdXR1cmVfXyBpbXBvcnQgdW5pY29kZV9saXRlcmFscywgZGl2aXNpb24sIGFic29sdXRlX2ltcG9ydCwgcHJpbnRfZnVuY3Rpb24KCmZyb20gLi5fZmZpIGltcG9ydCAoCiAgICBidWZmZXJfZnJvbV9ieXRlcywKICAgIGJ5dGVfc3RyaW5nX2Zyb21fYnVmZmVyLAogICAgZGVyZWYsCiAgICBpc19udWxsLAogICAgbmV3LAogICAgcmVnaXN0ZXJfZmZpLAopCgpmcm9tIGNmZmkgaW1wb3J0IEZGSQoKCl9fYWxsX18gPSBbCiAgICAnQ0ZIZWxwZXJzJywKICAgICdDb3JlRm91bmRhdGlvbicsCl0KCgpmZmkgPSBGRkkoKQpmZmkuY2RlZigiIiIKICAgIHR5cGVkZWYgYm9vbCBCb29sZWFuOwogICAgdHlwZWRlZiBsb25nIENGSW5kZXg7CiAgICB0eXBlZGVmIHVuc2lnbmVkIGxvbmcgQ0ZTdHJpbmdFbmNvZGluZzsKICAgIHR5cGVkZWYgdW5zaWduZWQgbG9uZyBDRk51bWJlclR5cGU7CiAgICB0eXBlZGVmIHVuc2lnbmVkIGxvbmcgQ0ZUeXBlSUQ7CgogICAgdHlwZWRlZiB2b2lkICpDRlR5cGVSZWY7CiAgICB0eXBlZGVmIENGVHlwZVJlZiBDRkFycmF5UmVmOwogICAgdHlwZWRlZiBDRlR5cGVSZWYgQ0ZEYXRhUmVmOwogICAgdHlwZWRlZiBDRlR5cGVSZWYgQ0ZTdHJpbmdSZWY7CiAgICB0eXBlZGVmIENGVHlwZVJlZiBDRk51bWJlclJlZjsKICAgIHR5cGVkZWYgQ0ZUeXBlUmVmIENGQm9vbGVhblJlZjsKICAgIHR5cGVkZWYgQ0ZUeXBlUmVmIENGRGljdGlvbmFyeVJlZjsKICAgIHR5cGVkZWYgQ0ZUeXBlUmVmIENGRXJyb3JSZWY7CiAgICB0eXBlZGVmIENGVHlwZVJlZiBDRkFsbG9jYXRvclJlZjsKCiAgICB0eXBlZGVmIHN0cnVjdCB7CiAgICAgICAgQ0ZJbmRleCB2ZXJzaW9uOwogICAgICAgIHZvaWQgKnJldGFpbjsKICAgICAgICB2b2lkICpyZWxlYXNlOwogICAgICAgIHZvaWQgKmNvcHlEZXNjcmlwdGlvbjsKICAgICAgICB2b2lkICplcXVhbDsKICAgICAgICB2b2lkICpoYXNoOwogICAgfSBDRkRpY3Rpb25hcnlLZXlDYWxsQmFja3M7CgogICAgdHlwZWRlZiBzdHJ1Y3QgewogICAgICAgIENGSW5kZXggdmVyc2lvbjsKICAgICAgICB2b2lkICpyZXRhaW47CiAgICAgICAgdm9pZCAqcmVsZWFzZTsKICAgICAgICB2b2lkICpjb3B5RGVzY3JpcHRpb247CiAgICAgICAgdm9pZCAqZXF1YWw7CiAgICB9IENGRGljdGlvbmFyeVZhbHVlQ2FsbEJhY2tzOwoKICAgIHR5cGVkZWYgc3RydWN0IHsKICAgICAgICBDRkluZGV4IHZlcnNpb247CiAgICAgICAgdm9pZCAqcmV0YWluOwogICAgICAgIHZvaWQgKnJlbGVhc2U7CiAgICAgICAgdm9pZCAqY29weURlc2NyaXB0aW9uOwogICAgICAgIHZvaWQgKmVxdWFsOwogICAgfSBDRkFycmF5Q2FsbEJhY2tzOwoKICAgIENGSW5kZXggQ0ZEYXRhR2V0TGVuZ3RoKENGRGF0YVJlZiB0aGVEYXRhKTsKICAgIGNvbnN0IGNoYXIgKkNGRGF0YUdldEJ5dGVQdHIoQ0ZEYXRhUmVmIHRoZURhdGEpOwogICAgQ0ZEYXRhUmVmIENGRGF0YUNyZWF0ZShDRkFsbG9jYXRvclJlZiBhbGxvY2F0b3IsIGNvbnN0IGNoYXIgKmJ5dGVzLCBDRkluZGV4IGxlbmd0aCk7CgogICAgQ0ZEaWN0aW9uYXJ5UmVmIENGRGljdGlvbmFyeUNyZWF0ZShDRkFsbG9jYXRvclJlZiBhbGxvY2F0b3IsIGNvbnN0IHZvaWQgKiprZXlzLCBjb25zdCB2b2lkICoqdmFsdWVzLAogICAgICAgICAgICAgICAgICAgIENGSW5kZXggbnVtVmFsdWVzLCBjb25zdCBDRkRpY3Rpb25hcnlLZXlDYWxsQmFja3MgKmtleUNhbGxCYWNrcywKICAgICAgICAgICAgICAgICAgICBjb25zdCBDRkRpY3Rpb25hcnlWYWx1ZUNhbGxCYWNrcyAqdmFsdWVDYWxsQmFja3MpOwogICAgQ0ZJbmRleCBDRkRpY3Rpb25hcnlHZXRDb3VudChDRkRpY3Rpb25hcnlSZWYgdGhlRGljdCk7CgogICAgY29uc3QgY2hhciAqQ0ZTdHJpbmdHZXRDU3RyaW5nUHRyKENGU3RyaW5nUmVmIHRoZVN0cmluZywgQ0ZTdHJpbmdFbmNvZGluZyBlbmNvZGluZyk7CiAgICBCb29sZWFuIENGU3RyaW5nR2V0Q1N0cmluZyhDRlN0cmluZ1JlZiB0aGVTdHJpbmcsIGNoYXIgKmJ1ZmZlciwgQ0ZJbmRleCBidWZmZXJTaXplLCBDRlN0cmluZ0VuY29kaW5nIGVuY29kaW5nKTsKICAgIENGU3RyaW5nUmVmIENGU3RyaW5nQ3JlYXRlV2l0aENTdHJpbmcoQ0ZBbGxvY2F0b3JSZWYgYWxsb2MsIGNvbnN0IGNoYXIgKmNTdHIsIENGU3RyaW5nRW5jb2RpbmcgZW5jb2RpbmcpOwoKICAgIENGTnVtYmVyUmVmIENGTnVtYmVyQ3JlYXRlKENGQWxsb2NhdG9yUmVmIGFsbG9jYXRvciwgQ0ZOdW1iZXJUeXBlIHRoZVR5cGUsIGNvbnN0IHZvaWQgKnZhbHVlUHRyKTsKCiAgICBDRlN0cmluZ1JlZiBDRkNvcHlUeXBlSUREZXNjcmlwdGlvbihDRlR5cGVJRCB0eXBlX2lkKTsKCiAgICB2b2lkIENGUmVsZWFzZShDRlR5cGVSZWYgY2YpOwogICAgdm9pZCBDRlJldGFpbihDRlR5cGVSZWYgY2YpOwoKICAgIENGU3RyaW5nUmVmIENGRXJyb3JDb3B5RGVzY3JpcHRpb24oQ0ZFcnJvclJlZiBlcnIpOwogICAgQ0ZTdHJpbmdSZWYgQ0ZFcnJvckdldERvbWFpbihDRkVycm9yUmVmIGVycik7CiAgICBDRkluZGV4IENGRXJyb3JHZXRDb2RlKENGRXJyb3JSZWYgZXJyKTsKCiAgICBCb29sZWFuIENGQm9vbGVhbkdldFZhbHVlKENGQm9vbGVhblJlZiBib29sZWFuKTsKCiAgICBDRlR5cGVJRCBDRkRpY3Rpb25hcnlHZXRUeXBlSUQodm9pZCk7CiAgICBDRlR5cGVJRCBDRk51bWJlckdldFR5cGVJRCh2b2lkKTsKICAgIENGVHlwZUlEIENGU3RyaW5nR2V0VHlwZUlEKHZvaWQpOwogICAgQ0ZUeXBlSUQgQ0ZEYXRhR2V0VHlwZUlEKHZvaWQpOwoKICAgIENGQXJyYXlSZWYgQ0ZBcnJheUNyZWF0ZShDRkFsbG9jYXRvclJlZiBhbGxvY2F0b3IsIGNvbnN0IHZvaWQgKip2YWx1ZXMsIENGSW5kZXggbnVtVmFsdWVzLAogICAgICAgICAgICAgICAgICAgIGNvbnN0IENGQXJyYXlDYWxsQmFja3MgKmNhbGxCYWNrcyk7CiAgICBDRkluZGV4IENGQXJyYXlHZXRDb3VudChDRkFycmF5UmVmIHRoZUFycmF5KTsKICAgIENGVHlwZVJlZiBDRkFycmF5R2V0VmFsdWVBdEluZGV4KENGQXJyYXlSZWYgdGhlQXJyYXksIENGSW5kZXggaWR4KTsKICAgIENGTnVtYmVyVHlwZSBDRk51bWJlckdldFR5cGUoQ0ZOdW1iZXJSZWYgbnVtYmVyKTsKICAgIEJvb2xlYW4gQ0ZOdW1iZXJHZXRWYWx1ZShDRk51bWJlclJlZiBudW1iZXIsIENGTnVtYmVyVHlwZSB0aGVUeXBlLCB2b2lkICp2YWx1ZVB0cik7CiAgICBDRkluZGV4IENGRGljdGlvbmFyeUdldEtleXNBbmRWYWx1ZXMoQ0ZEaWN0aW9uYXJ5UmVmIHRoZURpY3QsIGNvbnN0IHZvaWQgKiprZXlzLCBjb25zdCB2b2lkICoqdmFsdWVzKTsKICAgIENGVHlwZUlEIENGR2V0VHlwZUlEKENGVHlwZVJlZiBjZik7CgogICAgZXh0ZXJuIENGQWxsb2NhdG9yUmVmIGtDRkFsbG9jYXRvckRlZmF1bHQ7CiAgICBleHRlcm4gQ0ZBcnJheUNhbGxCYWNrcyBrQ0ZUeXBlQXJyYXlDYWxsQmFja3M7CiAgICBleHRlcm4gQ0ZCb29sZWFuUmVmIGtDRkJvb2xlYW5UcnVlOwogICAgZXh0ZXJuIENGRGljdGlvbmFyeUtleUNhbGxCYWNrcyBrQ0ZUeXBlRGljdGlvbmFyeUtleUNhbGxCYWNrczsKICAgIGV4dGVybiBDRkRpY3Rpb25hcnlWYWx1ZUNhbGxCYWNrcyBrQ0ZUeXBlRGljdGlvbmFyeVZhbHVlQ2FsbEJhY2tzOwoiIiIpCgpjb3JlX2ZvdW5kYXRpb25fcGF0aCA9ICcvU3lzdGVtL0xpYnJhcnkvRnJhbWV3b3Jrcy9Db3JlRm91bmRhdGlvbi5mcmFtZXdvcmsvQ29yZUZvdW5kYXRpb24nCgpDb3JlRm91bmRhdGlvbiA9IGZmaS5kbG9wZW4oY29yZV9mb3VuZGF0aW9uX3BhdGgpCnJlZ2lzdGVyX2ZmaShDb3JlRm91bmRhdGlvbiwgZmZpKQoKa0NGTnVtYmVyQ0ZJbmRleFR5cGUgPSAxNAprQ0ZTdHJpbmdFbmNvZGluZ1VURjggPSAweDA4MDAwMTAwCgoKY2xhc3MgQ0ZIZWxwZXJzKCk6CiAgICAiIiIKICAgIE5hbWVzcGFjZSBmb3IgY29yZSBmb3VuZGF0aW9uIGhlbHBlcnMKICAgICIiIgoKICAgIF9uYXRpdmVfbWFwID0ge30KCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiByZWdpc3Rlcl9uYXRpdmVfbWFwcGluZyhjbHMsIHR5cGVfaWQsIGNhbGxiYWNrKToKICAgICAgICAiIiIKICAgICAgICBSZWdpc3RlciBhIGZ1bmN0aW9uIHRvIGNvbnZlcnQgYSBjb3JlIGZvdW5kYXRpb24gZGF0YSB0eXBlIGludG8gaXRzCiAgICAgICAgZXF1aXZhbGVudCBpbiBweXRob24KCiAgICAgICAgOnBhcmFtIHR5cGVfaWQ6CiAgICAgICAgICAgIFRoZSBDRlR5cGVJZCBmb3IgdGhlIHR5cGUKCiAgICAgICAgOnBhcmFtIGNhbGxiYWNrOgogICAgICAgICAgICBBIGNhbGxiYWNrIHRvIHBhc3MgdGhlIENGVHlwZSBvYmplY3QgdG8KICAgICAgICAiIiIKCiAgICAgICAgY2xzLl9uYXRpdmVfbWFwW2ludCh0eXBlX2lkKV0gPSBjYWxsYmFjawoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjZl9udW1iZXJfdG9fbnVtYmVyKHZhbHVlKToKICAgICAgICAiIiIKICAgICAgICBDb252ZXJ0cyBhIENGTnVtYmVyIG9iamVjdCB0byBhIHB5dGhvbiBmbG9hdCBvciBpbnRlZ2VyCgogICAgICAgIDpwYXJhbSB2YWx1ZToKICAgICAgICAgICAgVGhlIENGTnVtYmVyIG9iamVjdAoKICAgICAgICA6cmV0dXJuOgogICAgICAgICAgICBBIHB5dGhvbiBudW1iZXIgKGZsb2F0IG9yIGludGVnZXIpCiAgICAgICAgIiIiCgogICAgICAgIHR5cGVfID0gQ29yZUZvdW5kYXRpb24uQ0ZOdW1iZXJHZXRUeXBlKHZhbHVlKQogICAgICAgIHR5cGVfbmFtZV8gPSB7CiAgICAgICAgICAgIDE6ICdpbnQ4X3QnLCAgICAgICMga0NGTnVtYmVyU0ludDhUeXBlCiAgICAgICAgICAgIDI6ICdpbjE2X3QnLCAgICAgICMga0NGTnVtYmVyU0ludDE2VHlwZQogICAgICAgICAgICAzOiAnaW50MzJfdCcsICAgICAjIGtDRk51bWJlclNJbnQzMlR5cGUKICAgICAgICAgICAgNDogJ2ludDY0X3QnLCAgICAgIyBrQ0ZOdW1iZXJTSW50NjRUeXBlCiAgICAgICAgICAgIDU6ICdmbG9hdCcsICAgICAgICMga0NGTnVtYmVyRmxvYXQzMlR5cGUKICAgICAgICAgICAgNjogJ2RvdWJsZScsICAgICAgIyBrQ0ZOdW1iZXJGbG9hdDY0VHlwZQogICAgICAgICAgICA3OiAnY2hhcicsICAgICAgICAjIGtDRk51bWJlckNoYXJUeXBlCiAgICAgICAgICAgIDg6ICdzaG9ydCcsICAgICAgICMga0NGTnVtYmVyU2hvcnRUeXBlCiAgICAgICAgICAgIDk6ICdpbnQnLCAgICAgICAgICMga0NGTnVtYmVySW50VHlwZQogICAgICAgICAgICAxMDogJ2xvbmcnLCAgICAgICAjIGtDRk51bWJlckxvbmdUeXBlCiAgICAgICAgICAgIDExOiAnbG9uZyBsb25nJywgICMga0NGTnVtYmVyTG9uZ0xvbmdUeXBlCiAgICAgICAgICAgIDEyOiAnZmxvYXQnLCAgICAgICMga0NGTnVtYmVyRmxvYXRUeXBlCiAgICAgICAgICAgIDEzOiAnZG91YmxlJywgICAgICMga0NGTnVtYmVyRG91YmxlVHlwZQogICAgICAgICAgICAxNDogJ2xvbmcnLCAgICAgICAjIGtDRk51bWJlckNGSW5kZXhUeXBlCiAgICAgICAgICAgIDE1OiAnaW50JywgICAgICAgICMga0NGTnVtYmVyTlNJbnRlZ2VyVHlwZQogICAgICAgICAgICAxNjogJ2RvdWJsZScsICAgICAjIGtDRk51bWJlckNHRmxvYXRUeXBlCiAgICAgICAgfVt0eXBlX10KICAgICAgICBvdXRwdXQgPSBuZXcoQ29yZUZvdW5kYXRpb24sIHR5cGVfbmFtZV8gKyAnIConKQogICAgICAgIENvcmVGb3VuZGF0aW9uLkNGTnVtYmVyR2V0VmFsdWUodmFsdWUsIHR5cGVfLCBvdXRwdXQpCiAgICAgICAgcmV0dXJuIGRlcmVmKG91dHB1dCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY2ZfZGljdGlvbmFyeV90b19kaWN0KGRpY3Rpb25hcnkpOgogICAgICAgICIiIgogICAgICAgIENvbnZlcnRzIGEgQ0ZEaWN0aW9uYXJ5IG9iamVjdCBpbnRvIGEgcHl0aG9uIGRpY3Rpb25hcnkKCiAgICAgICAgOnBhcmFtIGRpY3Rpb25hcnk6CiAgICAgICAgICAgIFRoZSBDRkRpY3Rpb25hcnkgdG8gY29udmVydAoKICAgICAgICA6cmV0dXJuOgogICAgICAgICAgICBBIHB5dGhvbiBkaWN0CiAgICAgICAgIiIiCgogICAgICAgIGRpY3RfbGVuZ3RoID0gQ29yZUZvdW5kYXRpb24uQ0ZEaWN0aW9uYXJ5R2V0Q291bnQoZGljdGlvbmFyeSkKCiAgICAgICAga2V5cyA9IG5ldyhDb3JlRm91bmRhdGlvbiwgJ0NGVHlwZVJlZlslc10nICUgZGljdF9sZW5ndGgpCiAgICAgICAgdmFsdWVzID0gbmV3KENvcmVGb3VuZGF0aW9uLCAnQ0ZUeXBlUmVmWyVzXScgJSBkaWN0X2xlbmd0aCkKICAgICAgICBDb3JlRm91bmRhdGlvbi5DRkRpY3Rpb25hcnlHZXRLZXlzQW5kVmFsdWVzKAogICAgICAgICAgICBkaWN0aW9uYXJ5LAogICAgICAgICAgICBrZXlzLAogICAgICAgICAgICB2YWx1ZXMKICAgICAgICApCgogICAgICAgIG91dHB1dCA9IHt9CiAgICAgICAgZm9yIGluZGV4IGluIHJhbmdlKDAsIGRpY3RfbGVuZ3RoKToKICAgICAgICAgICAgb3V0cHV0W0NGSGVscGVycy5uYXRpdmUoa2V5c1tpbmRleF0pXSA9IENGSGVscGVycy5uYXRpdmUodmFsdWVzW2luZGV4XSkKCiAgICAgICAgcmV0dXJuIG91dHB1dAoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIG5hdGl2ZShjbHMsIHZhbHVlKToKICAgICAgICAiIiIKICAgICAgICBDb252ZXJ0cyBhIENGKiBvYmplY3QgaW50byBpdHMgcHl0aG9uIGVxdWl2YWxlbnQKCiAgICAgICAgOnBhcmFtIHZhbHVlOgogICAgICAgICAgICBUaGUgQ0YqIG9iamVjdCB0byBjb252ZXJ0CgogICAgICAgIDpyZXR1cm46CiAgICAgICAgICAgIFRoZSBuYXRpdmUgcHl0aG9uIG9iamVjdAogICAgICAgICIiIgoKICAgICAgICB0eXBlX2lkID0gQ29yZUZvdW5kYXRpb24uQ0ZHZXRUeXBlSUQodmFsdWUpCiAgICAgICAgaWYgdHlwZV9pZCBpbiBjbHMuX25hdGl2ZV9tYXA6CiAgICAgICAgICAgIHJldHVybiBjbHMuX25hdGl2ZV9tYXBbdHlwZV9pZF0odmFsdWUpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIHZhbHVlCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNmX3N0cmluZ190b191bmljb2RlKHZhbHVlKToKICAgICAgICAiIiIKICAgICAgICBDcmVhdGVzIGEgcHl0aG9uIHVuaWNvZGUgc3RyaW5nIGZyb20gYSBDRlN0cmluZyBvYmplY3QKCiAgICAgICAgOnBhcmFtIHZhbHVlOgogICAgICAgICAgICBUaGUgQ0ZTdHJpbmcgdG8gY29udmVydAoKICAgICAgICA6cmV0dXJuOgogICAgICAgICAgICBBIHB5dGhvbiB1bmljb2RlIHN0cmluZwogICAgICAgICIiIgoKICAgICAgICBzdHJpbmdfcHRyID0gQ29yZUZvdW5kYXRpb24uQ0ZTdHJpbmdHZXRDU3RyaW5nUHRyKAogICAgICAgICAgICB2YWx1ZSwKICAgICAgICAgICAga0NGU3RyaW5nRW5jb2RpbmdVVEY4CiAgICAgICAgKQogICAgICAgIHN0cmluZyA9IE5vbmUgaWYgaXNfbnVsbChzdHJpbmdfcHRyKSBlbHNlIGZmaS5zdHJpbmcoc3RyaW5nX3B0cikKICAgICAgICBpZiBzdHJpbmcgaXMgTm9uZToKICAgICAgICAgICAgYnVmZmVyID0gYnVmZmVyX2Zyb21fYnl0ZXMoMTAyNCkKICAgICAgICAgICAgcmVzdWx0ID0gQ29yZUZvdW5kYXRpb24uQ0ZTdHJpbmdHZXRDU3RyaW5nKAogICAgICAgICAgICAgICAgdmFsdWUsCiAgICAgICAgICAgICAgICBidWZmZXIsCiAgICAgICAgICAgICAgICAxMDI0LAogICAgICAgICAgICAgICAga0NGU3RyaW5nRW5jb2RpbmdVVEY4CiAgICAgICAgICAgICkKICAgICAgICAgICAgaWYgbm90IHJlc3VsdDoKICAgICAgICAgICAgICAgIHJhaXNlIE9TRXJyb3IoJ0Vycm9yIGNvcHlpbmcgQyBzdHJpbmcgZnJvbSBDRlN0cmluZ1JlZicpCiAgICAgICAgICAgIHN0cmluZyA9IGJ5dGVfc3RyaW5nX2Zyb21fYnVmZmVyKGJ1ZmZlcikKICAgICAgICBpZiBzdHJpbmcgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHN0cmluZyA9IHN0cmluZy5kZWNvZGUoJ3V0Zi04JykKICAgICAgICByZXR1cm4gc3RyaW5nCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNmX3N0cmluZ19mcm9tX3VuaWNvZGUoc3RyaW5nKToKICAgICAgICAiIiIKICAgICAgICBDcmVhdGVzIGEgQ0ZTdHJpbmdSZWYgb2JqZWN0IGZyb20gYSB1bmljb2RlIHN0cmluZwoKICAgICAgICA6cGFyYW0gc3RyaW5nOgogICAgICAgICAgICBUaGUgdW5pY29kZSBzdHJpbmcgdG8gY3JlYXRlIHRoZSBDRlN0cmluZyBvYmplY3QgZnJvbQoKICAgICAgICA6cmV0dXJuOgogICAgICAgICAgICBBIENGU3RyaW5nUmVmCiAgICAgICAgIiIiCgogICAgICAgIHJldHVybiBDb3JlRm91bmRhdGlvbi5DRlN0cmluZ0NyZWF0ZVdpdGhDU3RyaW5nKAogICAgICAgICAgICBDb3JlRm91bmRhdGlvbi5rQ0ZBbGxvY2F0b3JEZWZhdWx0LAogICAgICAgICAgICBzdHJpbmcuZW5jb2RlKCd1dGYtOCcpLAogICAgICAgICAgICBrQ0ZTdHJpbmdFbmNvZGluZ1VURjgKICAgICAgICApCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNmX2RhdGFfdG9fYnl0ZXModmFsdWUpOgogICAgICAgICIiIgogICAgICAgIEV4dHJhY3RzIGEgYnl0ZXN0cmluZyBmcm9tIGEgQ0ZEYXRhIG9iamVjdAoKICAgICAgICA6cGFyYW0gdmFsdWU6CiAgICAgICAgICAgIEEgQ0ZEYXRhIG9iamVjdAoKICAgICAgICA6cmV0dXJuOgogICAgICAgICAgICBBIGJ5dGUgc3RyaW5nCiAgICAgICAgIiIiCgogICAgICAgIHN0YXJ0ID0gQ29yZUZvdW5kYXRpb24uQ0ZEYXRhR2V0Qnl0ZVB0cih2YWx1ZSkKICAgICAgICBudW1fYnl0ZXMgPSBDb3JlRm91bmRhdGlvbi5DRkRhdGFHZXRMZW5ndGgodmFsdWUpCiAgICAgICAgcmV0dXJuIGZmaS5idWZmZXIoc3RhcnQsIG51bV9ieXRlcylbOl0KCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY2ZfZGF0YV9mcm9tX2J5dGVzKGJ5dGVzXyk6CiAgICAgICAgIiIiCiAgICAgICAgQ3JlYXRlcyBhIENGRGF0YVJlZiBvYmplY3QgZnJvbSBhIGJ5dGUgc3RyaW5nCgogICAgICAgIDpwYXJhbSBieXRlc186CiAgICAgICAgICAgIFRoZSBkYXRhIHRvIGNyZWF0ZSB0aGUgQ0ZEYXRhIG9iamVjdCBmcm9tCgogICAgICAgIDpyZXR1cm46CiAgICAgICAgICAgIEEgQ0ZEYXRhUmVmCiAgICAgICAgIiIiCgogICAgICAgIHJldHVybiBDb3JlRm91bmRhdGlvbi5DRkRhdGFDcmVhdGUoCiAgICAgICAgICAgIENvcmVGb3VuZGF0aW9uLmtDRkFsbG9jYXRvckRlZmF1bHQsCiAgICAgICAgICAgIGJ5dGVzXywKICAgICAgICAgICAgbGVuKGJ5dGVzXykKICAgICAgICApCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNmX2RpY3Rpb25hcnlfZnJvbV9wYWlycyhwYWlycyk6CiAgICAgICAgIiIiCiAgICAgICAgQ3JlYXRlcyBhIENGRGljdGlvbmFyeVJlZiBvYmplY3QgZnJvbSBhIGxpc3Qgb2YgMi1lbGVtZW50IHR1cGxlcwogICAgICAgIHJlcHJlc2VudGluZyB0aGUga2V5IGFuZCB2YWx1ZS4gRWFjaCBrZXkgc2hvdWxkIGJlIGEgQ0ZTdHJpbmdSZWYgYW5kIGVhY2gKICAgICAgICB2YWx1ZSBzb21lIHNvcnQgb2YgQ0YqIHR5cGUuCgogICAgICAgIDpwYXJhbSBwYWlyczoKICAgICAgICAgICAgQSBsaXN0IG9mIDItZWxlbWVudCB0dXBsZXMKCiAgICAgICAgOnJldHVybjoKICAgICAgICAgICAgQSBDRkRpY3Rpb25hcnlSZWYKICAgICAgICAiIiIKCiAgICAgICAgbGVuZ3RoID0gbGVuKHBhaXJzKQogICAgICAgIGtleXMgPSBbXQogICAgICAgIHZhbHVlcyA9IFtdCiAgICAgICAgZm9yIHBhaXIgaW4gcGFpcnM6CiAgICAgICAgICAgIGtleSwgdmFsdWUgPSBwYWlyCiAgICAgICAgICAgIGtleXMuYXBwZW5kKGtleSkKICAgICAgICAgICAgdmFsdWVzLmFwcGVuZCh2YWx1ZSkKICAgICAgICByZXR1cm4gQ29yZUZvdW5kYXRpb24uQ0ZEaWN0aW9uYXJ5Q3JlYXRlKAogICAgICAgICAgICBDb3JlRm91bmRhdGlvbi5rQ0ZBbGxvY2F0b3JEZWZhdWx0LAogICAgICAgICAgICBrZXlzLAogICAgICAgICAgICB2YWx1ZXMsCiAgICAgICAgICAgIGxlbmd0aCwKICAgICAgICAgICAgZmZpLmFkZHJlc3NvZihDb3JlRm91bmRhdGlvbi5rQ0ZUeXBlRGljdGlvbmFyeUtleUNhbGxCYWNrcyksCiAgICAgICAgICAgIGZmaS5hZGRyZXNzb2YoQ29yZUZvdW5kYXRpb24ua0NGVHlwZURpY3Rpb25hcnlWYWx1ZUNhbGxCYWNrcykKICAgICAgICApCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNmX2FycmF5X2Zyb21fbGlzdCh2YWx1ZXMpOgogICAgICAgICIiIgogICAgICAgIENyZWF0ZXMgYSBDRkFycmF5UmVmIG9iamVjdCBmcm9tIGEgbGlzdCBvZiBDRiogdHlwZSBvYmplY3RzLgoKICAgICAgICA6cGFyYW0gdmFsdWVzOgogICAgICAgICAgICBBIGxpc3Qgb2YgQ0YqIHR5cGUgb2JqZWN0CgogICAgICAgIDpyZXR1cm46CiAgICAgICAgICAgIEEgQ0ZBcnJheVJlZgogICAgICAgICIiIgoKICAgICAgICBsZW5ndGggPSBsZW4odmFsdWVzKQogICAgICAgIHJldHVybiBDb3JlRm91bmRhdGlvbi5DRkFycmF5Q3JlYXRlKAogICAgICAgICAgICBDb3JlRm91bmRhdGlvbi5rQ0ZBbGxvY2F0b3JEZWZhdWx0LAogICAgICAgICAgICB2YWx1ZXMsCiAgICAgICAgICAgIGxlbmd0aCwKICAgICAgICAgICAgZmZpLmFkZHJlc3NvZihDb3JlRm91bmRhdGlvbi5rQ0ZUeXBlQXJyYXlDYWxsQmFja3MpCiAgICAgICAgKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjZl9udW1iZXJfZnJvbV9pbnRlZ2VyKGludGVnZXIpOgogICAgICAgICIiIgogICAgICAgIENyZWF0ZXMgYSBDRk51bWJlciBvYmplY3QgZnJvbSBhbiBpbnRlZ2VyCgogICAgICAgIDpwYXJhbSBpbnRlZ2VyOgogICAgICAgICAgICBUaGUgaW50ZWdlciB0byBjcmVhdGUgdGhlIENGTnVtYmVyIGZvcgoKICAgICAgICA6cmV0dXJuOgogICAgICAgICAgICBBIENGTnVtYmVyCiAgICAgICAgIiIiCgogICAgICAgIGludGVnZXJfYXNfbG9uZyA9IGZmaS5uZXcoJ2xvbmcgKicsIGludGVnZXIpCiAgICAgICAgcmV0dXJuIENvcmVGb3VuZGF0aW9uLkNGTnVtYmVyQ3JlYXRlKAogICAgICAgICAgICBDb3JlRm91bmRhdGlvbi5rQ0ZBbGxvY2F0b3JEZWZhdWx0LAogICAgICAgICAgICBrQ0ZOdW1iZXJDRkluZGV4VHlwZSwKICAgICAgICAgICAgaW50ZWdlcl9hc19sb25nCiAgICAgICAgKQo=
