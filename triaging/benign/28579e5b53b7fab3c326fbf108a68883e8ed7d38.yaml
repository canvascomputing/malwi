statistics:
  total_files: 1
  skipped_files: 0.0
  processed_objects: 1
  malicious_objects: 0
details:
- path: .repo_cache/malicious_repos/pypi_malregistry/botaa3/1.0.0/botaa3-1.0.0/boto3-1.20.7/boto3/dynamodb/conditions.py
  contents:
  - name: ConditionBase.get_expression
    score: null
    code: |-
      def get_expression(self):
              return {'format': self.expression_format,
                      'operator': self.expression_operator,
                      'values': self._values}
    tokens: resume load_fast self load_attr STRING_LEN_S_ENT_HIGH load_fast self load_attr STRING_LEN_S_ENT_HIGH load_fast self load_attr _values load_const build_const_key_map return_value
    hash: cac3e0df8f4b85d672b44f04183a2030009f053b46d6620991ee907ca035964f
sources:
  .repo_cache/malicious_repos/pypi_malregistry/botaa3/1.0.0/botaa3-1.0.0/boto3-1.20.7/boto3/dynamodb/conditions.py: IyBDb3B5cmlnaHQgMjAxNSBBbWF6b24uY29tLCBJbmMuIG9yIGl0cyBhZmZpbGlhdGVzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgojCiMgTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIikuIFlvdQojIG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBBIGNvcHkgb2YKIyB0aGUgTGljZW5zZSBpcyBsb2NhdGVkIGF0CiMKIyBodHRwczovL2F3cy5hbWF6b24uY29tL2FwYWNoZTIuMC8KIwojIG9yIGluIHRoZSAibGljZW5zZSIgZmlsZSBhY2NvbXBhbnlpbmcgdGhpcyBmaWxlLiBUaGlzIGZpbGUgaXMKIyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRgojIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYwojIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCmZyb20gY29sbGVjdGlvbnMgaW1wb3J0IG5hbWVkdHVwbGUKaW1wb3J0IHJlCgpmcm9tIGJvdG8zLmV4Y2VwdGlvbnMgaW1wb3J0IER5bmFtb0RCT3BlcmF0aW9uTm90U3VwcG9ydGVkRXJyb3IKZnJvbSBib3RvMy5leGNlcHRpb25zIGltcG9ydCBEeW5hbW9EQk5lZWRzQ29uZGl0aW9uRXJyb3IKZnJvbSBib3RvMy5leGNlcHRpb25zIGltcG9ydCBEeW5hbW9EQk5lZWRzS2V5Q29uZGl0aW9uRXJyb3IKCgpBVFRSX05BTUVfUkVHRVggPSByZS5jb21waWxlKHInW14uXFtcXV0rKD8hW15cW10qXF0pJykKCgpjbGFzcyBDb25kaXRpb25CYXNlKG9iamVjdCk6CgogICAgZXhwcmVzc2lvbl9mb3JtYXQgPSAnJwogICAgZXhwcmVzc2lvbl9vcGVyYXRvciA9ICcnCiAgICBoYXNfZ3JvdXBlZF92YWx1ZXMgPSBGYWxzZQoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCAqdmFsdWVzKToKICAgICAgICBzZWxmLl92YWx1ZXMgPSB2YWx1ZXMKCiAgICBkZWYgX19hbmRfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uob3RoZXIsIENvbmRpdGlvbkJhc2UpOgogICAgICAgICAgICByYWlzZSBEeW5hbW9EQk9wZXJhdGlvbk5vdFN1cHBvcnRlZEVycm9yKCdBTkQnLCBvdGhlcikKICAgICAgICByZXR1cm4gQW5kKHNlbGYsIG90aGVyKQoKICAgIGRlZiBfX29yX18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCBDb25kaXRpb25CYXNlKToKICAgICAgICAgICAgcmFpc2UgRHluYW1vREJPcGVyYXRpb25Ob3RTdXBwb3J0ZWRFcnJvcignT1InLCBvdGhlcikKICAgICAgICByZXR1cm4gT3Ioc2VsZiwgb3RoZXIpCgogICAgZGVmIF9faW52ZXJ0X18oc2VsZik6CiAgICAgICAgcmV0dXJuIE5vdChzZWxmKQoKICAgIGRlZiBnZXRfZXhwcmVzc2lvbihzZWxmKToKICAgICAgICByZXR1cm4geydmb3JtYXQnOiBzZWxmLmV4cHJlc3Npb25fZm9ybWF0LAogICAgICAgICAgICAgICAgJ29wZXJhdG9yJzogc2VsZi5leHByZXNzaW9uX29wZXJhdG9yLAogICAgICAgICAgICAgICAgJ3ZhbHVlcyc6IHNlbGYuX3ZhbHVlc30KCiAgICBkZWYgX19lcV9fKHNlbGYsIG90aGVyKToKICAgICAgICBpZiBpc2luc3RhbmNlKG90aGVyLCB0eXBlKHNlbGYpKToKICAgICAgICAgICAgaWYgc2VsZi5fdmFsdWVzID09IG90aGVyLl92YWx1ZXM6CiAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgIHJldHVybiBGYWxzZQoKICAgIGRlZiBfX25lX18oc2VsZiwgb3RoZXIpOgogICAgICAgIHJldHVybiBub3Qgc2VsZi5fX2VxX18ob3RoZXIpCgoKY2xhc3MgQXR0cmlidXRlQmFzZShvYmplY3QpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG5hbWUpOgogICAgICAgIHNlbGYubmFtZSA9IG5hbWUKCiAgICBkZWYgX19hbmRfXyhzZWxmLCB2YWx1ZSk6CiAgICAgICAgcmFpc2UgRHluYW1vREJPcGVyYXRpb25Ob3RTdXBwb3J0ZWRFcnJvcignQU5EJywgc2VsZikKCiAgICBkZWYgX19vcl9fKHNlbGYsIHZhbHVlKToKICAgICAgICByYWlzZSBEeW5hbW9EQk9wZXJhdGlvbk5vdFN1cHBvcnRlZEVycm9yKCdPUicsIHNlbGYpCgogICAgZGVmIF9faW52ZXJ0X18oc2VsZik6CiAgICAgICAgcmFpc2UgRHluYW1vREJPcGVyYXRpb25Ob3RTdXBwb3J0ZWRFcnJvcignTk9UJywgc2VsZikKCiAgICBkZWYgZXEoc2VsZiwgdmFsdWUpOgogICAgICAgICIiIkNyZWF0ZXMgYSBjb25kaXRpb24gd2hlcmUgdGhlIGF0dHJpYnV0ZSBpcyBlcXVhbCB0byB0aGUgdmFsdWUuCgogICAgICAgIDpwYXJhbSB2YWx1ZTogVGhlIHZhbHVlIHRoYXQgdGhlIGF0dHJpYnV0ZSBpcyBlcXVhbCB0by4KICAgICAgICAiIiIKICAgICAgICByZXR1cm4gRXF1YWxzKHNlbGYsIHZhbHVlKQoKICAgIGRlZiBsdChzZWxmLCB2YWx1ZSk6CiAgICAgICAgIiIiQ3JlYXRlcyBhIGNvbmRpdGlvbiB3aGVyZSB0aGUgYXR0cmlidXRlIGlzIGxlc3MgdGhhbiB0aGUgdmFsdWUuCgogICAgICAgIDpwYXJhbSB2YWx1ZTogVGhlIHZhbHVlIHRoYXQgdGhlIGF0dHJpYnV0ZSBpcyBsZXNzIHRoYW4uCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIExlc3NUaGFuKHNlbGYsIHZhbHVlKQoKICAgIGRlZiBsdGUoc2VsZiwgdmFsdWUpOgogICAgICAgICIiIkNyZWF0ZXMgYSBjb25kaXRpb24gd2hlcmUgdGhlIGF0dHJpYnV0ZSBpcyBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gdGhlCiAgICAgICAgICAgdmFsdWUuCgogICAgICAgIDpwYXJhbSB2YWx1ZTogVGhlIHZhbHVlIHRoYXQgdGhlIGF0dHJpYnV0ZSBpcyBsZXNzIHRoYW4gb3IgZXF1YWwgdG8uCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIExlc3NUaGFuRXF1YWxzKHNlbGYsIHZhbHVlKQoKICAgIGRlZiBndChzZWxmLCB2YWx1ZSk6CiAgICAgICAgIiIiQ3JlYXRlcyBhIGNvbmRpdGlvbiB3aGVyZSB0aGUgYXR0cmlidXRlIGlzIGdyZWF0ZXIgdGhhbiB0aGUgdmFsdWUuCgogICAgICAgIDpwYXJhbSB2YWx1ZTogVGhlIHZhbHVlIHRoYXQgdGhlIGF0dHJpYnV0ZSBpcyBncmVhdGVyIHRoYW4uCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIEdyZWF0ZXJUaGFuKHNlbGYsIHZhbHVlKQoKICAgIGRlZiBndGUoc2VsZiwgdmFsdWUpOgogICAgICAgICIiIkNyZWF0ZXMgYSBjb25kaXRpb24gd2hlcmUgdGhlIGF0dHJpYnV0ZSBpcyBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8KICAgICAgICAgICB0aGUgdmFsdWUuCgogICAgICAgIDpwYXJhbSB2YWx1ZTogVGhlIHZhbHVlIHRoYXQgdGhlIGF0dHJpYnV0ZSBpcyBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8uCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIEdyZWF0ZXJUaGFuRXF1YWxzKHNlbGYsIHZhbHVlKQoKICAgIGRlZiBiZWdpbnNfd2l0aChzZWxmLCB2YWx1ZSk6CiAgICAgICAgIiIiQ3JlYXRlcyBhIGNvbmRpdGlvbiB3aGVyZSB0aGUgYXR0cmlidXRlIGJlZ2lucyB3aXRoIHRoZSB2YWx1ZS4KCiAgICAgICAgOnBhcmFtIHZhbHVlOiBUaGUgdmFsdWUgdGhhdCB0aGUgYXR0cmlidXRlIGJlZ2lucyB3aXRoLgogICAgICAgICIiIgogICAgICAgIHJldHVybiBCZWdpbnNXaXRoKHNlbGYsIHZhbHVlKQoKICAgIGRlZiBiZXR3ZWVuKHNlbGYsIGxvd192YWx1ZSwgaGlnaF92YWx1ZSk6CiAgICAgICAgIiIiQ3JlYXRlcyBhIGNvbmRpdGlvbiB3aGVyZSB0aGUgYXR0cmlidXRlIGlzIGdyZWF0ZXIgdGhhbiBvciBlcXVhbAogICAgICAgIHRvIHRoZSBsb3cgdmFsdWUgYW5kIGxlc3MgdGhhbiBvciBlcXVhbCB0byB0aGUgaGlnaCB2YWx1ZS4KCiAgICAgICAgOnBhcmFtIGxvd192YWx1ZTogVGhlIHZhbHVlIHRoYXQgdGhlIGF0dHJpYnV0ZSBpcyBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8uCiAgICAgICAgOnBhcmFtIGhpZ2hfdmFsdWU6IFRoZSB2YWx1ZSB0aGF0IHRoZSBhdHRyaWJ1dGUgaXMgbGVzcyB0aGFuIG9yIGVxdWFsIHRvLgogICAgICAgICIiIgogICAgICAgIHJldHVybiBCZXR3ZWVuKHNlbGYsIGxvd192YWx1ZSwgaGlnaF92YWx1ZSkKCiAgICBkZWYgX19lcV9fKHNlbGYsIG90aGVyKToKICAgICAgICByZXR1cm4gaXNpbnN0YW5jZShvdGhlciwgdHlwZShzZWxmKSkgYW5kIHNlbGYubmFtZSA9PSBvdGhlci5uYW1lCgogICAgZGVmIF9fbmVfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgcmV0dXJuIG5vdCBzZWxmLl9fZXFfXyhvdGhlcikKCgpjbGFzcyBDb25kaXRpb25BdHRyaWJ1dGVCYXNlKENvbmRpdGlvbkJhc2UsIEF0dHJpYnV0ZUJhc2UpOgogICAgIiIiVGhpcyBiYXNlIGNsYXNzIGlzIGZvciBjb25kaXRpb25zIHRoYXQgY2FuIGhhdmUgYXR0cmlidXRlIG1ldGhvZHMuCgogICAgT25lIGV4YW1wbGUgaXMgdGhlIFNpemUgY29uZGl0aW9uLiBUbyBjb21wbGV0ZSBhIGNvbmRpdGlvbiwgeW91IG5lZWQKICAgIHRvIGFwcGx5IGFub3RoZXIgQXR0cmlidXRlQmFzZSBtZXRob2QgbGlrZSBlcSgpLgogICAgIiIiCiAgICBkZWYgX19pbml0X18oc2VsZiwgKnZhbHVlcyk6CiAgICAgICAgQ29uZGl0aW9uQmFzZS5fX2luaXRfXyhzZWxmLCAqdmFsdWVzKQogICAgICAgICMgVGhpcyBpcyBhc3N1bWluZyB0aGUgZmlyc3QgdmFsdWUgdG8gdGhlIGNvbmRpdGlvbiBpcyB0aGUgYXR0cmlidXRlCiAgICAgICAgIyBpbiB3aGljaCBjYW4gYmUgdXNlZCB0byBnZW5lcmF0ZSBpdHMgYXR0cmlidXRlIGJhc2UuCiAgICAgICAgQXR0cmlidXRlQmFzZS5fX2luaXRfXyhzZWxmLCB2YWx1ZXNbMF0ubmFtZSkKCiAgICBkZWYgX19lcV9fKHNlbGYsIG90aGVyKToKICAgICAgICByZXR1cm4gKAogICAgICAgICAgICBDb25kaXRpb25CYXNlLl9fZXFfXyhzZWxmLCBvdGhlcikgYW5kIEF0dHJpYnV0ZUJhc2UuX19lcV9fKHNlbGYsIG90aGVyKQogICAgICAgICkKCiAgICBkZWYgX19uZV9fKHNlbGYsIG90aGVyKToKICAgICAgICByZXR1cm4gbm90IHNlbGYuX19lcV9fKG90aGVyKQoKCmNsYXNzIENvbXBhcmlzb25Db25kaXRpb24oQ29uZGl0aW9uQmFzZSk6CiAgICBleHByZXNzaW9uX2Zvcm1hdCA9ICd7MH0ge29wZXJhdG9yfSB7MX0nCgoKY2xhc3MgRXF1YWxzKENvbXBhcmlzb25Db25kaXRpb24pOgogICAgZXhwcmVzc2lvbl9vcGVyYXRvciA9ICc9JwoKCmNsYXNzIE5vdEVxdWFscyhDb21wYXJpc29uQ29uZGl0aW9uKToKICAgIGV4cHJlc3Npb25fb3BlcmF0b3IgPSAnPD4nCgoKY2xhc3MgTGVzc1RoYW4oQ29tcGFyaXNvbkNvbmRpdGlvbik6CiAgICBleHByZXNzaW9uX29wZXJhdG9yID0gJzwnCgoKY2xhc3MgTGVzc1RoYW5FcXVhbHMoQ29tcGFyaXNvbkNvbmRpdGlvbik6CiAgICBleHByZXNzaW9uX29wZXJhdG9yID0gJzw9JwoKCmNsYXNzIEdyZWF0ZXJUaGFuKENvbXBhcmlzb25Db25kaXRpb24pOgogICAgZXhwcmVzc2lvbl9vcGVyYXRvciA9ICc+JwoKCmNsYXNzIEdyZWF0ZXJUaGFuRXF1YWxzKENvbXBhcmlzb25Db25kaXRpb24pOgogICAgZXhwcmVzc2lvbl9vcGVyYXRvciA9ICc+PScKCgpjbGFzcyBJbihDb21wYXJpc29uQ29uZGl0aW9uKToKICAgIGV4cHJlc3Npb25fb3BlcmF0b3IgPSAnSU4nCiAgICBoYXNfZ3JvdXBlZF92YWx1ZXMgPSBUcnVlCgoKY2xhc3MgQmV0d2VlbihDb25kaXRpb25CYXNlKToKICAgIGV4cHJlc3Npb25fb3BlcmF0b3IgPSAnQkVUV0VFTicKICAgIGV4cHJlc3Npb25fZm9ybWF0ID0gJ3swfSB7b3BlcmF0b3J9IHsxfSBBTkQgezJ9JwoKCmNsYXNzIEJlZ2luc1dpdGgoQ29uZGl0aW9uQmFzZSk6CiAgICBleHByZXNzaW9uX29wZXJhdG9yID0gJ2JlZ2luc193aXRoJwogICAgZXhwcmVzc2lvbl9mb3JtYXQgPSAne29wZXJhdG9yfSh7MH0sIHsxfSknCgoKY2xhc3MgQ29udGFpbnMoQ29uZGl0aW9uQmFzZSk6CiAgICBleHByZXNzaW9uX29wZXJhdG9yID0gJ2NvbnRhaW5zJwogICAgZXhwcmVzc2lvbl9mb3JtYXQgPSAne29wZXJhdG9yfSh7MH0sIHsxfSknCgoKY2xhc3MgU2l6ZShDb25kaXRpb25BdHRyaWJ1dGVCYXNlKToKICAgIGV4cHJlc3Npb25fb3BlcmF0b3IgPSAnc2l6ZScKICAgIGV4cHJlc3Npb25fZm9ybWF0ID0gJ3tvcGVyYXRvcn0oezB9KScKCgpjbGFzcyBBdHRyaWJ1dGVUeXBlKENvbmRpdGlvbkJhc2UpOgogICAgZXhwcmVzc2lvbl9vcGVyYXRvciA9ICdhdHRyaWJ1dGVfdHlwZScKICAgIGV4cHJlc3Npb25fZm9ybWF0ID0gJ3tvcGVyYXRvcn0oezB9LCB7MX0pJwoKCmNsYXNzIEF0dHJpYnV0ZUV4aXN0cyhDb25kaXRpb25CYXNlKToKICAgIGV4cHJlc3Npb25fb3BlcmF0b3IgPSAnYXR0cmlidXRlX2V4aXN0cycKICAgIGV4cHJlc3Npb25fZm9ybWF0ID0gJ3tvcGVyYXRvcn0oezB9KScKCgpjbGFzcyBBdHRyaWJ1dGVOb3RFeGlzdHMoQ29uZGl0aW9uQmFzZSk6CiAgICBleHByZXNzaW9uX29wZXJhdG9yID0gJ2F0dHJpYnV0ZV9ub3RfZXhpc3RzJwogICAgZXhwcmVzc2lvbl9mb3JtYXQgPSAne29wZXJhdG9yfSh7MH0pJwoKCmNsYXNzIEFuZChDb25kaXRpb25CYXNlKToKICAgIGV4cHJlc3Npb25fb3BlcmF0b3IgPSAnQU5EJwogICAgZXhwcmVzc2lvbl9mb3JtYXQgPSAnKHswfSB7b3BlcmF0b3J9IHsxfSknCgoKY2xhc3MgT3IoQ29uZGl0aW9uQmFzZSk6CiAgICBleHByZXNzaW9uX29wZXJhdG9yID0gJ09SJwogICAgZXhwcmVzc2lvbl9mb3JtYXQgPSAnKHswfSB7b3BlcmF0b3J9IHsxfSknCgoKY2xhc3MgTm90KENvbmRpdGlvbkJhc2UpOgogICAgZXhwcmVzc2lvbl9vcGVyYXRvciA9ICdOT1QnCiAgICBleHByZXNzaW9uX2Zvcm1hdCA9ICcoe29wZXJhdG9yfSB7MH0pJwoKCmNsYXNzIEtleShBdHRyaWJ1dGVCYXNlKToKICAgIHBhc3MKCgpjbGFzcyBBdHRyKEF0dHJpYnV0ZUJhc2UpOgogICAgIiIiUmVwcmVzZW50cyBhbiBEeW5hbW9EQiBpdGVtJ3MgYXR0cmlidXRlLiIiIgogICAgZGVmIG5lKHNlbGYsIHZhbHVlKToKICAgICAgICAiIiJDcmVhdGVzIGEgY29uZGl0aW9uIHdoZXJlIHRoZSBhdHRyaWJ1dGUgaXMgbm90IGVxdWFsIHRvIHRoZSB2YWx1ZQoKICAgICAgICA6cGFyYW0gdmFsdWU6IFRoZSB2YWx1ZSB0aGF0IHRoZSBhdHRyaWJ1dGUgaXMgbm90IGVxdWFsIHRvLgogICAgICAgICIiIgogICAgICAgIHJldHVybiBOb3RFcXVhbHMoc2VsZiwgdmFsdWUpCgogICAgZGVmIGlzX2luKHNlbGYsIHZhbHVlKToKICAgICAgICAiIiJDcmVhdGVzIGEgY29uZGl0aW9uIHdoZXJlIHRoZSBhdHRyaWJ1dGUgaXMgaW4gdGhlIHZhbHVlLAoKICAgICAgICA6dHlwZSB2YWx1ZTogbGlzdAogICAgICAgIDpwYXJhbSB2YWx1ZTogVGhlIHZhbHVlIHRoYXQgdGhlIGF0dHJpYnV0ZSBpcyBpbi4KICAgICAgICAiIiIKICAgICAgICByZXR1cm4gSW4oc2VsZiwgdmFsdWUpCgogICAgZGVmIGV4aXN0cyhzZWxmKToKICAgICAgICAiIiJDcmVhdGVzIGEgY29uZGl0aW9uIHdoZXJlIHRoZSBhdHRyaWJ1dGUgZXhpc3RzLiIiIgogICAgICAgIHJldHVybiBBdHRyaWJ1dGVFeGlzdHMoc2VsZikKCiAgICBkZWYgbm90X2V4aXN0cyhzZWxmKToKICAgICAgICAiIiJDcmVhdGVzIGEgY29uZGl0aW9uIHdoZXJlIHRoZSBhdHRyaWJ1dGUgZG9lcyBub3QgZXhpc3QuIiIiCiAgICAgICAgcmV0dXJuIEF0dHJpYnV0ZU5vdEV4aXN0cyhzZWxmKQoKICAgIGRlZiBjb250YWlucyhzZWxmLCB2YWx1ZSk6CiAgICAgICAgIiIiQ3JlYXRlcyBhIGNvbmRpdGlvbiB3aGVyZSB0aGUgYXR0cmlidXRlIGNvbnRhaW5zIHRoZSB2YWx1ZS4KCiAgICAgICAgOnBhcmFtIHZhbHVlOiBUaGUgdmFsdWUgdGhlIGF0dHJpYnV0ZSBjb250YWlucy4KICAgICAgICAiIiIKICAgICAgICByZXR1cm4gQ29udGFpbnMoc2VsZiwgdmFsdWUpCgogICAgZGVmIHNpemUoc2VsZik6CiAgICAgICAgIiIiQ3JlYXRlcyBhIGNvbmRpdGlvbiBmb3IgdGhlIGF0dHJpYnV0ZSBzaXplLgoKICAgICAgICBOb3RlIGFub3RoZXIgQXR0cmlidXRlQmFzZSBtZXRob2QgbXVzdCBiZSBjYWxsZWQgb24gdGhlIHJldHVybmVkCiAgICAgICAgc2l6ZSBjb25kaXRpb24gdG8gYmUgYSB2YWxpZCBEeW5hbW9EQiBjb25kaXRpb24uCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIFNpemUoc2VsZikKCiAgICBkZWYgYXR0cmlidXRlX3R5cGUoc2VsZiwgdmFsdWUpOgogICAgICAgICIiIkNyZWF0ZXMgYSBjb25kaXRpb24gZm9yIHRoZSBhdHRyaWJ1dGUgdHlwZS4KCiAgICAgICAgOnBhcmFtIHZhbHVlOiBUaGUgdHlwZSBvZiB0aGUgYXR0cmlidXRlLgogICAgICAgICIiIgogICAgICAgIHJldHVybiBBdHRyaWJ1dGVUeXBlKHNlbGYsIHZhbHVlKQoKCkJ1aWx0Q29uZGl0aW9uRXhwcmVzc2lvbiA9IG5hbWVkdHVwbGUoCiAgICAnQnVpbHRDb25kaXRpb25FeHByZXNzaW9uJywKICAgIFsnY29uZGl0aW9uX2V4cHJlc3Npb24nLCAnYXR0cmlidXRlX25hbWVfcGxhY2Vob2xkZXJzJywKICAgICAnYXR0cmlidXRlX3ZhbHVlX3BsYWNlaG9sZGVycyddCikKCgpjbGFzcyBDb25kaXRpb25FeHByZXNzaW9uQnVpbGRlcihvYmplY3QpOgogICAgIiIiVGhpcyBjbGFzcyBpcyB1c2VkIHRvIGJ1aWxkIGNvbmRpdGlvbiBleHByZXNzaW9ucyB3aXRoIHBsYWNlaG9sZGVycyIiIgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHNlbGYuX25hbWVfY291bnQgPSAwCiAgICAgICAgc2VsZi5fdmFsdWVfY291bnQgPSAwCiAgICAgICAgc2VsZi5fbmFtZV9wbGFjZWhvbGRlciA9ICduJwogICAgICAgIHNlbGYuX3ZhbHVlX3BsYWNlaG9sZGVyID0gJ3YnCgogICAgZGVmIF9nZXRfbmFtZV9wbGFjZWhvbGRlcihzZWxmKToKICAgICAgICByZXR1cm4gJyMnICsgc2VsZi5fbmFtZV9wbGFjZWhvbGRlciArIHN0cihzZWxmLl9uYW1lX2NvdW50KQoKICAgIGRlZiBfZ2V0X3ZhbHVlX3BsYWNlaG9sZGVyKHNlbGYpOgogICAgICAgIHJldHVybiAnOicgKyBzZWxmLl92YWx1ZV9wbGFjZWhvbGRlciArIHN0cihzZWxmLl92YWx1ZV9jb3VudCkKCiAgICBkZWYgcmVzZXQoc2VsZik6CiAgICAgICAgIiIiUmVzZXRzIHRoZSBwbGFjZWhvbGRlciBuYW1lIGFuZCB2YWx1ZXMiIiIKICAgICAgICBzZWxmLl9uYW1lX2NvdW50ID0gMAogICAgICAgIHNlbGYuX3ZhbHVlX2NvdW50ID0gMAoKICAgIGRlZiBidWlsZF9leHByZXNzaW9uKHNlbGYsIGNvbmRpdGlvbiwgaXNfa2V5X2NvbmRpdGlvbj1GYWxzZSk6CiAgICAgICAgIiIiQnVpbGRzIHRoZSBjb25kaXRpb24gZXhwcmVzc2lvbiBhbmQgdGhlIGRpY3Rpb25hcnkgb2YgcGxhY2Vob2xkZXJzLgoKICAgICAgICA6dHlwZSBjb25kaXRpb246IENvbmRpdGlvbkJhc2UKICAgICAgICA6cGFyYW0gY29uZGl0aW9uOiBBIGNvbmRpdGlvbiB0byBiZSBidWlsdCBpbnRvIGEgY29uZGl0aW9uIGV4cHJlc3Npb24KICAgICAgICAgICAgc3RyaW5nIHdpdGggYW55IG5lY2Vzc2FyeSBwbGFjZWhvbGRlcnMuCgogICAgICAgIDp0eXBlIGlzX2tleV9jb25kaXRpb246IEJvb2xlYW4KICAgICAgICA6cGFyYW0gaXNfa2V5X2NvbmRpdGlvbjogVHJ1ZSBpZiB0aGUgZXhwcmVzc2lvbiBpcyBmb3IgYQogICAgICAgICAgICBLZXlDb25kaXRpb25FeHByZXNzaW9uLiBGYWxzZSBvdGhlcndpc2UuCgogICAgICAgIDpydHlwZTogKHN0cmluZywgZGljdCwgZGljdCkKICAgICAgICA6cmV0dXJuczogV2lsbCByZXR1cm4gYSBzdHJpbmcgcmVwcmVzZW50aW5nIHRoZSBjb25kaXRpb24gd2l0aAogICAgICAgICAgICBwbGFjZWhvbGRlcnMgaW5zZXJ0ZWQgd2hlcmUgbmVjZXNzYXJ5LCBhIGRpY3Rpb25hcnkgb2YKICAgICAgICAgICAgcGxhY2Vob2xkZXJzIGZvciBhdHRyaWJ1dGUgbmFtZXMsIGFuZCBhIGRpY3Rpb25hcnkgb2YKICAgICAgICAgICAgcGxhY2Vob2xkZXJzIGZvciBhdHRyaWJ1dGUgdmFsdWVzLiBIZXJlIGlzIGEgc2FtcGxlIHJldHVybiB2YWx1ZToKCiAgICAgICAgICAgICgnI24wID0gOnYwJywgeycjbjAnOiAnbXlhdHRyaWJ1dGUnfSwgeyc6djEnOiAnbXl2YWx1ZSd9KQogICAgICAgICIiIgogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKGNvbmRpdGlvbiwgQ29uZGl0aW9uQmFzZSk6CiAgICAgICAgICAgIHJhaXNlIER5bmFtb0RCTmVlZHNDb25kaXRpb25FcnJvcihjb25kaXRpb24pCiAgICAgICAgYXR0cmlidXRlX25hbWVfcGxhY2Vob2xkZXJzID0ge30KICAgICAgICBhdHRyaWJ1dGVfdmFsdWVfcGxhY2Vob2xkZXJzID0ge30KICAgICAgICBjb25kaXRpb25fZXhwcmVzc2lvbiA9IHNlbGYuX2J1aWxkX2V4cHJlc3Npb24oCiAgICAgICAgICAgIGNvbmRpdGlvbiwgYXR0cmlidXRlX25hbWVfcGxhY2Vob2xkZXJzLAogICAgICAgICAgICBhdHRyaWJ1dGVfdmFsdWVfcGxhY2Vob2xkZXJzLCBpc19rZXlfY29uZGl0aW9uPWlzX2tleV9jb25kaXRpb24pCiAgICAgICAgcmV0dXJuIEJ1aWx0Q29uZGl0aW9uRXhwcmVzc2lvbigKICAgICAgICAgICAgY29uZGl0aW9uX2V4cHJlc3Npb249Y29uZGl0aW9uX2V4cHJlc3Npb24sCiAgICAgICAgICAgIGF0dHJpYnV0ZV9uYW1lX3BsYWNlaG9sZGVycz1hdHRyaWJ1dGVfbmFtZV9wbGFjZWhvbGRlcnMsCiAgICAgICAgICAgIGF0dHJpYnV0ZV92YWx1ZV9wbGFjZWhvbGRlcnM9YXR0cmlidXRlX3ZhbHVlX3BsYWNlaG9sZGVycwogICAgICAgICkKCiAgICBkZWYgX2J1aWxkX2V4cHJlc3Npb24oc2VsZiwgY29uZGl0aW9uLCBhdHRyaWJ1dGVfbmFtZV9wbGFjZWhvbGRlcnMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlX3ZhbHVlX3BsYWNlaG9sZGVycywgaXNfa2V5X2NvbmRpdGlvbik6CiAgICAgICAgZXhwcmVzc2lvbl9kaWN0ID0gY29uZGl0aW9uLmdldF9leHByZXNzaW9uKCkKICAgICAgICByZXBsYWNlZF92YWx1ZXMgPSBbXQogICAgICAgIGZvciB2YWx1ZSBpbiBleHByZXNzaW9uX2RpY3RbJ3ZhbHVlcyddOgogICAgICAgICAgICAjIEJ1aWxkIHRoZSBuZWNlc3NhcnkgcGxhY2Vob2xkZXJzIGZvciB0aGF0IHZhbHVlLgogICAgICAgICAgICAjIFBsYWNlaG9sZGVycyBhcmUgYnVpbHQgZm9yIGJvdGggYXR0cmlidXRlIG5hbWVzIGFuZCB2YWx1ZXMuCiAgICAgICAgICAgIHJlcGxhY2VkX3ZhbHVlID0gc2VsZi5fYnVpbGRfZXhwcmVzc2lvbl9jb21wb25lbnQoCiAgICAgICAgICAgICAgICB2YWx1ZSwgYXR0cmlidXRlX25hbWVfcGxhY2Vob2xkZXJzLAogICAgICAgICAgICAgICAgYXR0cmlidXRlX3ZhbHVlX3BsYWNlaG9sZGVycywgY29uZGl0aW9uLmhhc19ncm91cGVkX3ZhbHVlcywKICAgICAgICAgICAgICAgIGlzX2tleV9jb25kaXRpb24pCiAgICAgICAgICAgIHJlcGxhY2VkX3ZhbHVlcy5hcHBlbmQocmVwbGFjZWRfdmFsdWUpCiAgICAgICAgIyBGaWxsIG91dCB0aGUgZXhwcmVzc2lvbiB1c2luZyB0aGUgb3BlcmF0b3IgYW5kIHRoZQogICAgICAgICMgdmFsdWVzIHRoYXQgaGF2ZSBiZWVuIHJlcGxhY2VkIHdpdGggcGxhY2Vob2xkZXJzLgogICAgICAgIHJldHVybiBleHByZXNzaW9uX2RpY3RbJ2Zvcm1hdCddLmZvcm1hdCgKICAgICAgICAgICAgKnJlcGxhY2VkX3ZhbHVlcywgb3BlcmF0b3I9ZXhwcmVzc2lvbl9kaWN0WydvcGVyYXRvciddKQoKICAgIGRlZiBfYnVpbGRfZXhwcmVzc2lvbl9jb21wb25lbnQoc2VsZiwgdmFsdWUsIGF0dHJpYnV0ZV9uYW1lX3BsYWNlaG9sZGVycywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlX3ZhbHVlX3BsYWNlaG9sZGVycywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzX2dyb3VwZWRfdmFsdWVzLCBpc19rZXlfY29uZGl0aW9uKToKICAgICAgICAjIENvbnRpbnVlIHRvIHJlY3Vyc2UgaWYgdGhlIHZhbHVlIGlzIGEgQ29uZGl0aW9uQmFzZSBpbiBvcmRlcgogICAgICAgICMgdG8gZXh0cmFjdCBvdXQgYWxsIHBhcnRzIG9mIHRoZSBleHByZXNzaW9uLgogICAgICAgIGlmIGlzaW5zdGFuY2UodmFsdWUsIENvbmRpdGlvbkJhc2UpOgogICAgICAgICAgICByZXR1cm4gc2VsZi5fYnVpbGRfZXhwcmVzc2lvbigKICAgICAgICAgICAgICAgIHZhbHVlLCBhdHRyaWJ1dGVfbmFtZV9wbGFjZWhvbGRlcnMsCiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVfdmFsdWVfcGxhY2Vob2xkZXJzLCBpc19rZXlfY29uZGl0aW9uKQogICAgICAgICMgSWYgaXQgaXMgbm90IGEgQ29uZGl0aW9uQmFzZSwgd2UgY2FuIHJlY3Vyc2Ugbm8gZnVydGhlci4KICAgICAgICAjIFNvIHdlIGNoZWNrIGlmIGl0IGlzIGFuIGF0dHJpYnV0ZSBhbmQgYWRkIHBsYWNlaG9sZGVycyBmb3IKICAgICAgICAjIGl0cyBuYW1lCiAgICAgICAgZWxpZiBpc2luc3RhbmNlKHZhbHVlLCBBdHRyaWJ1dGVCYXNlKToKICAgICAgICAgICAgaWYgaXNfa2V5X2NvbmRpdGlvbiBhbmQgbm90IGlzaW5zdGFuY2UodmFsdWUsIEtleSk6CiAgICAgICAgICAgICAgICByYWlzZSBEeW5hbW9EQk5lZWRzS2V5Q29uZGl0aW9uRXJyb3IoCiAgICAgICAgICAgICAgICAgICAgJ0F0dHJpYnV0ZSBvYmplY3QgJXMgaXMgb2YgdHlwZSAlcy4gJwogICAgICAgICAgICAgICAgICAgICdLZXlDb25kaXRpb25FeHByZXNzaW9uIG9ubHkgc3VwcG9ydHMgQXR0cmlidXRlIG9iamVjdHMgJwogICAgICAgICAgICAgICAgICAgICdvZiB0eXBlIEtleScgJSAodmFsdWUubmFtZSwgdHlwZSh2YWx1ZSkpKQogICAgICAgICAgICByZXR1cm4gc2VsZi5fYnVpbGRfbmFtZV9wbGFjZWhvbGRlcigKICAgICAgICAgICAgICAgIHZhbHVlLCBhdHRyaWJ1dGVfbmFtZV9wbGFjZWhvbGRlcnMpCiAgICAgICAgIyBJZiBpdCBpcyBhbnl0aGluZyBlbHNlLCB3ZSB0cmVhdCBpdCBhcyBhIHZhbHVlIGFuZCB0aHVzIHBsYWNlaG9sZGVycwogICAgICAgICMgYXJlIG5lZWRlZCBmb3IgdGhlIHZhbHVlLgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9idWlsZF92YWx1ZV9wbGFjZWhvbGRlcigKICAgICAgICAgICAgICAgIHZhbHVlLCBhdHRyaWJ1dGVfdmFsdWVfcGxhY2Vob2xkZXJzLCBoYXNfZ3JvdXBlZF92YWx1ZXMpCgogICAgZGVmIF9idWlsZF9uYW1lX3BsYWNlaG9sZGVyKHNlbGYsIHZhbHVlLCBhdHRyaWJ1dGVfbmFtZV9wbGFjZWhvbGRlcnMpOgogICAgICAgIGF0dHJpYnV0ZV9uYW1lID0gdmFsdWUubmFtZQogICAgICAgICMgRmlndXJlIG91dCB3aGljaCBwYXJ0cyBvZiB0aGUgYXR0cmlidXRlIG5hbWUgdGhhdCBuZWVkcyByZXBsYWNlbWVudC4KICAgICAgICBhdHRyaWJ1dGVfbmFtZV9wYXJ0cyA9IEFUVFJfTkFNRV9SRUdFWC5maW5kYWxsKGF0dHJpYnV0ZV9uYW1lKQoKICAgICAgICAjIEFkZCBhIHRlbXBvcmFyeSBwbGFjZWhvbGRlciBmb3IgZWFjaCBvZiB0aGVzZSBwYXJ0cy4KICAgICAgICBwbGFjZWhvbGRlcl9mb3JtYXQgPSBBVFRSX05BTUVfUkVHRVguc3ViKCclcycsIGF0dHJpYnV0ZV9uYW1lKQogICAgICAgIHN0cl9mb3JtYXRfYXJncyA9IFtdCiAgICAgICAgZm9yIHBhcnQgaW4gYXR0cmlidXRlX25hbWVfcGFydHM6CiAgICAgICAgICAgIG5hbWVfcGxhY2Vob2xkZXIgPSBzZWxmLl9nZXRfbmFtZV9wbGFjZWhvbGRlcigpCiAgICAgICAgICAgIHNlbGYuX25hbWVfY291bnQgKz0gMQogICAgICAgICAgICBzdHJfZm9ybWF0X2FyZ3MuYXBwZW5kKG5hbWVfcGxhY2Vob2xkZXIpCiAgICAgICAgICAgICMgQWRkIHRoZSBwbGFjZWhvbGRlciBhbmQgdmFsdWUgdG8gZGljdGlvbmFyeSBvZiBuYW1lIHBsYWNlaG9sZGVycy4KICAgICAgICAgICAgYXR0cmlidXRlX25hbWVfcGxhY2Vob2xkZXJzW25hbWVfcGxhY2Vob2xkZXJdID0gcGFydAogICAgICAgICMgUmVwbGFjZSB0aGUgdGVtcG9yYXJ5IHBsYWNlaG9sZGVycyB3aXRoIHRoZSBkZXNpZ25hdGVkIHBsYWNlaG9sZGVycy4KICAgICAgICByZXR1cm4gcGxhY2Vob2xkZXJfZm9ybWF0ICUgdHVwbGUoc3RyX2Zvcm1hdF9hcmdzKQoKICAgIGRlZiBfYnVpbGRfdmFsdWVfcGxhY2Vob2xkZXIoc2VsZiwgdmFsdWUsIGF0dHJpYnV0ZV92YWx1ZV9wbGFjZWhvbGRlcnMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc19ncm91cGVkX3ZhbHVlcz1GYWxzZSk6CiAgICAgICAgIyBJZiB0aGUgdmFsdWVzIGFyZSBncm91cGVkLCB3ZSBuZWVkIHRvIGFkZCBhIHBsYWNlaG9sZGVyIGZvcgogICAgICAgICMgZWFjaCBlbGVtZW50IGluc2lkZSBvZiB0aGUgYWN0dWFsIHZhbHVlLgogICAgICAgIGlmIGhhc19ncm91cGVkX3ZhbHVlczoKICAgICAgICAgICAgcGxhY2Vob2xkZXJfbGlzdCA9IFtdCiAgICAgICAgICAgIGZvciB2IGluIHZhbHVlOgogICAgICAgICAgICAgICAgdmFsdWVfcGxhY2Vob2xkZXIgPSBzZWxmLl9nZXRfdmFsdWVfcGxhY2Vob2xkZXIoKQogICAgICAgICAgICAgICAgc2VsZi5fdmFsdWVfY291bnQgKz0gMQogICAgICAgICAgICAgICAgcGxhY2Vob2xkZXJfbGlzdC5hcHBlbmQodmFsdWVfcGxhY2Vob2xkZXIpCiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVfdmFsdWVfcGxhY2Vob2xkZXJzW3ZhbHVlX3BsYWNlaG9sZGVyXSA9IHYKICAgICAgICAgICAgIyBBc3N1bWluZyB0aGUgdmFsdWVzIGFyZSBncm91cGVkIGJ5IHBhcmVudGhlc2lzLgogICAgICAgICAgICAjIElOIGlzIHRoZSBjdXJyZW50bHkgdGhlIG9ubHkgb25lIHRoYXQgdXNlcyB0aGlzIHNvIGl0IG1heWJlCiAgICAgICAgICAgICMgbmVlZGVkIHRvIGJlIGNoYW5nZWQgaW4gZnV0dXJlLgogICAgICAgICAgICByZXR1cm4gJygnICsgJywgJy5qb2luKHBsYWNlaG9sZGVyX2xpc3QpICsgJyknCiAgICAgICAgIyBPdGhlcndpc2UsIHRyZWF0IHRoZSB2YWx1ZSBhcyBhIHNpbmdsZSB2YWx1ZSB0aGF0IG5lZWRzIG9ubHkKICAgICAgICAjIG9uZSBwbGFjZWhvbGRlci4KICAgICAgICBlbHNlOgogICAgICAgICAgICB2YWx1ZV9wbGFjZWhvbGRlciA9IHNlbGYuX2dldF92YWx1ZV9wbGFjZWhvbGRlcigpCiAgICAgICAgICAgIHNlbGYuX3ZhbHVlX2NvdW50ICs9IDEKICAgICAgICAgICAgYXR0cmlidXRlX3ZhbHVlX3BsYWNlaG9sZGVyc1t2YWx1ZV9wbGFjZWhvbGRlcl0gPSB2YWx1ZQogICAgICAgICAgICByZXR1cm4gdmFsdWVfcGxhY2Vob2xkZXIK
