statistics:
  total_files: 1
  skipped_files: 0.0
  processed_objects: 1
  malicious_objects: 0
details:
- path: .repo_cache/malicious_repos/pypi_malregistry/pycryptoenv/1.0.7/pycryptoenv-1.0.7/pycryptoenv-1.0.7/pycryptoenv/trust_list.py
  contents:
  - name: _ca_path
    score: 0.0
    code: |-
      def _ca_path(temp_dir=None):
          """
          Returns the file path to the CA certs file

          :param temp_dir:
              The temporary directory to cache the CA certs in on OS X and Windows.
              Needs to have secure permissions so other users can not modify the
              contents.

          :return:
              A 2-element tuple:
               - 0: A unicode string of the file path
               - 1: A bool if the file is a temporary file
          """

          ca_path = system_path()

          # Windows and OS X
          if ca_path is None:
              if temp_dir is None:
                  temp_dir = tempfile.gettempdir()

              if not os.path.isdir(temp_dir):
                  raise CACertsError(pretty_message(
                      '''
                      The temp dir specified, "%s", is not a directory
                      ''',
                      temp_dir
                  ))

              ca_path = os.path.join(temp_dir, 'oscrypto-ca-bundle.crt')
              return (ca_path, True)

          return (ca_path, False)
    tokens: resume load_global system_path call store_fast ca_path load_fast ca_path pop_jump_if_not_none TO_NUMBER load_fast temp_dir pop_jump_if_not_none TO_NUMBER load_global tempfile load_attr gettempdir call store_fast temp_dir load_global os load_attr path load_attr isdir load_fast temp_dir call pop_jump_if_true TO_NUMBER load_global CACertsError load_global pretty_message load_const STRING_LEN_S_ENT_HIGH load_fast temp_dir call call raise_varargs load_global os load_attr path load_attr join load_fast temp_dir load_const STRING_LEN_S_ENT_HIGH call store_fast ca_path load_fast ca_path load_const INTEGER build_tuple return_value load_fast ca_path load_const INTEGER build_tuple return_value
    hash: 683ceccfd5cbe2441ae25619d40b68bee571dc75622fdc60e7c9435fb182390f
sources:
  ? .repo_cache/malicious_repos/pypi_malregistry/pycryptoenv/1.0.7/pycryptoenv-1.0.7/pycryptoenv-1.0.7/pycryptoenv/trust_list.py
  : IyBjb2Rpbmc6IHV0Zi04CmZyb20gX19mdXR1cmVfXyBpbXBvcnQgdW5pY29kZV9saXRlcmFscywgZGl2aXNpb24sIGFic29sdXRlX2ltcG9ydCwgcHJpbnRfZnVuY3Rpb24KCmltcG9ydCBvcwppbXBvcnQgdGltZQppbXBvcnQgc3lzCmltcG9ydCB0ZW1wZmlsZQppbXBvcnQgdGhyZWFkaW5nCgpmcm9tIC5fYXNuMSBpbXBvcnQgYXJtb3IsIENlcnRpZmljYXRlCmZyb20gLl9lcnJvcnMgaW1wb3J0IHByZXR0eV9tZXNzYWdlCmZyb20gLmVycm9ycyBpbXBvcnQgQ0FDZXJ0c0Vycm9yCgppZiBzeXMucGxhdGZvcm0gPT0gJ3dpbjMyJzoKICAgIGZyb20gLl93aW4udHJ1c3RfbGlzdCBpbXBvcnQgZXh0cmFjdF9mcm9tX3N5c3RlbSwgc3lzdGVtX3BhdGgKZWxpZiBzeXMucGxhdGZvcm0gPT0gJ2Rhcndpbic6CiAgICBmcm9tIC5fbWFjLnRydXN0X2xpc3QgaW1wb3J0IGV4dHJhY3RfZnJvbV9zeXN0ZW0sIHN5c3RlbV9wYXRoCmVsc2U6CiAgICBmcm9tIC5fbGludXhfYnNkLnRydXN0X2xpc3QgaW1wb3J0IGV4dHJhY3RfZnJvbV9zeXN0ZW0sIHN5c3RlbV9wYXRoCgoKX19hbGxfXyA9IFsKICAgICdjbGVhcl9jYWNoZScsCiAgICAnZ2V0X2xpc3QnLAogICAgJ2dldF9wYXRoJywKXQoKCnBhdGhfbG9jayA9IHRocmVhZGluZy5Mb2NrKCkKbWVtb3J5X2xvY2sgPSB0aHJlYWRpbmcuTG9jaygpCl9tb2R1bGVfdmFsdWVzID0gewogICAgJ2xhc3RfdXBkYXRlJzogTm9uZSwKICAgICdjZXJ0cyc6IE5vbmUKfQoKX29pZF9tYXAgPSB7CiAgICAjIGFwcGxlX3NtaW1lIC0+IGVtYWlsX3Byb3RlY3Rpb24KICAgICcxLjIuODQwLjExMzYzNS4xMDAuMS44Jzogc2V0KFsnMS4zLjYuMS41LjUuNy4zLjQnXSksCiAgICAjIGFwcGxlX2NvZGVfc2lnbmluZyAtPiBjb2RlX3NpZ25pbmcKICAgICcxLjIuODQwLjExMzYzNS4xMDAuMS4xNic6IHNldChbJzEuMy42LjEuNS41LjcuMy4zJ10pLAogICAgIyBhcHBsZV90aW1lX3N0YW1waW5nIC0+IHRpbWVfc3RhbXBpbmcKICAgICcxLjIuODQwLjExMzYzNS4xMDAuMS4yMCc6IHNldChbJzEuMy42LjEuNS41LjcuMy44J10pLAogICAgIyBtaWNyb3NvZnRfdGltZV9zdGFtcF9zaWduaW5nIC0+IHRpbWVfc3RhbXBpbmcKICAgICcxLjMuNi4xLjQuMS4zMTEuMTAuMy4yJzogc2V0KFsnMS4zLjYuMS41LjUuNy4zLjgnXSksCiAgICAjIGFwcGxlX3NzbCAtPiAoc2VydmVyX2F1dGgsIGNsaWVudF9hdXRoKQogICAgJzEuMi44NDAuMTEzNjM1LjEwMC4xLjMnOiBzZXQoWwogICAgICAgICcxLjMuNi4xLjUuNS43LjMuMScsCiAgICAgICAgJzEuMy42LjEuNS41LjcuMy4yJywKICAgIF0pLAogICAgIyBhcHBsZV9lYXAgLT4gKGVhcF9vdmVyX3BwcCwgZWFwX292ZXJfbGFuKQogICAgJzEuMi44NDAuMTEzNjM1LjEwMC4xLjknOiBzZXQoWwogICAgICAgICcxLjMuNi4xLjUuNS43LjMuMTMnLAogICAgICAgICcxLjMuNi4xLjUuNS43LjMuMTQnLAogICAgXSksCiAgICAjIGFwcGxlX2lwc2VjIC0+IChpcHNlY19lbmRfc3lzdGVtLCBpcHNlY190dW5uZWwsIGlwc2VjX3VzZXIsIGlwc2VjX2lrZSkKICAgICcxLjIuODQwLjExMzYzNS4xMDAuMS4xMSc6IHNldChbCiAgICAgICAgJzEuMy42LjEuNS41LjcuMy41JywKICAgICAgICAnMS4zLjYuMS41LjUuNy4zLjYnLAogICAgICAgICcxLjMuNi4xLjUuNS43LjMuNycsCiAgICAgICAgJzEuMy42LjEuNS41LjcuMy4xNycsCiAgICBdKQp9CgoKZGVmIGdldF9wYXRoKHRlbXBfZGlyPU5vbmUsIGNhY2hlX2xlbmd0aD0yNCwgY2VydF9jYWxsYmFjaz1Ob25lKToKICAgICIiIgogICAgR2V0IHRoZSBmaWxlc3lzdGVtIHBhdGggdG8gYSBmaWxlIHRoYXQgY29udGFpbnMgT3BlblNTTC1jb21wYXRpYmxlIENBIGNlcnRzLgoKICAgIE9uIE9TIFggYW5kIFdpbmRvd3MsIHRoZXJlIGFyZSBleHRyYWN0ZWQgZnJvbSB0aGUgc3lzdGVtIGNlcnRpZmljYXRlIHN0b3JlCiAgICBhbmQgY2FjaGVkIGluIGEgZmlsZSBvbiB0aGUgZmlsZXN5c3RlbS4gVGhpcyBwYXRoIHNob3VsZCBub3QgYmUgd3JpdGFibGUKICAgIGJ5IG90aGVyIHVzZXJzLCBvdGhlcndpc2UgdGhleSBjb3VsZCBpbmplY3QgQ0EgY2VydHMgaW50byB0aGUgdHJ1c3QgbGlzdC4KCiAgICA6cGFyYW0gdGVtcF9kaXI6CiAgICAgICAgVGhlIHRlbXBvcmFyeSBkaXJlY3RvcnkgdG8gY2FjaGUgdGhlIENBIGNlcnRzIGluIG9uIE9TIFggYW5kIFdpbmRvd3MuCiAgICAgICAgTmVlZHMgdG8gaGF2ZSBzZWN1cmUgcGVybWlzc2lvbnMgc28gb3RoZXIgdXNlcnMgY2FuIG5vdCBtb2RpZnkgdGhlCiAgICAgICAgY29udGVudHMuCgogICAgOnBhcmFtIGNhY2hlX2xlbmd0aDoKICAgICAgICBUaGUgbnVtYmVyIG9mIGhvdXJzIHRvIGNhY2hlIHRoZSBDQSBjZXJ0cyBvbiBPUyBYIGFuZCBXaW5kb3dzCgogICAgOnBhcmFtIGNlcnRfY2FsbGJhY2s6CiAgICAgICAgQSBjYWxsYmFjayB0aGF0IGlzIGNhbGxlZCBvbmNlIGZvciBlYWNoIGNlcnRpZmljYXRlIGluIHRoZSB0cnVzdCBzdG9yZS4KICAgICAgICBJdCBzaG91bGQgYWNjZXB0IHR3byBwYXJhbWV0ZXJzOiBhbiBhc24xY3J5cHRvLng1MDkuQ2VydGlmaWNhdGUgb2JqZWN0LAogICAgICAgIGFuZCBhIHJlYXNvbi4gVGhlIHJlYXNvbiB3aWxsIGJlIE5vbmUgaWYgdGhlIGNlcnRpZmljYXRlIGlzIGJlaW5nCiAgICAgICAgZXhwb3J0ZWQsIG90aGVyd2lzZSBpdCB3aWxsIGJlIGEgdW5pY29kZSBzdHJpbmcgb2YgdGhlIHJlYXNvbiBpdCB3b24ndC4KICAgICAgICBUaGlzIGlzIG9ubHkgY2FsbGVkIG9uIFdpbmRvd3MgYW5kIE9TIFggd2hlbiBwYXNzZWQgdG8gdGhpcyBmdW5jdGlvbi4KCiAgICA6cmFpc2VzOgogICAgICAgIG9zY3J5cHRvLmVycm9ycy5DQUNlcnRzRXJyb3IgLSB3aGVuIGFuIGVycm9yIG9jY3VycyBleHBvcnRpbmcvbG9jYXRpbmcgY2VydHMKCiAgICA6cmV0dXJuOgogICAgICAgIFRoZSBmdWxsIGZpbGVzeXN0ZW0gcGF0aCB0byBhIENBIGNlcnRzIGZpbGUKICAgICIiIgoKICAgIGNhX3BhdGgsIHRlbXAgPSBfY2FfcGF0aCh0ZW1wX2RpcikKCiAgICAjIFdpbmRvd3MgYW5kIE9TIFgKICAgIGlmIHRlbXAgYW5kIF9jYWNoZWRfcGF0aF9uZWVkc191cGRhdGUoY2FfcGF0aCwgY2FjaGVfbGVuZ3RoKToKICAgICAgICBlbXB0eV9zZXQgPSBzZXQoKQoKICAgICAgICBhbnlfcHVycG9zZSA9ICcyLjUuMjkuMzcuMCcKICAgICAgICBhcHBsZV9zc2wgPSAnMS4yLjg0MC4xMTM2MzUuMTAwLjEuMycKICAgICAgICB3aW5fc2VydmVyX2F1dGggPSAnMS4zLjYuMS41LjUuNy4zLjEnCgogICAgICAgIHdpdGggcGF0aF9sb2NrOgogICAgICAgICAgICBpZiBfY2FjaGVkX3BhdGhfbmVlZHNfdXBkYXRlKGNhX3BhdGgsIGNhY2hlX2xlbmd0aCk6CiAgICAgICAgICAgICAgICB3aXRoIG9wZW4oY2FfcGF0aCwgJ3diJykgYXMgZjoKICAgICAgICAgICAgICAgICAgICBmb3IgY2VydCwgdHJ1c3Rfb2lkcywgcmVqZWN0X29pZHMgaW4gZXh0cmFjdF9mcm9tX3N5c3RlbShjZXJ0X2NhbGxiYWNrLCBUcnVlKToKICAgICAgICAgICAgICAgICAgICAgICAgaWYgc3lzLnBsYXRmb3JtID09ICdkYXJ3aW4nOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdHJ1c3Rfb2lkcyAhPSBlbXB0eV9zZXQgYW5kIGFueV9wdXJwb3NlIG5vdCBpbiB0cnVzdF9vaWRzIFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5kIGFwcGxlX3NzbCBub3QgaW4gdHJ1c3Rfb2lkczoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBjZXJ0X2NhbGxiYWNrOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZXJ0X2NhbGxiYWNrKENlcnRpZmljYXRlLmxvYWQoY2VydCksICdpbXBsaWNpdGx5IGRpc3RydXN0ZWQgZm9yIFRMUycpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHJlamVjdF9vaWRzICE9IGVtcHR5X3NldCBhbmQgKGFwcGxlX3NzbCBpbiByZWplY3Rfb2lkcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3IgYW55X3B1cnBvc2UgaW4gcmVqZWN0X29pZHMpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGNlcnRfY2FsbGJhY2s6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNlcnRfY2FsbGJhY2soQ2VydGlmaWNhdGUubG9hZChjZXJ0KSwgJ2V4cGxpY2l0bHkgZGlzdHJ1c3RlZCBmb3IgVExTJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgICAgICAgICBlbGlmIHN5cy5wbGF0Zm9ybSA9PSAnd2luMzInOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdHJ1c3Rfb2lkcyAhPSBlbXB0eV9zZXQgYW5kIGFueV9wdXJwb3NlIG5vdCBpbiB0cnVzdF9vaWRzIFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5kIHdpbl9zZXJ2ZXJfYXV0aCBub3QgaW4gdHJ1c3Rfb2lkczoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBjZXJ0X2NhbGxiYWNrOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZXJ0X2NhbGxiYWNrKENlcnRpZmljYXRlLmxvYWQoY2VydCksICdpbXBsaWNpdGx5IGRpc3RydXN0ZWQgZm9yIFRMUycpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHJlamVjdF9vaWRzICE9IGVtcHR5X3NldCBhbmQgKHdpbl9zZXJ2ZXJfYXV0aCBpbiByZWplY3Rfb2lkcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3IgYW55X3B1cnBvc2UgaW4gcmVqZWN0X29pZHMpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGNlcnRfY2FsbGJhY2s6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNlcnRfY2FsbGJhY2soQ2VydGlmaWNhdGUubG9hZChjZXJ0KSwgJ2V4cGxpY2l0bHkgZGlzdHJ1c3RlZCBmb3IgVExTJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgICAgICAgICBpZiBjZXJ0X2NhbGxiYWNrOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2VydF9jYWxsYmFjayhDZXJ0aWZpY2F0ZS5sb2FkKGNlcnQpLCBOb25lKQogICAgICAgICAgICAgICAgICAgICAgICBmLndyaXRlKGFybW9yKCdDRVJUSUZJQ0FURScsIGNlcnQpKQoKICAgIGlmIG5vdCBjYV9wYXRoOgogICAgICAgIHJhaXNlIENBQ2VydHNFcnJvcignTm8gQ0EgY2VydHMgZm91bmQnKQoKICAgIHJldHVybiBjYV9wYXRoCgoKZGVmIGdldF9saXN0KGNhY2hlX2xlbmd0aD0yNCwgbWFwX3ZlbmRvcl9vaWRzPVRydWUsIGNlcnRfY2FsbGJhY2s9Tm9uZSk6CiAgICAiIiIKICAgIFJldHJpZXZlcyAoYW5kIGNhY2hlcyBpbiBtZW1vcnkpIHRoZSBsaXN0IG9mIENBIGNlcnRzIGZyb20gdGhlIE9TLiBJbmNsdWRlcwogICAgdHJ1c3QgaW5mb3JtYXRpb24gZnJvbSB0aGUgT1MgLSBwdXJwb3NlcyB0aGUgY2VydGlmaWNhdGUgc2hvdWxkIGJlIHRydXN0ZWQKICAgIG9yIHJlamVjdGVkIGZvci4KCiAgICBUcnVzdCBpbmZvcm1hdGlvbiBpcyBlbmNvZGVkIHZpYSBvYmplY3QgaWRlbnRpZmllcnMgKE9JRHMpIHRoYXQgYXJlIHNvdXJjZWQKICAgIGZyb20gdmFyaW91cyBSRkNzIGFuZCB2ZW5kb3JzIChBcHBsZSBhbmQgTWljcm9zb2Z0KS4gVGhpcyB0cnVzdCBpbmZvcm1hdGlvbgogICAgYXVnbWVudHMgd2hhdCBpcyBpbiB0aGUgY2VydGlmaWNhdGUgaXRzZWxmLiBBbnkgT0lEIHRoYXQgaXMgaW4gdGhlIHNldCBvZgogICAgdHJ1c3RlZCBwdXJwb3NlcyBpbmRpY2F0ZXMgdGhlIGNlcnRpZmljYXRlIGhhcyBiZWVuIGV4cGxpY2l0bHkgdHJ1c3RlZCBmb3IKICAgIGEgcHVycG9zZSBiZXlvbmQgdGhlIGV4dGVuZGVkIGtleSBwdXJwb3NlIGV4dGVuc2lvbi4gQW55IE9JRCBpbiB0aGUgcmVqZWN0CiAgICBzZXQgaXMgYSBwdXJwb3NlIHRoYXQgdGhlIGNlcnRpZmljYXRlIHNob3VsZCBub3QgYmUgdHJ1c3RlZCBmb3IsIGV2ZW4gaWYKICAgIHByZXNlbnQgaW4gdGhlIGV4dGVuZGVkIGtleSBwdXJwb3NlIGV4dGVuc2lvbi4KCiAgICAqQSBsaXN0IG9mIGNvbW1vbiB0cnVzdCBPSURzIGNhbiBiZSBmb3VuZCBhcyBwYXJ0IG9mIHRoZSBgS2V5UHVycG9zZUlkKClgCiAgICBjbGFzcyBpbiB0aGUgYGFzbjFjcnlwdG8ueDUwOWAgbW9kdWxlIG9mIHRoZSBgYXNuMWNyeXB0b2AgcGFja2FnZS4qCgogICAgOnBhcmFtIGNhY2hlX2xlbmd0aDoKICAgICAgICBUaGUgbnVtYmVyIG9mIGhvdXJzIHRvIGNhY2hlIHRoZSBDQSBjZXJ0cyBpbiBtZW1vcnkgYmVmb3JlIHRoZXkgYXJlCiAgICAgICAgcmVmcmVzaGVkCgogICAgOnBhcmFtIG1hcF92ZW5kb3Jfb2lkczoKICAgICAgICBBIGJvb2wgaW5kaWNhdGluZyBpZiB0aGUgZm9sbG93aW5nIG1hcHBpbmcgb2YgT0lEcyBzaG91bGQgaGFwcGVuIGZvcgogICAgICAgIHRydXN0IGluZm9ybWF0aW9uIGZyb20gdGhlIE9TIHRydXN0IGxpc3Q6CiAgICAgICAgIC0gMS4yLjg0MC4xMTM2MzUuMTAwLjEuMyAoYXBwbGVfc3NsKSAtPiAxLjMuNi4xLjUuNS43LjMuMSAoc2VydmVyX2F1dGgpCiAgICAgICAgIC0gMS4yLjg0MC4xMTM2MzUuMTAwLjEuMyAoYXBwbGVfc3NsKSAtPiAxLjMuNi4xLjUuNS43LjMuMiAoY2xpZW50X2F1dGgpCiAgICAgICAgIC0gMS4yLjg0MC4xMTM2MzUuMTAwLjEuOCAoYXBwbGVfc21pbWUpIC0+IDEuMy42LjEuNS41LjcuMy40IChlbWFpbF9wcm90ZWN0aW9uKQogICAgICAgICAtIDEuMi44NDAuMTEzNjM1LjEwMC4xLjkgKGFwcGxlX2VhcCkgLT4gMS4zLjYuMS41LjUuNy4zLjEzIChlYXBfb3Zlcl9wcHApCiAgICAgICAgIC0gMS4yLjg0MC4xMTM2MzUuMTAwLjEuOSAoYXBwbGVfZWFwKSAtPiAxLjMuNi4xLjUuNS43LjMuMTQgKGVhcF9vdmVyX2xhbikKICAgICAgICAgLSAxLjIuODQwLjExMzYzNS4xMDAuMS4xMSAoYXBwbGVfaXBzZWMpIC0+IDEuMy42LjEuNS41LjcuMy41IChpcHNlY19lbmRfc3lzdGVtKQogICAgICAgICAtIDEuMi44NDAuMTEzNjM1LjEwMC4xLjExIChhcHBsZV9pcHNlYykgLT4gMS4zLjYuMS41LjUuNy4zLjYgKGlwc2VjX3R1bm5lbCkKICAgICAgICAgLSAxLjIuODQwLjExMzYzNS4xMDAuMS4xMSAoYXBwbGVfaXBzZWMpIC0+IDEuMy42LjEuNS41LjcuMy43IChpcHNlY191c2VyKQogICAgICAgICAtIDEuMi44NDAuMTEzNjM1LjEwMC4xLjExIChhcHBsZV9pcHNlYykgLT4gMS4zLjYuMS41LjUuNy4zLjE3IChpcHNlY19pa2UpCiAgICAgICAgIC0gMS4yLjg0MC4xMTM2MzUuMTAwLjEuMTYgKGFwcGxlX2NvZGVfc2lnbmluZykgLT4gMS4zLjYuMS41LjUuNy4zLjMgKGNvZGVfc2lnbmluZykKICAgICAgICAgLSAxLjIuODQwLjExMzYzNS4xMDAuMS4yMCAoYXBwbGVfdGltZV9zdGFtcGluZykgLT4gMS4zLjYuMS41LjUuNy4zLjggKHRpbWVfc3RhbXBpbmcpCiAgICAgICAgIC0gMS4zLjYuMS40LjEuMzExLjEwLjMuMiAobWljcm9zb2Z0X3RpbWVfc3RhbXBfc2lnbmluZykgLT4gMS4zLjYuMS41LjUuNy4zLjggKHRpbWVfc3RhbXBpbmcpCgogICAgOnBhcmFtIGNlcnRfY2FsbGJhY2s6CiAgICAgICAgQSBjYWxsYmFjayB0aGF0IGlzIGNhbGxlZCBvbmNlIGZvciBlYWNoIGNlcnRpZmljYXRlIGluIHRoZSB0cnVzdCBzdG9yZS4KICAgICAgICBJdCBzaG91bGQgYWNjZXB0IHR3byBwYXJhbWV0ZXJzOiBhbiBhc24xY3J5cHRvLng1MDkuQ2VydGlmaWNhdGUgb2JqZWN0LAogICAgICAgIGFuZCBhIHJlYXNvbi4gVGhlIHJlYXNvbiB3aWxsIGJlIE5vbmUgaWYgdGhlIGNlcnRpZmljYXRlIGlzIGJlaW5nCiAgICAgICAgZXhwb3J0ZWQsIG90aGVyd2lzZSBpdCB3aWxsIGJlIGEgdW5pY29kZSBzdHJpbmcgb2YgdGhlIHJlYXNvbiBpdCB3b24ndC4KCiAgICA6cmFpc2VzOgogICAgICAgIG9zY3J5cHRvLmVycm9ycy5DQUNlcnRzRXJyb3IgLSB3aGVuIGFuIGVycm9yIG9jY3VycyBleHBvcnRpbmcvbG9jYXRpbmcgY2VydHMKCiAgICA6cmV0dXJuOgogICAgICAgIEEgKGNvcGllZCkgbGlzdCBvZiAzLWVsZW1lbnQgdHVwbGVzIGNvbnRhaW5pbmcgQ0EgY2VydHMgZnJvbSB0aGUgT1MKICAgICAgICB0cnVzdCBpbHN0OgogICAgICAgICAtIDA6IGFuIGFzbjFjcnlwdG8ueDUwOS5DZXJ0aWZpY2F0ZSBvYmplY3QKICAgICAgICAgLSAxOiBhIHNldCBvZiB1bmljb2RlIHN0cmluZ3Mgb2YgT0lEcyBvZiB0cnVzdGVkIHB1cnBvc2VzCiAgICAgICAgIC0gMjogYSBzZXQgb2YgdW5pY29kZSBzdHJpbmdzIG9mIE9JRHMgb2YgcmVqZWN0ZWQgcHVycG9zZXMKICAgICIiIgoKICAgIGlmIG5vdCBfaW5fbWVtb3J5X3VwX3RvX2RhdGUoY2FjaGVfbGVuZ3RoKToKICAgICAgICB3aXRoIG1lbW9yeV9sb2NrOgogICAgICAgICAgICBpZiBub3QgX2luX21lbW9yeV91cF90b19kYXRlKGNhY2hlX2xlbmd0aCk6CiAgICAgICAgICAgICAgICBjZXJ0cyA9IFtdCiAgICAgICAgICAgICAgICBmb3IgY2VydF9ieXRlcywgdHJ1c3Rfb2lkcywgcmVqZWN0X29pZHMgaW4gZXh0cmFjdF9mcm9tX3N5c3RlbShjZXJ0X2NhbGxiYWNrKToKICAgICAgICAgICAgICAgICAgICBpZiBtYXBfdmVuZG9yX29pZHM6CiAgICAgICAgICAgICAgICAgICAgICAgIHRydXN0X29pZHMgPSBfbWFwX29pZHModHJ1c3Rfb2lkcykKICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0X29pZHMgPSBfbWFwX29pZHMocmVqZWN0X29pZHMpCiAgICAgICAgICAgICAgICAgICAgY2VydHMuYXBwZW5kKChDZXJ0aWZpY2F0ZS5sb2FkKGNlcnRfYnl0ZXMpLCB0cnVzdF9vaWRzLCByZWplY3Rfb2lkcykpCiAgICAgICAgICAgICAgICBfbW9kdWxlX3ZhbHVlc1snY2VydHMnXSA9IGNlcnRzCiAgICAgICAgICAgICAgICBfbW9kdWxlX3ZhbHVlc1snbGFzdF91cGRhdGUnXSA9IHRpbWUudGltZSgpCgogICAgcmV0dXJuIGxpc3QoX21vZHVsZV92YWx1ZXNbJ2NlcnRzJ10pCgoKZGVmIGNsZWFyX2NhY2hlKHRlbXBfZGlyPU5vbmUpOgogICAgIiIiCiAgICBDbGVhcnMgYW55IGNhY2hlZCBpbmZvIHRoYXQgd2FzIGV4cG9ydGVkIGZyb20gdGhlIE9TIHRydXN0IHN0b3JlLiBUaGlzIHdpbGwKICAgIGVuc3VyZSB0aGUgbGF0ZXN0IGNoYW5nZXMgYXJlIHJldHVybmVkIGZyb20gY2FsbHMgdG8gZ2V0X2xpc3QoKSBhbmQKICAgIGdldF9wYXRoKCksIGJ1dCBhdCB0aGUgZXhwZW5zZSBvZiByZS1leHBvcnRpbmcgYW5kIHBhcnNpbmcgYWxsIGNlcnRpZmljYXRlcy4KCiAgICA6cGFyYW0gdGVtcF9kaXI6CiAgICAgICAgVGhlIHRlbXBvcmFyeSBkaXJlY3RvcnkgdG8gY2FjaGUgdGhlIENBIGNlcnRzIGluIG9uIE9TIFggYW5kIFdpbmRvd3MuCiAgICAgICAgTmVlZHMgdG8gaGF2ZSBzZWN1cmUgcGVybWlzc2lvbnMgc28gb3RoZXIgdXNlcnMgY2FuIG5vdCBtb2RpZnkgdGhlCiAgICAgICAgY29udGVudHMuIE11c3QgYmUgdGhlIHNhbWUgdmFsdWUgcGFzc2VkIHRvIGdldF9wYXRoKCkuCiAgICAiIiIKCiAgICB3aXRoIG1lbW9yeV9sb2NrOgogICAgICAgIF9tb2R1bGVfdmFsdWVzWydsYXN0X3VwZGF0ZSddID0gTm9uZQogICAgICAgIF9tb2R1bGVfdmFsdWVzWydjZXJ0cyddID0gTm9uZQoKICAgIGNhX3BhdGgsIHRlbXAgPSBfY2FfcGF0aCh0ZW1wX2RpcikKICAgIGlmIHRlbXA6CiAgICAgICAgd2l0aCBwYXRoX2xvY2s6CiAgICAgICAgICAgIGlmIG9zLnBhdGguZXhpc3RzKGNhX3BhdGgpOgogICAgICAgICAgICAgICAgb3MucmVtb3ZlKGNhX3BhdGgpCgoKZGVmIF9jYV9wYXRoKHRlbXBfZGlyPU5vbmUpOgogICAgIiIiCiAgICBSZXR1cm5zIHRoZSBmaWxlIHBhdGggdG8gdGhlIENBIGNlcnRzIGZpbGUKCiAgICA6cGFyYW0gdGVtcF9kaXI6CiAgICAgICAgVGhlIHRlbXBvcmFyeSBkaXJlY3RvcnkgdG8gY2FjaGUgdGhlIENBIGNlcnRzIGluIG9uIE9TIFggYW5kIFdpbmRvd3MuCiAgICAgICAgTmVlZHMgdG8gaGF2ZSBzZWN1cmUgcGVybWlzc2lvbnMgc28gb3RoZXIgdXNlcnMgY2FuIG5vdCBtb2RpZnkgdGhlCiAgICAgICAgY29udGVudHMuCgogICAgOnJldHVybjoKICAgICAgICBBIDItZWxlbWVudCB0dXBsZToKICAgICAgICAgLSAwOiBBIHVuaWNvZGUgc3RyaW5nIG9mIHRoZSBmaWxlIHBhdGgKICAgICAgICAgLSAxOiBBIGJvb2wgaWYgdGhlIGZpbGUgaXMgYSB0ZW1wb3JhcnkgZmlsZQogICAgIiIiCgogICAgY2FfcGF0aCA9IHN5c3RlbV9wYXRoKCkKCiAgICAjIFdpbmRvd3MgYW5kIE9TIFgKICAgIGlmIGNhX3BhdGggaXMgTm9uZToKICAgICAgICBpZiB0ZW1wX2RpciBpcyBOb25lOgogICAgICAgICAgICB0ZW1wX2RpciA9IHRlbXBmaWxlLmdldHRlbXBkaXIoKQoKICAgICAgICBpZiBub3Qgb3MucGF0aC5pc2Rpcih0ZW1wX2Rpcik6CiAgICAgICAgICAgIHJhaXNlIENBQ2VydHNFcnJvcihwcmV0dHlfbWVzc2FnZSgKICAgICAgICAgICAgICAgICcnJwogICAgICAgICAgICAgICAgVGhlIHRlbXAgZGlyIHNwZWNpZmllZCwgIiVzIiwgaXMgbm90IGEgZGlyZWN0b3J5CiAgICAgICAgICAgICAgICAnJycsCiAgICAgICAgICAgICAgICB0ZW1wX2RpcgogICAgICAgICAgICApKQoKICAgICAgICBjYV9wYXRoID0gb3MucGF0aC5qb2luKHRlbXBfZGlyLCAnb3NjcnlwdG8tY2EtYnVuZGxlLmNydCcpCiAgICAgICAgcmV0dXJuIChjYV9wYXRoLCBUcnVlKQoKICAgIHJldHVybiAoY2FfcGF0aCwgRmFsc2UpCgoKZGVmIF9tYXBfb2lkcyhvaWRzKToKICAgICIiIgogICAgVGFrZXMgYSBzZXQgb2YgdW5pY29kZSBzdHJpbmcgT0lEcyBhbmQgY29udmVydHMgdmVuZG9yLXNwZWNpZmljIE9JRHMgaW50bwogICAgZ2VuZXJpY3MgT0lEcyBmcm9tIFJGQ3MuCgogICAgIC0gMS4yLjg0MC4xMTM2MzUuMTAwLjEuMyAoYXBwbGVfc3NsKSAtPiAxLjMuNi4xLjUuNS43LjMuMSAoc2VydmVyX2F1dGgpCiAgICAgLSAxLjIuODQwLjExMzYzNS4xMDAuMS4zIChhcHBsZV9zc2wpIC0+IDEuMy42LjEuNS41LjcuMy4yIChjbGllbnRfYXV0aCkKICAgICAtIDEuMi44NDAuMTEzNjM1LjEwMC4xLjggKGFwcGxlX3NtaW1lKSAtPiAxLjMuNi4xLjUuNS43LjMuNCAoZW1haWxfcHJvdGVjdGlvbikKICAgICAtIDEuMi44NDAuMTEzNjM1LjEwMC4xLjkgKGFwcGxlX2VhcCkgLT4gMS4zLjYuMS41LjUuNy4zLjEzIChlYXBfb3Zlcl9wcHApCiAgICAgLSAxLjIuODQwLjExMzYzNS4xMDAuMS45IChhcHBsZV9lYXApIC0+IDEuMy42LjEuNS41LjcuMy4xNCAoZWFwX292ZXJfbGFuKQogICAgIC0gMS4yLjg0MC4xMTM2MzUuMTAwLjEuMTEgKGFwcGxlX2lwc2VjKSAtPiAxLjMuNi4xLjUuNS43LjMuNSAoaXBzZWNfZW5kX3N5c3RlbSkKICAgICAtIDEuMi44NDAuMTEzNjM1LjEwMC4xLjExIChhcHBsZV9pcHNlYykgLT4gMS4zLjYuMS41LjUuNy4zLjYgKGlwc2VjX3R1bm5lbCkKICAgICAtIDEuMi44NDAuMTEzNjM1LjEwMC4xLjExIChhcHBsZV9pcHNlYykgLT4gMS4zLjYuMS41LjUuNy4zLjcgKGlwc2VjX3VzZXIpCiAgICAgLSAxLjIuODQwLjExMzYzNS4xMDAuMS4xMSAoYXBwbGVfaXBzZWMpIC0+IDEuMy42LjEuNS41LjcuMy4xNyAoaXBzZWNfaWtlKQogICAgIC0gMS4yLjg0MC4xMTM2MzUuMTAwLjEuMTYgKGFwcGxlX2NvZGVfc2lnbmluZykgLT4gMS4zLjYuMS41LjUuNy4zLjMgKGNvZGVfc2lnbmluZykKICAgICAtIDEuMi44NDAuMTEzNjM1LjEwMC4xLjIwIChhcHBsZV90aW1lX3N0YW1waW5nKSAtPiAxLjMuNi4xLjUuNS43LjMuOCAodGltZV9zdGFtcGluZykKICAgICAtIDEuMy42LjEuNC4xLjMxMS4xMC4zLjIgKG1pY3Jvc29mdF90aW1lX3N0YW1wX3NpZ25pbmcpIC0+IDEuMy42LjEuNS41LjcuMy44ICh0aW1lX3N0YW1waW5nKQoKICAgIDpwYXJhbSBvaWRzOgogICAgICAgIEEgc2V0IG9mIHVuaWNvZGUgc3RyaW5ncwoKICAgIDpyZXR1cm46CiAgICAgICAgVGhlIG9yaWdpbmFsIHNldCBvZiBPSURzIHdpdGggYW55IG1hcHBlZCBPSURzIGFkZGVkCiAgICAiIiIKCiAgICBuZXdfb2lkcyA9IHNldCgpCiAgICBmb3Igb2lkIGluIG9pZHM6CiAgICAgICAgaWYgb2lkIGluIF9vaWRfbWFwOgogICAgICAgICAgICBuZXdfb2lkcyB8PSBfb2lkX21hcFtvaWRdCiAgICByZXR1cm4gb2lkcyB8IG5ld19vaWRzCgoKZGVmIF9jYWNoZWRfcGF0aF9uZWVkc191cGRhdGUoY2FfcGF0aCwgY2FjaGVfbGVuZ3RoKToKICAgICIiIgogICAgQ2hlY2tzIHRvIHNlZSBpZiBhIGNhY2hlIGZpbGUgbmVlZHMgdG8gYmUgcmVmcmVzaGVkCgogICAgOnBhcmFtIGNhX3BhdGg6CiAgICAgICAgQSB1bmljb2RlIHN0cmluZyBvZiB0aGUgcGF0aCB0byB0aGUgY2FjaGUgZmlsZQoKICAgIDpwYXJhbSBjYWNoZV9sZW5ndGg6CiAgICAgICAgQW4gaW50ZWdlciByZXByZXNlbnRpbmcgdGhlIG51bWJlciBvZiBob3VycyB0aGUgY2FjaGUgaXMgdmFsaWQgZm9yCgogICAgOnJldHVybjoKICAgICAgICBBIGJvb2xlYW4gLSBUcnVlIGlmIHRoZSBjYWNoZSBuZWVkcyB0byBiZSB1cGRhdGVkLCBGYWxzZSBpZiB0aGUgZmlsZQogICAgICAgIGlzIHVwLXRvLWRhdGUKICAgICIiIgoKICAgIGV4aXN0cyA9IG9zLnBhdGguZXhpc3RzKGNhX3BhdGgpCiAgICBpZiBub3QgZXhpc3RzOgogICAgICAgIHJldHVybiBUcnVlCgogICAgc3RhdHMgPSBvcy5zdGF0KGNhX3BhdGgpCgogICAgaWYgc3RhdHMuc3RfbXRpbWUgPCB0aW1lLnRpbWUoKSAtIGNhY2hlX2xlbmd0aCAqIDYwICogNjA6CiAgICAgICAgcmV0dXJuIFRydWUKCiAgICBpZiBzdGF0cy5zdF9zaXplID09IDA6CiAgICAgICAgcmV0dXJuIFRydWUKCiAgICByZXR1cm4gRmFsc2UKCgpkZWYgX2luX21lbW9yeV91cF90b19kYXRlKGNhY2hlX2xlbmd0aCk6CiAgICAiIiIKICAgIENoZWNrcyB0byBzZWUgaWYgdGhlIGluLW1lbW9yeSBjYWNoZSBvZiBjZXJ0aWZpY2F0ZXMgaXMgZnJlc2gKCiAgICA6cGFyYW0gY2FjaGVfbGVuZ3RoOgogICAgICAgIEFuIGludGVnZXIgcmVwcmVzZW50aW5nIHRoZSBudW1iZXIgb2YgaG91cnMgdGhlIGNhY2hlIGlzIHZhbGlkIGZvcgoKICAgIDpyZXR1cm46CiAgICAgICAgQSBib29sZWFuIC0gVHJ1ZSBpZiB0aGUgY2FjaGUgaXMgdXAtdG8tZGF0ZSwgRmFsc2UgaWYgaXQgbmVlZHMgdG8gYmUKICAgICAgICByZWZyZXNoZWQKICAgICIiIgoKICAgIHJldHVybiAoCiAgICAgICAgX21vZHVsZV92YWx1ZXNbJ2NlcnRzJ10gYW5kCiAgICAgICAgX21vZHVsZV92YWx1ZXNbJ2xhc3RfdXBkYXRlJ10gYW5kCiAgICAgICAgX21vZHVsZV92YWx1ZXNbJ2xhc3RfdXBkYXRlJ10gPiB0aW1lLnRpbWUoKSAtIChjYWNoZV9sZW5ndGggKiA2MCAqIDYwKQogICAgKQo=
