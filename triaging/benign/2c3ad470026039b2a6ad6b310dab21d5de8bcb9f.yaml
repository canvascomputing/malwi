statistics:
  total_files: 1
  skipped_files: 0.0
  processed_objects: 1
  malicious_objects: 0
details:
- path: .repo_cache/malicious_repos/pypi_malregistry/pycryptoenv/1.0.7/pycryptoenv-1.0.7/pycryptoenv-1.0.7/tests/test_tls.py
  contents:
  - name: TLSTests.test_tls_error_not_yet_valid
    score: 0.0
    code: |-
      @connection_timeout()
          def test_tls_error_not_yet_valid(self):
              session = tls.TLSSession(extra_trust_roots=[badtls_ca_path])
              with assert_exception(self, errors.TLSVerificationError, 'not valid until'):
                  tls.TLSSocket('future.badtls.io', 11001, session=session)
    tokens: resume load_global tls load_attr TLSSession load_global badtls_ca_path build_list kw_names extra_trust_roots call store_fast session load_global STRING_LEN_S_ENT_HIGH load_fast self load_global errors load_attr STRING_BASE64_LEN_S_ENT_HIGH load_const not valid until call before_with pop_top load_global tls load_attr TLSSocket load_const STRING_LEN_S_ENT_HIGH load_const INTEGER load_fast session kw_names session call pop_top load_const load_const load_const call pop_top return_const None push_exc_info with_except_start pop_jump_if_true TO_NUMBER reraise pop_top pop_except pop_top pop_top return_const None copy pop_except reraise
    hash: ba8d30666db013c17f541e8bc8538b6dd39a89d25d53ea4ee0fb93137d7fb82c
sources:
  .repo_cache/malicious_repos/pypi_malregistry/pycryptoenv/1.0.7/pycryptoenv-1.0.7/pycryptoenv-1.0.7/tests/test_tls.py: IyBjb2Rpbmc6IHV0Zi04CmZyb20gX19mdXR1cmVfXyBpbXBvcnQgdW5pY29kZV9saXRlcmFscywgZGl2aXNpb24sIGFic29sdXRlX2ltcG9ydCwgcHJpbnRfZnVuY3Rpb24KCmltcG9ydCB1bml0dGVzdAppbXBvcnQgc3lzCmltcG9ydCBvcwppbXBvcnQgcmUKaW1wb3J0IHRocmVhZGluZwppbXBvcnQgcGxhdGZvcm0KaW1wb3J0IHRpbWUKaW1wb3J0IHNvY2tldAoKZnJvbSBvc2NyeXB0byBpbXBvcnQgdGxzLCBlcnJvcnMsIGJhY2tlbmQKZnJvbSBvc2NyeXB0by5fdGxzIGltcG9ydCBwYXJzZV90bHNfcmVjb3JkcywgcGFyc2VfaGFuZHNoYWtlX21lc3NhZ2VzCmZyb20gYXNuMWNyeXB0byBpbXBvcnQgeDUwOQoKZnJvbSAudW5pdHRlc3RfZGF0YSBpbXBvcnQgZGF0YV9kZWNvcmF0b3IsIGRhdGEKZnJvbSAuZXhjZXB0aW9uX2NvbnRleHQgaW1wb3J0IGFzc2VydF9leGNlcHRpb24KZnJvbSAuX3VuaXR0ZXN0X2NvbXBhdCBpbXBvcnQgcGF0Y2gKZnJvbSAuX2h0dHBzX2NsaWVudCBpbXBvcnQgSHR0cHNDbGllbnQKZnJvbSAuX3NvY2tldF9wcm94eSBpbXBvcnQgbWFrZV9zb2NrZXRfcHJveHkKZnJvbSAuX3NvY2tldF9zZXJ2ZXIgaW1wb3J0IG1ha2Vfc29ja2V0X3NlcnZlcgoKaWYgc3lzLnZlcnNpb25faW5mbyA8ICgzLCk6CiAgICBpbXBvcnQgdGhyZWFkCmVsc2U6CiAgICBpbXBvcnQgX3RocmVhZCBhcyB0aHJlYWQKCnBhdGNoKCkKCmlmIHN5cy52ZXJzaW9uX2luZm8gPCAoMywpOgogICAgc3RyX2NscyA9IHVuaWNvZGUgICMgbm9xYQogICAgYnl0ZV9jbHMgPSBzdHIKZWxzZToKICAgIHN0cl9jbHMgPSBzdHIKICAgIGJ5dGVfY2xzID0gYnl0ZXMKCgpfYmFja2VuZCA9IGJhY2tlbmQoKQoKeHAgPSBzeXMucGxhdGZvcm0gPT0gJ3dpbjMyJyBhbmQgc3lzLmdldHdpbmRvd3N2ZXJzaW9uKClbMF0gPCA2Cgp0ZXN0c19yb290ID0gb3MucGF0aC5kaXJuYW1lKF9fZmlsZV9fKQpmaXh0dXJlc19kaXIgPSBvcy5wYXRoLmpvaW4odGVzdHNfcm9vdCwgJ2ZpeHR1cmVzJykKCmRpZ2ljZXJ0X2NhX3BhdGggPSBvcy5wYXRoLmpvaW4oZml4dHVyZXNfZGlyLCAnZGlnaWNlcnRfY2EuY3J0JykKYmFkdGxzX2NhX3BhdGggPSBvcy5wYXRoLmpvaW4oZml4dHVyZXNfZGlyLCAnYmFkdGxzLmlvX2NhLmNydCcpCgojIFB5UHkgPD0gNS42LjAgb24gT1MgWCAxMC4xMSBoYXMgYSBidWcgd2l0aCBfZ2V0X2Nsb2NrdGltZQpvc3hfcHlweV9idWcgPSBwbGF0Zm9ybS5weXRob25faW1wbGVtZW50YXRpb24oKSA9PSAnUHlQeScgXAogICAgYW5kIHN5cy5wbGF0Zm9ybSA9PSAnZGFyd2luJyBcCiAgICBhbmQgdHVwbGUobWFwKGludCwgcGxhdGZvcm0ubWFjX3ZlcigpWzBdLnNwbGl0KCcuJykpKSA8ICgxMCwgMTIpCgpyYWlzZV93aXRoID0gTm9uZQppZiBzeXMudmVyc2lvbl9pbmZvIDwgKDMsKToKICAgIGV4ZWMoJycnCmRlZiByYWlzZV93aXRoKGUsIHRiKToKICAgIHJhaXNlIGUsIE5vbmUsIHRiCicnJykKZWxzZToKICAgIGV4ZWMoJycnCmRlZiByYWlzZV93aXRoKGUsIHRiKToKICAgIGUuX190cmFjZWJhY2tfXyA9IHRiCiAgICByYWlzZSBlIGZyb20gTm9uZQonJycpCgoKZGVmIGNvbm5lY3Rpb25fdGltZW91dCh0aW1lb3V0PTMwKToKICAgIGRlZiB0aW1lb3V0X2RlY29yYXRvcihmKToKICAgICAgICBkZWYgd3JhcHBlZCgqYXJncyk6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGlmIG5vdCBvc3hfcHlweV9idWc6CiAgICAgICAgICAgICAgICAgICAgdCA9IHRocmVhZGluZy5UaW1lcih0aW1lb3V0LCBsYW1iZGE6IHRocmVhZC5pbnRlcnJ1cHRfbWFpbigpKQogICAgICAgICAgICAgICAgICAgIHQuc3RhcnQoKQogICAgICAgICAgICAgICAgZigqYXJncykKICAgICAgICAgICAgZXhjZXB0IChLZXlib2FyZEludGVycnVwdCk6CiAgICAgICAgICAgICAgICByYWlzZV93aXRoKEFzc2VydGlvbkVycm9yKCJUaW1lZCBvdXQiKSwgc3lzLmV4Y19pbmZvKClbMl0pCiAgICAgICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgICAgICBpZiBub3Qgb3N4X3B5cHlfYnVnOgogICAgICAgICAgICAgICAgICAgIHQuY2FuY2VsKCkKICAgICAgICByZXR1cm4gd3JhcHBlZAogICAgcmV0dXJuIHRpbWVvdXRfZGVjb3JhdG9yCgoKQGRhdGFfZGVjb3JhdG9yCmNsYXNzIFRMU1Rlc3RzKHVuaXR0ZXN0LlRlc3RDYXNlKToKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgdGxzX2hvc3RzKCk6CiAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgKCdnb29nbGUnLCAnd3d3Lmdvb2dsZS5jb20nLCA0NDMpLAogICAgICAgICAgICAoJ3BhY2thZ2VfY29udHJvbCcsICdwYWNrYWdlY29udHJvbC5pbycsIDQ0MyksCiAgICAgICAgICAgICgnZGgxMDI0JywgJ2RoMTAyNC5iYWR0bHMuaW8nLCAxMDAwNSksCiAgICAgICAgKQoKICAgIEBkYXRhKCd0bHNfaG9zdHMnLCBUcnVlKQogICAgQGNvbm5lY3Rpb25fdGltZW91dCgpCiAgICBkZWYgdGxzX2Nvbm5lY3Qoc2VsZiwgaG9zdG5hbWUsIHBvcnQpOgogICAgICAgIHNlc3Npb24gPSBOb25lCiAgICAgICAgaWYgaG9zdG5hbWUgPT0gJ2RoMTAyNC5iYWR0bHMuaW8nOgogICAgICAgICAgICBzZXNzaW9uID0gdGxzLlRMU1Nlc3Npb24oZXh0cmFfdHJ1c3Rfcm9vdHM9W2JhZHRsc19jYV9wYXRoXSkKICAgICAgICBjb25uZWN0aW9uID0gdGxzLlRMU1NvY2tldChob3N0bmFtZSwgcG9ydCwgc2Vzc2lvbj1zZXNzaW9uKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoaG9zdG5hbWUsIGNvbm5lY3Rpb24uaG9zdG5hbWUpCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKGNvbm5lY3Rpb24uaG9zdG5hbWUsIHN0cl9jbHMpCiAgICAgICAgc2VsZi5hc3NlcnRJc0luc3RhbmNlKGNvbm5lY3Rpb24uY2lwaGVyX3N1aXRlLCBzdHJfY2xzKQogICAgICAgIHNlbGYuYXNzZXJ0SXNJbnN0YW5jZShjb25uZWN0aW9uLmNlcnRpZmljYXRlLCB4NTA5LkNlcnRpZmljYXRlKQogICAgICAgIHNlbGYuYXNzZXJ0TGVzcygxMCwgbGVuKGNvbm5lY3Rpb24uY2lwaGVyX3N1aXRlKSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHBvcnQsIGNvbm5lY3Rpb24ucG9ydCkKICAgICAgICBjb25uZWN0aW9uLndyaXRlKGInR0VUIC8gSFRUUC8xLjFcclxuSG9zdDogJyArIGhvc3RuYW1lLmVuY29kZSgndXRmLTgnKSArIGInXHJcblxyXG4nKQogICAgICAgIGh0bWwgPSBjb25uZWN0aW9uLnJlYWRfdW50aWwocmUuY29tcGlsZShiJzwvaHRtbD4nLCByZS5JKSkKICAgICAgICBzZWxmLmFzc2VydE5vdEVxdWFsKE5vbmUsIHJlLnNlYXJjaChiJzwvaHRtbD4nLCBodG1sLCByZS5JKSkKCiAgICBAY29ubmVjdGlvbl90aW1lb3V0KCkKICAgIGRlZiB0ZXN0X3Rsc19jb25uZWN0X3Jldm9rZWQoc2VsZik6CiAgICAgICAgaWYgX2JhY2tlbmQgPT0gJ21hYyc6CiAgICAgICAgICAgIGZyb20gb3NjcnlwdG8uX21hYy5fc2VjdXJpdHkgaW1wb3J0IG9zeF92ZXJzaW9uX2luZm8KCiAgICAgICAgICAgICMgbWFjT1MgMTAuMTIgd2lsbCByZWFkIHRoZSBPQ1NQIFN0YXBsZSByZXNwb25zZSBhbmQgcmFpc2UgYSByZXZva2VkCiAgICAgICAgICAgICMgZXJyb3IsIGV2ZW4gdGhvdWdoIHdlIGhhdmUgcmV2b2NhdGlvbiBjaGVja2luZyBkaXNhYmxlZAogICAgICAgICAgICBpZiBvc3hfdmVyc2lvbl9pbmZvID49ICgxMCwgMTIpOgogICAgICAgICAgICAgICAgd2l0aCBhc3NlcnRfZXhjZXB0aW9uKHNlbGYsIGVycm9ycy5UTFNFcnJvciwgJ3Jldm9rZWQnKToKICAgICAgICAgICAgICAgICAgICB0bHMuVExTU29ja2V0KCdnbG9iYWwtcm9vdC1jYS1yZXZva2VkLmNoYWluLWRlbW9zLmRpZ2ljZXJ0LmNvbScsIDQ0MykKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgIHRscy5UTFNTb2NrZXQoJ2dsb2JhbC1yb290LWNhLXJldm9rZWQuY2hhaW4tZGVtb3MuZGlnaWNlcnQuY29tJywgNDQzKQoKICAgIEBjb25uZWN0aW9uX3RpbWVvdXQoKQogICAgZGVmIHRlc3RfdGxzX2Vycm9yX2h0dHAoc2VsZik6CiAgICAgICAgd2l0aCBhc3NlcnRfZXhjZXB0aW9uKHNlbGYsIGVycm9ycy5UTFNFcnJvciwgJ3NlcnZlciByZXNwb25kZWQgdXNpbmcgSFRUUCcpOgogICAgICAgICAgICB0bHMuVExTU29ja2V0KCd3d3cuZ29vZ2xlLmNvbScsIDgwKQoKICAgIEBjb25uZWN0aW9uX3RpbWVvdXQoKQogICAgZGVmIHRlc3RfdGxzX2Vycm9yX2Z0cChzZWxmKToKICAgICAgICBzID0gTm9uZQogICAgICAgIHRyeToKICAgICAgICAgICAgZGVmX3RpbWVvdXQgPSBzb2NrZXQuZ2V0ZGVmYXVsdHRpbWVvdXQoKQogICAgICAgICAgICBzb2NrZXQuc2V0ZGVmYXVsdHRpbWVvdXQoNSkKICAgICAgICAgICAgcyA9IG1ha2Vfc29ja2V0X3NlcnZlcigxODAyMSwgbGFtYmRhIHMsIGQ6IHMuc2VuZChiJzIyMCBXZWxjb21lIHRvIEZvb0ZUUFxuJykpCiAgICAgICAgICAgIHdpdGggYXNzZXJ0X2V4Y2VwdGlvbihzZWxmLCBlcnJvcnMuVExTRXJyb3IsICdyZW1vdGUgZW5kIGNsb3NlZCB0aGUgY29ubmVjdGlvbnxzZXJ2ZXIgcmVzcG9uZGVkIHVzaW5nIEZUUCcpOgogICAgICAgICAgICAgICAgdGxzLlRMU1NvY2tldCgnbG9jYWxob3N0JywgMTgwMjEpCiAgICAgICAgZmluYWxseToKICAgICAgICAgICAgaWYgczoKICAgICAgICAgICAgICAgIHMuY2xvc2UoKQogICAgICAgICAgICBzb2NrZXQuc2V0ZGVmYXVsdHRpbWVvdXQoZGVmX3RpbWVvdXQpCgogICAgQGNvbm5lY3Rpb25fdGltZW91dCgpCiAgICBkZWYgdGVzdF90bHNfZXJyb3JfbWlzc2luZ19pc3N1ZXIoc2VsZik6CiAgICAgICAgZXhwZWN0ZWQgPSAnY2VydGlmaWNhdGUgaXNzdWVyIG5vdCBmb3VuZCBpbiB0cnVzdGVkIHJvb3QgY2VydGlmaWNhdGUgc3RvcmUnCiAgICAgICAgd2l0aCBhc3NlcnRfZXhjZXB0aW9uKHNlbGYsIGVycm9ycy5UTFNWZXJpZmljYXRpb25FcnJvciwgZXhwZWN0ZWQpOgogICAgICAgICAgICB0bHMuVExTU29ja2V0KCdkb21haW4tbWF0Y2guYmFkdGxzLmlvJywgMTAwMDApCgogICAgQGNvbm5lY3Rpb25fdGltZW91dCgpCiAgICBkZWYgdGVzdF90bHNfZXJyb3JfZG9tYWluX21pc21hdGNoKHNlbGYpOgogICAgICAgIHNlc3Npb24gPSB0bHMuVExTU2Vzc2lvbihleHRyYV90cnVzdF9yb290cz1bYmFkdGxzX2NhX3BhdGhdKQogICAgICAgIHdpdGggYXNzZXJ0X2V4Y2VwdGlvbihzZWxmLCBlcnJvcnMuVExTVmVyaWZpY2F0aW9uRXJyb3IsICdkb2VzIG5vdCBtYXRjaCcpOgogICAgICAgICAgICB0bHMuVExTU29ja2V0KCdkb21haW4tbWlzbWF0Y2guYmFkdGxzLmlvJywgMTEwMDIsIHNlc3Npb249c2Vzc2lvbikKCiAgICBAY29ubmVjdGlvbl90aW1lb3V0KCkKICAgIGRlZiB0ZXN0X3Rsc19lcnJvcl9zYW5fbWlzbWF0Y2goc2VsZik6CiAgICAgICAgc2Vzc2lvbiA9IHRscy5UTFNTZXNzaW9uKGV4dHJhX3RydXN0X3Jvb3RzPVtiYWR0bHNfY2FfcGF0aF0pCiAgICAgICAgd2l0aCBhc3NlcnRfZXhjZXB0aW9uKHNlbGYsIGVycm9ycy5UTFNWZXJpZmljYXRpb25FcnJvciwgJ2RvZXMgbm90IG1hdGNoJyk6CiAgICAgICAgICAgIHRscy5UTFNTb2NrZXQoJ3Nhbi1taXNtYXRjaC5iYWR0bHMuaW8nLCAxMTAwMywgc2Vzc2lvbj1zZXNzaW9uKQoKICAgIEBjb25uZWN0aW9uX3RpbWVvdXQoKQogICAgZGVmIHRlc3RfdGxzX3dpbGRjYXJkX3N1Y2Nlc3Moc2VsZik6CiAgICAgICAgc2Vzc2lvbiA9IHRscy5UTFNTZXNzaW9uKGV4dHJhX3RydXN0X3Jvb3RzPVtiYWR0bHNfY2FfcGF0aF0pCiAgICAgICAgdGxzLlRMU1NvY2tldCgnd2lsZGNhcmQtbWF0Y2guYmFkdGxzLmlvJywgMTAwMDEsIHNlc3Npb249c2Vzc2lvbikKCiAgICBAY29ubmVjdGlvbl90aW1lb3V0KCkKICAgIGRlZiB0ZXN0X3Rsc19lcnJvcl9ub3RfeWV0X3ZhbGlkKHNlbGYpOgogICAgICAgIHNlc3Npb24gPSB0bHMuVExTU2Vzc2lvbihleHRyYV90cnVzdF9yb290cz1bYmFkdGxzX2NhX3BhdGhdKQogICAgICAgIHdpdGggYXNzZXJ0X2V4Y2VwdGlvbihzZWxmLCBlcnJvcnMuVExTVmVyaWZpY2F0aW9uRXJyb3IsICdub3QgdmFsaWQgdW50aWwnKToKICAgICAgICAgICAgdGxzLlRMU1NvY2tldCgnZnV0dXJlLmJhZHRscy5pbycsIDExMDAxLCBzZXNzaW9uPXNlc3Npb24pCgogICAgQGNvbm5lY3Rpb25fdGltZW91dCgpCiAgICBkZWYgdGVzdF90bHNfZXJyb3JfZXhwaXJlZF8yKHNlbGYpOgogICAgICAgIHNlc3Npb24gPSB0bHMuVExTU2Vzc2lvbihleHRyYV90cnVzdF9yb290cz1bYmFkdGxzX2NhX3BhdGhdKQogICAgICAgICMgVGhpcyB0ZXN0IGFsbG93cyBwYXN0IG9yIGZ1dHVyZSBzaW5jZSBjZXJ0IGlzIDE5NjMsIHdoaWNoIHNvbWUgc3lzdGVtcwogICAgICAgICMgd2lsbCBpbnRlcnByZXQgYXMgMjA2MwogICAgICAgIHdpdGggYXNzZXJ0X2V4Y2VwdGlvbihzZWxmLCBlcnJvcnMuVExTVmVyaWZpY2F0aW9uRXJyb3IsICdjZXJ0aWZpY2F0ZSBleHBpcmVkfG5vdCB2YWxpZCB1bnRpbCcpOgogICAgICAgICAgICB0bHMuVExTU29ja2V0KCdleHBpcmVkLTE5NjMuYmFkdGxzLmlvJywgMTEwMDAsIHNlc3Npb249c2Vzc2lvbikKCiAgICBAY29ubmVjdGlvbl90aW1lb3V0KCkKICAgIGRlZiB0ZXN0X3Rsc19lcnJvcl9jbGllbnRfY2VydF9yZXF1aXJlZChzZWxmKToKICAgICAgICBzZXNzaW9uID0gdGxzLlRMU1Nlc3Npb24oZXh0cmFfdHJ1c3Rfcm9vdHM9W2JhZHRsc19jYV9wYXRoXSkKICAgICAgICB3aXRoIGFzc2VydF9leGNlcHRpb24oc2VsZiwgZXJyb3JzLlRMU0Vycm9yLCAnY2xpZW50IGF1dGhlbnRpY2F0aW9uJyk6CiAgICAgICAgICAgIHRscy5UTFNTb2NrZXQoJ3JlcXVpcmVkLWF1dGguYmFkdGxzLmlvJywgMTAwMDMsIHNlc3Npb249c2Vzc2lvbikKCiAgICBAY29ubmVjdGlvbl90aW1lb3V0KCkKICAgIGRlZiB0ZXN0X3Rsc19lcnJvcl9oYW5kc2hha2VfZXJyb3JfMyhzZWxmKToKICAgICAgICBzZXNzaW9uID0gdGxzLlRMU1Nlc3Npb24oZXh0cmFfdHJ1c3Rfcm9vdHM9W2JhZHRsc19jYV9wYXRoXSkKICAgICAgICB3aXRoIGFzc2VydF9leGNlcHRpb24oc2VsZiwgZXJyb3JzLlRMU0Vycm9yLCAnd2VhayBjZXJ0aWZpY2F0ZSBzaWduYXR1cmUgYWxnb3JpdGhtJyk6CiAgICAgICAgICAgIHRscy5UTFNTb2NrZXQoJ3dlYWstc2lnLmJhZHRscy5pbycsIDExMDA0LCBzZXNzaW9uPXNlc3Npb24pCgogICAgQGNvbm5lY3Rpb25fdGltZW91dCgpCiAgICBkZWYgdGVzdF90bHNfZXJyb3Jfbm9uX3dlYihzZWxmKToKICAgICAgICBzZXNzaW9uID0gdGxzLlRMU1Nlc3Npb24oZXh0cmFfdHJ1c3Rfcm9vdHM9W2JhZHRsc19jYV9wYXRoXSkKICAgICAgICB3aXRoIGFzc2VydF9leGNlcHRpb24oc2VsZiwgZXJyb3JzLlRMU1ZlcmlmaWNhdGlvbkVycm9yLCAndmVyaWZpY2F0aW9uIGZhaWxlZCcpOgogICAgICAgICAgICB0bHMuVExTU29ja2V0KCdiYWQta2V5LXVzYWdlLmJhZHRscy5pbycsIDExMDA1LCBzZXNzaW9uPXNlc3Npb24pCgogICAgQGNvbm5lY3Rpb25fdGltZW91dCgpCiAgICBkZWYgdGVzdF90bHNfZXJyb3Jfd2lsZGNhcmRfbWlzbWF0Y2goc2VsZik6CiAgICAgICAgc2Vzc2lvbiA9IHRscy5UTFNTZXNzaW9uKGV4dHJhX3RydXN0X3Jvb3RzPVtiYWR0bHNfY2FfcGF0aF0pCiAgICAgICAgd2l0aCBhc3NlcnRfZXhjZXB0aW9uKHNlbGYsIGVycm9ycy5UTFNWZXJpZmljYXRpb25FcnJvciwgJ2RvZXMgbm90IG1hdGNoJyk6CiAgICAgICAgICAgIHRscy5UTFNTb2NrZXQoJ3dpbGRjYXJkLm1pc21hdGNoLmJhZHRscy5pbycsIDExMDA3LCBzZXNzaW9uPXNlc3Npb24pCgogICAgQGNvbm5lY3Rpb25fdGltZW91dCgpCiAgICBkZWYgdGVzdF90bHNfZXJyb3JfZXhwaXJlZChzZWxmKToKICAgICAgICBzZXNzaW9uID0gdGxzLlRMU1Nlc3Npb24oZXh0cmFfdHJ1c3Rfcm9vdHM9W2JhZHRsc19jYV9wYXRoXSkKICAgICAgICB3aXRoIGFzc2VydF9leGNlcHRpb24oc2VsZiwgZXJyb3JzLlRMU1ZlcmlmaWNhdGlvbkVycm9yLCAnY2VydGlmaWNhdGUgZXhwaXJlZCcpOgogICAgICAgICAgICB0bHMuVExTU29ja2V0KCdleHBpcmVkLmJhZHRscy5pbycsIDExMDA2LCBzZXNzaW9uPXNlc3Npb24pCgogICAgQGNvbm5lY3Rpb25fdGltZW91dCgpCiAgICBkZWYgdGVzdF90bHNfZXJyb3Jfc2VsZl9zaWduZWQoc2VsZik6CiAgICAgICAgd2l0aCBhc3NlcnRfZXhjZXB0aW9uKHNlbGYsIGVycm9ycy5UTFNWZXJpZmljYXRpb25FcnJvciwgJ3NlbGYtc2lnbmVkJyk6CiAgICAgICAgICAgIHRscy5UTFNTb2NrZXQoJ3NlbGYtc2lnbmVkLmJhZHNzbC5jb20nLCA0NDMpCgogICAgQGNvbm5lY3Rpb25fdGltZW91dCgpCiAgICBkZWYgdGVzdF90bHNfZXJyb3Jfd2Vha19kaF9wYXJhbXMoc2VsZik6CiAgICAgICAgIyBiYWRzc2wuY29tIHVzZXMgU05JLCB3aGljaCBXaW5kb3dzIFhQIGRvZXMgbm90IHN1cHBvcnQKICAgICAgICByZWdleCA9ICd3ZWFrIERIIHBhcmFtZXRlcnMnIGlmIG5vdCB4cCBlbHNlICdzZWxmLXNpZ25lZCcKICAgICAgICAjIGlkZWFsbHkgd2Ugd291bGQgdXNlIGJhZHRscy5pbyBzaW5jZSB0aGF0IGRvZXMgbm90IHJlcXVpcmUgU05JLCBob3dldmVyCiAgICAgICAgIyBpdCBpcyBub3QgcG9zc2libGUgdG8gZm9yY2UgYSBnb29kIHZlcnNpb24gb2YgT3BlblNTTCB0byB1c2Ugc3VjaCBhCiAgICAgICAgIyBzbWFsbCB2YWx1ZSBmb3IgREggcGFyYW1zLCBhbmQgSSBkb24ndCBmZWVsIGxpa2UgdGhlIGhlYWRhY2hlIG9mIHRyeWluZwogICAgICAgICMgdG8gZ2V0IGFuIG9sZCwgc3RhdGljbHktbGlua2VkIHNvY2F0IHNldCB1cCBqdXN0IGZvciB0aGlzIHRleHQgb24gWFAKICAgICAgICB3aXRoIGFzc2VydF9leGNlcHRpb24oc2VsZiwgZXJyb3JzLlRMU0Vycm9yLCByZWdleCk6CiAgICAgICAgICAgIHRscy5UTFNTb2NrZXQoJ2RoNTEyLmJhZHNzbC5jb20nLCA0NDMpCgogICAgQGNvbm5lY3Rpb25fdGltZW91dCgpCiAgICBkZWYgdGVzdF90bHNfZXJyb3JfaGFuZHNoYWtlX2Vycm9yKHNlbGYpOgogICAgICAgIHNlc3Npb24gPSB0bHMuVExTU2Vzc2lvbihleHRyYV90cnVzdF9yb290cz1bYmFkdGxzX2NhX3BhdGhdKQogICAgICAgIHdpdGggYXNzZXJ0X2V4Y2VwdGlvbihzZWxmLCBlcnJvcnMuVExTRXJyb3IsICdUTFMgaGFuZHNoYWtlIGZhaWxlZCcpOgogICAgICAgICAgICB0bHMuVExTU29ja2V0KCdyYzQtbWQ1LmJhZHRscy5pbycsIDExMDA5LCBzZXNzaW9uPXNlc3Npb24pCgogICAgQGNvbm5lY3Rpb25fdGltZW91dCgpCiAgICBkZWYgdGVzdF90bHNfZXJyb3JfaGFuZHNoYWtlX2Vycm9yXzIoc2VsZik6CiAgICAgICAgc2Vzc2lvbiA9IHRscy5UTFNTZXNzaW9uKGV4dHJhX3RydXN0X3Jvb3RzPVtiYWR0bHNfY2FfcGF0aF0pCiAgICAgICAgd2l0aCBhc3NlcnRfZXhjZXB0aW9uKHNlbGYsIGVycm9ycy5UTFNFcnJvciwgJ1RMUyBoYW5kc2hha2UgZmFpbGVkJyk6CiAgICAgICAgICAgIHRscy5UTFNTb2NrZXQoJ3JjNC5iYWR0bHMuaW8nLCAxMTAwOCwgc2Vzc2lvbj1zZXNzaW9uKQoKICAgIEBjb25uZWN0aW9uX3RpbWVvdXQoKQogICAgZGVmIHRlc3RfdGxzX2V4dHJhX3RydXN0X3Jvb3RzX25vX21hdGNoKHNlbGYpOgogICAgICAgIGV4cGVjdGVkID0gJ2NlcnRpZmljYXRlIGlzc3VlciBub3QgZm91bmQgaW4gdHJ1c3RlZCByb290IGNlcnRpZmljYXRlIHN0b3JlJwogICAgICAgIHdpdGggYXNzZXJ0X2V4Y2VwdGlvbihzZWxmLCBlcnJvcnMuVExTVmVyaWZpY2F0aW9uRXJyb3IsIGV4cGVjdGVkKToKICAgICAgICAgICAgc2Vzc2lvbiA9IHRscy5UTFNTZXNzaW9uKGV4dHJhX3RydXN0X3Jvb3RzPVtkaWdpY2VydF9jYV9wYXRoXSkKICAgICAgICAgICAgdGxzLlRMU1NvY2tldCgnZG9tYWluLW1hdGNoLmJhZHRscy5pbycsIDEwMDAwLCBzZXNzaW9uPXNlc3Npb24pCgogICAgQGNvbm5lY3Rpb25fdGltZW91dCgpCiAgICBkZWYgdGVzdF90bHNfZXh0cmFfdHJ1c3Rfcm9vdHMoc2VsZik6CiAgICAgICAgc2Vzc2lvbiA9IHRscy5UTFNTZXNzaW9uKGV4dHJhX3RydXN0X3Jvb3RzPVtiYWR0bHNfY2FfcGF0aCwgZGlnaWNlcnRfY2FfcGF0aF0pCiAgICAgICAgdGxzLlRMU1NvY2tldCgnZG9tYWluLW1hdGNoLmJhZHRscy5pbycsIDEwMDAwLCBzZXNzaW9uPXNlc3Npb24pCgogICAgQGNvbm5lY3Rpb25fdGltZW91dCg5MCkKICAgIGRlZiB0ZXN0X3Rsc19ncmFjZWZ1bF9kaXNjb25uZWN0KHNlbGYpOgogICAgICAgICMgVGhpcyBjb25uZWN0cyB0byBhIGJ1bmNoIG9mIHBhZ2VzIG9uIHRoZSBzYW1lIGRvbWFpbnMgdXNpbmcKICAgICAgICAjIHRoZSBDb25uZWN0aW9uOiBLZWVwLUFsaXZlIGhlYWRlciwgaG93ZXZlciB0aGUgc2VydmVyIGlzCiAgICAgICAgIyBjb25maWd1cmVkIHRvIGRpc2Nvbm5lY3QgYWZ0ZXIgNDAgcmVzcG9uc2VzLCBzbyBpdCByZXF1aXJlcwogICAgICAgICMgVExTU29ja2V0KCkgdG8gcHJvcGVybHkgaGFuZGxlIGEgZ3JhY2VmdWwgZGlzY29ubmVjdC4KICAgICAgICB1cmxzID0gWwogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MScsCiAgICAgICAgICAgICdodHRwczovL3BhY2thZ2Vjb250cm9sLmlvL2Jyb3dzZS9wb3B1bGFyLmpzb24/cGFnZT0yJywKICAgICAgICAgICAgJ2h0dHBzOi8vcGFja2FnZWNvbnRyb2wuaW8vYnJvd3NlL3BvcHVsYXIuanNvbj9wYWdlPTMnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NCcsCiAgICAgICAgICAgICdodHRwczovL3BhY2thZ2Vjb250cm9sLmlvL2Jyb3dzZS9wb3B1bGFyLmpzb24/cGFnZT01JywKICAgICAgICAgICAgJ2h0dHBzOi8vcGFja2FnZWNvbnRyb2wuaW8vYnJvd3NlL3BvcHVsYXIuanNvbj9wYWdlPTYnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NycsCiAgICAgICAgICAgICdodHRwczovL3BhY2thZ2Vjb250cm9sLmlvL2Jyb3dzZS9wb3B1bGFyLmpzb24/cGFnZT04JywKICAgICAgICAgICAgJ2h0dHBzOi8vcGFja2FnZWNvbnRyb2wuaW8vYnJvd3NlL3BvcHVsYXIuanNvbj9wYWdlPTknLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MTAnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MTEnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MTInLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MTMnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MTQnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MTUnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MTYnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MTcnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MTgnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MTknLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MjAnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MjEnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MjInLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MjMnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MjQnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MjUnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MjYnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MjcnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MjgnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MjknLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MzAnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MzEnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MzInLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MzMnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MzQnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MzUnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MzYnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MzcnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MzgnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MzknLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NDAnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NDEnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NDInLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NDMnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NDQnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NDUnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NDYnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NDcnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NDgnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NDknLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NTAnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NTEnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NTInLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NTMnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NTQnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NTUnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NTYnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NTcnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NTgnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NTknLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NjAnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NjEnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NjInLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NjMnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NjQnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NjUnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NjYnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NjcnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NjgnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NjknLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NzAnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NzEnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NzInLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NzMnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NzQnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NzUnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NzYnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NzcnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NzgnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9NzknLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9ODAnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9ODEnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9ODInLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9ODMnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9ODQnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9ODUnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9ODYnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9ODcnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9ODgnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9ODknLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9OTAnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9OTEnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9OTInLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9OTMnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9OTQnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9OTUnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9OTYnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9OTcnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9OTgnLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9OTknLAogICAgICAgICAgICAnaHR0cHM6Ly9wYWNrYWdlY29udHJvbC5pby9icm93c2UvcG9wdWxhci5qc29uP3BhZ2U9MTAwJywKICAgICAgICBdCiAgICAgICAgYyA9IEh0dHBzQ2xpZW50KCkKICAgICAgICBmb3IgdXJsIGluIHVybHM6CiAgICAgICAgICAgIGMuZG93bmxvYWQodXJsLCAxNSkKCiAgICBAY29ubmVjdGlvbl90aW1lb3V0KDYwKQogICAgZGVmIHRlc3RfdGxzX2xhcmdlX2Rvd25sb2FkKHNlbGYpOgogICAgICAgICMgVGhpcyB0ZXN0cyBkb3dubG9hZGluZyBhIGxhcmdlICgzTUIrKSBmaWxlIHRvIGVuc3VyZQogICAgICAgICMgdGhlcmUgYXJlbid0IGJ1ZmZlciBvdmVyZmxvdyBpc3N1ZXMgaW4gVExTU29ja2V0KCkKICAgICAgICBjID0gSHR0cHNDbGllbnQoKQogICAgICAgIGMuZG93bmxvYWQoJ2h0dHBzOi8vcGFja2FnZWNvbnRyb2wuaW8vY2hhbm5lbF92My5qc29uJywgMTUpCgogICAgQGNvbm5lY3Rpb25fdGltZW91dCgpCiAgICBkZWYgdGVzdF90bHNfcHJvdG9jb2xfdmVyc2lvbihzZWxmKToKICAgICAgICBzZXNzaW9uID0gdGxzLlRMU1Nlc3Npb24oc2V0KFsnVExTdjEnLCAnVExTdjEuMSddKSkKICAgICAgICB3aXRoIGFzc2VydF9leGNlcHRpb24oc2VsZiwgZXJyb3JzLlRMU0Vycm9yLCAnVExTIGhhbmRzaGFrZSBmYWlsZWQgLSBwcm90b2NvbCB2ZXJzaW9uIGVycm9yJyk6CiAgICAgICAgICAgIHRscy5UTFNTb2NrZXQoJ2dpdGh1Yi5jb20nLCA0NDMsIHNlc3Npb249c2Vzc2lvbikKCiAgICBAY29ubmVjdGlvbl90aW1lb3V0KCkKICAgIGRlZiB0ZXN0X3Rsc19wYXVzZV90aW1lb3V0KHNlbGYpOgogICAgICAgIGMgPSBIdHRwc0NsaWVudChGYWxzZSwgVHJ1ZSkKICAgICAgICBjLmRvd25sb2FkKCdodHRwczovL3BhY2thZ2Vjb250cm9sLmlvL2Jyb3dzZS9wb3B1bGFyLmpzb24/cGFnZT0xJywgNSkKICAgICAgICB0aW1lLnNsZWVwKDEwKQogICAgICAgIGMuZG93bmxvYWQoJ2h0dHBzOi8vcGFja2FnZWNvbnRyb2wuaW8vYnJvd3NlL3BvcHVsYXIuanNvbj9wYWdlPTInLCA1KQoKICAgIEBjb25uZWN0aW9uX3RpbWVvdXQoKQogICAgZGVmIHRlc3RfdGxzX2Nsb3NlZF9jb25uZWN0aW9uX3JlYWQoc2VsZik6CiAgICAgICAgaXAgPSBzb2NrZXQuZ2V0aG9zdGJ5bmFtZSgnYmFkdGxzLmlvJykKCiAgICAgICAgd2l0aCBhc3NlcnRfZXhjZXB0aW9uKHNlbGYsIChlcnJvcnMuVExTRGlzY29ubmVjdEVycm9yLCBlcnJvcnMuVExTRXJyb3IpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVGhlIHJlbW90ZSBlbmQgY2xvc2VkIHRoZSBjb25uZWN0aW9ufFRMUyBoYW5kc2hha2UgZmFpbGVkJyk6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHNvY2ssIHNlbmRfc29jaywgcmVjdl9zb2NrLCBzZXJ2ZXIgPSBtYWtlX3NvY2tldF9wcm94eShpcCwgNDQzKQogICAgICAgICAgICAgICAgdHNvY2sgPSB0bHMuVExTU29ja2V0LndyYXAoc29jaywgJ2JhZHRscy5pbycpCiAgICAgICAgICAgICAgICBzZW5kX3NvY2suY2xvc2UoKQogICAgICAgICAgICAgICAgdHNvY2sucmVhZCg4MTkyKQogICAgICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICAgICAgcmVjdl9zb2NrLmNsb3NlKCkKICAgICAgICAgICAgICAgIHNlcnZlci5jbG9zZSgpCgogICAgQGNvbm5lY3Rpb25fdGltZW91dCgpCiAgICBkZWYgdGVzdF90bHNfY2xvc2VkX2Nvbm5lY3Rpb25fd3JpdGUoc2VsZik6CiAgICAgICAgaXAgPSBzb2NrZXQuZ2V0aG9zdGJ5bmFtZSgnYmFkdGxzLmlvJykKCiAgICAgICAgd2l0aCBhc3NlcnRfZXhjZXB0aW9uKHNlbGYsIChlcnJvcnMuVExTRGlzY29ubmVjdEVycm9yLCBlcnJvcnMuVExTRXJyb3IpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVGhlIHJlbW90ZSBlbmQgY2xvc2VkIHRoZSBjb25uZWN0aW9ufFRMUyBoYW5kc2hha2UgZmFpbGVkJyk6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHNvY2ssIHNlbmRfc29jaywgcmVjdl9zb2NrLCBzZXJ2ZXIgPSBtYWtlX3NvY2tldF9wcm94eShpcCwgNDQzKQogICAgICAgICAgICAgICAgdHNvY2sgPSB0bHMuVExTU29ja2V0LndyYXAoc29jaywgJ2JhZHRscy5pbycpCiAgICAgICAgICAgICAgICBzZW5kX3NvY2suY2xvc2UoKQogICAgICAgICAgICAgICAgdHNvY2sud3JpdGUoYidHRVQgLyBIVFRQLzEuMVxyXG4nKQogICAgICAgICAgICAgICAgdHNvY2sud3JpdGUoYidcclxuJykKICAgICAgICAgICAgICAgIHRzb2NrLndyaXRlKGInXHJcbicpCiAgICAgICAgICAgIGZpbmFsbHk6CiAgICAgICAgICAgICAgICByZWN2X3NvY2suY2xvc2UoKQogICAgICAgICAgICAgICAgc2VydmVyLmNsb3NlKCkKCiAgICBAY29ubmVjdGlvbl90aW1lb3V0KCkKICAgIGRlZiB0ZXN0X3Rsc19jbG9zZWRfY29ubmVjdGlvbl9yZWFkX2hhbmRzaGFrZShzZWxmKToKICAgICAgICBpcCA9IHNvY2tldC5nZXRob3N0YnluYW1lKCdiYWR0bHMuaW8nKQoKICAgICAgICAjIEJyZWFrIHRoZSBjb25uZWN0aW9uIGFmdGVyIHRoZSBTZXJ2ZXJIZWxsbyBpcyByZWNlaXZlZAogICAgICAgIGRlZiByZWN2X2NhbGxiYWNrKHNyYywgZGVzdCk6CiAgICAgICAgICAgIGRhdGEgPSBzcmMucmVjdig4MTkyKQogICAgICAgICAgICBmb3IgcmVjb3JkX3R5cGUsIHRsc192ZXJzaW9uLCBtZXNzYWdlIGluIHBhcnNlX3Rsc19yZWNvcmRzKGRhdGEpOgogICAgICAgICAgICAgICAgaWYgcmVjb3JkX3R5cGUgPT0gYidceDE2JzoKICAgICAgICAgICAgICAgICAgICBmb3IgbWVzc2FnZV90eXBlLCBwYXlsb2FkIGluIHBhcnNlX2hhbmRzaGFrZV9tZXNzYWdlcyhtZXNzYWdlKToKICAgICAgICAgICAgICAgICAgICAgICAgaWYgbWVzc2FnZV90eXBlID09IGInXHgwMic6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXN0LmNsb3NlKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBkZXN0LnNlbmQoZGF0YSkKCiAgICAgICAgd2l0aCBhc3NlcnRfZXhjZXB0aW9uKHNlbGYsIChlcnJvcnMuVExTRGlzY29ubmVjdEVycm9yLCBlcnJvcnMuVExTRXJyb3IpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVGhlIHJlbW90ZSBlbmQgY2xvc2VkIHRoZSBjb25uZWN0aW9ufFRMUyBoYW5kc2hha2UgZmFpbGVkJyk6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHNvY2ssIHNlbmRfc29jaywgcmVjdl9zb2NrLCBzZXJ2ZXIgPSBtYWtlX3NvY2tldF9wcm94eShpcCwgNDQzLCBOb25lLCByZWN2X2NhbGxiYWNrKQogICAgICAgICAgICAgICAgdGxzLlRMU1NvY2tldC53cmFwKHNvY2ssICdiYWR0bHMuaW8nKQogICAgICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICAgICAgcmVjdl9zb2NrLmNsb3NlKCkKICAgICAgICAgICAgICAgIHNlbmRfc29jay5jbG9zZSgpCiAgICAgICAgICAgICAgICBzZXJ2ZXIuY2xvc2UoKQoKICAgIEBjb25uZWN0aW9uX3RpbWVvdXQoKQogICAgZGVmIHRlc3RfdGxzX2Nsb3NlZF9jb25uZWN0aW9uX3dyaXRlX2hhbmRzaGFrZShzZWxmKToKICAgICAgICBpcCA9IHNvY2tldC5nZXRob3N0YnluYW1lKCdiYWR0bHMuaW8nKQoKICAgICAgICAjIEJyZWFrIHRoZSBjb25uZWN0aW9uIGFmdGVyIHRoZSBDbGllbnRIZWxsbyBpcyBzZW50CiAgICAgICAgZGVmIHNlbmRfY2FsbGJhY2soc3JjLCBkZXN0KToKICAgICAgICAgICAgZGF0YSA9IHNyYy5yZWN2KDgxOTIpCiAgICAgICAgICAgIGZvciByZWNvcmRfdHlwZSwgdGxzX3ZlcnNpb24sIG1lc3NhZ2UgaW4gcGFyc2VfdGxzX3JlY29yZHMoZGF0YSk6CiAgICAgICAgICAgICAgICBpZiByZWNvcmRfdHlwZSA9PSBiJ1x4MTYnOgogICAgICAgICAgICAgICAgICAgIGZvciBtZXNzYWdlX3R5cGUsIHBheWxvYWQgaW4gcGFyc2VfaGFuZHNoYWtlX21lc3NhZ2VzKG1lc3NhZ2UpOgogICAgICAgICAgICAgICAgICAgICAgICBpZiBtZXNzYWdlX3R5cGUgPT0gYidceDAxJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNyYy5jbG9zZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgZGVzdC5zZW5kKGRhdGEpCgogICAgICAgIHdpdGggYXNzZXJ0X2V4Y2VwdGlvbihzZWxmLCAoZXJyb3JzLlRMU0Rpc2Nvbm5lY3RFcnJvciwgZXJyb3JzLlRMU0Vycm9yKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1RoZSByZW1vdGUgZW5kIGNsb3NlZCB0aGUgY29ubmVjdGlvbnxUTFMgaGFuZHNoYWtlIGZhaWxlZCcpOgogICAgICAgICAgICByZWN2X3NvY2sgPSBOb25lCiAgICAgICAgICAgIHNlbmRfc29jayA9IE5vbmUKICAgICAgICAgICAgc2VydmVyID0gTm9uZQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBzb2NrLCBzZW5kX3NvY2ssIHJlY3Zfc29jaywgc2VydmVyID0gbWFrZV9zb2NrZXRfcHJveHkoaXAsIDQ0Mywgc2VuZF9jYWxsYmFjaykKICAgICAgICAgICAgICAgIHRscy5UTFNTb2NrZXQud3JhcChzb2NrLCAnYmFkdGxzLmlvJykKICAgICAgICAgICAgZmluYWxseToKICAgICAgICAgICAgICAgIGlmIHJlY3Zfc29jazoKICAgICAgICAgICAgICAgICAgICByZWN2X3NvY2suY2xvc2UoKQogICAgICAgICAgICAgICAgaWYgc2VuZF9zb2NrOgogICAgICAgICAgICAgICAgICAgIHNlbmRfc29jay5jbG9zZSgpCiAgICAgICAgICAgICAgICBpZiBzZXJ2ZXI6CiAgICAgICAgICAgICAgICAgICAgc2VydmVyLmNsb3NlKCkKCiAgICBAY29ubmVjdGlvbl90aW1lb3V0KCkKICAgIGRlZiB0ZXN0X3Rsc19jbG9zZWRfY29ubmVjdGlvbl9yZWFkX3NodXRkb3duKHNlbGYpOgogICAgICAgIGlwID0gc29ja2V0LmdldGhvc3RieW5hbWUoJ2JhZHRscy5pbycpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzb2NrLCBzZW5kX3NvY2ssIHJlY3Zfc29jaywgc2VydmVyID0gbWFrZV9zb2NrZXRfcHJveHkoaXAsIDQ0MykKICAgICAgICAgICAgdHNvY2sgPSBOb25lCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHRzb2NrID0gdGxzLlRMU1NvY2tldC53cmFwKHNvY2ssICdiYWR0bHMuaW8nKQogICAgICAgICAgICAgICAgc2VuZF9zb2NrLmNsb3NlKCkKICAgICAgICAgICAgICAgIHRzb2NrLnJlYWQoODE5MikKICAgICAgICAgICAgICAgIHNodXRkb3duID0gRmFsc2UKICAgICAgICAgICAgZXhjZXB0IChlcnJvcnMuVExTRXJyb3IpOgogICAgICAgICAgICAgICAgaWYgdHNvY2s6CiAgICAgICAgICAgICAgICAgICAgdHNvY2suc2h1dGRvd24oKQogICAgICAgICAgICAgICAgc2h1dGRvd24gPSBUcnVlCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoVHJ1ZSwgc2h1dGRvd24pCiAgICAgICAgZmluYWxseToKICAgICAgICAgICAgcmVjdl9zb2NrLmNsb3NlKCkKICAgICAgICAgICAgc2VydmVyLmNsb3NlKCkKCiAgICBAY29ubmVjdGlvbl90aW1lb3V0KCkKICAgIGRlZiB0ZXN0X3Rsc19jbG9zZWRfY29ubmVjdGlvbl93cml0ZV9zaHV0ZG93bihzZWxmKToKICAgICAgICBpcCA9IHNvY2tldC5nZXRob3N0YnluYW1lKCdiYWR0bHMuaW8nKQogICAgICAgIHRyeToKICAgICAgICAgICAgc29jaywgc2VuZF9zb2NrLCByZWN2X3NvY2ssIHNlcnZlciA9IG1ha2Vfc29ja2V0X3Byb3h5KGlwLCA0NDMpCiAgICAgICAgICAgIHRzb2NrID0gTm9uZQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICB0c29jayA9IHRscy5UTFNTb2NrZXQud3JhcChzb2NrLCAnYmFkdGxzLmlvJykKICAgICAgICAgICAgICAgIHNlbmRfc29jay5jbG9zZSgpCiAgICAgICAgICAgICAgICB0c29jay53cml0ZShiJ0dFVCAvIEhUVFAvMS4xXHJcbicpCiAgICAgICAgICAgICAgICB0c29jay53cml0ZShiJ1xyXG4nKQogICAgICAgICAgICAgICAgdHNvY2sud3JpdGUoYidcclxuJykKICAgICAgICAgICAgICAgIHRzb2NrLnJlYWQoODE5MikKICAgICAgICAgICAgICAgIHNodXRkb3duID0gRmFsc2UKICAgICAgICAgICAgZXhjZXB0IChlcnJvcnMuVExTRXJyb3IpOgogICAgICAgICAgICAgICAgaWYgdHNvY2s6CiAgICAgICAgICAgICAgICAgICAgdHNvY2suc2h1dGRvd24oKQogICAgICAgICAgICAgICAgc2h1dGRvd24gPSBUcnVlCiAgICAgICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoVHJ1ZSwgc2h1dGRvd24pCiAgICAgICAgZmluYWxseToKICAgICAgICAgICAgcmVjdl9zb2NrLmNsb3NlKCkKICAgICAgICAgICAgc2VydmVyLmNsb3NlKCkK
