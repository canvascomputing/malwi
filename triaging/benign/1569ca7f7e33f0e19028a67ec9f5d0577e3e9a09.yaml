statistics:
  total_files: 1
  skipped_files: 0.0
  processed_objects: 1
  malicious_objects: 0
details:
- path: .repo_cache/malicious_repos/pypi_malregistry/python-aliyun-sdk-core/2.13.36/python-aliyun-sdk-core-2.13.36/python-aliyun-sdk-core-2.13.36/aliyunsdkcore/endpoint/location_service_endpoint_resolver.py
  contents:
  - name: LocationServiceEndpointResolver.get_endpoint_key_from_request
    score: 0.0
    code: |-
      def get_endpoint_key_from_request(self, request):
              return self._make_endpoint_entry_key(
                  request.product_code, request.location_service_code,
                  request.region_id, request.endpoint_type
              )
    tokens: resume load_fast self load_attr STRING_LEN_S_ENT_HIGH load_fast request load_attr product_code load_fast request load_attr STRING_LEN_S_ENT_HIGH load_fast request load_attr region_id load_fast request load_attr endpoint_type call return_value
    hash: 70ee2d1bf728ef60d42a419083c76fac7c723fedcd608487f89fe86432772fc2
sources:
  ? .repo_cache/malicious_repos/pypi_malregistry/python-aliyun-sdk-core/2.13.36/python-aliyun-sdk-core-2.13.36/python-aliyun-sdk-core-2.13.36/aliyunsdkcore/endpoint/location_service_endpoint_resolver.py
  : IwojIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAoQVNGKSB1bmRlciBvbmUKIyBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKIyBkaXN0cmlidXRlZCB3aXRoIHNlbGYgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvbgojIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBsaWNlbnNlcyBzZWxmIGZpbGUKIyB0byB5b3UgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiMgIkxpY2Vuc2UiKTsgeW91IG1heSBub3QgdXNlIHNlbGYgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZQojIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKIwojICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKIwojIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywKIyBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbgojICJBUyBJUyIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQojIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZQojIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMKIyB1bmRlciB0aGUgTGljZW5zZS4KIwoKaW1wb3J0IHRocmVhZGluZwppbXBvcnQganNvbgoKZnJvbSBhbGl5dW5zZGtjb3JlLmFjc19leGNlcHRpb24uZXhjZXB0aW9ucyBpbXBvcnQgU2VydmVyRXhjZXB0aW9uCmZyb20gYWxpeXVuc2RrY29yZS5lbmRwb2ludC5lbmRwb2ludF9yZXNvbHZlcl9iYXNlIGltcG9ydCBFbmRwb2ludFJlc29sdmVyQmFzZQpmcm9tIGFsaXl1bnNka2NvcmUuZW5kcG9pbnQubG9jYXRpb24uRGVzY3JpYmVFbmRwb2ludHNSZXF1ZXN0IGltcG9ydCBEZXNjcmliZUVuZHBvaW50c1JlcXVlc3QKCkRFRkFVTFRfTE9DQVRJT05fU0VSVklDRV9FTkRQT0lOVCA9ICJsb2NhdGlvbi1yZWFkb25seS5hbGl5dW5jcy5jb20iCgoKY2xhc3MgTG9jYXRpb25TZXJ2aWNlRW5kcG9pbnRSZXNvbHZlcihFbmRwb2ludFJlc29sdmVyQmFzZSk6CgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGNsaWVudCk6CiAgICAgICAgRW5kcG9pbnRSZXNvbHZlckJhc2UuX19pbml0X18oc2VsZikKICAgICAgICBzZWxmLl9sb2NhdGlvbl9zZXJ2aWNlX2VuZHBvaW50ID0gREVGQVVMVF9MT0NBVElPTl9TRVJWSUNFX0VORFBPSU5UCiAgICAgICAgc2VsZi5fY2xpZW50ID0gY2xpZW50CiAgICAgICAgc2VsZi5faW52YWxpZF9wcm9kdWN0X2NvZGVzID0gc2V0KCkKICAgICAgICBzZWxmLl9pbnZhbGlkX3JlZ2lvbl9pZHMgPSBzZXQoKQogICAgICAgIHNlbGYuX3ZhbGlkX3Byb2R1Y3RfY29kZXMgPSBzZXQoKQogICAgICAgIHNlbGYuX3ZhbGlkX3JlZ2lvbl9pZHMgPSBzZXQoKQoKICAgIGRlZiBzZXRfbG9jYXRpb25fc2VydmljZV9lbmRwb2ludChzZWxmLCBlbmRwb2ludCk6CiAgICAgICAgc2VsZi5fbG9jYXRpb25fc2VydmljZV9lbmRwb2ludCA9IGVuZHBvaW50CgogICAgZGVmIHJlc29sdmUoc2VsZiwgcmVxdWVzdCk6CiAgICAgICAgaWYgbm90IHJlcXVlc3QubG9jYXRpb25fc2VydmljZV9jb2RlOgogICAgICAgICAgICByZXR1cm4gTm9uZQoKICAgICAgICBpZiByZXF1ZXN0LnByb2R1Y3RfY29kZV9sb3dlciBpbiBzZWxmLl9pbnZhbGlkX3Byb2R1Y3RfY29kZXM6CiAgICAgICAgICAgIHJldHVybiBOb25lCgogICAgICAgIGlmIHJlcXVlc3QucmVnaW9uX2lkIGluIHNlbGYuX2ludmFsaWRfcmVnaW9uX2lkczoKICAgICAgICAgICAgcmV0dXJuIE5vbmUKCiAgICAgICAga2V5ID0gc2VsZi5nZXRfZW5kcG9pbnRfa2V5X2Zyb21fcmVxdWVzdChyZXF1ZXN0KQogICAgICAgIGlmIGtleSBpbiBzZWxmLmVuZHBvaW50c19kYXRhOgogICAgICAgICAgICAjIFRoZSBlbmRwb2ludCBjYW4gYmUgTm9uZSB3aGVuIGxhc3QgZmV0Y2ggaXMgZmFpbGVkCiAgICAgICAgICAgIHJldHVybiBzZWxmLmVuZHBvaW50c19kYXRhW2tleV0KCiAgICAgICAgbG9jayA9IHRocmVhZGluZy5Mb2NrKCkKICAgICAgICB3aXRoIGxvY2s6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9nZXRfZW5kcG9pbnRfZnJvbV9sb2NhdGlvbl9zZXJ2aWNlKGtleSwgcmVxdWVzdCkKCiAgICBkZWYgX2dldF9lbmRwb2ludF9mcm9tX2xvY2F0aW9uX3NlcnZpY2Uoc2VsZiwga2V5LCByZXF1ZXN0KToKICAgICAgICAjIHdoZW4gb3RoZXIgdGhyZWFkCiAgICAgICAgaWYga2V5IGluIHNlbGYuZW5kcG9pbnRzX2RhdGE6CiAgICAgICAgICAgIHJldHVybiBzZWxmLmVuZHBvaW50c19kYXRhLmdldChrZXkpCgogICAgICAgIHNlbGYuX2NhbGxfbG9jYXRpb25fc2VydmljZShrZXksIHJlcXVlc3QpCgogICAgICAgIHJldHVybiBzZWxmLmVuZHBvaW50c19kYXRhLmdldChrZXkpCgogICAgZGVmIF9jYWxsX2xvY2F0aW9uX3NlcnZpY2Uoc2VsZiwga2V5LCByYXdfcmVxdWVzdCk6CiAgICAgICAgcmVxdWVzdCA9IERlc2NyaWJlRW5kcG9pbnRzUmVxdWVzdCgpCiAgICAgICAgcmVxdWVzdC5zZXRfcHJvdG9jb2xfdHlwZSgiaHR0cHMiKQogICAgICAgIHJlcXVlc3Quc2V0X2FjY2VwdF9mb3JtYXQoImpzb24iKQogICAgICAgIHJlcXVlc3Quc2V0X0lkKHJhd19yZXF1ZXN0LnJlZ2lvbl9pZCkKICAgICAgICByZXF1ZXN0LnNldF9TZXJ2aWNlQ29kZShyYXdfcmVxdWVzdC5sb2NhdGlvbl9zZXJ2aWNlX2NvZGUpCiAgICAgICAgcmVxdWVzdC5zZXRfVHlwZShyYXdfcmVxdWVzdC5lbmRwb2ludF90eXBlKQogICAgICAgIHJlcXVlc3QuZW5kcG9pbnQgPSBzZWxmLl9sb2NhdGlvbl9zZXJ2aWNlX2VuZHBvaW50CgogICAgICAgIHRyeToKICAgICAgICAgICAgcmVzcG9uc2UgPSBzZWxmLl9jbGllbnQuZG9fYWN0aW9uX3dpdGhfZXhjZXB0aW9uKHJlcXVlc3QpCiAgICAgICAgZXhjZXB0IFNlcnZlckV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBpZiAiSW52YWxpZFJlZ2lvbklkIiA9PSBlLmdldF9lcnJvcl9jb2RlKCkgYW5kIFwKICAgICAgICAgICAgICAgIlRoZSBzcGVjaWZpZWQgcmVnaW9uIGRvZXMgbm90IGV4aXN0LiIgPT0gZS5nZXRfZXJyb3JfbXNnKCk6CiAgICAgICAgICAgICAgICAjIE5vIHN1Y2ggcmVnaW9uYAogICAgICAgICAgICAgICAgc2VsZi5faW52YWxpZF9yZWdpb25faWRzLmFkZChyYXdfcmVxdWVzdC5yZWdpb25faWQpCiAgICAgICAgICAgICAgICBzZWxmLnB1dF9lbmRwb2ludF9lbnRyeShrZXksIE5vbmUpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgZWxpZiAiSWxsZWdhbCBQYXJhbWV0ZXIiID09IGUuZ2V0X2Vycm9yX2NvZGUoKSBhbmQgXAogICAgICAgICAgICAgICAgICJQbGVhc2UgY2hlY2sgdGhlIHBhcmFtZXRlcnMiID09IGUuZ2V0X2Vycm9yX21zZygpOgogICAgICAgICAgICAgICAgIyBObyBzdWNoIHByb2R1Y3QKICAgICAgICAgICAgICAgIHNlbGYuX2ludmFsaWRfcHJvZHVjdF9jb2Rlcy5hZGQocmF3X3JlcXVlc3QucHJvZHVjdF9jb2RlX2xvd2VyKQogICAgICAgICAgICAgICAgc2VsZi5wdXRfZW5kcG9pbnRfZW50cnkoa2V5LCBOb25lKQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZSBlCgogICAgICAgICMgQXMgbG9uZyBhcyBjb2RlIGdldHMgaGVyZQogICAgICAgICMgdGhlIHByb2R1Y3QgY29kZSBhbmQgdGhlIHJlZ2lvbiBpZCBpcyB2YWxpZAogICAgICAgICMgdGhlIGVuZHBvaW50IGNhbiBiZSBzdGlsbCBub3QgZm91bmQKICAgICAgICBzZWxmLl92YWxpZF9wcm9kdWN0X2NvZGVzLmFkZChyYXdfcmVxdWVzdC5wcm9kdWN0X2NvZGVfbG93ZXIpCiAgICAgICAgc2VsZi5fdmFsaWRfcmVnaW9uX2lkcy5hZGQocmF3X3JlcXVlc3QucmVnaW9uX2lkKQoKICAgICAgICBmb3VuZF9mbGFnID0gRmFsc2UKICAgICAgICBib2R5ID0ganNvbi5sb2FkcyhyZXNwb25zZS5kZWNvZGUoJ3V0Zi04JykpCiAgICAgICAgZm9yIGl0ZW0gaW4gYm9keVsiRW5kcG9pbnRzIl1bIkVuZHBvaW50Il06CgogICAgICAgICAgICAjIExvY2F0aW9uIHJldHVybiBkYXRhIGhhcyBhIHR5cG86IFNlcml2Y2VDb2RlCiAgICAgICAgICAgICMgV2Ugc3RpbGwgdHJ5IHRvIGV4cGVjdCBTZXJ2aWNlQ29kZSBpbiBjYXNlIHRoaXMgdHlwbyB3b3VsZCBiZSBmaXhlZCBpbiB0aGUgZnV0dXJlCiAgICAgICAgICAgIHNlcnZpY2VfY29kZSA9IGl0ZW0uZ2V0KCJTZXJ2aWNlQ29kZSIpIG9yIGl0ZW0uZ2V0KCJTZXJpdmNlQ29kZSIpCgogICAgICAgICAgICBpZiBzZXJ2aWNlX2NvZGUgYW5kIGl0ZW0uZ2V0KCJUeXBlIikgPT0gcmF3X3JlcXVlc3QuZW5kcG9pbnRfdHlwZToKICAgICAgICAgICAgICAgIGZvdW5kX2ZsYWcgPSBUcnVlCiAgICAgICAgICAgICAgICBzZWxmLnB1dF9lbmRwb2ludF9lbnRyeShrZXksIGl0ZW0uZ2V0KCJFbmRwb2ludCIpKQogICAgICAgICAgICAgICAgYnJlYWsKCiAgICAgICAgaWYgbm90IGZvdW5kX2ZsYWc6CiAgICAgICAgICAgIHNlbGYucHV0X2VuZHBvaW50X2VudHJ5KGtleSwgTm9uZSkKCiAgICBkZWYgaXNfcHJvZHVjdF9jb2RlX3ZhbGlkKHNlbGYsIHJlcXVlc3QpOgogICAgICAgIGlmIHJlcXVlc3QubG9jYXRpb25fc2VydmljZV9jb2RlOgogICAgICAgICAgICByZXR1cm4gcmVxdWVzdC5wcm9kdWN0X2NvZGVfbG93ZXIgbm90IGluIHNlbGYuX2ludmFsaWRfcHJvZHVjdF9jb2RlcwogICAgICAgIHJldHVybiBGYWxzZQoKICAgIGRlZiBpc19yZWdpb25faWRfdmFsaWQoc2VsZiwgcmVxdWVzdCk6CiAgICAgICAgcmV0dXJuIHNlbGYudmVyaWZ5X3JlZ2lvbl9pZChyZXF1ZXN0LnJlZ2lvbl9pZC5sb3dlcigpKQoKICAgIGRlZiBnZXRfZW5kcG9pbnRfa2V5X2Zyb21fcmVxdWVzdChzZWxmLCByZXF1ZXN0KToKICAgICAgICByZXR1cm4gc2VsZi5fbWFrZV9lbmRwb2ludF9lbnRyeV9rZXkoCiAgICAgICAgICAgIHJlcXVlc3QucHJvZHVjdF9jb2RlLCByZXF1ZXN0LmxvY2F0aW9uX3NlcnZpY2VfY29kZSwKICAgICAgICAgICAgcmVxdWVzdC5yZWdpb25faWQsIHJlcXVlc3QuZW5kcG9pbnRfdHlwZQogICAgICAgICkKCiAgICBkZWYgX21ha2VfZW5kcG9pbnRfZW50cnlfa2V5KHNlbGYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RfY29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25fc2VydmljZV9jb2RlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWdpb25faWQsIGVuZHBvaW50X3R5cGUpOgogICAgICAgIHJldHVybiAiLiIuam9pbihbCiAgICAgICAgICAgIHByb2R1Y3RfY29kZS5sb3dlcigpLAogICAgICAgICAgICBsb2NhdGlvbl9zZXJ2aWNlX2NvZGUsCiAgICAgICAgICAgIHJlZ2lvbl9pZC5sb3dlcigpLAogICAgICAgICAgICBlbmRwb2ludF90eXBlCiAgICAgICAgXSkK
