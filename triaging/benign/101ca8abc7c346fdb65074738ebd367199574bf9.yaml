statistics:
  total_files: 1
  skipped_files: 0.0
  processed_objects: 1
  malicious_objects: 0
details:
- path: .repo_cache/malicious_repos/pypi_malregistry/python-aliyun-sdk-core/2.13.36/python-aliyun-sdk-core-2.13.36/python-aliyun-sdk-core-2.13.36/aliyunsdkcore/vendored/requests/packages/urllib3/_collections.py
  contents:
  - name: HTTPHeaderDict
    score: 0.0
    code: |-
      def keys(self):
              with self.lock:
                  return list(iterkeys(self._container))
    tokens: make_cell __class__ resume load_name __name__ store_name __module__ load_const HTTPHeaderDict store_name __qualname__ load_const STRING_LEN_L_ENT_HIGH store_name __doc__ load_const load_closure __class__ build_tuple load_const OBJECT make_function defaults, closure store_name __init__ load_const OBJECT make_function store_name __setitem__ load_const OBJECT make_function store_name __getitem__ load_const OBJECT make_function store_name __delitem__ load_const OBJECT make_function store_name __contains__ load_const OBJECT make_function store_name __eq__ load_const OBJECT make_function store_name __ne__ load_name PY3 pop_jump_if_true TO_NUMBER load_name MutableMapping load_attr iterkeys store_name iterkeys load_name MutableMapping load_attr itervalues store_name itervalues push_null load_name object call store_name STRING_LEN_S_ENT_HIGH load_const OBJECT make_function store_name __len__ load_const OBJECT make_function store_name __iter__ load_name STRING_LEN_S_ENT_HIGH build_tuple load_const OBJECT make_function defaults store_name pop load_const OBJECT make_function store_name discard load_const OBJECT make_function store_name add load_const OBJECT make_function store_name extend load_name STRING_LEN_S_ENT_HIGH build_tuple load_const OBJECT make_function defaults store_name getlist load_name getlist store_name getheaders load_name getlist store_name STRING_LEN_S_ENT_HIGH load_name getlist store_name iget load_name getlist store_name get_all load_const OBJECT make_function store_name __repr__ load_const OBJECT make_function store_name _copy_from load_const OBJECT make_function store_name copy load_const OBJECT make_function store_name iteritems load_const OBJECT make_function store_name itermerged load_const OBJECT make_function store_name items load_name classmethod load_const OBJECT make_function call store_name from_httplib load_closure __class__ copy store_name __classcell__ return_value
    hash: bf97ac5becde1ff60ae6efdca1aed1d90699d5eb933815c6cb485ac9b9a1e883
sources:
  ? .repo_cache/malicious_repos/pypi_malregistry/python-aliyun-sdk-core/2.13.36/python-aliyun-sdk-core-2.13.36/python-aliyun-sdk-core-2.13.36/aliyunsdkcore/vendored/requests/packages/urllib3/_collections.py
  : ZnJvbSBfX2Z1dHVyZV9fIGltcG9ydCBhYnNvbHV0ZV9pbXBvcnQKdHJ5OgogICAgZnJvbSBjb2xsZWN0aW9ucy5hYmMgaW1wb3J0IE1hcHBpbmcsIE11dGFibGVNYXBwaW5nCmV4Y2VwdCBJbXBvcnRFcnJvcjoKICAgIGZyb20gY29sbGVjdGlvbnMgaW1wb3J0IE1hcHBpbmcsIE11dGFibGVNYXBwaW5nCnRyeToKICAgIGZyb20gdGhyZWFkaW5nIGltcG9ydCBSTG9jawpleGNlcHQgSW1wb3J0RXJyb3I6ICAjIFBsYXRmb3JtLXNwZWNpZmljOiBObyB0aHJlYWRzIGF2YWlsYWJsZQogICAgY2xhc3MgUkxvY2s6CiAgICAgICAgZGVmIF9fZW50ZXJfXyhzZWxmKToKICAgICAgICAgICAgcGFzcwoKICAgICAgICBkZWYgX19leGl0X18oc2VsZiwgZXhjX3R5cGUsIGV4Y192YWx1ZSwgdHJhY2ViYWNrKToKICAgICAgICAgICAgcGFzcwoKCnRyeTogICMgUHl0aG9uIDIuNysKICAgIGZyb20gY29sbGVjdGlvbnMgaW1wb3J0IE9yZGVyZWREaWN0CmV4Y2VwdCBJbXBvcnRFcnJvcjoKICAgIGZyb20gLnBhY2thZ2VzLm9yZGVyZWRfZGljdCBpbXBvcnQgT3JkZXJlZERpY3QKZnJvbSAuZXhjZXB0aW9ucyBpbXBvcnQgSW52YWxpZEhlYWRlcgpmcm9tIC5wYWNrYWdlcy5zaXggaW1wb3J0IGl0ZXJrZXlzLCBpdGVydmFsdWVzLCBQWTMKCgpfX2FsbF9fID0gWydSZWNlbnRseVVzZWRDb250YWluZXInLCAnSFRUUEhlYWRlckRpY3QnXQoKCl9OdWxsID0gb2JqZWN0KCkKCgpjbGFzcyBSZWNlbnRseVVzZWRDb250YWluZXIoTXV0YWJsZU1hcHBpbmcpOgogICAgIiIiCiAgICBQcm92aWRlcyBhIHRocmVhZC1zYWZlIGRpY3QtbGlrZSBjb250YWluZXIgd2hpY2ggbWFpbnRhaW5zIHVwIHRvCiAgICBgYG1heHNpemVgYCBrZXlzIHdoaWxlIHRocm93aW5nIGF3YXkgdGhlIGxlYXN0LXJlY2VudGx5LXVzZWQga2V5cyBiZXlvbmQKICAgIGBgbWF4c2l6ZWBgLgoKICAgIDpwYXJhbSBtYXhzaXplOgogICAgICAgIE1heGltdW0gbnVtYmVyIG9mIHJlY2VudCBlbGVtZW50cyB0byByZXRhaW4uCgogICAgOnBhcmFtIGRpc3Bvc2VfZnVuYzoKICAgICAgICBFdmVyeSB0aW1lIGFuIGl0ZW0gaXMgZXZpY3RlZCBmcm9tIHRoZSBjb250YWluZXIsCiAgICAgICAgYGBkaXNwb3NlX2Z1bmModmFsdWUpYGAgaXMgY2FsbGVkLiAgQ2FsbGJhY2sgd2hpY2ggd2lsbCBnZXQgY2FsbGVkCiAgICAiIiIKCiAgICBDb250YWluZXJDbHMgPSBPcmRlcmVkRGljdAoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBtYXhzaXplPTEwLCBkaXNwb3NlX2Z1bmM9Tm9uZSk6CiAgICAgICAgc2VsZi5fbWF4c2l6ZSA9IG1heHNpemUKICAgICAgICBzZWxmLmRpc3Bvc2VfZnVuYyA9IGRpc3Bvc2VfZnVuYwoKICAgICAgICBzZWxmLl9jb250YWluZXIgPSBzZWxmLkNvbnRhaW5lckNscygpCiAgICAgICAgc2VsZi5sb2NrID0gUkxvY2soKQoKICAgIGRlZiBfX2dldGl0ZW1fXyhzZWxmLCBrZXkpOgogICAgICAgICMgUmUtaW5zZXJ0IHRoZSBpdGVtLCBtb3ZpbmcgaXQgdG8gdGhlIGVuZCBvZiB0aGUgZXZpY3Rpb24gbGluZS4KICAgICAgICB3aXRoIHNlbGYubG9jazoKICAgICAgICAgICAgaXRlbSA9IHNlbGYuX2NvbnRhaW5lci5wb3Aoa2V5KQogICAgICAgICAgICBzZWxmLl9jb250YWluZXJba2V5XSA9IGl0ZW0KICAgICAgICAgICAgcmV0dXJuIGl0ZW0KCiAgICBkZWYgX19zZXRpdGVtX18oc2VsZiwga2V5LCB2YWx1ZSk6CiAgICAgICAgZXZpY3RlZF92YWx1ZSA9IF9OdWxsCiAgICAgICAgd2l0aCBzZWxmLmxvY2s6CiAgICAgICAgICAgICMgUG9zc2libHkgZXZpY3QgdGhlIGV4aXN0aW5nIHZhbHVlIG9mICdrZXknCiAgICAgICAgICAgIGV2aWN0ZWRfdmFsdWUgPSBzZWxmLl9jb250YWluZXIuZ2V0KGtleSwgX051bGwpCiAgICAgICAgICAgIHNlbGYuX2NvbnRhaW5lcltrZXldID0gdmFsdWUKCiAgICAgICAgICAgICMgSWYgd2UgZGlkbid0IGV2aWN0IGFuIGV4aXN0aW5nIHZhbHVlLCB3ZSBtaWdodCBoYXZlIHRvIGV2aWN0IHRoZQogICAgICAgICAgICAjIGxlYXN0IHJlY2VudGx5IHVzZWQgaXRlbSBmcm9tIHRoZSBiZWdpbm5pbmcgb2YgdGhlIGNvbnRhaW5lci4KICAgICAgICAgICAgaWYgbGVuKHNlbGYuX2NvbnRhaW5lcikgPiBzZWxmLl9tYXhzaXplOgogICAgICAgICAgICAgICAgX2tleSwgZXZpY3RlZF92YWx1ZSA9IHNlbGYuX2NvbnRhaW5lci5wb3BpdGVtKGxhc3Q9RmFsc2UpCgogICAgICAgIGlmIHNlbGYuZGlzcG9zZV9mdW5jIGFuZCBldmljdGVkX3ZhbHVlIGlzIG5vdCBfTnVsbDoKICAgICAgICAgICAgc2VsZi5kaXNwb3NlX2Z1bmMoZXZpY3RlZF92YWx1ZSkKCiAgICBkZWYgX19kZWxpdGVtX18oc2VsZiwga2V5KToKICAgICAgICB3aXRoIHNlbGYubG9jazoKICAgICAgICAgICAgdmFsdWUgPSBzZWxmLl9jb250YWluZXIucG9wKGtleSkKCiAgICAgICAgaWYgc2VsZi5kaXNwb3NlX2Z1bmM6CiAgICAgICAgICAgIHNlbGYuZGlzcG9zZV9mdW5jKHZhbHVlKQoKICAgIGRlZiBfX2xlbl9fKHNlbGYpOgogICAgICAgIHdpdGggc2VsZi5sb2NrOgogICAgICAgICAgICByZXR1cm4gbGVuKHNlbGYuX2NvbnRhaW5lcikKCiAgICBkZWYgX19pdGVyX18oc2VsZik6CiAgICAgICAgcmFpc2UgTm90SW1wbGVtZW50ZWRFcnJvcignSXRlcmF0aW9uIG92ZXIgdGhpcyBjbGFzcyBpcyB1bmxpa2VseSB0byBiZSB0aHJlYWRzYWZlLicpCgogICAgZGVmIGNsZWFyKHNlbGYpOgogICAgICAgIHdpdGggc2VsZi5sb2NrOgogICAgICAgICAgICAjIENvcHkgcG9pbnRlcnMgdG8gYWxsIHZhbHVlcywgdGhlbiB3aXBlIHRoZSBtYXBwaW5nCiAgICAgICAgICAgIHZhbHVlcyA9IGxpc3QoaXRlcnZhbHVlcyhzZWxmLl9jb250YWluZXIpKQogICAgICAgICAgICBzZWxmLl9jb250YWluZXIuY2xlYXIoKQoKICAgICAgICBpZiBzZWxmLmRpc3Bvc2VfZnVuYzoKICAgICAgICAgICAgZm9yIHZhbHVlIGluIHZhbHVlczoKICAgICAgICAgICAgICAgIHNlbGYuZGlzcG9zZV9mdW5jKHZhbHVlKQoKICAgIGRlZiBrZXlzKHNlbGYpOgogICAgICAgIHdpdGggc2VsZi5sb2NrOgogICAgICAgICAgICByZXR1cm4gbGlzdChpdGVya2V5cyhzZWxmLl9jb250YWluZXIpKQoKCmNsYXNzIEhUVFBIZWFkZXJEaWN0KE11dGFibGVNYXBwaW5nKToKICAgICIiIgogICAgOnBhcmFtIGhlYWRlcnM6CiAgICAgICAgQW4gaXRlcmFibGUgb2YgZmllbGQtdmFsdWUgcGFpcnMuIE11c3Qgbm90IGNvbnRhaW4gbXVsdGlwbGUgZmllbGQgbmFtZXMKICAgICAgICB3aGVuIGNvbXBhcmVkIGNhc2UtaW5zZW5zaXRpdmVseS4KCiAgICA6cGFyYW0ga3dhcmdzOgogICAgICAgIEFkZGl0aW9uYWwgZmllbGQtdmFsdWUgcGFpcnMgdG8gcGFzcyBpbiB0byBgYGRpY3QudXBkYXRlYGAuCgogICAgQSBgYGRpY3RgYCBsaWtlIGNvbnRhaW5lciBmb3Igc3RvcmluZyBIVFRQIEhlYWRlcnMuCgogICAgRmllbGQgbmFtZXMgYXJlIHN0b3JlZCBhbmQgY29tcGFyZWQgY2FzZS1pbnNlbnNpdGl2ZWx5IGluIGNvbXBsaWFuY2Ugd2l0aAogICAgUkZDIDcyMzAuIEl0ZXJhdGlvbiBwcm92aWRlcyB0aGUgZmlyc3QgY2FzZS1zZW5zaXRpdmUga2V5IHNlZW4gZm9yIGVhY2gKICAgIGNhc2UtaW5zZW5zaXRpdmUgcGFpci4KCiAgICBVc2luZyBgYF9fc2V0aXRlbV9fYGAgc3ludGF4IG92ZXJ3cml0ZXMgZmllbGRzIHRoYXQgY29tcGFyZSBlcXVhbAogICAgY2FzZS1pbnNlbnNpdGl2ZWx5IGluIG9yZGVyIHRvIG1haW50YWluIGBgZGljdGBgJ3MgYXBpLiBGb3IgZmllbGRzIHRoYXQKICAgIGNvbXBhcmUgZXF1YWwsIGluc3RlYWQgY3JlYXRlIGEgbmV3IGBgSFRUUEhlYWRlckRpY3RgYCBhbmQgdXNlIGBgLmFkZGBgCiAgICBpbiBhIGxvb3AuCgogICAgSWYgbXVsdGlwbGUgZmllbGRzIHRoYXQgYXJlIGVxdWFsIGNhc2UtaW5zZW5zaXRpdmVseSBhcmUgcGFzc2VkIHRvIHRoZQogICAgY29uc3RydWN0b3Igb3IgYGAudXBkYXRlYGAsIHRoZSBiZWhhdmlvciBpcyB1bmRlZmluZWQgYW5kIHNvbWUgd2lsbCBiZQogICAgbG9zdC4KCiAgICA+Pj4gaGVhZGVycyA9IEhUVFBIZWFkZXJEaWN0KCkKICAgID4+PiBoZWFkZXJzLmFkZCgnU2V0LUNvb2tpZScsICdmb289YmFyJykKICAgID4+PiBoZWFkZXJzLmFkZCgnc2V0LWNvb2tpZScsICdiYXo9cXV4eCcpCiAgICA+Pj4gaGVhZGVyc1snY29udGVudC1sZW5ndGgnXSA9ICc3JwogICAgPj4+IGhlYWRlcnNbJ1NFVC1jb29raWUnXQogICAgJ2Zvbz1iYXIsIGJhej1xdXh4JwogICAgPj4+IGhlYWRlcnNbJ0NvbnRlbnQtTGVuZ3RoJ10KICAgICc3JwogICAgIiIiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhlYWRlcnM9Tm9uZSwgKiprd2FyZ3MpOgogICAgICAgIHN1cGVyKEhUVFBIZWFkZXJEaWN0LCBzZWxmKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi5fY29udGFpbmVyID0gT3JkZXJlZERpY3QoKQogICAgICAgIGlmIGhlYWRlcnMgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UoaGVhZGVycywgSFRUUEhlYWRlckRpY3QpOgogICAgICAgICAgICAgICAgc2VsZi5fY29weV9mcm9tKGhlYWRlcnMpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLmV4dGVuZChoZWFkZXJzKQogICAgICAgIGlmIGt3YXJnczoKICAgICAgICAgICAgc2VsZi5leHRlbmQoa3dhcmdzKQoKICAgIGRlZiBfX3NldGl0ZW1fXyhzZWxmLCBrZXksIHZhbCk6CiAgICAgICAgc2VsZi5fY29udGFpbmVyW2tleS5sb3dlcigpXSA9IFtrZXksIHZhbF0KICAgICAgICByZXR1cm4gc2VsZi5fY29udGFpbmVyW2tleS5sb3dlcigpXQoKICAgIGRlZiBfX2dldGl0ZW1fXyhzZWxmLCBrZXkpOgogICAgICAgIHZhbCA9IHNlbGYuX2NvbnRhaW5lcltrZXkubG93ZXIoKV0KICAgICAgICByZXR1cm4gJywgJy5qb2luKHZhbFsxOl0pCgogICAgZGVmIF9fZGVsaXRlbV9fKHNlbGYsIGtleSk6CiAgICAgICAgZGVsIHNlbGYuX2NvbnRhaW5lcltrZXkubG93ZXIoKV0KCiAgICBkZWYgX19jb250YWluc19fKHNlbGYsIGtleSk6CiAgICAgICAgcmV0dXJuIGtleS5sb3dlcigpIGluIHNlbGYuX2NvbnRhaW5lcgoKICAgIGRlZiBfX2VxX18oc2VsZiwgb3RoZXIpOgogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCBNYXBwaW5nKSBhbmQgbm90IGhhc2F0dHIob3RoZXIsICdrZXlzJyk6CiAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKG90aGVyLCB0eXBlKHNlbGYpKToKICAgICAgICAgICAgb3RoZXIgPSB0eXBlKHNlbGYpKG90aGVyKQogICAgICAgIHJldHVybiAoZGljdCgoay5sb3dlcigpLCB2KSBmb3IgaywgdiBpbiBzZWxmLml0ZXJtZXJnZWQoKSkgPT0KICAgICAgICAgICAgICAgIGRpY3QoKGsubG93ZXIoKSwgdikgZm9yIGssIHYgaW4gb3RoZXIuaXRlcm1lcmdlZCgpKSkKCiAgICBkZWYgX19uZV9fKHNlbGYsIG90aGVyKToKICAgICAgICByZXR1cm4gbm90IHNlbGYuX19lcV9fKG90aGVyKQoKICAgIGlmIG5vdCBQWTM6ICAjIFB5dGhvbiAyCiAgICAgICAgaXRlcmtleXMgPSBNdXRhYmxlTWFwcGluZy5pdGVya2V5cwogICAgICAgIGl0ZXJ2YWx1ZXMgPSBNdXRhYmxlTWFwcGluZy5pdGVydmFsdWVzCgogICAgX19tYXJrZXIgPSBvYmplY3QoKQoKICAgIGRlZiBfX2xlbl9fKHNlbGYpOgogICAgICAgIHJldHVybiBsZW4oc2VsZi5fY29udGFpbmVyKQoKICAgIGRlZiBfX2l0ZXJfXyhzZWxmKToKICAgICAgICAjIE9ubHkgcHJvdmlkZSB0aGUgb3JpZ2luYWxseSBjYXNlZCBuYW1lcwogICAgICAgIGZvciB2YWxzIGluIHNlbGYuX2NvbnRhaW5lci52YWx1ZXMoKToKICAgICAgICAgICAgeWllbGQgdmFsc1swXQoKICAgIGRlZiBwb3Aoc2VsZiwga2V5LCBkZWZhdWx0PV9fbWFya2VyKToKICAgICAgICAnJydELnBvcChrWyxkXSkgLT4gdiwgcmVtb3ZlIHNwZWNpZmllZCBrZXkgYW5kIHJldHVybiB0aGUgY29ycmVzcG9uZGluZyB2YWx1ZS4KICAgICAgICAgIElmIGtleSBpcyBub3QgZm91bmQsIGQgaXMgcmV0dXJuZWQgaWYgZ2l2ZW4sIG90aGVyd2lzZSBLZXlFcnJvciBpcyByYWlzZWQuCiAgICAgICAgJycnCiAgICAgICAgIyBVc2luZyB0aGUgTXV0YWJsZU1hcHBpbmcgZnVuY3Rpb24gZGlyZWN0bHkgZmFpbHMgZHVlIHRvIHRoZSBwcml2YXRlIG1hcmtlci4KICAgICAgICAjIFVzaW5nIG9yZGluYXJ5IGRpY3QucG9wIHdvdWxkIGV4cG9zZSB0aGUgaW50ZXJuYWwgc3RydWN0dXJlcy4KICAgICAgICAjIFNvIGxldCdzIHJlaW52ZW50IHRoZSB3aGVlbC4KICAgICAgICB0cnk6CiAgICAgICAgICAgIHZhbHVlID0gc2VsZltrZXldCiAgICAgICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICAgICBpZiBkZWZhdWx0IGlzIHNlbGYuX19tYXJrZXI6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgICAgICByZXR1cm4gZGVmYXVsdAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGRlbCBzZWxmW2tleV0KICAgICAgICAgICAgcmV0dXJuIHZhbHVlCgogICAgZGVmIGRpc2NhcmQoc2VsZiwga2V5KToKICAgICAgICB0cnk6CiAgICAgICAgICAgIGRlbCBzZWxmW2tleV0KICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgIHBhc3MKCiAgICBkZWYgYWRkKHNlbGYsIGtleSwgdmFsKToKICAgICAgICAiIiJBZGRzIGEgKG5hbWUsIHZhbHVlKSBwYWlyLCBkb2Vzbid0IG92ZXJ3cml0ZSB0aGUgdmFsdWUgaWYgaXQgYWxyZWFkeQogICAgICAgIGV4aXN0cy4KCiAgICAgICAgPj4+IGhlYWRlcnMgPSBIVFRQSGVhZGVyRGljdChmb289J2JhcicpCiAgICAgICAgPj4+IGhlYWRlcnMuYWRkKCdGb28nLCAnYmF6JykKICAgICAgICA+Pj4gaGVhZGVyc1snZm9vJ10KICAgICAgICAnYmFyLCBiYXonCiAgICAgICAgIiIiCiAgICAgICAga2V5X2xvd2VyID0ga2V5Lmxvd2VyKCkKICAgICAgICBuZXdfdmFscyA9IFtrZXksIHZhbF0KICAgICAgICAjIEtlZXAgdGhlIGNvbW1vbiBjYXNlIGFrYSBubyBpdGVtIHByZXNlbnQgYXMgZmFzdCBhcyBwb3NzaWJsZQogICAgICAgIHZhbHMgPSBzZWxmLl9jb250YWluZXIuc2V0ZGVmYXVsdChrZXlfbG93ZXIsIG5ld192YWxzKQogICAgICAgIGlmIG5ld192YWxzIGlzIG5vdCB2YWxzOgogICAgICAgICAgICB2YWxzLmFwcGVuZCh2YWwpCgogICAgZGVmIGV4dGVuZChzZWxmLCAqYXJncywgKiprd2FyZ3MpOgogICAgICAgICIiIkdlbmVyaWMgaW1wb3J0IGZ1bmN0aW9uIGZvciBhbnkgdHlwZSBvZiBoZWFkZXItbGlrZSBvYmplY3QuCiAgICAgICAgQWRhcHRlZCB2ZXJzaW9uIG9mIE11dGFibGVNYXBwaW5nLnVwZGF0ZSBpbiBvcmRlciB0byBpbnNlcnQgaXRlbXMKICAgICAgICB3aXRoIHNlbGYuYWRkIGluc3RlYWQgb2Ygc2VsZi5fX3NldGl0ZW1fXwogICAgICAgICIiIgogICAgICAgIGlmIGxlbihhcmdzKSA+IDE6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigiZXh0ZW5kKCkgdGFrZXMgYXQgbW9zdCAxIHBvc2l0aW9uYWwgIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgImFyZ3VtZW50cyAoezB9IGdpdmVuKSIuZm9ybWF0KGxlbihhcmdzKSkpCiAgICAgICAgb3RoZXIgPSBhcmdzWzBdIGlmIGxlbihhcmdzKSA+PSAxIGVsc2UgKCkKCiAgICAgICAgaWYgaXNpbnN0YW5jZShvdGhlciwgSFRUUEhlYWRlckRpY3QpOgogICAgICAgICAgICBmb3Iga2V5LCB2YWwgaW4gb3RoZXIuaXRlcml0ZW1zKCk6CiAgICAgICAgICAgICAgICBzZWxmLmFkZChrZXksIHZhbCkKICAgICAgICBlbGlmIGlzaW5zdGFuY2Uob3RoZXIsIE1hcHBpbmcpOgogICAgICAgICAgICBmb3Iga2V5IGluIG90aGVyOgogICAgICAgICAgICAgICAgc2VsZi5hZGQoa2V5LCBvdGhlcltrZXldKQogICAgICAgIGVsaWYgaGFzYXR0cihvdGhlciwgImtleXMiKToKICAgICAgICAgICAgZm9yIGtleSBpbiBvdGhlci5rZXlzKCk6CiAgICAgICAgICAgICAgICBzZWxmLmFkZChrZXksIG90aGVyW2tleV0pCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZm9yIGtleSwgdmFsdWUgaW4gb3RoZXI6CiAgICAgICAgICAgICAgICBzZWxmLmFkZChrZXksIHZhbHVlKQoKICAgICAgICBmb3Iga2V5LCB2YWx1ZSBpbiBrd2FyZ3MuaXRlbXMoKToKICAgICAgICAgICAgc2VsZi5hZGQoa2V5LCB2YWx1ZSkKCiAgICBkZWYgZ2V0bGlzdChzZWxmLCBrZXksIGRlZmF1bHQ9X19tYXJrZXIpOgogICAgICAgICIiIlJldHVybnMgYSBsaXN0IG9mIGFsbCB0aGUgdmFsdWVzIGZvciB0aGUgbmFtZWQgZmllbGQuIFJldHVybnMgYW4KICAgICAgICBlbXB0eSBsaXN0IGlmIHRoZSBrZXkgZG9lc24ndCBleGlzdC4iIiIKICAgICAgICB0cnk6CiAgICAgICAgICAgIHZhbHMgPSBzZWxmLl9jb250YWluZXJba2V5Lmxvd2VyKCldCiAgICAgICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICAgICBpZiBkZWZhdWx0IGlzIHNlbGYuX19tYXJrZXI6CiAgICAgICAgICAgICAgICByZXR1cm4gW10KICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHQKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gdmFsc1sxOl0KCiAgICAjIEJhY2t3YXJkcyBjb21wYXRpYmlsaXR5IGZvciBodHRwbGliCiAgICBnZXRoZWFkZXJzID0gZ2V0bGlzdAogICAgZ2V0YWxsbWF0Y2hpbmdoZWFkZXJzID0gZ2V0bGlzdAogICAgaWdldCA9IGdldGxpc3QKCiAgICAjIEJhY2t3YXJkcyBjb21wYXRpYmlsaXR5IGZvciBodHRwLmNvb2tpZWphcgogICAgZ2V0X2FsbCA9IGdldGxpc3QKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgcmV0dXJuICIlcyglcykiICUgKHR5cGUoc2VsZikuX19uYW1lX18sIGRpY3Qoc2VsZi5pdGVybWVyZ2VkKCkpKQoKICAgIGRlZiBfY29weV9mcm9tKHNlbGYsIG90aGVyKToKICAgICAgICBmb3Iga2V5IGluIG90aGVyOgogICAgICAgICAgICB2YWwgPSBvdGhlci5nZXRsaXN0KGtleSkKICAgICAgICAgICAgaWYgaXNpbnN0YW5jZSh2YWwsIGxpc3QpOgogICAgICAgICAgICAgICAgIyBEb24ndCBuZWVkIHRvIGNvbnZlcnQgdHVwbGVzCiAgICAgICAgICAgICAgICB2YWwgPSBsaXN0KHZhbCkKICAgICAgICAgICAgc2VsZi5fY29udGFpbmVyW2tleS5sb3dlcigpXSA9IFtrZXldICsgdmFsCgogICAgZGVmIGNvcHkoc2VsZik6CiAgICAgICAgY2xvbmUgPSB0eXBlKHNlbGYpKCkKICAgICAgICBjbG9uZS5fY29weV9mcm9tKHNlbGYpCiAgICAgICAgcmV0dXJuIGNsb25lCgogICAgZGVmIGl0ZXJpdGVtcyhzZWxmKToKICAgICAgICAiIiJJdGVyYXRlIG92ZXIgYWxsIGhlYWRlciBsaW5lcywgaW5jbHVkaW5nIGR1cGxpY2F0ZSBvbmVzLiIiIgogICAgICAgIGZvciBrZXkgaW4gc2VsZjoKICAgICAgICAgICAgdmFscyA9IHNlbGYuX2NvbnRhaW5lcltrZXkubG93ZXIoKV0KICAgICAgICAgICAgZm9yIHZhbCBpbiB2YWxzWzE6XToKICAgICAgICAgICAgICAgIHlpZWxkIHZhbHNbMF0sIHZhbAoKICAgIGRlZiBpdGVybWVyZ2VkKHNlbGYpOgogICAgICAgICIiIkl0ZXJhdGUgb3ZlciBhbGwgaGVhZGVycywgbWVyZ2luZyBkdXBsaWNhdGUgb25lcyB0b2dldGhlci4iIiIKICAgICAgICBmb3Iga2V5IGluIHNlbGY6CiAgICAgICAgICAgIHZhbCA9IHNlbGYuX2NvbnRhaW5lcltrZXkubG93ZXIoKV0KICAgICAgICAgICAgeWllbGQgdmFsWzBdLCAnLCAnLmpvaW4odmFsWzE6XSkKCiAgICBkZWYgaXRlbXMoc2VsZik6CiAgICAgICAgcmV0dXJuIGxpc3Qoc2VsZi5pdGVyaXRlbXMoKSkKCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBmcm9tX2h0dHBsaWIoY2xzLCBtZXNzYWdlKTogICMgUHl0aG9uIDIKICAgICAgICAiIiJSZWFkIGhlYWRlcnMgZnJvbSBhIFB5dGhvbiAyIGh0dHBsaWIgbWVzc2FnZSBvYmplY3QuIiIiCiAgICAgICAgIyBweXRob24yLjcgZG9lcyBub3QgZXhwb3NlIGEgcHJvcGVyIEFQSSBmb3IgZXhwb3J0aW5nIG11bHRpaGVhZGVycwogICAgICAgICMgZWZmaWNpZW50bHkuIFRoaXMgZnVuY3Rpb24gcmUtcmVhZHMgcmF3IGxpbmVzIGZyb20gdGhlIG1lc3NhZ2UKICAgICAgICAjIG9iamVjdCBhbmQgZXh0cmFjdHMgdGhlIG11bHRpaGVhZGVycyBwcm9wZXJseS4KICAgICAgICBvYnNfZm9sZF9jb250aW51ZWRfbGVhZGVycyA9ICgnICcsICdcdCcpCiAgICAgICAgaGVhZGVycyA9IFtdCgogICAgICAgIGZvciBsaW5lIGluIG1lc3NhZ2UuaGVhZGVyczoKICAgICAgICAgICAgaWYgbGluZS5zdGFydHN3aXRoKG9ic19mb2xkX2NvbnRpbnVlZF9sZWFkZXJzKToKICAgICAgICAgICAgICAgIGlmIG5vdCBoZWFkZXJzOgogICAgICAgICAgICAgICAgICAgICMgV2UgcmVjZWl2ZWQgYSBoZWFkZXIgbGluZSB0aGF0IHN0YXJ0cyB3aXRoIE9XUyBhcyBkZXNjcmliZWQKICAgICAgICAgICAgICAgICAgICAjIGluIFJGQy03MjMwIFMzLjIuNC4gVGhpcyBpbmRpY2F0ZXMgYSBtdWx0aWxpbmUgaGVhZGVyLCBidXQKICAgICAgICAgICAgICAgICAgICAjIHRoZXJlIGV4aXN0cyBubyBwcmV2aW91cyBoZWFkZXIgdG8gd2hpY2ggd2UgY2FuIGF0dGFjaCBpdC4KICAgICAgICAgICAgICAgICAgICByYWlzZSBJbnZhbGlkSGVhZGVyKAogICAgICAgICAgICAgICAgICAgICAgICAnSGVhZGVyIGNvbnRpbnVhdGlvbiB3aXRoIG5vIHByZXZpb3VzIGhlYWRlcjogJXMnICUgbGluZQogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAga2V5LCB2YWx1ZSA9IGhlYWRlcnNbLTFdCiAgICAgICAgICAgICAgICAgICAgaGVhZGVyc1stMV0gPSAoa2V5LCB2YWx1ZSArICcgJyArIGxpbmUuc3RyaXAoKSkKICAgICAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAgICAga2V5LCB2YWx1ZSA9IGxpbmUuc3BsaXQoJzonLCAxKQogICAgICAgICAgICBoZWFkZXJzLmFwcGVuZCgoa2V5LCB2YWx1ZS5zdHJpcCgpKSkKCiAgICAgICAgcmV0dXJuIGNscyhoZWFkZXJzKQo=
