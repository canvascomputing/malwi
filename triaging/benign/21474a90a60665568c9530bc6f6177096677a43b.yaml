statistics:
  total_files: 1
  skipped_files: 0.0
  processed_objects: 1
  malicious_objects: 0
details:
- path: .repo_cache/malicious_repos/pypi_malregistry/typesutil/1.9.4/typesutil-1.9.4/typesutil-1.9.4/typesutil/western.py
  contents:
  - name: WesternTimeDelta.days
    score: 0.0
    code: |-
      @property
          def days(self):
              return self._days
    tokens: resume load_fast self load_attr _days return_value
    hash: aace2645c1a84a752c26fd0992c29e9a1cb57777ed0e5fad5e386fc92b5df092
sources:
  .repo_cache/malicious_repos/pypi_malregistry/typesutil/1.9.4/typesutil-1.9.4/typesutil-1.9.4/typesutil/western.py: IyBHcmVnb3JpYW4gY2FsZW5kYXIgaW4gY2FsZW5kYXJzIHBhY2thZ2UKCiMgQ29weXJpZ2h0IChjKSAyMDEyLTIwMjIgRnJhbmNlc2NvIFJpY2NpYXJkaQojCiMgQWxsIHJpZ2h0cyByZXNlcnZlZC4KIwojIFJlZGlzdHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNlIGFuZCBiaW5hcnkgZm9ybXMsIHdpdGggb3Igd2l0aG91dAojIG1vZGlmaWNhdGlvbiwgYXJlIHBlcm1pdHRlZCBwcm92aWRlZCB0aGF0IHRoZSBmb2xsb3dpbmcgY29uZGl0aW9ucyBhcmUgbWV0OgojCiMgKiBSZWRpc3RyaWJ1dGlvbnMgb2Ygc291cmNlIGNvZGUgbXVzdCByZXRhaW4gdGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UsCiMgICB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyLgojICogUmVkaXN0cmlidXRpb25zIGluIGJpbmFyeSBmb3JtIG11c3QgcmVwcm9kdWNlIHRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlLAojICAgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lciBpbiB0aGUgZG9jdW1lbnRhdGlvbgojICAgYW5kL29yIG90aGVyIG1hdGVyaWFscyBwcm92aWRlZCB3aXRoIHRoZSBkaXN0cmlidXRpb24uCiMgKiBOZWl0aGVyIHRoZSBuYW1lKHMpIG9mIHRoZSBjb3B5cmlnaHQgaG9sZGVycyBub3IgdGhlIG5hbWVzIG9mIGl0cwojICAgY29udHJpYnV0b3JzIG1heSBiZSB1c2VkIHRvIGVuZG9yc2Ugb3IgcHJvbW90ZSBwcm9kdWN0cyBkZXJpdmVkIGZyb20gdGhpcwojICAgc29mdHdhcmUgd2l0aG91dCBzcGVjaWZpYyBwcmlvciB3cml0dGVuIHBlcm1pc3Npb24uCiMKIyBUSElTIFNPRlRXQVJFIElTIFBST1ZJREVEIEJZIFRIRSBDT1BZUklHSFQgSE9MREVSUyBBUyBJUyBBTkQgQU5ZIEVYUFJFU1MgT1IKIyBJTVBMSUVEIFdBUlJBTlRJRVMsIElOQ0xVRElORywgQlVUIE5PVCBMSU1JVEVEIFRPLCBUSEUgSU1QTElFRCBXQVJSQU5USUVTIE9GCiMgTUVSQ0hBTlRBQklMSVRZIEFORCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBUkUgRElTQ0xBSU1FRC4gSU4gTk8KIyBFVkVOVCBTSEFMTCBUSEUgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgRElSRUNULCBJTkRJUkVDVCwKIyBJTkNJREVOVEFMLCBTUEVDSUFMLCBFWEVNUExBUlksIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyAoSU5DTFVESU5HLCBCVVQgTk9UCiMgTElNSVRFRCBUTywgUFJPQ1VSRU1FTlQgT0YgU1VCU1RJVFVURSBHT09EUyBPUiBTRVJWSUNFUzsgTE9TUyBPRiBVU0UsIERBVEEsCiMgT1IgUFJPRklUUzsgT1IgQlVTSU5FU1MgSU5URVJSVVBUSU9OKSBIT1dFVkVSIENBVVNFRCBBTkQgT04gQU5ZIFRIRU9SWSBPRgojIExJQUJJTElUWSwgV0hFVEhFUiBJTiBDT05UUkFDVCwgU1RSSUNUIExJQUJJTElUWSwgT1IgVE9SVCAoSU5DTFVESU5HCiMgTkVHTElHRU5DRSBPUiBPVEhFUldJU0UpIEFSSVNJTkcgSU4gQU5ZIFdBWSBPVVQgT0YgVEhFIFVTRSBPRiBUSElTIFNPRlRXQVJFLAojIEVWRU4gSUYgQURWSVNFRCBPRiBUSEUgUE9TU0lCSUxJVFkgT0YgU1VDSCBEQU1BR0UuCgpfX2F1dGhvcl9fID0gIkZyYW5jZXNjbyBSaWNjaWFyZGkgPGZyYW5jZXNjb3IyMDEwIGF0IHlhaG9vLml0PiIKCgppbXBvcnQgYmlzZWN0CmZyb20gZnJhY3Rpb25zIGltcG9ydCBGcmFjdGlvbgoKZnJvbSAuY29tbW9uIGltcG9ydCB2ZXJpZnlfZnJhY3Rpb25hbF92YWx1ZQoKCl9kYXlzX2luX21vbnRoID0gWwogICAgWzMxLCAyOCwgMzEsIDMwLCAzMSwgMzAsIDMxLCAzMSwgMzAsIDMxLCAzMCwgMzFdLAogICAgWzMxLCAyOSwgMzEsIDMwLCAzMSwgMzAsIDMxLCAzMSwgMzAsIDMxLCAzMCwgMzFdLApdCgpfZGF5c19pbl9wcmV2aW91c19tb250aHMgPSBbCiAgICBbc3VtKF9kYXlzX2luX21vbnRoW2xlYXBfeWVhcl1bOm1vbnRoXSkgZm9yIG1vbnRoIGluIHJhbmdlKDEyKV0KICAgIGZvciBsZWFwX3llYXIgaW4gKDAsIDEpCl0KCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyBHcmVnb3JpYW4gY2FsZW5kYXIKIwpjbGFzcyBHcmVnb3JpYW5DYWxlbmRhcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB5ZWFyLCBtb250aCwgZGF5KToKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZSh5ZWFyLCBpbnQpIG9yIG5vdCBpc2luc3RhbmNlKG1vbnRoLCBpbnQpIG9yIG5vdCBpc2luc3RhbmNlKGRheSwgaW50KToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJpbnRlZ2VyIGFyZ3VtZW50IGV4cGVjdGVkIikKICAgICAgICBpZiBtb250aCA8IDEgb3IgbW9udGggPiAxMjoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcihmIk1vbnRoIG11c3QgYmUgYmV0d2VlbiAxIGFuZCAxMiwgd2hpbGUgaXQgaXMge21vbnRofS4iKQogICAgICAgIGlmIGRheSA8IDEgb3IgZGF5ID4gX2RheXNfaW5fbW9udGhbR3JlZ29yaWFuQ2FsZW5kYXIuaXNfbGVhcF95ZWFyKHllYXIpXVttb250aCAtIDFdOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKGYiRGF5IG11c3QgYmUgYmV0d2VlbiAxIGFuZCBudW1iZXIgb2YgZGF5cyBpbiBtb250aCwgd2hpbGUgaXQgaXMge2RheX0uIikKICAgICAgICBzZWxmLl95ZWFyID0geWVhcgogICAgICAgIHNlbGYuX21vbnRoID0gbW9udGgKICAgICAgICBzZWxmLl9kYXkgPSBkYXkKICAgICAgICBzZWxmLl9yYXRhX2RpZSA9IE5vbmUKCiAgICBAcHJvcGVydHkKICAgIGRlZiB5ZWFyKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLl95ZWFyCgogICAgQHByb3BlcnR5CiAgICBkZWYgbW9udGgoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuX21vbnRoCgogICAgQHByb3BlcnR5CiAgICBkZWYgZGF5KHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLl9kYXkKCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiB5ZWFyX2RheShjbHMsIHllYXIsIGRheSk6CiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UoeWVhciwgaW50KSBvciBub3QgaXNpbnN0YW5jZShkYXksIGludCk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigiaW50ZWdlciBhcmd1bWVudCBleHBlY3RlZCIpCiAgICAgICAgaWYgZGF5IDwgMSBvciBkYXkgPiAoMzY2IGlmIEdyZWdvcmlhbkNhbGVuZGFyLmlzX2xlYXBfeWVhcih5ZWFyKSBlbHNlIDM2NSk6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoZiJEYXkgbXVzdCBiZSBiZXR3ZWVuIDEgYW5kIG51bWJlciBvZiBkYXlzIGluIHllYXIsIHdoaWxlIGl0IGlzIHtkYXl9LiIpCiAgICAgICAgbW9udGggPSBiaXNlY3QuYmlzZWN0X2xlZnQoX2RheXNfaW5fcHJldmlvdXNfbW9udGhzW0dyZWdvcmlhbkNhbGVuZGFyLmlzX2xlYXBfeWVhcih5ZWFyKV0sIGRheSkKICAgICAgICBkYXlfaW5fbW9udGggPSAoZGF5IC0gX2RheXNfaW5fcHJldmlvdXNfbW9udGhzW0dyZWdvcmlhbkNhbGVuZGFyLmlzX2xlYXBfeWVhcih5ZWFyKV1bbW9udGggLSAxXSkKICAgICAgICByZXR1cm4gY2xzKHllYXIsIG1vbnRoLCBkYXlfaW5fbW9udGgpCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgZnJvbV9yYXRhX2RpZShjbHMsIGRheV9jb3VudCk6CiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UoZGF5X2NvdW50LCBpbnQpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoImludGVnZXIgYXJndW1lbnQgZXhwZWN0ZWQiKQogICAgICAgIHk0MDAsIGQ0MDAgPSBkaXZtb2QoZGF5X2NvdW50IC0gMSwgMTQ2MDk3KQogICAgICAgIHkxMDAsIGQxMDAgPSBkaXZtb2QoZDQwMCwgMzY1MjQpCiAgICAgICAgeTQsIGQ0ID0gZGl2bW9kKGQxMDAsIDE0NjEpCiAgICAgICAgeTEgPSBkNCAvLyAzNjUKICAgICAgICB5ZWFyX21pbnVzX29uZSA9ICg0MDAgKiB5NDAwICsgMTAwICogeTEwMCArIDQgKiB5NCArIHkxIC0gKDEgaWYgKHkxMDAgPT0gNCBvciB5MSA9PSA0KSBlbHNlIDApKQogICAgICAgIGRheXMgPSAoZGF5X2NvdW50IC0gMzY1ICogeWVhcl9taW51c19vbmUgLSB5ZWFyX21pbnVzX29uZSAvLyA0ICsgeWVhcl9taW51c19vbmUgLy8gMTAwIC0geWVhcl9taW51c19vbmUgLy8gNDAwKSAgIyBkYXlzIGZyb20gamFudWFyeSAxc3QgKGluY2x1ZGVkKSB0byB0b2RheQogICAgICAgIGdyZWdfZGF5ID0gY2xzLnllYXJfZGF5KHllYXJfbWludXNfb25lICsgMSwgZGF5cykKICAgICAgICBncmVnX2RheS5fcmF0YV9kaWUgPSBkYXlfY291bnQKICAgICAgICByZXR1cm4gZ3JlZ19kYXkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgaXNfbGVhcF95ZWFyKHllYXIpOgogICAgICAgIHJldHVybiAoeWVhciAlIDQgPT0gMCkgYW5kICh5ZWFyICUgNDAwIG5vdCBpbiAoMTAwLCAyMDAsIDMwMCkpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGRheXNfaW5feWVhcih5ZWFyKToKICAgICAgICByZXR1cm4gMzY1IGlmIG5vdCBHcmVnb3JpYW5DYWxlbmRhci5pc19sZWFwX3llYXIoeWVhcikgZWxzZSAzNjYKCiAgICBkZWYgdG9fcmF0YV9kaWUoc2VsZik6CiAgICAgICAgaWYgc2VsZi5fcmF0YV9kaWUgaXMgTm9uZToKICAgICAgICAgICAgc2VsZi5fcmF0YV9kaWUgPSAoMzY1ICogKHNlbGYuX3llYXIgLSAxKQogICAgICAgICAgICAgICAgKyAoc2VsZi5feWVhciAtIDEpIC8vIDQKICAgICAgICAgICAgICAgIC0gKHNlbGYuX3llYXIgLSAxKSAvLyAxMDAKICAgICAgICAgICAgICAgICsgKHNlbGYuX3llYXIgLSAxKSAvLyA0MDAKICAgICAgICAgICAgICAgICsgKDM2NyAqIHNlbGYuX21vbnRoIC0gMzYyKSAvLyAxMgogICAgICAgICAgICAgICAgKyAoKC0xIGlmIEdyZWdvcmlhbkNhbGVuZGFyLmlzX2xlYXBfeWVhcihzZWxmLl95ZWFyKSBlbHNlIC0yKSBpZiBzZWxmLl9tb250aCA+IDIgZWxzZSAwKQogICAgICAgICAgICAgICAgKyBzZWxmLl9kYXkpCiAgICAgICAgcmV0dXJuIHNlbGYuX3JhdGFfZGllCgogICAgZGVmIHdlZWtkYXkoc2VsZik6CiAgICAgICAgcmV0dXJuIChzZWxmLnRvX3JhdGFfZGllKCkgLSAxKSAlIDcgKyAxCgogICAgZGVmIGRheV9vZl95ZWFyKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLnRvX3JhdGFfZGllKCkgLSAoMzY1ICogKHNlbGYuX3llYXIgLSAxKSArIChzZWxmLl95ZWFyIC0gMSkgLy8gNAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLSAoc2VsZi5feWVhciAtIDEpIC8vIDEwMCArIChzZWxmLl95ZWFyIC0gMSkgLy8gNDAwKQoKICAgIGRlZiByZXBsYWNlKHNlbGYsICosIHllYXI9Tm9uZSwgbW9udGg9Tm9uZSwgZGF5PU5vbmUpOgogICAgICAgIGlmIHllYXIgaXMgTm9uZToKICAgICAgICAgICAgeWVhciA9IHNlbGYueWVhcgogICAgICAgIGlmIG1vbnRoIGlzIE5vbmU6CiAgICAgICAgICAgIG1vbnRoID0gc2VsZi5tb250aAogICAgICAgIGlmIGRheSBpcyBOb25lOgogICAgICAgICAgICBkYXkgPSBzZWxmLmRheQogICAgICAgIHJldHVybiB0eXBlKHNlbGYpKHllYXIsIG1vbnRoLCBkYXkpCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBmInR5cGVzdXRpbC53ZXN0ZXJuLnt0eXBlKHNlbGYpLl9fbmFtZV9ffSh7c2VsZi55ZWFyfSwge3NlbGYubW9udGh9LCB7c2VsZi5kYXl9KSIKCiAgICBkZWYgX19zdHJfXyhzZWxmKToKICAgICAgICBpZiBzZWxmLnllYXIgPj0gMDoKICAgICAgICAgICAgcmV0dXJuIGYie3NlbGYueWVhcjowNGR9LXtzZWxmLm1vbnRoOjAyZH0te3NlbGYuZGF5OjAyZH0iCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIGYie3NlbGYueWVhcjowNWR9LXtzZWxmLm1vbnRoOjAyZH0te3NlbGYuZGF5OjAyZH0iCgogICAgbmFtZV93ZWVrZGF5cyA9IFsKICAgICAgICAiTW9uZGF5IiwKICAgICAgICAiVHVlc2RheSIsCiAgICAgICAgIldlZG5lc2RheSIsCiAgICAgICAgIlRodXJzZGF5IiwKICAgICAgICAiRnJpZGF5IiwKICAgICAgICAiU2F0dXJkYXkiLAogICAgICAgICJTdW5kYXkiLAogICAgXQogICAgbmFtZV9tb250aHMgPSBbCiAgICAgICAgIkphbnVhcnkiLAogICAgICAgICJGZWJydWFyeSIsCiAgICAgICAgIk1hcmNoIiwKICAgICAgICAiQXByaWwiLAogICAgICAgICJNYXkiLAogICAgICAgICJKdW5lIiwKICAgICAgICAiSnVseSIsCiAgICAgICAgIkF1Z3VzdCIsCiAgICAgICAgIlNlcHRlbWJlciIsCiAgICAgICAgIk9jdG9iZXIiLAogICAgICAgICJOb3ZlbWJlciIsCiAgICAgICAgIkRlY2VtYmVyIiwKICAgIF0KCiAgICBmb3JtYXRfZnVuY3Rpb25zID0gewogICAgICAgICJhIjogbGFtYmRhIHNlbGY6IEdyZWdvcmlhbkNhbGVuZGFyLm5hbWVfd2Vla2RheXNbc2VsZi53ZWVrZGF5KCkgLSAxXVs6M10sCiAgICAgICAgIkEiOiBsYW1iZGEgc2VsZjogR3JlZ29yaWFuQ2FsZW5kYXIubmFtZV93ZWVrZGF5c1tzZWxmLndlZWtkYXkoKSAtIDFdLAogICAgICAgICJiIjogbGFtYmRhIHNlbGY6IEdyZWdvcmlhbkNhbGVuZGFyLm5hbWVfbW9udGhzW3NlbGYubW9udGggLSAxXVs6M10sCiAgICAgICAgIkIiOiBsYW1iZGEgc2VsZjogR3JlZ29yaWFuQ2FsZW5kYXIubmFtZV9tb250aHNbc2VsZi5tb250aCAtIDFdLAogICAgICAgICJkIjogbGFtYmRhIHNlbGY6IGYie3NlbGYuZGF5OjAyZH0iLAogICAgICAgICJtIjogbGFtYmRhIHNlbGY6IGYie3NlbGYubW9udGg6MDJkfSIsCiAgICAgICAgImoiOiBsYW1iZGEgc2VsZjogZiJ7c2VsZi5kYXlfb2ZfeWVhcigpOjAzZH0iLAogICAgICAgICJVIjogbGFtYmRhIHNlbGY6IGYieyhzZWxmLmRheV9vZl95ZWFyKCkgKyAoMTMgLSBzZWxmLndlZWtkYXkoKSkgJSA3KSAvLyA3OjAyZH0iLAogICAgICAgICJ3IjogbGFtYmRhIHNlbGY6IGYie3NlbGYud2Vla2RheSgpOjFkfSIsCiAgICAgICAgIlciOiBsYW1iZGEgc2VsZjogZiJ7KHNlbGYuZGF5X29mX3llYXIoKSArIDcgLSBzZWxmLndlZWtkYXkoKSkgLy8gNzowMmR9IiwKICAgICAgICAieSI6IGxhbWJkYSBzZWxmOiBmIntzZWxmLnllYXI6MDNkfSJbLTI6XSwKICAgICAgICAiWSI6IGxhbWJkYSBzZWxmOiBmIntzZWxmLnllYXI6MDRkfSIgaWYgc2VsZi55ZWFyID49IDAgZWxzZSBmIi17LXNlbGYueWVhcjowNGR9IiwKICAgIH0KCiAgICBkZWYgY2Zvcm1hdChzZWxmLCBmb3JtYXRfc3RyaW5nKToKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShmb3JtYXRfc3RyaW5nLCBzdHIpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoIkZvcm1hdCBtdXN0IGJlIHNwZWNpZmllZCB3aXRoIHN0cmluZy4iKQogICAgICAgIG91dHB1dF9waWVjZXMgPSBbXQogICAgICAgIGZvciBmb3JtYXRfY2h1bmsgaW4gZm9ybWF0X3N0cmluZy5zcGxpdCgiJSUiKToKICAgICAgICAgICAgZm9ybWF0X3BhcnRzID0gZm9ybWF0X2NodW5rLnNwbGl0KCIlIikKICAgICAgICAgICAgY2h1bmtfcGllY2VzID0gW2Zvcm1hdF9wYXJ0c1swXV0KICAgICAgICAgICAgZm9yIHBhcnQgaW4gZm9ybWF0X3BhcnRzWzE6XToKICAgICAgICAgICAgICAgIGlmIHBhcnQgPT0gIiI6ICAjIHNwZWNpYWwgY2FzZTogbGFzdCBjaGFyIGlzICclJwogICAgICAgICAgICAgICAgICAgIHZhbHVlID0gIiUiCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBzZWxmLmZvcm1hdF9mdW5jdGlvbnNbcGFydFswXV0oc2VsZikKICAgICAgICAgICAgICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gIiUiICsgcGFydFswXQogICAgICAgICAgICAgICAgY2h1bmtfcGllY2VzLmFwcGVuZCh2YWx1ZSkKICAgICAgICAgICAgICAgIGNodW5rX3BpZWNlcy5hcHBlbmQocGFydFsxOl0pCiAgICAgICAgICAgIG91dHB1dF9waWVjZXMuYXBwZW5kKCIiLmpvaW4oY2h1bmtfcGllY2VzKSkKICAgICAgICByZXR1cm4gIiUiLmpvaW4ob3V0cHV0X3BpZWNlcykKCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyBXZXN0ZXJuIHRpbWUgcmVwcmVzZW50YXRpb24KY2xhc3MgV2VzdGVyblRpbWU6CiAgICBkZWYgX19pbml0X18oc2VsZiwgaG91ciwgbWludXRlLCBzZWNvbmQsICosIHRpbWV6b25lPU5vbmUpOgogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKGhvdXIsIGludCkgb3Igbm90IGlzaW5zdGFuY2UobWludXRlLCBpbnQpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoIkhvdXIgYW5kIG1pbnV0ZSBtdXN0IGJlIGludGVnZXIiKQogICAgICAgIGlmIGhvdXIgPCAwIG9yIGhvdXIgPiAyMzoKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcihmIkhvdXIgbXVzdCBiZSBiZXR3ZWVuIDAgYW5kIDIzLCB3aGlsZSBpdCBpcyB7aG91cn0uIikKICAgICAgICBpZiBtaW51dGUgPCAwIG9yIG1pbnV0ZSA+IDU5OgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKGYiTWludXRlIG11c3QgYmUgYmV0d2VlbiAwIGFuZCA1OSwgd2hpbGUgaXQgaXMge21pbnV0ZX0uIikKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlY29uZF9mcmFjdGlvbiA9IHZlcmlmeV9mcmFjdGlvbmFsX3ZhbHVlKHNlY29uZCwgbWluPTAsIG1heF9leGNsPTYwKQogICAgICAgIGV4Y2VwdCBUeXBlRXJyb3IgYXMgZXhjOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoIlNlY29uZCBpcyBub3QgYSB2YWxpZCBmcmFjdGlvbmFsIHZhbHVlIikgZnJvbSBleGMKICAgICAgICBleGNlcHQgVmFsdWVFcnJvciBhcyBleGM6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIlNlY29uZCBtdXN0IGJlIGVxdWFsIG9yIGdyZWF0ZXIgdGhhbiAwIGFuZCBsZXNzIHRoYW4gNjAuIikgZnJvbSBleGMKICAgICAgICBzZWxmLl9ob3VyID0gaG91cgogICAgICAgIHNlbGYuX21pbnV0ZSA9IG1pbnV0ZQogICAgICAgIHNlbGYuX3NlY29uZCA9IHNlY29uZF9mcmFjdGlvbgogICAgICAgIGlmIHRpbWV6b25lIGlzIE5vbmU6CiAgICAgICAgICAgIHNlbGYuX3RpbWV6b25lID0gTm9uZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGNhbmRpZGF0ZV90aW1lem9uZSA9IHZlcmlmeV9mcmFjdGlvbmFsX3ZhbHVlKHRpbWV6b25lLCBtaW49LTI0LCBtYXg9KzI0KQogICAgICAgICAgICBleGNlcHQgVHlwZUVycm9yIGFzIGV4YzoKICAgICAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigiVGltZSB6b25lIGlzIG5vdCBhIHZhbGlkIGZyYWN0aW9uYWwgdmFsdWUiKSBmcm9tIGV4YwogICAgICAgICAgICBleGNlcHQgVmFsdWVFcnJvciBhcyBleGM6CiAgICAgICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJUaW1lIHpvbmUgbXVzdCBiZSBncmVhdGVyIHRoYW4gLTI0IGFuZCBsZXNzIHRoYW4gMjQuIikgZnJvbSBleGMKICAgICAgICAgICAgc2VsZi5fdGltZXpvbmUgPSBjYW5kaWRhdGVfdGltZXpvbmUKCiAgICBAcHJvcGVydHkKICAgIGRlZiBob3VyKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLl9ob3VyCgogICAgQHByb3BlcnR5CiAgICBkZWYgbWludXRlKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLl9taW51dGUKCiAgICBAcHJvcGVydHkKICAgIGRlZiBzZWNvbmQoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuX3NlY29uZAoKICAgIEBwcm9wZXJ0eQogICAgZGVmIHRpbWV6b25lKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLl90aW1lem9uZQoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIGZyb21fdGltZV9wYWlyKGNscywgZGF5X2ZyYWMsIHV0Y29mZnNldCk6CiAgICAgICAgZGF5X2ZyYWNfdmFsaWQgPSB2ZXJpZnlfZnJhY3Rpb25hbF92YWx1ZShkYXlfZnJhYywgbWluPTAsIG1heF9leGNsPTEsIHN0cmljdD1UcnVlKQogICAgICAgIGhvdXIgPSBpbnQoZGF5X2ZyYWNfdmFsaWQgKiAyNCkKICAgICAgICBtaW51dGUgPSBpbnQoKGRheV9mcmFjX3ZhbGlkIC0gRnJhY3Rpb24oaG91ciwgMjQpKSAqIDE0NDApCiAgICAgICAgc2Vjb25kID0gKGRheV9mcmFjX3ZhbGlkIC0gRnJhY3Rpb24oaG91ciwgMjQpIC0gRnJhY3Rpb24obWludXRlLCAxNDQwKSkgKiA4NjQwMAogICAgICAgIGlmIHV0Y29mZnNldCBpcyBOb25lOgogICAgICAgICAgICB3ZXN0ZXJuID0gY2xzKGhvdXIsIG1pbnV0ZSwgc2Vjb25kKQogICAgICAgICAgICByZXR1cm4gd2VzdGVybgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHV0Y29mZnNldF92YWxpZCA9IHZlcmlmeV9mcmFjdGlvbmFsX3ZhbHVlKHV0Y29mZnNldCwgbWluPS0xLCBtYXg9MSwgc3RyaWN0PVRydWUpCiAgICAgICAgICAgIHdlc3Rlcm4gPSBjbHMoaG91ciwgbWludXRlLCBzZWNvbmQsIHRpbWV6b25lPXV0Y29mZnNldF92YWxpZCAqIDI0KQogICAgICAgICAgICByZXR1cm4gd2VzdGVybgoKICAgIGRlZiB0b190aW1lX3BhaXIoc2VsZik6CiAgICAgICAgZGF5X2ZyYWMgPSBzZWxmLl9zZWNvbmQgLyA4NjQwMCArIEZyYWN0aW9uKHNlbGYuX21pbnV0ZSwgMTQ0MCkgKyBGcmFjdGlvbihzZWxmLl9ob3VyLCAyNCkKICAgICAgICBpZiBzZWxmLl90aW1lem9uZSBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gZGF5X2ZyYWMsIE5vbmUKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gZGF5X2ZyYWMsIHNlbGYuX3RpbWV6b25lIC8gMjQKCiAgICBkZWYgcmVwbGFjZShzZWxmLCAqLCBob3VyPU5vbmUsIG1pbnV0ZT1Ob25lLCBzZWNvbmQ9Tm9uZSwgdGltZXpvbmU9Tm9uZSk6CiAgICAgICAgaWYgaG91ciBpcyBOb25lOgogICAgICAgICAgICBob3VyID0gc2VsZi5ob3VyCiAgICAgICAgaWYgbWludXRlIGlzIE5vbmU6CiAgICAgICAgICAgIG1pbnV0ZSA9IHNlbGYubWludXRlCiAgICAgICAgaWYgc2Vjb25kIGlzIE5vbmU6CiAgICAgICAgICAgIHNlY29uZCA9IHNlbGYuc2Vjb25kCiAgICAgICAgaWYgdGltZXpvbmUgaXMgTm9uZToKICAgICAgICAgICAgcmV0dXJuIHR5cGUoc2VsZikoaG91ciwgbWludXRlLCBzZWNvbmQsIHRpbWV6b25lPXNlbGYudGltZXpvbmUpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaWYgc2VsZi50aW1lem9uZSBpcyBOb25lOgogICAgICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJDYW4gcmVwbGFjZSB0aW1lem9uZSBvbmx5IGluIGF3YXJlIGluc3RhbmNlcy4iKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmV0dXJuIHR5cGUoc2VsZikoaG91ciwgbWludXRlLCBzZWNvbmQsIHRpbWV6b25lPXRpbWV6b25lKQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICBpZiBzZWxmLnRpbWV6b25lIGlzIE5vbmU6CiAgICAgICAgICAgIHJldHVybiBmInR5cGVzdXRpbC53ZXN0ZXJuLnt0eXBlKHNlbGYpLl9fbmFtZV9ffSh7c2VsZi5ob3VyfSwge3NlbGYubWludXRlfSwge3NlbGYuc2Vjb25kIXJ9KSIKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gZiJ0eXBlc3V0aWwud2VzdGVybi57dHlwZShzZWxmKS5fX25hbWVfX30oe3NlbGYuaG91cn0sIHtzZWxmLm1pbnV0ZX0sIHtzZWxmLnNlY29uZCFyfSwgdGltZXpvbmU9e3NlbGYudGltZXpvbmUhcn0pIgoKICAgIGRlZiBfX3N0cl9fKHNlbGYpOgogICAgICAgIHRpbWVfc3RyID0gZiJ7c2VsZi5ob3VyOjAyZH06e3NlbGYubWludXRlOjAyZH06e2ludChzZWxmLnNlY29uZCk6MDJkfSIKICAgICAgICBpZiBzZWxmLnRpbWV6b25lIGlzIE5vbmU6CiAgICAgICAgICAgIHJldHVybiB0aW1lX3N0cgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHR6X2hvdXIgPSBpbnQoc2VsZi50aW1lem9uZSkKICAgICAgICAgICAgaG91cl9yZXN0ID0gKHNlbGYudGltZXpvbmUgLSB0el9ob3VyKSAqIDYwCiAgICAgICAgICAgIHR6X21pbnV0ZSA9IGludChob3VyX3Jlc3QpCiAgICAgICAgICAgIHJldHVybiBmInt0aW1lX3N0cn17dHpfaG91cjorMDJkfTp7dHpfbWludXRlOjAyZH0iCgogICAgZm9ybWF0X2Z1bmN0aW9ucyA9IHsKICAgICAgICAiSCI6IGxhbWJkYSBzZWxmOiBmIntzZWxmLmhvdXI6MDJkfSIsCiAgICAgICAgIkkiOiBsYW1iZGEgc2VsZjogZiJ7MTIgaWYgc2VsZi5ob3VyID09IDAgZWxzZSBzZWxmLmhvdXIgaWYgc2VsZi5ob3VyIDw9IDEyIGVsc2Ugc2VsZi5ob3VyIC0gMTI6MDJkfSIsCiAgICAgICAgInAiOiBsYW1iZGEgc2VsZjogIkFNIiBpZiBzZWxmLmhvdXIgPCAxMiBlbHNlICJQTSIsCiAgICAgICAgIk0iOiBsYW1iZGEgc2VsZjogZiJ7c2VsZi5taW51dGU6MDJkfSIsCiAgICAgICAgIlMiOiBsYW1iZGEgc2VsZjogZiJ7aW50KHNlbGYuc2Vjb25kKTowMmR9IiwKICAgICAgICAiZiI6IGxhbWJkYSBzZWxmOiBmIntpbnQoKHNlbGYuc2Vjb25kIC0gaW50KHNlbGYuc2Vjb25kKSkgKiAxMDAwMDAwKTowNmR9IiwKICAgIH0KCiAgICBkZWYgY2Zvcm1hdChzZWxmLCBmb3JtYXRfc3RyaW5nKToKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShmb3JtYXRfc3RyaW5nLCBzdHIpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoIkZvcm1hdCBtdXN0IGJlIHNwZWNpZmllZCB3aXRoIHN0cmluZy4iKQogICAgICAgIG91dHB1dF9waWVjZXMgPSBbXQogICAgICAgIGZvciBmb3JtYXRfY2h1bmsgaW4gZm9ybWF0X3N0cmluZy5zcGxpdCgiJSUiKToKICAgICAgICAgICAgZm9ybWF0X3BhcnRzID0gZm9ybWF0X2NodW5rLnNwbGl0KCIlIikKICAgICAgICAgICAgY2h1bmtfcGllY2VzID0gW2Zvcm1hdF9wYXJ0c1swXV0KICAgICAgICAgICAgZm9yIHBhcnQgaW4gZm9ybWF0X3BhcnRzWzE6XToKICAgICAgICAgICAgICAgIGlmIHBhcnQgPT0gIiI6ICAjIHNwZWNpYWwgY2FzZTogbGFzdCBjaGFyIGlzICclJwogICAgICAgICAgICAgICAgICAgIHZhbHVlID0gIiUiCiAgICAgICAgICAgICAgICBlbGlmIHBhcnQgPT0gJ3onOiAgIyB0aGlzIGNhc2UgaXMgdG9vIGNvbXBsZXggdG8gZml0IGluIGEgbGFtYmRhCiAgICAgICAgICAgICAgICAgICAgaWYgc2VsZi50aW1lem9uZSBpcyBOb25lOgogICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9ICcnCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgaWYgc2VsZi50aW1lem9uZSA8IDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0el9zaWduID0gJy0nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhYnNfdGltZXpvbmUgPSAtc2VsZi50aW1lem9uZQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHpfc2lnbiA9ICcrJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWJzX3RpbWV6b25lID0gc2VsZi50aW1lem9uZQogICAgICAgICAgICAgICAgICAgICAgICB0el9ob3VyID0gaW50KGFic190aW1lem9uZSkKICAgICAgICAgICAgICAgICAgICAgICAgcmVtYWluZGVyX2luX21pbnV0ZXMgPSAoYWJzX3RpbWV6b25lIC0gdHpfaG91cikgKiA2MAogICAgICAgICAgICAgICAgICAgICAgICB0el9taW51dGUgPSBpbnQocmVtYWluZGVyX2luX21pbnV0ZXMpCiAgICAgICAgICAgICAgICAgICAgICAgIHJlbWFpbmRlcl9pbl9zZWNvbmRzID0gKHJlbWFpbmRlcl9pbl9taW51dGVzIC0gdHpfbWludXRlKSAqIDYwCiAgICAgICAgICAgICAgICAgICAgICAgIHR6X3NlY29uZCA9IGludChyZW1haW5kZXJfaW5fc2Vjb25kcykKICAgICAgICAgICAgICAgICAgICAgICAgcmVtYWluZGVyX2luX21pY3Jvc2Vjb25kcyA9IChyZW1haW5kZXJfaW5fc2Vjb25kcyAtIHR6X3NlY29uZCkgKiAxXzAwMF8wMDAKICAgICAgICAgICAgICAgICAgICAgICAgdHpfbWljcm9zZWNvbmQgPSBpbnQocmVtYWluZGVyX2luX21pY3Jvc2Vjb25kcykKICAgICAgICAgICAgICAgICAgICAgICAgaWYgdHpfbWljcm9zZWNvbmQgPiAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBmInt0el9zaWdufXt0el9ob3VyOjAyZH06e3R6X21pbnV0ZTowMmR9Ont0el9zZWNvbmQ6MDJkfS57dHpfbWljcm9zZWNvbmQ6MDZkfSIKICAgICAgICAgICAgICAgICAgICAgICAgZWxpZiB0el9zZWNvbmQgPiAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBmInt0el9zaWdufXt0el9ob3VyOjAyZH06e3R6X21pbnV0ZTowMmR9Ont0el9zZWNvbmQ6MDJkfSIKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gZiJ7dHpfc2lnbn17dHpfaG91cjowMmR9Ont0el9taW51dGU6MDJkfSIKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHNlbGYuZm9ybWF0X2Z1bmN0aW9uc1twYXJ0WzBdXShzZWxmKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSAiJSIgKyBwYXJ0WzBdCiAgICAgICAgICAgICAgICBjaHVua19waWVjZXMuYXBwZW5kKHZhbHVlKQogICAgICAgICAgICAgICAgY2h1bmtfcGllY2VzLmFwcGVuZChwYXJ0WzE6XSkKICAgICAgICAgICAgb3V0cHV0X3BpZWNlcy5hcHBlbmQoIiIuam9pbihjaHVua19waWVjZXMpKQogICAgICAgIHJldHVybiAiJSIuam9pbihvdXRwdXRfcGllY2VzKQoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIFdlc3Rlcm4gdGltZSBpbnRlcnZhbApjbGFzcyBXZXN0ZXJuVGltZURlbHRhOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGRheXMsIGhvdXJzLCBtaW51dGVzLCBzZWNvbmRzKToKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShkYXlzLCBpbnQpIG9yIG5vdCBpc2luc3RhbmNlKGhvdXJzLCBpbnQpIG9yIG5vdCBpc2luc3RhbmNlKG1pbnV0ZXMsIGludCk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigiRGF5cywgaG91cnMgYW5kIG1pbnV0ZXMgbXVzdCBiZSBpbnRlZ2VyIikKICAgICAgICB2ZXJpZmllZF9zZWNvbmRzID0gdmVyaWZ5X2ZyYWN0aW9uYWxfdmFsdWUoc2Vjb25kcykKICAgICAgICBpZiBkYXlzID4gMCBhbmQgKGhvdXJzIDwgMCBvciBtaW51dGVzIDwgMCBvciB2ZXJpZmllZF9zZWNvbmRzIDwgMCkgb3IgXAogICAgICAgICAgIGRheXMgPCAwIGFuZCAoaG91cnMgPiAwIG9yIG1pbnV0ZXMgPiAwIG9yIHZlcmlmaWVkX3NlY29uZHMgPiAwKSBvciBcCiAgICAgICAgICAgaG91cnMgPiAwIGFuZCAobWludXRlcyA8IDAgb3IgdmVyaWZpZWRfc2Vjb25kcyA8IDApIG9yIFwKICAgICAgICAgICBob3VycyA8IDAgYW5kIChtaW51dGVzID4gMCBvciB2ZXJpZmllZF9zZWNvbmRzID4gMCkgb3IgXAogICAgICAgICAgIG1pbnV0ZXMgPiAwIGFuZCB2ZXJpZmllZF9zZWNvbmRzIDwgMCBvciBcCiAgICAgICAgICAgbWludXRlcyA8IDAgYW5kIHZlcmlmaWVkX3NlY29uZHMgPiAwOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJEYXlzLCBob3VycywgbWludXRlcyBhbmQgc2Vjb25kcyBtdXN0IGhhdmUgdGhlIHNhbWUgc2lnbiIpCiAgICAgICAgYWJzX2ggPSBhYnMoaG91cnMpCiAgICAgICAgaWYgYWJzX2ggPCAwIG9yIGFic19oID4gMjM6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIkhvdXJzIG11c3QgYmUgYmV0d2VlbiAwIGFuZCAyMyBpbiBhYnNvbHV0ZSB2YWx1ZS4iKQogICAgICAgIGFic19tID0gYWJzKG1pbnV0ZXMpCiAgICAgICAgaWYgYWJzX20gPCAwIG9yIGFic19tID4gNTk6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIk1pbnV0ZXMgbXVzdCBiZSBiZXR3ZWVuIDAgYW5kIDU5IGluIGFic29sdXRlIHZhbHVlLiIpCiAgICAgICAgIyB3ZSBoYXZlIGFscmVhZHkgY2hlY2tlZCB0aGF0IHZlcmlmaWVkX3NlY29uZHMgaXMgYSB2YWxpZCBGcmFjdGlvbgogICAgICAgIGFic19zID0gYWJzKHZlcmlmaWVkX3NlY29uZHMpCiAgICAgICAgaWYgYWJzX3MgPj0gNjA6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIkFic29sdXRlIHZhbHVlIG9mIHNlY29uZHMgbXVzdCBiZSBsZXNzIHRoYW4gNjAiKQogICAgICAgIHNlbGYuX2RheXMgPSBkYXlzCiAgICAgICAgc2VsZi5faG91cnMgPSBob3VycwogICAgICAgIHNlbGYuX21pbnV0ZXMgPSBtaW51dGVzCiAgICAgICAgc2VsZi5fc2Vjb25kcyA9IHZlcmlmaWVkX3NlY29uZHMKCiAgICBAcHJvcGVydHkKICAgIGRlZiBkYXlzKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLl9kYXlzCgogICAgQHByb3BlcnR5CiAgICBkZWYgaG91cnMoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuX2hvdXJzCgogICAgQHByb3BlcnR5CiAgICBkZWYgbWludXRlcyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5fbWludXRlcwoKICAgIEBwcm9wZXJ0eQogICAgZGVmIHNlY29uZHMoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuX3NlY29uZHMKCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBmcm9tX2ZyYWN0aW9uYWxfZGF5cyhjbHMsIGZyYWN0aW9uYWxfZGF5cyk6CiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UoZnJhY3Rpb25hbF9kYXlzLCBGcmFjdGlvbik6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigiRnJhY3Rpb25hbCBkYXlzIG11c3QgYmUgYSBQeXRob24gRnJhY3Rpb24uIikKICAgICAgICBkYXlzID0gaW50KGZyYWN0aW9uYWxfZGF5cykKICAgICAgICBob3VycyA9IGludCgoZnJhY3Rpb25hbF9kYXlzIC0gZGF5cykgKiAyNCkKICAgICAgICBtaW51dGVzID0gaW50KChmcmFjdGlvbmFsX2RheXMgLSBkYXlzIC0gRnJhY3Rpb24oaG91cnMsIDI0KSkgKiAxNDQwKQogICAgICAgIHNlY29uZHMgPSAoZnJhY3Rpb25hbF9kYXlzIC0gZGF5cyAtIEZyYWN0aW9uKGhvdXJzLCAyNCkgLSBGcmFjdGlvbihtaW51dGVzLCAxNDQwKSkgKiA4NjQwMAogICAgICAgIHJldHVybiBjbHMoZGF5cywgaG91cnMsIG1pbnV0ZXMsIHNlY29uZHMpCgogICAgZGVmIHRvX2ZyYWN0aW9uYWxfZGF5cyhzZWxmKToKICAgICAgICByZXR1cm4gRnJhY3Rpb24oc2VsZi5zZWNvbmRzLCA4NjQwMCkgKyBGcmFjdGlvbihzZWxmLm1pbnV0ZXMsIDE0NDApICsgRnJhY3Rpb24oc2VsZi5ob3VycywgMjQpICsgc2VsZi5kYXlzCgogICAgZGVmIHJlcGxhY2Uoc2VsZiwgKiwgZGF5cz1Ob25lLCBob3Vycz1Ob25lLCBtaW51dGVzPU5vbmUsIHNlY29uZHM9Tm9uZSk6CiAgICAgICAgaWYgZGF5cyBpcyBOb25lOgogICAgICAgICAgICBkYXlzID0gc2VsZi5kYXlzCiAgICAgICAgaWYgaG91cnMgaXMgTm9uZToKICAgICAgICAgICAgaG91cnMgPSBzZWxmLmhvdXJzCiAgICAgICAgaWYgbWludXRlcyBpcyBOb25lOgogICAgICAgICAgICBtaW51dGVzID0gc2VsZi5taW51dGVzCiAgICAgICAgaWYgc2Vjb25kcyBpcyBOb25lOgogICAgICAgICAgICBzZWNvbmRzID0gc2VsZi5zZWNvbmRzCiAgICAgICAgcmV0dXJuIHR5cGUoc2VsZikoZGF5cywgaG91cnMsIG1pbnV0ZXMsIHNlY29uZHMpCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBmInR5cGVzdXRpbC53ZXN0ZXJuLnt0eXBlKHNlbGYpLl9fbmFtZV9ffSh7c2VsZi5kYXlzfSwge3NlbGYuaG91cnN9LCB7c2VsZi5taW51dGVzfSwge3NlbGYuc2Vjb25kcyFyfSkiCgogICAgZGVmIF9fc3RyX18oc2VsZik6CiAgICAgICAgaW50X3NlYyA9IGludChzZWxmLnNlY29uZHMpCiAgICAgICAgaWYgc2VsZi5kYXlzID09IHNlbGYuaG91cnMgPT0gc2VsZi5taW51dGVzID09IGludF9zZWMgPT0gMDoKICAgICAgICAgICAgcmV0dXJuICIwIGRheXMiCiAgICAgICAgc3RyX2QgPSBmIntzZWxmLmRheXMhc30gZGF5eydzJyBpZiBhYnMoc2VsZi5kYXlzKSAhPSAxIGVsc2UgJyd9IgogICAgICAgIHN0cl9oID0gZiJ7c2VsZi5ob3VycyFzfSBob3VyeydzJyBpZiBhYnMoc2VsZi5ob3VycykgIT0gMSBlbHNlICcnfSIKICAgICAgICBzdHJfbSA9IGYie3NlbGYubWludXRlcyFzfSBtaW51dGV7J3MnIGlmIGFicyhzZWxmLm1pbnV0ZXMpICE9IDEgZWxzZSAnJ30iCiAgICAgICAgc3RyX3MgPSBmIntpbnRfc2VjIXN9IHNlY29uZHsncycgaWYgYWJzKGludF9zZWMpICE9IDEgZWxzZSAnJ30iCiAgICAgICAgc3RyX2xpc3QgPSBbc3RyaW5nIGZvciBzdHJpbmcgaW4gKHN0cl9kLCBzdHJfaCwgc3RyX20sIHN0cl9zKSBpZiBub3Qgc3RyaW5nLnN0YXJ0c3dpdGgoJzAgJyldCiAgICAgICAgc3RyaW5nID0gJyBhbmQgJy5qb2luKHN0cl9saXN0KQogICAgICAgIHJldHVybiBzdHJpbmcucmVwbGFjZSgnIGFuZCAnLCAnLCAnLCBsZW4oc3RyX2xpc3QpIC0gMikKCiAgICBmb3JtYXRfZnVuY3Rpb25zID0gewogICAgICAgICJkIjogbGFtYmRhIHNlbGY6IHN0cihzZWxmLmRheXMpLAogICAgICAgICJIIjogbGFtYmRhIHNlbGY6IGYie3NlbGYuaG91cnM6MDJkfSIsCiAgICAgICAgIk0iOiBsYW1iZGEgc2VsZjogZiJ7c2VsZi5taW51dGVzOjAyZH0iLAogICAgICAgICJTIjogbGFtYmRhIHNlbGY6IGYie2ludChzZWxmLnNlY29uZHMpOjAyZH0iLAogICAgICAgICJmIjogbGFtYmRhIHNlbGY6IGYie2ludCgoc2VsZi5zZWNvbmRzIC0gaW50KHNlbGYuc2Vjb25kcykpICogMTAwMDAwMCk6MDZkfSIsCiAgICB9CgogICAgZGVmIGNmb3JtYXQoc2VsZiwgZm9ybWF0X3N0cmluZyk6CiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UoZm9ybWF0X3N0cmluZywgc3RyKToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJGb3JtYXQgbXVzdCBiZSBzcGVjaWZpZWQgd2l0aCBzdHJpbmcuIikKICAgICAgICBvdXRwdXRfcGllY2VzID0gW10KICAgICAgICBmb3IgZm9ybWF0X2NodW5rIGluIGZvcm1hdF9zdHJpbmcuc3BsaXQoIiUlIik6CiAgICAgICAgICAgIGZvcm1hdF9wYXJ0cyA9IGZvcm1hdF9jaHVuay5zcGxpdCgiJSIpCiAgICAgICAgICAgIGNodW5rX3BpZWNlcyA9IFtmb3JtYXRfcGFydHNbMF1dCiAgICAgICAgICAgIGZvciBwYXJ0IGluIGZvcm1hdF9wYXJ0c1sxOl06CiAgICAgICAgICAgICAgICBpZiBwYXJ0ID09ICIiOiAgIyBzcGVjaWFsIGNhc2U6IGxhc3QgY2hhciBpcyAnJScKICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9ICIlIgogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gc2VsZi5mb3JtYXRfZnVuY3Rpb25zW3BhcnRbMF1dKHNlbGYpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9ICIlIiArIHBhcnRbMF0KICAgICAgICAgICAgICAgIGNodW5rX3BpZWNlcy5hcHBlbmQodmFsdWUpCiAgICAgICAgICAgICAgICBjaHVua19waWVjZXMuYXBwZW5kKHBhcnRbMTpdKQogICAgICAgICAgICBvdXRwdXRfcGllY2VzLmFwcGVuZCgiIi5qb2luKGNodW5rX3BpZWNlcykpCiAgICAgICAgcmV0dXJuICIlIi5qb2luKG91dHB1dF9waWVjZXMpCg==
