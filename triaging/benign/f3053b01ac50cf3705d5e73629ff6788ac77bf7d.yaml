statistics:
  total_files: 1
  skipped_files: 0.0
  processed_objects: 1
  malicious_objects: 0
details:
- path: .repo_cache/malicious_repos/pypi_malregistry/datagraph/0.9.0/datagraph-0.9.0/datagraph-0.9.0/datagraph/__init__.py
  contents:
  - name: _CustomTextWrap._len
    score: 0.0
    code: |-
      @staticmethod
          def _len(item):
              """Custom len that gets console column width for wide
              and non-wide characters as well as ignores color codes"""
              stripped = _strip_ansi(item)
              if wcwidth:
                  return wcwidth.wcswidth(stripped)
              else:
                  return len(stripped)
    tokens: TARGETED_FILE resume load_global _strip_ansi load_fast item call store_fast stripped load_global wcwidth pop_jump_if_false TO_NUMBER load_global wcwidth load_attr wcswidth load_fast stripped call return_value load_global len load_fast stripped call return_value
    hash: 8724383d9bbef8d718f27f63145d0cf4b665ab33c2911c50b5d1825552b9bb00
sources:
  .repo_cache/malicious_repos/pypi_malregistry/datagraph/0.9.0/datagraph-0.9.0/datagraph-0.9.0/datagraph/__init__.py: IiIiUHJldHR5LXByaW50IHRhYnVsYXIgZGF0YS4iIiIKCmZyb20gY29sbGVjdGlvbnMgaW1wb3J0IG5hbWVkdHVwbGUKZnJvbSBjb2xsZWN0aW9ucy5hYmMgaW1wb3J0IEl0ZXJhYmxlLCBTaXplZApmcm9tIGh0bWwgaW1wb3J0IGVzY2FwZSBhcyBodG1sZXNjYXBlCmZyb20gaXRlcnRvb2xzIGltcG9ydCBjaGFpbiwgemlwX2xvbmdlc3QgYXMgaXppcF9sb25nZXN0CmZyb20gZnVuY3Rvb2xzIGltcG9ydCByZWR1Y2UsIHBhcnRpYWwKaW1wb3J0IGlvCmltcG9ydCByZQppbXBvcnQgbWF0aAppbXBvcnQgdGV4dHdyYXAKaW1wb3J0IGRhdGFjbGFzc2VzCgp0cnk6CiAgICBpbXBvcnQgd2N3aWR0aCAgIyBvcHRpb25hbCB3aWRlLWNoYXJhY3RlciAoQ0pLKSBzdXBwb3J0CmV4Y2VwdCBJbXBvcnRFcnJvcjoKICAgIHdjd2lkdGggPSBOb25lCgoKZGVmIF9pc19maWxlKGYpOgogICAgcmV0dXJuIGlzaW5zdGFuY2UoZiwgaW8uSU9CYXNlKQoKCl9fYWxsX18gPSBbInRhYnVsYXRlIiwgInRhYnVsYXRlX2Zvcm1hdHMiLCAic2ltcGxlX3NlcGFyYXRlZF9mb3JtYXQiXQp0cnk6CiAgICBmcm9tIC52ZXJzaW9uIGltcG9ydCB2ZXJzaW9uIGFzIF9fdmVyc2lvbl9fICAjIG5vcWE6IEY0MDEKZXhjZXB0IEltcG9ydEVycm9yOgogICAgcGFzcyAgIyBydW5uaW5nIF9faW5pdF9fLnB5IGFzIGEgc2NyaXB0LCBBcHBWZXlvciBweXRlc3RzCgoKIyBtaW5pbXVtIGV4dHJhIHNwYWNlIGluIGhlYWRlcnMKTUlOX1BBRERJTkcgPSAyCgojIFdoZXRoZXIgb3Igbm90IHRvIHByZXNlcnZlIGxlYWRpbmcvdHJhaWxpbmcgd2hpdGVzcGFjZSBpbiBkYXRhLgpQUkVTRVJWRV9XSElURVNQQUNFID0gRmFsc2UKCl9ERUZBVUxUX0ZMT0FURk1UID0gImciCl9ERUZBVUxUX0lOVEZNVCA9ICIiCl9ERUZBVUxUX01JU1NJTkdWQUwgPSAiIgojIGRlZmF1bHQgYWxpZ24gd2lsbCBiZSBvdmVyd3JpdHRlbiBieSAibGVmdCIsICJjZW50ZXIiIG9yICJkZWNpbWFsIgojIGRlcGVuZGluZyBvbiB0aGUgZm9ybWF0dGVyCl9ERUZBVUxUX0FMSUdOID0gImRlZmF1bHQiCgoKIyBpZiBUcnVlLCBlbmFibGUgd2lkZS1jaGFyYWN0ZXIgKENKSykgc3VwcG9ydApXSURFX0NIQVJTX01PREUgPSB3Y3dpZHRoIGlzIG5vdCBOb25lCgojIENvbnN0YW50IHRoYXQgY2FuIGJlIHVzZWQgYXMgcGFydCBvZiBwYXNzZWQgcm93cyB0byBnZW5lcmF0ZSBhIHNlcGFyYXRpbmcgbGluZQojIEl0IGlzIHB1cnBvc2VseSBhbiB1bnByaW50YWJsZSBjaGFyYWN0ZXIsIHZlcnkgdW5saWtlbHkgdG8gYmUgdXNlZCBpbiBhIHRhYmxlClNFUEFSQVRJTkdfTElORSA9ICJcMDAxIgoKTGluZSA9IG5hbWVkdHVwbGUoIkxpbmUiLCBbImJlZ2luIiwgImhsaW5lIiwgInNlcCIsICJlbmQiXSkKCgpEYXRhUm93ID0gbmFtZWR0dXBsZSgiRGF0YVJvdyIsIFsiYmVnaW4iLCAic2VwIiwgImVuZCJdKQoKCiMgQSB0YWJsZSBzdHJ1Y3R1cmUgaXMgc3VwcG9zZWQgdG8gYmU6CiMKIyAgICAgLS0tIGxpbmVhYm92ZSAtLS0tLS0tLS0KIyAgICAgICAgIGhlYWRlcnJvdwojICAgICAtLS0gbGluZWJlbG93aGVhZGVyIC0tLQojICAgICAgICAgZGF0YXJvdwojICAgICAtLS0gbGluZWJldHdlZW5yb3dzIC0tLQojICAgICAuLi4gKG1vcmUgZGF0YXJvd3MpIC4uLgojICAgICAtLS0gbGluZWJldHdlZW5yb3dzIC0tLQojICAgICAgICAgbGFzdCBkYXRhcm93CiMgICAgIC0tLSBsaW5lYmVsb3cgLS0tLS0tLS0tCiMKIyBUYWJsZUZvcm1hdCdzIGxpbmUqIGVsZW1lbnRzIGNhbiBiZQojCiMgICAtIGVpdGhlciBOb25lLCBpZiB0aGUgZWxlbWVudCBpcyBub3QgdXNlZCwKIyAgIC0gb3IgYSBMaW5lIHR1cGxlLAojICAgLSBvciBhIGZ1bmN0aW9uOiBbY29sX3dpZHRoc10sIFtjb2xfYWxpZ25tZW50c10gLT4gc3RyaW5nLgojCiMgVGFibGVGb3JtYXQncyAqcm93IGVsZW1lbnRzIGNhbiBiZQojCiMgICAtIGVpdGhlciBOb25lLCBpZiB0aGUgZWxlbWVudCBpcyBub3QgdXNlZCwKIyAgIC0gb3IgYSBEYXRhUm93IHR1cGxlLAojICAgLSBvciBhIGZ1bmN0aW9uOiBbY2VsbF92YWx1ZXNdLCBbY29sX3dpZHRoc10sIFtjb2xfYWxpZ25tZW50c10gLT4gc3RyaW5nLgojCiMgcGFkZGluZyAoYW4gaW50ZWdlcikgaXMgdGhlIGFtb3VudCBvZiB3aGl0ZSBzcGFjZSBhcm91bmQgZGF0YSB2YWx1ZXMuCiMKIyB3aXRoX2hlYWRlcl9oaWRlOgojCiMgICAtIGVpdGhlciBOb25lLCB0byBkaXNwbGF5IGFsbCB0YWJsZSBlbGVtZW50cyB1bmNvbmRpdGlvbmFsbHksCiMgICAtIG9yIGEgbGlzdCBvZiBlbGVtZW50cyBub3QgdG8gYmUgZGlzcGxheWVkIGlmIHRoZSB0YWJsZSBoYXMgY29sdW1uIGhlYWRlcnMuCiMKVGFibGVGb3JtYXQgPSBuYW1lZHR1cGxlKAogICAgIlRhYmxlRm9ybWF0IiwKICAgIFsKICAgICAgICAibGluZWFib3ZlIiwKICAgICAgICAibGluZWJlbG93aGVhZGVyIiwKICAgICAgICAibGluZWJldHdlZW5yb3dzIiwKICAgICAgICAibGluZWJlbG93IiwKICAgICAgICAiaGVhZGVycm93IiwKICAgICAgICAiZGF0YXJvdyIsCiAgICAgICAgInBhZGRpbmciLAogICAgICAgICJ3aXRoX2hlYWRlcl9oaWRlIiwKICAgIF0sCikKCgpkZWYgX2lzX3NlcGFyYXRpbmdfbGluZShyb3cpOgogICAgcm93X3R5cGUgPSB0eXBlKHJvdykKICAgIGlzX3NsID0gKHJvd190eXBlID09IGxpc3Qgb3Igcm93X3R5cGUgPT0gc3RyKSBhbmQgKAogICAgICAgIChsZW4ocm93KSA+PSAxIGFuZCByb3dbMF0gPT0gU0VQQVJBVElOR19MSU5FKQogICAgICAgIG9yIChsZW4ocm93KSA+PSAyIGFuZCByb3dbMV0gPT0gU0VQQVJBVElOR19MSU5FKQogICAgKQogICAgcmV0dXJuIGlzX3NsCgoKZGVmIF9waXBlX3NlZ21lbnRfd2l0aF9jb2xvbnMoYWxpZ24sIGNvbHdpZHRoKToKICAgICIiIlJldHVybiBhIHNlZ21lbnQgb2YgYSBob3Jpem9udGFsIGxpbmUgd2l0aCBvcHRpb25hbCBjb2xvbnMgd2hpY2gKICAgIGluZGljYXRlIGNvbHVtbidzIGFsaWdubWVudCAoYXMgaW4gYHBpcGVgIG91dHB1dCBmb3JtYXQpLiIiIgogICAgdyA9IGNvbHdpZHRoCiAgICBpZiBhbGlnbiBpbiBbInJpZ2h0IiwgImRlY2ltYWwiXToKICAgICAgICByZXR1cm4gKCItIiAqICh3IC0gMSkpICsgIjoiCiAgICBlbGlmIGFsaWduID09ICJjZW50ZXIiOgogICAgICAgIHJldHVybiAiOiIgKyAoIi0iICogKHcgLSAyKSkgKyAiOiIKICAgIGVsaWYgYWxpZ24gPT0gImxlZnQiOgogICAgICAgIHJldHVybiAiOiIgKyAoIi0iICogKHcgLSAxKSkKICAgIGVsc2U6CiAgICAgICAgcmV0dXJuICItIiAqIHcKCgpkZWYgX3BpcGVfbGluZV93aXRoX2NvbG9ucyhjb2x3aWR0aHMsIGNvbGFsaWducyk6CiAgICAiIiJSZXR1cm4gYSBob3Jpem9udGFsIGxpbmUgd2l0aCBvcHRpb25hbCBjb2xvbnMgdG8gaW5kaWNhdGUgY29sdW1uJ3MKICAgIGFsaWdubWVudCAoYXMgaW4gYHBpcGVgIG91dHB1dCBmb3JtYXQpLiIiIgogICAgaWYgbm90IGNvbGFsaWduczogICMgZS5nLiBwcmludGluZyBhbiBlbXB0eSBkYXRhIGZyYW1lIChnaXRodWIgaXNzdWUgIzE1KQogICAgICAgIGNvbGFsaWducyA9IFsiIl0gKiBsZW4oY29sd2lkdGhzKQogICAgc2VnbWVudHMgPSBbX3BpcGVfc2VnbWVudF93aXRoX2NvbG9ucyhhLCB3KSBmb3IgYSwgdyBpbiB6aXAoY29sYWxpZ25zLCBjb2x3aWR0aHMpXQogICAgcmV0dXJuICJ8IiArICJ8Ii5qb2luKHNlZ21lbnRzKSArICJ8IgoKCmRlZiBfbWVkaWF3aWtpX3Jvd193aXRoX2F0dHJzKHNlcGFyYXRvciwgY2VsbF92YWx1ZXMsIGNvbHdpZHRocywgY29sYWxpZ25zKToKICAgIGFsaWdubWVudCA9IHsKICAgICAgICAibGVmdCI6ICIiLAogICAgICAgICJyaWdodCI6ICdhbGlnbj0icmlnaHQifCAnLAogICAgICAgICJjZW50ZXIiOiAnYWxpZ249ImNlbnRlciJ8ICcsCiAgICAgICAgImRlY2ltYWwiOiAnYWxpZ249InJpZ2h0InwgJywKICAgIH0KICAgICMgaGFyZC1jb2RlZCBwYWRkaW5nIF9hcm91bmRfIGFsaWduIGF0dHJpYnV0ZSBhbmQgdmFsdWUgdG9nZXRoZXIKICAgICMgcmF0aGVyIHRoYW4gcGFkZGluZyBwYXJhbWV0ZXIgd2hpY2ggYWZmZWN0cyBvbmx5IHRoZSB2YWx1ZQogICAgdmFsdWVzX3dpdGhfYXR0cnMgPSBbCiAgICAgICAgIiAiICsgYWxpZ25tZW50LmdldChhLCAiIikgKyBjICsgIiAiIGZvciBjLCBhIGluIHppcChjZWxsX3ZhbHVlcywgY29sYWxpZ25zKQogICAgXQogICAgY29sc2VwID0gc2VwYXJhdG9yICogMgogICAgcmV0dXJuIChzZXBhcmF0b3IgKyBjb2xzZXAuam9pbih2YWx1ZXNfd2l0aF9hdHRycykpLnJzdHJpcCgpCgoKZGVmIF90ZXh0aWxlX3Jvd193aXRoX2F0dHJzKGNlbGxfdmFsdWVzLCBjb2x3aWR0aHMsIGNvbGFsaWducyk6CiAgICBjZWxsX3ZhbHVlc1swXSArPSAiICIKICAgIGFsaWdubWVudCA9IHsibGVmdCI6ICI8LiIsICJyaWdodCI6ICI+LiIsICJjZW50ZXIiOiAiPS4iLCAiZGVjaW1hbCI6ICI+LiJ9CiAgICB2YWx1ZXMgPSAoYWxpZ25tZW50LmdldChhLCAiIikgKyB2IGZvciBhLCB2IGluIHppcChjb2xhbGlnbnMsIGNlbGxfdmFsdWVzKSkKICAgIHJldHVybiAifCIgKyAifCIuam9pbih2YWx1ZXMpICsgInwiCgoKZGVmIF9odG1sX2JlZ2luX3RhYmxlX3dpdGhvdXRfaGVhZGVyKGNvbHdpZHRoc19pZ25vcmUsIGNvbGFsaWduc19pZ25vcmUpOgogICAgIyB0aGlzIHRhYmxlIGhlYWRlciB3aWxsIGJlIHN1cHByZXNzZWQgaWYgdGhlcmUgaXMgYSBoZWFkZXIgcm93CiAgICByZXR1cm4gIjx0YWJsZT5cbjx0Ym9keT4iCgoKZGVmIF9odG1sX3Jvd193aXRoX2F0dHJzKGNlbGx0YWcsIHVuc2FmZSwgY2VsbF92YWx1ZXMsIGNvbHdpZHRocywgY29sYWxpZ25zKToKICAgIGFsaWdubWVudCA9IHsKICAgICAgICAibGVmdCI6ICIiLAogICAgICAgICJyaWdodCI6ICcgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyInLAogICAgICAgICJjZW50ZXIiOiAnIHN0eWxlPSJ0ZXh0LWFsaWduOiBjZW50ZXI7IicsCiAgICAgICAgImRlY2ltYWwiOiAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsiJywKICAgIH0KICAgIGlmIHVuc2FmZToKICAgICAgICB2YWx1ZXNfd2l0aF9hdHRycyA9IFsKICAgICAgICAgICAgIjx7MH17MX0+ezJ9PC97MH0+Ii5mb3JtYXQoY2VsbHRhZywgYWxpZ25tZW50LmdldChhLCAiIiksIGMpCiAgICAgICAgICAgIGZvciBjLCBhIGluIHppcChjZWxsX3ZhbHVlcywgY29sYWxpZ25zKQogICAgICAgIF0KICAgIGVsc2U6CiAgICAgICAgdmFsdWVzX3dpdGhfYXR0cnMgPSBbCiAgICAgICAgICAgICI8ezB9ezF9PnsyfTwvezB9PiIuZm9ybWF0KGNlbGx0YWcsIGFsaWdubWVudC5nZXQoYSwgIiIpLCBodG1sZXNjYXBlKGMpKQogICAgICAgICAgICBmb3IgYywgYSBpbiB6aXAoY2VsbF92YWx1ZXMsIGNvbGFsaWducykKICAgICAgICBdCiAgICByb3dodG1sID0gIjx0cj57fTwvdHI+Ii5mb3JtYXQoIiIuam9pbih2YWx1ZXNfd2l0aF9hdHRycykucnN0cmlwKCkpCiAgICBpZiBjZWxsdGFnID09ICJ0aCI6ICAjIGl0J3MgYSBoZWFkZXIgcm93LCBjcmVhdGUgYSBuZXcgdGFibGUgaGVhZGVyCiAgICAgICAgcm93aHRtbCA9IGYiPHRhYmxlPlxuPHRoZWFkPlxue3Jvd2h0bWx9XG48L3RoZWFkPlxuPHRib2R5PiIKICAgIHJldHVybiByb3dodG1sCgoKZGVmIF9tb2luX3Jvd193aXRoX2F0dHJzKGNlbGx0YWcsIGNlbGxfdmFsdWVzLCBjb2x3aWR0aHMsIGNvbGFsaWducywgaGVhZGVyPSIiKToKICAgIGFsaWdubWVudCA9IHsKICAgICAgICAibGVmdCI6ICIiLAogICAgICAgICJyaWdodCI6ICc8c3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyI+JywKICAgICAgICAiY2VudGVyIjogJzxzdHlsZT0idGV4dC1hbGlnbjogY2VudGVyOyI+JywKICAgICAgICAiZGVjaW1hbCI6ICc8c3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyI+JywKICAgIH0KICAgIHZhbHVlc193aXRoX2F0dHJzID0gWwogICAgICAgICJ7fXt9IHt9ICIuZm9ybWF0KGNlbGx0YWcsIGFsaWdubWVudC5nZXQoYSwgIiIpLCBoZWFkZXIgKyBjICsgaGVhZGVyKQogICAgICAgIGZvciBjLCBhIGluIHppcChjZWxsX3ZhbHVlcywgY29sYWxpZ25zKQogICAgXQogICAgcmV0dXJuICIiLmpvaW4odmFsdWVzX3dpdGhfYXR0cnMpICsgInx8IgoKCmRlZiBfbGF0ZXhfbGluZV9iZWdpbl90YWJ1bGFyKGNvbHdpZHRocywgY29sYWxpZ25zLCBib29rdGFicz1GYWxzZSwgbG9uZ3RhYmxlPUZhbHNlKToKICAgIGFsaWdubWVudCA9IHsibGVmdCI6ICJsIiwgInJpZ2h0IjogInIiLCAiY2VudGVyIjogImMiLCAiZGVjaW1hbCI6ICJyIn0KICAgIHRhYnVsYXJfY29sdW1uc19mbXQgPSAiIi5qb2luKFthbGlnbm1lbnQuZ2V0KGEsICJsIikgZm9yIGEgaW4gY29sYWxpZ25zXSkKICAgIHJldHVybiAiXG4iLmpvaW4oCiAgICAgICAgWwogICAgICAgICAgICAoIlxcYmVnaW57dGFidWxhcn17IiBpZiBub3QgbG9uZ3RhYmxlIGVsc2UgIlxcYmVnaW57bG9uZ3RhYmxlfXsiKQogICAgICAgICAgICArIHRhYnVsYXJfY29sdW1uc19mbXQKICAgICAgICAgICAgKyAifSIsCiAgICAgICAgICAgICJcXHRvcHJ1bGUiIGlmIGJvb2t0YWJzIGVsc2UgIlxcaGxpbmUiLAogICAgICAgIF0KICAgICkKCgpkZWYgX2FzY2lpZG9jX3Jvdyhpc19oZWFkZXIsICphcmdzKToKICAgICIiImhhbmRsZSBoZWFkZXIgYW5kIGRhdGEgcm93cyBmb3IgYXNjaWlkb2MgZm9ybWF0IiIiCgogICAgZGVmIG1ha2VfaGVhZGVyX2xpbmUoaXNfaGVhZGVyLCBjb2x3aWR0aHMsIGNvbGFsaWducyk6CiAgICAgICAgIyBnZW5lcmF0ZSB0aGUgY29sdW1uIHNwZWNpZmllcnMKCiAgICAgICAgYWxpZ25tZW50ID0geyJsZWZ0IjogIjwiLCAicmlnaHQiOiAiPiIsICJjZW50ZXIiOiAiXiIsICJkZWNpbWFsIjogIj4ifQogICAgICAgICMgdXNlIHRoZSBjb2x1bW4gd2lkdGhzIGdlbmVyYXRlZCBieSB0YWJ1bGF0ZSBmb3IgdGhlIGFzY2lpZG9jIGNvbHVtbiB3aWR0aCBzcGVjaWZpZXJzCiAgICAgICAgYXNjaWlkb2NfYWxpZ25tZW50cyA9IHppcCgKICAgICAgICAgICAgY29sd2lkdGhzLCBbYWxpZ25tZW50W2NvbGFsaWduXSBmb3IgY29sYWxpZ24gaW4gY29sYWxpZ25zXQogICAgICAgICkKICAgICAgICBhc2NpaWRvY19jb2x1bW5fc3BlY2lmaWVycyA9IFsKICAgICAgICAgICAgIns6ZH17fSIuZm9ybWF0KHdpZHRoLCBhbGlnbikgZm9yIHdpZHRoLCBhbGlnbiBpbiBhc2NpaWRvY19hbGlnbm1lbnRzCiAgICAgICAgXQogICAgICAgIGhlYWRlcl9saXN0ID0gWydjb2xzPSInICsgKCIsIi5qb2luKGFzY2lpZG9jX2NvbHVtbl9zcGVjaWZpZXJzKSkgKyAnIiddCgogICAgICAgICMgZ2VuZXJhdGUgdGhlIGxpc3Qgb2Ygb3B0aW9ucyAoY3VycmVudGx5IG9ubHkgImhlYWRlciIpCiAgICAgICAgb3B0aW9uc19saXN0ID0gW10KCiAgICAgICAgaWYgaXNfaGVhZGVyOgogICAgICAgICAgICBvcHRpb25zX2xpc3QuYXBwZW5kKCJoZWFkZXIiKQoKICAgICAgICBpZiBvcHRpb25zX2xpc3Q6CiAgICAgICAgICAgIGhlYWRlcl9saXN0ICs9IFsnb3B0aW9ucz0iJyArICIsIi5qb2luKG9wdGlvbnNfbGlzdCkgKyAnIiddCgogICAgICAgICMgZ2VuZXJhdGUgdGhlIGxpc3Qgb2YgZW50cmllcyBpbiB0aGUgdGFibGUgaGVhZGVyIGZpZWxkCgogICAgICAgIHJldHVybiAiW3t9XVxufD09PT0iLmZvcm1hdCgiLCIuam9pbihoZWFkZXJfbGlzdCkpCgogICAgaWYgbGVuKGFyZ3MpID09IDI6CiAgICAgICAgIyB0d28gYXJndW1lbnRzIGFyZSBwYXNzZWQgaWYgY2FsbGVkIGluIHRoZSBjb250ZXh0IG9mIGFib3ZlbGluZQogICAgICAgICMgcHJpbnQgdGhlIHRhYmxlIGhlYWRlciB3aXRoIGNvbHVtbiB3aWR0aHMgYW5kIG9wdGlvbmFsIGhlYWRlciB0YWcKICAgICAgICByZXR1cm4gbWFrZV9oZWFkZXJfbGluZShGYWxzZSwgKmFyZ3MpCgogICAgZWxpZiBsZW4oYXJncykgPT0gMzoKICAgICAgICAjIHRocmVlIGFyZ3VtZW50cyBhcmUgcGFzc2VkIGlmIGNhbGxlZCBpbiB0aGUgY29udGV4dCBvZiBkYXRhbGluZSBvciBoZWFkZXJsaW5lCiAgICAgICAgIyBwcmludCB0aGUgdGFibGUgbGluZSBhbmQgbWFrZSB0aGUgYWJvdmVsaW5lIGlmIGl0IGlzIGEgaGVhZGVyCgogICAgICAgIGNlbGxfdmFsdWVzLCBjb2x3aWR0aHMsIGNvbGFsaWducyA9IGFyZ3MKICAgICAgICBkYXRhX2xpbmUgPSAifCIgKyAifCIuam9pbihjZWxsX3ZhbHVlcykKCiAgICAgICAgaWYgaXNfaGVhZGVyOgogICAgICAgICAgICByZXR1cm4gbWFrZV9oZWFkZXJfbGluZShUcnVlLCBjb2x3aWR0aHMsIGNvbGFsaWducykgKyAiXG4iICsgZGF0YV9saW5lCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIGRhdGFfbGluZQoKICAgIGVsc2U6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigKICAgICAgICAgICAgIiBfYXNjaWlkb2Nfcm93KCkgcmVxdWlyZXMgdHdvIChjb2x3aWR0aHMsIGNvbGFsaWducykgIgogICAgICAgICAgICArICJvciB0aHJlZSAoY2VsbF92YWx1ZXMsIGNvbHdpZHRocywgY29sYWxpZ25zKSBhcmd1bWVudHMpICIKICAgICAgICApCgoKTEFURVhfRVNDQVBFX1JVTEVTID0gewogICAgciImIjogciJcJiIsCiAgICByIiUiOiByIlwlIiwKICAgIHIiJCI6IHIiXCQiLAogICAgciIjIjogciJcIyIsCiAgICByIl8iOiByIlxfIiwKICAgIHIiXiI6IHIiXF57fSIsCiAgICByInsiOiByIlx7IiwKICAgIHIifSI6IHIiXH0iLAogICAgciJ+IjogciJcdGV4dGFzY2lpdGlsZGV7fSIsCiAgICAiXFwiOiByIlx0ZXh0YmFja3NsYXNoe30iLAogICAgciI8IjogciJcZW5zdXJlbWF0aHs8fSIsCiAgICByIj4iOiByIlxlbnN1cmVtYXRoez59IiwKfQoKCmRlZiBfbGF0ZXhfcm93KGNlbGxfdmFsdWVzLCBjb2x3aWR0aHMsIGNvbGFsaWducywgZXNjcnVsZXM9TEFURVhfRVNDQVBFX1JVTEVTKToKICAgIGRlZiBlc2NhcGVfY2hhcihjKToKICAgICAgICByZXR1cm4gZXNjcnVsZXMuZ2V0KGMsIGMpCgogICAgZXNjYXBlZF92YWx1ZXMgPSBbIiIuam9pbihtYXAoZXNjYXBlX2NoYXIsIGNlbGwpKSBmb3IgY2VsbCBpbiBjZWxsX3ZhbHVlc10KICAgIHJvd2ZtdCA9IERhdGFSb3coIiIsICImIiwgIlxcXFwiKQogICAgcmV0dXJuIF9idWlsZF9zaW1wbGVfcm93KGVzY2FwZWRfdmFsdWVzLCByb3dmbXQpCgoKZGVmIF9yc3RfZXNjYXBlX2ZpcnN0X2NvbHVtbihyb3dzLCBoZWFkZXJzKToKICAgIGRlZiBlc2NhcGVfZW1wdHkodmFsKToKICAgICAgICBpZiBpc2luc3RhbmNlKHZhbCwgKHN0ciwgYnl0ZXMpKSBhbmQgbm90IHZhbC5zdHJpcCgpOgogICAgICAgICAgICByZXR1cm4gIi4uIgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiB2YWwKCiAgICBuZXdfaGVhZGVycyA9IGxpc3QoaGVhZGVycykKICAgIG5ld19yb3dzID0gW10KICAgIGlmIGhlYWRlcnM6CiAgICAgICAgbmV3X2hlYWRlcnNbMF0gPSBlc2NhcGVfZW1wdHkoaGVhZGVyc1swXSkKICAgIGZvciByb3cgaW4gcm93czoKICAgICAgICBuZXdfcm93ID0gbGlzdChyb3cpCiAgICAgICAgaWYgbmV3X3JvdzoKICAgICAgICAgICAgbmV3X3Jvd1swXSA9IGVzY2FwZV9lbXB0eShyb3dbMF0pCiAgICAgICAgbmV3X3Jvd3MuYXBwZW5kKG5ld19yb3cpCiAgICByZXR1cm4gbmV3X3Jvd3MsIG5ld19oZWFkZXJzCgoKX3RhYmxlX2Zvcm1hdHMgPSB7CiAgICAic2ltcGxlIjogVGFibGVGb3JtYXQoCiAgICAgICAgbGluZWFib3ZlPUxpbmUoIiIsICItIiwgIiAgIiwgIiIpLAogICAgICAgIGxpbmViZWxvd2hlYWRlcj1MaW5lKCIiLCAiLSIsICIgICIsICIiKSwKICAgICAgICBsaW5lYmV0d2VlbnJvd3M9Tm9uZSwKICAgICAgICBsaW5lYmVsb3c9TGluZSgiIiwgIi0iLCAiICAiLCAiIiksCiAgICAgICAgaGVhZGVycm93PURhdGFSb3coIiIsICIgICIsICIiKSwKICAgICAgICBkYXRhcm93PURhdGFSb3coIiIsICIgICIsICIiKSwKICAgICAgICBwYWRkaW5nPTAsCiAgICAgICAgd2l0aF9oZWFkZXJfaGlkZT1bImxpbmVhYm92ZSIsICJsaW5lYmVsb3ciXSwKICAgICksCiAgICAicGxhaW4iOiBUYWJsZUZvcm1hdCgKICAgICAgICBsaW5lYWJvdmU9Tm9uZSwKICAgICAgICBsaW5lYmVsb3doZWFkZXI9Tm9uZSwKICAgICAgICBsaW5lYmV0d2VlbnJvd3M9Tm9uZSwKICAgICAgICBsaW5lYmVsb3c9Tm9uZSwKICAgICAgICBoZWFkZXJyb3c9RGF0YVJvdygiIiwgIiAgIiwgIiIpLAogICAgICAgIGRhdGFyb3c9RGF0YVJvdygiIiwgIiAgIiwgIiIpLAogICAgICAgIHBhZGRpbmc9MCwKICAgICAgICB3aXRoX2hlYWRlcl9oaWRlPU5vbmUsCiAgICApLAogICAgImdyaWQiOiBUYWJsZUZvcm1hdCgKICAgICAgICBsaW5lYWJvdmU9TGluZSgiKyIsICItIiwgIisiLCAiKyIpLAogICAgICAgIGxpbmViZWxvd2hlYWRlcj1MaW5lKCIrIiwgIj0iLCAiKyIsICIrIiksCiAgICAgICAgbGluZWJldHdlZW5yb3dzPUxpbmUoIisiLCAiLSIsICIrIiwgIisiKSwKICAgICAgICBsaW5lYmVsb3c9TGluZSgiKyIsICItIiwgIisiLCAiKyIpLAogICAgICAgIGhlYWRlcnJvdz1EYXRhUm93KCJ8IiwgInwiLCAifCIpLAogICAgICAgIGRhdGFyb3c9RGF0YVJvdygifCIsICJ8IiwgInwiKSwKICAgICAgICBwYWRkaW5nPTEsCiAgICAgICAgd2l0aF9oZWFkZXJfaGlkZT1Ob25lLAogICAgKSwKICAgICJzaW1wbGVfZ3JpZCI6IFRhYmxlRm9ybWF0KAogICAgICAgIGxpbmVhYm92ZT1MaW5lKCLilIwiLCAi4pSAIiwgIuKUrCIsICLilJAiKSwKICAgICAgICBsaW5lYmVsb3doZWFkZXI9TGluZSgi4pScIiwgIuKUgCIsICLilLwiLCAi4pSkIiksCiAgICAgICAgbGluZWJldHdlZW5yb3dzPUxpbmUoIuKUnCIsICLilIAiLCAi4pS8IiwgIuKUpCIpLAogICAgICAgIGxpbmViZWxvdz1MaW5lKCLilJQiLCAi4pSAIiwgIuKUtCIsICLilJgiKSwKICAgICAgICBoZWFkZXJyb3c9RGF0YVJvdygi4pSCIiwgIuKUgiIsICLilIIiKSwKICAgICAgICBkYXRhcm93PURhdGFSb3coIuKUgiIsICLilIIiLCAi4pSCIiksCiAgICAgICAgcGFkZGluZz0xLAogICAgICAgIHdpdGhfaGVhZGVyX2hpZGU9Tm9uZSwKICAgICksCiAgICAicm91bmRlZF9ncmlkIjogVGFibGVGb3JtYXQoCiAgICAgICAgbGluZWFib3ZlPUxpbmUoIuKVrSIsICLilIAiLCAi4pSsIiwgIuKVriIpLAogICAgICAgIGxpbmViZWxvd2hlYWRlcj1MaW5lKCLilJwiLCAi4pSAIiwgIuKUvCIsICLilKQiKSwKICAgICAgICBsaW5lYmV0d2VlbnJvd3M9TGluZSgi4pScIiwgIuKUgCIsICLilLwiLCAi4pSkIiksCiAgICAgICAgbGluZWJlbG93PUxpbmUoIuKVsCIsICLilIAiLCAi4pS0IiwgIuKVryIpLAogICAgICAgIGhlYWRlcnJvdz1EYXRhUm93KCLilIIiLCAi4pSCIiwgIuKUgiIpLAogICAgICAgIGRhdGFyb3c9RGF0YVJvdygi4pSCIiwgIuKUgiIsICLilIIiKSwKICAgICAgICBwYWRkaW5nPTEsCiAgICAgICAgd2l0aF9oZWFkZXJfaGlkZT1Ob25lLAogICAgKSwKICAgICJoZWF2eV9ncmlkIjogVGFibGVGb3JtYXQoCiAgICAgICAgbGluZWFib3ZlPUxpbmUoIuKUjyIsICLilIEiLCAi4pSzIiwgIuKUkyIpLAogICAgICAgIGxpbmViZWxvd2hlYWRlcj1MaW5lKCLilKMiLCAi4pSBIiwgIuKViyIsICLilKsiKSwKICAgICAgICBsaW5lYmV0d2VlbnJvd3M9TGluZSgi4pSjIiwgIuKUgSIsICLilYsiLCAi4pSrIiksCiAgICAgICAgbGluZWJlbG93PUxpbmUoIuKUlyIsICLilIEiLCAi4pS7IiwgIuKUmyIpLAogICAgICAgIGhlYWRlcnJvdz1EYXRhUm93KCLilIMiLCAi4pSDIiwgIuKUgyIpLAogICAgICAgIGRhdGFyb3c9RGF0YVJvdygi4pSDIiwgIuKUgyIsICLilIMiKSwKICAgICAgICBwYWRkaW5nPTEsCiAgICAgICAgd2l0aF9oZWFkZXJfaGlkZT1Ob25lLAogICAgKSwKICAgICJtaXhlZF9ncmlkIjogVGFibGVGb3JtYXQoCiAgICAgICAgbGluZWFib3ZlPUxpbmUoIuKUjSIsICLilIEiLCAi4pSvIiwgIuKUkSIpLAogICAgICAgIGxpbmViZWxvd2hlYWRlcj1MaW5lKCLilJ0iLCAi4pSBIiwgIuKUvyIsICLilKUiKSwKICAgICAgICBsaW5lYmV0d2VlbnJvd3M9TGluZSgi4pScIiwgIuKUgCIsICLilLwiLCAi4pSkIiksCiAgICAgICAgbGluZWJlbG93PUxpbmUoIuKUlSIsICLilIEiLCAi4pS3IiwgIuKUmSIpLAogICAgICAgIGhlYWRlcnJvdz1EYXRhUm93KCLilIIiLCAi4pSCIiwgIuKUgiIpLAogICAgICAgIGRhdGFyb3c9RGF0YVJvdygi4pSCIiwgIuKUgiIsICLilIIiKSwKICAgICAgICBwYWRkaW5nPTEsCiAgICAgICAgd2l0aF9oZWFkZXJfaGlkZT1Ob25lLAogICAgKSwKICAgICJkb3VibGVfZ3JpZCI6IFRhYmxlRm9ybWF0KAogICAgICAgIGxpbmVhYm92ZT1MaW5lKCLilZQiLCAi4pWQIiwgIuKVpiIsICLilZciKSwKICAgICAgICBsaW5lYmVsb3doZWFkZXI9TGluZSgi4pWgIiwgIuKVkCIsICLilawiLCAi4pWjIiksCiAgICAgICAgbGluZWJldHdlZW5yb3dzPUxpbmUoIuKVoCIsICLilZAiLCAi4pWsIiwgIuKVoyIpLAogICAgICAgIGxpbmViZWxvdz1MaW5lKCLilZoiLCAi4pWQIiwgIuKVqSIsICLilZ0iKSwKICAgICAgICBoZWFkZXJyb3c9RGF0YVJvdygi4pWRIiwgIuKVkSIsICLilZEiKSwKICAgICAgICBkYXRhcm93PURhdGFSb3coIuKVkSIsICLilZEiLCAi4pWRIiksCiAgICAgICAgcGFkZGluZz0xLAogICAgICAgIHdpdGhfaGVhZGVyX2hpZGU9Tm9uZSwKICAgICksCiAgICAiZmFuY3lfZ3JpZCI6IFRhYmxlRm9ybWF0KAogICAgICAgIGxpbmVhYm92ZT1MaW5lKCLilZIiLCAi4pWQIiwgIuKVpCIsICLilZUiKSwKICAgICAgICBsaW5lYmVsb3doZWFkZXI9TGluZSgi4pWeIiwgIuKVkCIsICLilaoiLCAi4pWhIiksCiAgICAgICAgbGluZWJldHdlZW5yb3dzPUxpbmUoIuKUnCIsICLilIAiLCAi4pS8IiwgIuKUpCIpLAogICAgICAgIGxpbmViZWxvdz1MaW5lKCLilZgiLCAi4pWQIiwgIuKVpyIsICLilZsiKSwKICAgICAgICBoZWFkZXJyb3c9RGF0YVJvdygi4pSCIiwgIuKUgiIsICLilIIiKSwKICAgICAgICBkYXRhcm93PURhdGFSb3coIuKUgiIsICLilIIiLCAi4pSCIiksCiAgICAgICAgcGFkZGluZz0xLAogICAgICAgIHdpdGhfaGVhZGVyX2hpZGU9Tm9uZSwKICAgICksCiAgICAib3V0bGluZSI6IFRhYmxlRm9ybWF0KAogICAgICAgIGxpbmVhYm92ZT1MaW5lKCIrIiwgIi0iLCAiKyIsICIrIiksCiAgICAgICAgbGluZWJlbG93aGVhZGVyPUxpbmUoIisiLCAiPSIsICIrIiwgIisiKSwKICAgICAgICBsaW5lYmV0d2VlbnJvd3M9Tm9uZSwKICAgICAgICBsaW5lYmVsb3c9TGluZSgiKyIsICItIiwgIisiLCAiKyIpLAogICAgICAgIGhlYWRlcnJvdz1EYXRhUm93KCJ8IiwgInwiLCAifCIpLAogICAgICAgIGRhdGFyb3c9RGF0YVJvdygifCIsICJ8IiwgInwiKSwKICAgICAgICBwYWRkaW5nPTEsCiAgICAgICAgd2l0aF9oZWFkZXJfaGlkZT1Ob25lLAogICAgKSwKICAgICJzaW1wbGVfb3V0bGluZSI6IFRhYmxlRm9ybWF0KAogICAgICAgIGxpbmVhYm92ZT1MaW5lKCLilIwiLCAi4pSAIiwgIuKUrCIsICLilJAiKSwKICAgICAgICBsaW5lYmVsb3doZWFkZXI9TGluZSgi4pScIiwgIuKUgCIsICLilLwiLCAi4pSkIiksCiAgICAgICAgbGluZWJldHdlZW5yb3dzPU5vbmUsCiAgICAgICAgbGluZWJlbG93PUxpbmUoIuKUlCIsICLilIAiLCAi4pS0IiwgIuKUmCIpLAogICAgICAgIGhlYWRlcnJvdz1EYXRhUm93KCLilIIiLCAi4pSCIiwgIuKUgiIpLAogICAgICAgIGRhdGFyb3c9RGF0YVJvdygi4pSCIiwgIuKUgiIsICLilIIiKSwKICAgICAgICBwYWRkaW5nPTEsCiAgICAgICAgd2l0aF9oZWFkZXJfaGlkZT1Ob25lLAogICAgKSwKICAgICJyb3VuZGVkX291dGxpbmUiOiBUYWJsZUZvcm1hdCgKICAgICAgICBsaW5lYWJvdmU9TGluZSgi4pWtIiwgIuKUgCIsICLilKwiLCAi4pWuIiksCiAgICAgICAgbGluZWJlbG93aGVhZGVyPUxpbmUoIuKUnCIsICLilIAiLCAi4pS8IiwgIuKUpCIpLAogICAgICAgIGxpbmViZXR3ZWVucm93cz1Ob25lLAogICAgICAgIGxpbmViZWxvdz1MaW5lKCLilbAiLCAi4pSAIiwgIuKUtCIsICLila8iKSwKICAgICAgICBoZWFkZXJyb3c9RGF0YVJvdygi4pSCIiwgIuKUgiIsICLilIIiKSwKICAgICAgICBkYXRhcm93PURhdGFSb3coIuKUgiIsICLilIIiLCAi4pSCIiksCiAgICAgICAgcGFkZGluZz0xLAogICAgICAgIHdpdGhfaGVhZGVyX2hpZGU9Tm9uZSwKICAgICksCiAgICAiaGVhdnlfb3V0bGluZSI6IFRhYmxlRm9ybWF0KAogICAgICAgIGxpbmVhYm92ZT1MaW5lKCLilI8iLCAi4pSBIiwgIuKUsyIsICLilJMiKSwKICAgICAgICBsaW5lYmVsb3doZWFkZXI9TGluZSgi4pSjIiwgIuKUgSIsICLilYsiLCAi4pSrIiksCiAgICAgICAgbGluZWJldHdlZW5yb3dzPU5vbmUsCiAgICAgICAgbGluZWJlbG93PUxpbmUoIuKUlyIsICLilIEiLCAi4pS7IiwgIuKUmyIpLAogICAgICAgIGhlYWRlcnJvdz1EYXRhUm93KCLilIMiLCAi4pSDIiwgIuKUgyIpLAogICAgICAgIGRhdGFyb3c9RGF0YVJvdygi4pSDIiwgIuKUgyIsICLilIMiKSwKICAgICAgICBwYWRkaW5nPTEsCiAgICAgICAgd2l0aF9oZWFkZXJfaGlkZT1Ob25lLAogICAgKSwKICAgICJtaXhlZF9vdXRsaW5lIjogVGFibGVGb3JtYXQoCiAgICAgICAgbGluZWFib3ZlPUxpbmUoIuKUjSIsICLilIEiLCAi4pSvIiwgIuKUkSIpLAogICAgICAgIGxpbmViZWxvd2hlYWRlcj1MaW5lKCLilJ0iLCAi4pSBIiwgIuKUvyIsICLilKUiKSwKICAgICAgICBsaW5lYmV0d2VlbnJvd3M9Tm9uZSwKICAgICAgICBsaW5lYmVsb3c9TGluZSgi4pSVIiwgIuKUgSIsICLilLciLCAi4pSZIiksCiAgICAgICAgaGVhZGVycm93PURhdGFSb3coIuKUgiIsICLilIIiLCAi4pSCIiksCiAgICAgICAgZGF0YXJvdz1EYXRhUm93KCLilIIiLCAi4pSCIiwgIuKUgiIpLAogICAgICAgIHBhZGRpbmc9MSwKICAgICAgICB3aXRoX2hlYWRlcl9oaWRlPU5vbmUsCiAgICApLAogICAgImRvdWJsZV9vdXRsaW5lIjogVGFibGVGb3JtYXQoCiAgICAgICAgbGluZWFib3ZlPUxpbmUoIuKVlCIsICLilZAiLCAi4pWmIiwgIuKVlyIpLAogICAgICAgIGxpbmViZWxvd2hlYWRlcj1MaW5lKCLilaAiLCAi4pWQIiwgIuKVrCIsICLilaMiKSwKICAgICAgICBsaW5lYmV0d2VlbnJvd3M9Tm9uZSwKICAgICAgICBsaW5lYmVsb3c9TGluZSgi4pWaIiwgIuKVkCIsICLilakiLCAi4pWdIiksCiAgICAgICAgaGVhZGVycm93PURhdGFSb3coIuKVkSIsICLilZEiLCAi4pWRIiksCiAgICAgICAgZGF0YXJvdz1EYXRhUm93KCLilZEiLCAi4pWRIiwgIuKVkSIpLAogICAgICAgIHBhZGRpbmc9MSwKICAgICAgICB3aXRoX2hlYWRlcl9oaWRlPU5vbmUsCiAgICApLAogICAgImZhbmN5X291dGxpbmUiOiBUYWJsZUZvcm1hdCgKICAgICAgICBsaW5lYWJvdmU9TGluZSgi4pWSIiwgIuKVkCIsICLilaQiLCAi4pWVIiksCiAgICAgICAgbGluZWJlbG93aGVhZGVyPUxpbmUoIuKVniIsICLilZAiLCAi4pWqIiwgIuKVoSIpLAogICAgICAgIGxpbmViZXR3ZWVucm93cz1Ob25lLAogICAgICAgIGxpbmViZWxvdz1MaW5lKCLilZgiLCAi4pWQIiwgIuKVpyIsICLilZsiKSwKICAgICAgICBoZWFkZXJyb3c9RGF0YVJvdygi4pSCIiwgIuKUgiIsICLilIIiKSwKICAgICAgICBkYXRhcm93PURhdGFSb3coIuKUgiIsICLilIIiLCAi4pSCIiksCiAgICAgICAgcGFkZGluZz0xLAogICAgICAgIHdpdGhfaGVhZGVyX2hpZGU9Tm9uZSwKICAgICksCiAgICAiZ2l0aHViIjogVGFibGVGb3JtYXQoCiAgICAgICAgbGluZWFib3ZlPUxpbmUoInwiLCAiLSIsICJ8IiwgInwiKSwKICAgICAgICBsaW5lYmVsb3doZWFkZXI9TGluZSgifCIsICItIiwgInwiLCAifCIpLAogICAgICAgIGxpbmViZXR3ZWVucm93cz1Ob25lLAogICAgICAgIGxpbmViZWxvdz1Ob25lLAogICAgICAgIGhlYWRlcnJvdz1EYXRhUm93KCJ8IiwgInwiLCAifCIpLAogICAgICAgIGRhdGFyb3c9RGF0YVJvdygifCIsICJ8IiwgInwiKSwKICAgICAgICBwYWRkaW5nPTEsCiAgICAgICAgd2l0aF9oZWFkZXJfaGlkZT1bImxpbmVhYm92ZSJdLAogICAgKSwKICAgICJwaXBlIjogVGFibGVGb3JtYXQoCiAgICAgICAgbGluZWFib3ZlPV9waXBlX2xpbmVfd2l0aF9jb2xvbnMsCiAgICAgICAgbGluZWJlbG93aGVhZGVyPV9waXBlX2xpbmVfd2l0aF9jb2xvbnMsCiAgICAgICAgbGluZWJldHdlZW5yb3dzPU5vbmUsCiAgICAgICAgbGluZWJlbG93PU5vbmUsCiAgICAgICAgaGVhZGVycm93PURhdGFSb3coInwiLCAifCIsICJ8IiksCiAgICAgICAgZGF0YXJvdz1EYXRhUm93KCJ8IiwgInwiLCAifCIpLAogICAgICAgIHBhZGRpbmc9MSwKICAgICAgICB3aXRoX2hlYWRlcl9oaWRlPVsibGluZWFib3ZlIl0sCiAgICApLAogICAgIm9yZ3RibCI6IFRhYmxlRm9ybWF0KAogICAgICAgIGxpbmVhYm92ZT1Ob25lLAogICAgICAgIGxpbmViZWxvd2hlYWRlcj1MaW5lKCJ8IiwgIi0iLCAiKyIsICJ8IiksCiAgICAgICAgbGluZWJldHdlZW5yb3dzPU5vbmUsCiAgICAgICAgbGluZWJlbG93PU5vbmUsCiAgICAgICAgaGVhZGVycm93PURhdGFSb3coInwiLCAifCIsICJ8IiksCiAgICAgICAgZGF0YXJvdz1EYXRhUm93KCJ8IiwgInwiLCAifCIpLAogICAgICAgIHBhZGRpbmc9MSwKICAgICAgICB3aXRoX2hlYWRlcl9oaWRlPU5vbmUsCiAgICApLAogICAgImppcmEiOiBUYWJsZUZvcm1hdCgKICAgICAgICBsaW5lYWJvdmU9Tm9uZSwKICAgICAgICBsaW5lYmVsb3doZWFkZXI9Tm9uZSwKICAgICAgICBsaW5lYmV0d2VlbnJvd3M9Tm9uZSwKICAgICAgICBsaW5lYmVsb3c9Tm9uZSwKICAgICAgICBoZWFkZXJyb3c9RGF0YVJvdygifHwiLCAifHwiLCAifHwiKSwKICAgICAgICBkYXRhcm93PURhdGFSb3coInwiLCAifCIsICJ8IiksCiAgICAgICAgcGFkZGluZz0xLAogICAgICAgIHdpdGhfaGVhZGVyX2hpZGU9Tm9uZSwKICAgICksCiAgICAicHJlc3RvIjogVGFibGVGb3JtYXQoCiAgICAgICAgbGluZWFib3ZlPU5vbmUsCiAgICAgICAgbGluZWJlbG93aGVhZGVyPUxpbmUoIiIsICItIiwgIisiLCAiIiksCiAgICAgICAgbGluZWJldHdlZW5yb3dzPU5vbmUsCiAgICAgICAgbGluZWJlbG93PU5vbmUsCiAgICAgICAgaGVhZGVycm93PURhdGFSb3coIiIsICJ8IiwgIiIpLAogICAgICAgIGRhdGFyb3c9RGF0YVJvdygiIiwgInwiLCAiIiksCiAgICAgICAgcGFkZGluZz0xLAogICAgICAgIHdpdGhfaGVhZGVyX2hpZGU9Tm9uZSwKICAgICksCiAgICAicHJldHR5IjogVGFibGVGb3JtYXQoCiAgICAgICAgbGluZWFib3ZlPUxpbmUoIisiLCAiLSIsICIrIiwgIisiKSwKICAgICAgICBsaW5lYmVsb3doZWFkZXI9TGluZSgiKyIsICItIiwgIisiLCAiKyIpLAogICAgICAgIGxpbmViZXR3ZWVucm93cz1Ob25lLAogICAgICAgIGxpbmViZWxvdz1MaW5lKCIrIiwgIi0iLCAiKyIsICIrIiksCiAgICAgICAgaGVhZGVycm93PURhdGFSb3coInwiLCAifCIsICJ8IiksCiAgICAgICAgZGF0YXJvdz1EYXRhUm93KCJ8IiwgInwiLCAifCIpLAogICAgICAgIHBhZGRpbmc9MSwKICAgICAgICB3aXRoX2hlYWRlcl9oaWRlPU5vbmUsCiAgICApLAogICAgInBzcWwiOiBUYWJsZUZvcm1hdCgKICAgICAgICBsaW5lYWJvdmU9TGluZSgiKyIsICItIiwgIisiLCAiKyIpLAogICAgICAgIGxpbmViZWxvd2hlYWRlcj1MaW5lKCJ8IiwgIi0iLCAiKyIsICJ8IiksCiAgICAgICAgbGluZWJldHdlZW5yb3dzPU5vbmUsCiAgICAgICAgbGluZWJlbG93PUxpbmUoIisiLCAiLSIsICIrIiwgIisiKSwKICAgICAgICBoZWFkZXJyb3c9RGF0YVJvdygifCIsICJ8IiwgInwiKSwKICAgICAgICBkYXRhcm93PURhdGFSb3coInwiLCAifCIsICJ8IiksCiAgICAgICAgcGFkZGluZz0xLAogICAgICAgIHdpdGhfaGVhZGVyX2hpZGU9Tm9uZSwKICAgICksCiAgICAicnN0IjogVGFibGVGb3JtYXQoCiAgICAgICAgbGluZWFib3ZlPUxpbmUoIiIsICI9IiwgIiAgIiwgIiIpLAogICAgICAgIGxpbmViZWxvd2hlYWRlcj1MaW5lKCIiLCAiPSIsICIgICIsICIiKSwKICAgICAgICBsaW5lYmV0d2VlbnJvd3M9Tm9uZSwKICAgICAgICBsaW5lYmVsb3c9TGluZSgiIiwgIj0iLCAiICAiLCAiIiksCiAgICAgICAgaGVhZGVycm93PURhdGFSb3coIiIsICIgICIsICIiKSwKICAgICAgICBkYXRhcm93PURhdGFSb3coIiIsICIgICIsICIiKSwKICAgICAgICBwYWRkaW5nPTAsCiAgICAgICAgd2l0aF9oZWFkZXJfaGlkZT1Ob25lLAogICAgKSwKICAgICJtZWRpYXdpa2kiOiBUYWJsZUZvcm1hdCgKICAgICAgICBsaW5lYWJvdmU9TGluZSgKICAgICAgICAgICAgJ3t8IGNsYXNzPSJ3aWtpdGFibGUiIHN0eWxlPSJ0ZXh0LWFsaWduOiBsZWZ0OyInLAogICAgICAgICAgICAiIiwKICAgICAgICAgICAgIiIsCiAgICAgICAgICAgICJcbnwrIDwhLS0gY2FwdGlvbiAtLT5cbnwtIiwKICAgICAgICApLAogICAgICAgIGxpbmViZWxvd2hlYWRlcj1MaW5lKCJ8LSIsICIiLCAiIiwgIiIpLAogICAgICAgIGxpbmViZXR3ZWVucm93cz1MaW5lKCJ8LSIsICIiLCAiIiwgIiIpLAogICAgICAgIGxpbmViZWxvdz1MaW5lKCJ8fSIsICIiLCAiIiwgIiIpLAogICAgICAgIGhlYWRlcnJvdz1wYXJ0aWFsKF9tZWRpYXdpa2lfcm93X3dpdGhfYXR0cnMsICIhIiksCiAgICAgICAgZGF0YXJvdz1wYXJ0aWFsKF9tZWRpYXdpa2lfcm93X3dpdGhfYXR0cnMsICJ8IiksCiAgICAgICAgcGFkZGluZz0wLAogICAgICAgIHdpdGhfaGVhZGVyX2hpZGU9Tm9uZSwKICAgICksCiAgICAibW9pbm1vaW4iOiBUYWJsZUZvcm1hdCgKICAgICAgICBsaW5lYWJvdmU9Tm9uZSwKICAgICAgICBsaW5lYmVsb3doZWFkZXI9Tm9uZSwKICAgICAgICBsaW5lYmV0d2VlbnJvd3M9Tm9uZSwKICAgICAgICBsaW5lYmVsb3c9Tm9uZSwKICAgICAgICBoZWFkZXJyb3c9cGFydGlhbChfbW9pbl9yb3dfd2l0aF9hdHRycywgInx8IiwgaGVhZGVyPSInJyciKSwKICAgICAgICBkYXRhcm93PXBhcnRpYWwoX21vaW5fcm93X3dpdGhfYXR0cnMsICJ8fCIpLAogICAgICAgIHBhZGRpbmc9MSwKICAgICAgICB3aXRoX2hlYWRlcl9oaWRlPU5vbmUsCiAgICApLAogICAgInlvdXRyYWNrIjogVGFibGVGb3JtYXQoCiAgICAgICAgbGluZWFib3ZlPU5vbmUsCiAgICAgICAgbGluZWJlbG93aGVhZGVyPU5vbmUsCiAgICAgICAgbGluZWJldHdlZW5yb3dzPU5vbmUsCiAgICAgICAgbGluZWJlbG93PU5vbmUsCiAgICAgICAgaGVhZGVycm93PURhdGFSb3coInx8ICIsICIgfHwgIiwgIiB8fCAiKSwKICAgICAgICBkYXRhcm93PURhdGFSb3coInwgIiwgIiB8ICIsICIgfCIpLAogICAgICAgIHBhZGRpbmc9MSwKICAgICAgICB3aXRoX2hlYWRlcl9oaWRlPU5vbmUsCiAgICApLAogICAgImh0bWwiOiBUYWJsZUZvcm1hdCgKICAgICAgICBsaW5lYWJvdmU9X2h0bWxfYmVnaW5fdGFibGVfd2l0aG91dF9oZWFkZXIsCiAgICAgICAgbGluZWJlbG93aGVhZGVyPSIiLAogICAgICAgIGxpbmViZXR3ZWVucm93cz1Ob25lLAogICAgICAgIGxpbmViZWxvdz1MaW5lKCI8L3Rib2R5PlxuPC90YWJsZT4iLCAiIiwgIiIsICIiKSwKICAgICAgICBoZWFkZXJyb3c9cGFydGlhbChfaHRtbF9yb3dfd2l0aF9hdHRycywgInRoIiwgRmFsc2UpLAogICAgICAgIGRhdGFyb3c9cGFydGlhbChfaHRtbF9yb3dfd2l0aF9hdHRycywgInRkIiwgRmFsc2UpLAogICAgICAgIHBhZGRpbmc9MCwKICAgICAgICB3aXRoX2hlYWRlcl9oaWRlPVsibGluZWFib3ZlIl0sCiAgICApLAogICAgInVuc2FmZWh0bWwiOiBUYWJsZUZvcm1hdCgKICAgICAgICBsaW5lYWJvdmU9X2h0bWxfYmVnaW5fdGFibGVfd2l0aG91dF9oZWFkZXIsCiAgICAgICAgbGluZWJlbG93aGVhZGVyPSIiLAogICAgICAgIGxpbmViZXR3ZWVucm93cz1Ob25lLAogICAgICAgIGxpbmViZWxvdz1MaW5lKCI8L3Rib2R5PlxuPC90YWJsZT4iLCAiIiwgIiIsICIiKSwKICAgICAgICBoZWFkZXJyb3c9cGFydGlhbChfaHRtbF9yb3dfd2l0aF9hdHRycywgInRoIiwgVHJ1ZSksCiAgICAgICAgZGF0YXJvdz1wYXJ0aWFsKF9odG1sX3Jvd193aXRoX2F0dHJzLCAidGQiLCBUcnVlKSwKICAgICAgICBwYWRkaW5nPTAsCiAgICAgICAgd2l0aF9oZWFkZXJfaGlkZT1bImxpbmVhYm92ZSJdLAogICAgKSwKICAgICJsYXRleCI6IFRhYmxlRm9ybWF0KAogICAgICAgIGxpbmVhYm92ZT1fbGF0ZXhfbGluZV9iZWdpbl90YWJ1bGFyLAogICAgICAgIGxpbmViZWxvd2hlYWRlcj1MaW5lKCJcXGhsaW5lIiwgIiIsICIiLCAiIiksCiAgICAgICAgbGluZWJldHdlZW5yb3dzPU5vbmUsCiAgICAgICAgbGluZWJlbG93PUxpbmUoIlxcaGxpbmVcblxcZW5ke3RhYnVsYXJ9IiwgIiIsICIiLCAiIiksCiAgICAgICAgaGVhZGVycm93PV9sYXRleF9yb3csCiAgICAgICAgZGF0YXJvdz1fbGF0ZXhfcm93LAogICAgICAgIHBhZGRpbmc9MSwKICAgICAgICB3aXRoX2hlYWRlcl9oaWRlPU5vbmUsCiAgICApLAogICAgImxhdGV4X3JhdyI6IFRhYmxlRm9ybWF0KAogICAgICAgIGxpbmVhYm92ZT1fbGF0ZXhfbGluZV9iZWdpbl90YWJ1bGFyLAogICAgICAgIGxpbmViZWxvd2hlYWRlcj1MaW5lKCJcXGhsaW5lIiwgIiIsICIiLCAiIiksCiAgICAgICAgbGluZWJldHdlZW5yb3dzPU5vbmUsCiAgICAgICAgbGluZWJlbG93PUxpbmUoIlxcaGxpbmVcblxcZW5ke3RhYnVsYXJ9IiwgIiIsICIiLCAiIiksCiAgICAgICAgaGVhZGVycm93PXBhcnRpYWwoX2xhdGV4X3JvdywgZXNjcnVsZXM9e30pLAogICAgICAgIGRhdGFyb3c9cGFydGlhbChfbGF0ZXhfcm93LCBlc2NydWxlcz17fSksCiAgICAgICAgcGFkZGluZz0xLAogICAgICAgIHdpdGhfaGVhZGVyX2hpZGU9Tm9uZSwKICAgICksCiAgICAibGF0ZXhfYm9va3RhYnMiOiBUYWJsZUZvcm1hdCgKICAgICAgICBsaW5lYWJvdmU9cGFydGlhbChfbGF0ZXhfbGluZV9iZWdpbl90YWJ1bGFyLCBib29rdGFicz1UcnVlKSwKICAgICAgICBsaW5lYmVsb3doZWFkZXI9TGluZSgiXFxtaWRydWxlIiwgIiIsICIiLCAiIiksCiAgICAgICAgbGluZWJldHdlZW5yb3dzPU5vbmUsCiAgICAgICAgbGluZWJlbG93PUxpbmUoIlxcYm90dG9tcnVsZVxuXFxlbmR7dGFidWxhcn0iLCAiIiwgIiIsICIiKSwKICAgICAgICBoZWFkZXJyb3c9X2xhdGV4X3JvdywKICAgICAgICBkYXRhcm93PV9sYXRleF9yb3csCiAgICAgICAgcGFkZGluZz0xLAogICAgICAgIHdpdGhfaGVhZGVyX2hpZGU9Tm9uZSwKICAgICksCiAgICAibGF0ZXhfbG9uZ3RhYmxlIjogVGFibGVGb3JtYXQoCiAgICAgICAgbGluZWFib3ZlPXBhcnRpYWwoX2xhdGV4X2xpbmVfYmVnaW5fdGFidWxhciwgbG9uZ3RhYmxlPVRydWUpLAogICAgICAgIGxpbmViZWxvd2hlYWRlcj1MaW5lKCJcXGhsaW5lXG5cXGVuZGhlYWQiLCAiIiwgIiIsICIiKSwKICAgICAgICBsaW5lYmV0d2VlbnJvd3M9Tm9uZSwKICAgICAgICBsaW5lYmVsb3c9TGluZSgiXFxobGluZVxuXFxlbmR7bG9uZ3RhYmxlfSIsICIiLCAiIiwgIiIpLAogICAgICAgIGhlYWRlcnJvdz1fbGF0ZXhfcm93LAogICAgICAgIGRhdGFyb3c9X2xhdGV4X3JvdywKICAgICAgICBwYWRkaW5nPTEsCiAgICAgICAgd2l0aF9oZWFkZXJfaGlkZT1Ob25lLAogICAgKSwKICAgICJ0c3YiOiBUYWJsZUZvcm1hdCgKICAgICAgICBsaW5lYWJvdmU9Tm9uZSwKICAgICAgICBsaW5lYmVsb3doZWFkZXI9Tm9uZSwKICAgICAgICBsaW5lYmV0d2VlbnJvd3M9Tm9uZSwKICAgICAgICBsaW5lYmVsb3c9Tm9uZSwKICAgICAgICBoZWFkZXJyb3c9RGF0YVJvdygiIiwgIlx0IiwgIiIpLAogICAgICAgIGRhdGFyb3c9RGF0YVJvdygiIiwgIlx0IiwgIiIpLAogICAgICAgIHBhZGRpbmc9MCwKICAgICAgICB3aXRoX2hlYWRlcl9oaWRlPU5vbmUsCiAgICApLAogICAgInRleHRpbGUiOiBUYWJsZUZvcm1hdCgKICAgICAgICBsaW5lYWJvdmU9Tm9uZSwKICAgICAgICBsaW5lYmVsb3doZWFkZXI9Tm9uZSwKICAgICAgICBsaW5lYmV0d2VlbnJvd3M9Tm9uZSwKICAgICAgICBsaW5lYmVsb3c9Tm9uZSwKICAgICAgICBoZWFkZXJyb3c9RGF0YVJvdygifF8uICIsICJ8Xy4iLCAifCIpLAogICAgICAgIGRhdGFyb3c9X3RleHRpbGVfcm93X3dpdGhfYXR0cnMsCiAgICAgICAgcGFkZGluZz0xLAogICAgICAgIHdpdGhfaGVhZGVyX2hpZGU9Tm9uZSwKICAgICksCiAgICAiYXNjaWlkb2MiOiBUYWJsZUZvcm1hdCgKICAgICAgICBsaW5lYWJvdmU9cGFydGlhbChfYXNjaWlkb2Nfcm93LCBGYWxzZSksCiAgICAgICAgbGluZWJlbG93aGVhZGVyPU5vbmUsCiAgICAgICAgbGluZWJldHdlZW5yb3dzPU5vbmUsCiAgICAgICAgbGluZWJlbG93PUxpbmUoInw9PT09IiwgIiIsICIiLCAiIiksCiAgICAgICAgaGVhZGVycm93PXBhcnRpYWwoX2FzY2lpZG9jX3JvdywgVHJ1ZSksCiAgICAgICAgZGF0YXJvdz1wYXJ0aWFsKF9hc2NpaWRvY19yb3csIEZhbHNlKSwKICAgICAgICBwYWRkaW5nPTEsCiAgICAgICAgd2l0aF9oZWFkZXJfaGlkZT1bImxpbmVhYm92ZSJdLAogICAgKSwKfQoKCnRhYnVsYXRlX2Zvcm1hdHMgPSBsaXN0KHNvcnRlZChfdGFibGVfZm9ybWF0cy5rZXlzKCkpKQoKIyBUaGUgdGFibGUgZm9ybWF0cyBmb3Igd2hpY2ggbXVsdGlsaW5lIGNlbGxzIHdpbGwgYmUgZm9sZGVkIGludG8gc3Vic2VxdWVudAojIHRhYmxlIHJvd3MuIFRoZSBrZXkgaXMgdGhlIG9yaWdpbmFsIGZvcm1hdCBzcGVjaWZpZWQgYXQgdGhlIEFQSS4gVGhlIHZhbHVlIGlzCiMgdGhlIGZvcm1hdCB0aGF0IHdpbGwgYmUgdXNlZCB0byByZXByZXNlbnQgdGhlIG9yaWdpbmFsIGZvcm1hdC4KbXVsdGlsaW5lX2Zvcm1hdHMgPSB7CiAgICAicGxhaW4iOiAicGxhaW4iLAogICAgInNpbXBsZSI6ICJzaW1wbGUiLAogICAgImdyaWQiOiAiZ3JpZCIsCiAgICAic2ltcGxlX2dyaWQiOiAic2ltcGxlX2dyaWQiLAogICAgInJvdW5kZWRfZ3JpZCI6ICJyb3VuZGVkX2dyaWQiLAogICAgImhlYXZ5X2dyaWQiOiAiaGVhdnlfZ3JpZCIsCiAgICAibWl4ZWRfZ3JpZCI6ICJtaXhlZF9ncmlkIiwKICAgICJkb3VibGVfZ3JpZCI6ICJkb3VibGVfZ3JpZCIsCiAgICAiZmFuY3lfZ3JpZCI6ICJmYW5jeV9ncmlkIiwKICAgICJwaXBlIjogInBpcGUiLAogICAgIm9yZ3RibCI6ICJvcmd0YmwiLAogICAgImppcmEiOiAiamlyYSIsCiAgICAicHJlc3RvIjogInByZXN0byIsCiAgICAicHJldHR5IjogInByZXR0eSIsCiAgICAicHNxbCI6ICJwc3FsIiwKICAgICJyc3QiOiAicnN0IiwKfQoKIyBUT0RPOiBBZGQgbXVsdGlsaW5lIHN1cHBvcnQgZm9yIHRoZSByZW1haW5pbmcgdGFibGUgZm9ybWF0czoKIyAgICAgICAtIG1lZGlhd2lraTogUmVwbGFjZSBcbiB3aXRoIDxicj4KIyAgICAgICAtIG1vaW5tb2luOiBUQkQKIyAgICAgICAtIHlvdXRyYWNrOiBUQkQKIyAgICAgICAtIGh0bWw6IFJlcGxhY2UgXG4gd2l0aCA8YnI+CiMgICAgICAgLSBsYXRleCo6IFVzZSAibWFrZWNlbGwiIHBhY2thZ2U6IEluIGhlYWRlciwgcmVwbGFjZSBYXG5ZIHdpdGgKIyAgICAgICAgIFx0aGVhZHtYXFxZfSBhbmQgaW4gZGF0YSByb3csIHJlcGxhY2UgWFxuWSB3aXRoIFxtYWtlY2VsbHtYXFxZfQojICAgICAgIC0gdHN2OiBUQkQKIyAgICAgICAtIHRleHRpbGU6IFJlcGxhY2UgXG4gd2l0aCA8YnIvPiAobXVzdCBiZSB3ZWxsLWZvcm1lZCBYTUwpCgpfbXVsdGlsaW5lX2NvZGVzID0gcmUuY29tcGlsZShyIlxyfFxufFxyXG4iKQpfbXVsdGlsaW5lX2NvZGVzX2J5dGVzID0gcmUuY29tcGlsZShiIlxyfFxufFxyXG4iKQoKIyBIYW5kbGUgQU5TSSBlc2NhcGUgc2VxdWVuY2VzIGZvciBib3RoIGNvbnRyb2wgc2VxdWVuY2UgaW50cm9kdWNlciAoQ1NJKSBhbmQKIyBvcGVyYXRpbmcgc3lzdGVtIGNvbW1hbmQgKE9TQykuIEJvdGggb2YgdGhlc2UgYmVnaW4gd2l0aCAweDFiIChvciBvY3RhbCAwMzMpLAojIHdoaWNoIHdpbGwgYmUgc2hvd24gYmVsb3cgYXMgRVNDLgojCiMgQ1NJIEFOU0kgZXNjYXBlIGNvZGVzIGhhdmUgdGhlIGZvbGxvd2luZyBmb3JtYXQsIGRlZmluZWQgaW4gc2VjdGlvbiA1LjQgb2YgRUNNQS00ODoKIwojIENTSTogRVNDIGZvbGxvd2VkIGJ5IHRoZSAnWycgY2hhcmFjdGVyICgweDViKQojIFBhcmFtZXRlciBCeXRlczogMC4ubiBieXRlcyBpbiB0aGUgcmFuZ2UgMHgzMC0weDNmCiMgSW50ZXJtZWRpYXRlIEJ5dGVzOiAwLi5uIGJ5dGVzIGluIHRoZSByYW5nZSAweDIwLTB4MmYKIyBGaW5hbCBCeXRlOiBhIHNpbmdsZSBieXRlIGluIHRoZSByYW5nZSAweDQwLTB4N2UKIwojIEFsc28gaW5jbHVkZSB0aGUgdGVybWluYWwgaHlwZXJsaW5rIHNlcXVlbmNlcyBhcyBkZXNjcmliZWQgaGVyZToKIyBodHRwczovL2dpc3QuZ2l0aHViLmNvbS9lZ21vbnRrb2IvZWIxMTQyOTRlZmJjZDVhZGIxOTQ0YzlmM2NiNWZlZGEKIwojIE9TQyA4IDsgcGFyYW1zIDsgdXJpIFNUIGRpc3BsYXlfdGV4dCBPU0MgOCA7OyBTVAojCiMgRXhhbXBsZTogXHgxYl04OztodHRwczovL2V4YW1wbGUuY29tXHg1Y3RleHQgdG8gc2hvd1x4MWJdODs7XHg1YwojCiMgV2hlcmU6CiMgT1NDOiBFU0MgZm9sbG93ZWQgYnkgdGhlICddJyBjaGFyYWN0ZXIgKDB4NWQpCiMgcGFyYW1zOiAwLi5uIG9wdGlvbmFsIGtleSB2YWx1ZSBwYWlycyBzZXBhcmF0ZWQgYnkgJzonIChlLmcuIGZvbz1iYXI6YmF6PXF1eDphYmM9MTIzKQojIFVSSTogdGhlIGFjdHVhbCBVUkkgd2l0aCBwcm90b2NvbCBzY2hlbWUgKGUuZy4gaHR0cHM6Ly8sIGZpbGU6Ly8sIGZ0cDovLykKIyBTVDogRVNDIGZvbGxvd2VkIGJ5IHRoZSAnXCcgY2hhcmFjdGVyICgweDVjKQpfZXNjID0gciJceDFiIgpfY3NpID0gcmYie19lc2N9XFsiCl9vc2MgPSByZiJ7X2VzY31cXSIKX3N0ID0gcmYie19lc2N9XFwiCgpfYW5zaV9lc2NhcGVfcGF0ID0gcmYiIiIKICAgICgKICAgICAgICAjIHRlcm1pbmFsIGNvbG9ycywgZXRjCiAgICAgICAge19jc2l9ICAgICAgICAjIENTSQogICAgICAgIFtceDMwLVx4M2ZdKiAgIyBwYXJhbWV0ZXIgYnl0ZXMKICAgICAgICBbXHgyMC1ceDJmXSogICMgaW50ZXJtZWRpYXRlIGJ5dGVzCiAgICAgICAgW1x4NDAtXHg3ZV0gICAjIGZpbmFsIGJ5dGUKICAgIHwKICAgICAgICAjIHRlcm1pbmFsIGh5cGVybGlua3MKICAgICAgICB7X29zY304OyAgICAgICAgIyBPU0Mgb3BlbmluZwogICAgICAgIChcdys9XHcrOj8pKiAgICAjIGtleT12YWx1ZSBwYXJhbXMgbGlzdCAoc3VibWF0Y2ggMikKICAgICAgICA7ICAgICAgICAgICAgICAgIyBkZWxpbWl0ZXIKICAgICAgICAoW157X2VzY31dKykgICAgIyBVUkkgLSBhbnl0aGluZyBidXQgRVNDIChzdWJtYXRjaCAzKQogICAgICAgIHtfc3R9ICAgICAgICAgICAjIFNUCiAgICAgICAgKFtee19lc2N9XSspICAgICMgbGluayB0ZXh0IC0gYW55dGhpbmcgYnV0IEVTQyAoc3VibWF0Y2ggNCkKICAgICAgICB7X29zY304Ozt7X3N0fSAgIyAiY2xvc2luZyIgT1NDIHNlcXVlbmNlCiAgICApCiIiIgpfYW5zaV9jb2RlcyA9IHJlLmNvbXBpbGUoX2Fuc2lfZXNjYXBlX3BhdCwgcmUuVkVSQk9TRSkKX2Fuc2lfY29kZXNfYnl0ZXMgPSByZS5jb21waWxlKF9hbnNpX2VzY2FwZV9wYXQuZW5jb2RlKCJ1dGY4IiksIHJlLlZFUkJPU0UpCl9hbnNpX2NvbG9yX3Jlc2V0X2NvZGUgPSAiXDAzM1swbSIKCl9mbG9hdF93aXRoX3Rob3VzYW5kc19zZXBhcmF0b3JzID0gcmUuY29tcGlsZSgKICAgIHIiXigoWystXT9bMC05XXsxLDN9KSg/OiwoWzAtOV17M30pKSopPyg/KDEpXC5bMC05XSp8XC5bMC05XSspPyQiCikKCgpkZWYgc2ltcGxlX3NlcGFyYXRlZF9mb3JtYXQoc2VwYXJhdG9yKToKICAgICIiIkNvbnN0cnVjdCBhIHNpbXBsZSBUYWJsZUZvcm1hdCB3aXRoIGNvbHVtbnMgc2VwYXJhdGVkIGJ5IGEgc2VwYXJhdG9yLgoKICAgID4+PiB0c3YgPSBzaW1wbGVfc2VwYXJhdGVkX2Zvcm1hdCgiXFx0IikgOyBcCiAgICAgICAgdGFidWxhdGUoW1siZm9vIiwgMV0sIFsic3BhbSIsIDIzXV0sIHRhYmxlZm10PXRzdikgPT0gJ2ZvbyBcXHQgMVxcbnNwYW1cXHQyMycKICAgIFRydWUKCiAgICAiIiIKICAgIHJldHVybiBUYWJsZUZvcm1hdCgKICAgICAgICBOb25lLAogICAgICAgIE5vbmUsCiAgICAgICAgTm9uZSwKICAgICAgICBOb25lLAogICAgICAgIGhlYWRlcnJvdz1EYXRhUm93KCIiLCBzZXBhcmF0b3IsICIiKSwKICAgICAgICBkYXRhcm93PURhdGFSb3coIiIsIHNlcGFyYXRvciwgIiIpLAogICAgICAgIHBhZGRpbmc9MCwKICAgICAgICB3aXRoX2hlYWRlcl9oaWRlPU5vbmUsCiAgICApCgoKZGVmIF9pc251bWJlcl93aXRoX3Rob3VzYW5kc19zZXBhcmF0b3Ioc3RyaW5nKToKICAgICIiIgogICAgPj4+IF9pc251bWJlcl93aXRoX3Rob3VzYW5kc19zZXBhcmF0b3IoIi4iKQogICAgRmFsc2UKICAgID4+PiBfaXNudW1iZXJfd2l0aF90aG91c2FuZHNfc2VwYXJhdG9yKCIxIikKICAgIFRydWUKICAgID4+PiBfaXNudW1iZXJfd2l0aF90aG91c2FuZHNfc2VwYXJhdG9yKCIxLiIpCiAgICBUcnVlCiAgICA+Pj4gX2lzbnVtYmVyX3dpdGhfdGhvdXNhbmRzX3NlcGFyYXRvcigiLjEiKQogICAgVHJ1ZQogICAgPj4+IF9pc251bWJlcl93aXRoX3Rob3VzYW5kc19zZXBhcmF0b3IoIjEwMDAiKQogICAgRmFsc2UKICAgID4+PiBfaXNudW1iZXJfd2l0aF90aG91c2FuZHNfc2VwYXJhdG9yKCIxLDAwMCIpCiAgICBUcnVlCiAgICA+Pj4gX2lzbnVtYmVyX3dpdGhfdGhvdXNhbmRzX3NlcGFyYXRvcigiMSwwMDAwIikKICAgIEZhbHNlCiAgICA+Pj4gX2lzbnVtYmVyX3dpdGhfdGhvdXNhbmRzX3NlcGFyYXRvcigiMSwwMDAuMTIzNCIpCiAgICBUcnVlCiAgICA+Pj4gX2lzbnVtYmVyX3dpdGhfdGhvdXNhbmRzX3NlcGFyYXRvcihiIjEsMDAwLjEyMzQiKQogICAgVHJ1ZQogICAgPj4+IF9pc251bWJlcl93aXRoX3Rob3VzYW5kc19zZXBhcmF0b3IoIisxLDAwMC4xMjM0IikKICAgIFRydWUKICAgID4+PiBfaXNudW1iZXJfd2l0aF90aG91c2FuZHNfc2VwYXJhdG9yKCItMSwwMDAuMTIzNCIpCiAgICBUcnVlCiAgICAiIiIKICAgIHRyeToKICAgICAgICBzdHJpbmcgPSBzdHJpbmcuZGVjb2RlKCkKICAgIGV4Y2VwdCAoVW5pY29kZURlY29kZUVycm9yLCBBdHRyaWJ1dGVFcnJvcik6CiAgICAgICAgcGFzcwoKICAgIHJldHVybiBib29sKHJlLm1hdGNoKF9mbG9hdF93aXRoX3Rob3VzYW5kc19zZXBhcmF0b3JzLCBzdHJpbmcpKQoKCmRlZiBfaXNjb252ZXJ0aWJsZShjb252LCBzdHJpbmcpOgogICAgdHJ5OgogICAgICAgIGNvbnYoc3RyaW5nKQogICAgICAgIHJldHVybiBUcnVlCiAgICBleGNlcHQgKFZhbHVlRXJyb3IsIFR5cGVFcnJvcik6CiAgICAgICAgcmV0dXJuIEZhbHNlCgoKZGVmIF9pc251bWJlcihzdHJpbmcpOgogICAgIiIiCiAgICA+Pj4gX2lzbnVtYmVyKCIxMjMuNDUiKQogICAgVHJ1ZQogICAgPj4+IF9pc251bWJlcigiMTIzIikKICAgIFRydWUKICAgID4+PiBfaXNudW1iZXIoInNwYW0iKQogICAgRmFsc2UKICAgID4+PiBfaXNudW1iZXIoIjEyM2U0NTY3OCIpCiAgICBGYWxzZQogICAgPj4+IF9pc251bWJlcigiaW5mIikKICAgIFRydWUKICAgICIiIgogICAgaWYgbm90IF9pc2NvbnZlcnRpYmxlKGZsb2F0LCBzdHJpbmcpOgogICAgICAgIHJldHVybiBGYWxzZQogICAgZWxpZiBpc2luc3RhbmNlKHN0cmluZywgKHN0ciwgYnl0ZXMpKSBhbmQgKAogICAgICAgIG1hdGguaXNpbmYoZmxvYXQoc3RyaW5nKSkgb3IgbWF0aC5pc25hbihmbG9hdChzdHJpbmcpKQogICAgKToKICAgICAgICByZXR1cm4gc3RyaW5nLmxvd2VyKCkgaW4gWyJpbmYiLCAiLWluZiIsICJuYW4iXQogICAgcmV0dXJuIFRydWUKCgpkZWYgX2lzaW50KHN0cmluZywgaW50dHlwZT1pbnQpOgogICAgIiIiCiAgICA+Pj4gX2lzaW50KCIxMjMiKQogICAgVHJ1ZQogICAgPj4+IF9pc2ludCgiMTIzLjQ1IikKICAgIEZhbHNlCiAgICAiIiIKICAgIHJldHVybiAoCiAgICAgICAgdHlwZShzdHJpbmcpIGlzIGludHR5cGUKICAgICAgICBvciBpc2luc3RhbmNlKHN0cmluZywgKGJ5dGVzLCBzdHIpKQogICAgICAgIGFuZCBfaXNjb252ZXJ0aWJsZShpbnR0eXBlLCBzdHJpbmcpCiAgICApCgoKZGVmIF9pc2Jvb2woc3RyaW5nKToKICAgICIiIgogICAgPj4+IF9pc2Jvb2woVHJ1ZSkKICAgIFRydWUKICAgID4+PiBfaXNib29sKCJGYWxzZSIpCiAgICBUcnVlCiAgICA+Pj4gX2lzYm9vbCgxKQogICAgRmFsc2UKICAgICIiIgogICAgcmV0dXJuIHR5cGUoc3RyaW5nKSBpcyBib29sIG9yICgKICAgICAgICBpc2luc3RhbmNlKHN0cmluZywgKGJ5dGVzLCBzdHIpKSBhbmQgc3RyaW5nIGluICgiVHJ1ZSIsICJGYWxzZSIpCiAgICApCgoKZGVmIF90eXBlKHN0cmluZywgaGFzX2ludmlzaWJsZT1UcnVlLCBudW1wYXJzZT1UcnVlKToKICAgICIiIlRoZSBsZWFzdCBnZW5lcmljIHR5cGUgKHR5cGUoTm9uZSksIGludCwgZmxvYXQsIHN0ciwgdW5pY29kZSkuCgogICAgPj4+IF90eXBlKE5vbmUpIGlzIHR5cGUoTm9uZSkKICAgIFRydWUKICAgID4+PiBfdHlwZSgiZm9vIikgaXMgdHlwZSgiIikKICAgIFRydWUKICAgID4+PiBfdHlwZSgiMSIpIGlzIHR5cGUoMSkKICAgIFRydWUKICAgID4+PiBfdHlwZSgnXHgxYlszMW00Mlx4MWJbMG0nKSBpcyB0eXBlKDQyKQogICAgVHJ1ZQogICAgPj4+IF90eXBlKCdceDFiWzMxbTQyXHgxYlswbScpIGlzIHR5cGUoNDIpCiAgICBUcnVlCgogICAgIiIiCgogICAgaWYgaGFzX2ludmlzaWJsZSBhbmQgaXNpbnN0YW5jZShzdHJpbmcsIChzdHIsIGJ5dGVzKSk6CiAgICAgICAgc3RyaW5nID0gX3N0cmlwX2Fuc2koc3RyaW5nKQoKICAgIGlmIHN0cmluZyBpcyBOb25lOgogICAgICAgIHJldHVybiB0eXBlKE5vbmUpCiAgICBlbGlmIGhhc2F0dHIoc3RyaW5nLCAiaXNvZm9ybWF0Iik6ICAjIGRhdGV0aW1lLmRhdGV0aW1lLCBkYXRlLCBhbmQgdGltZQogICAgICAgIHJldHVybiBzdHIKICAgIGVsaWYgX2lzYm9vbChzdHJpbmcpOgogICAgICAgIHJldHVybiBib29sCiAgICBlbGlmIF9pc2ludChzdHJpbmcpIGFuZCBudW1wYXJzZToKICAgICAgICByZXR1cm4gaW50CiAgICBlbGlmIF9pc251bWJlcihzdHJpbmcpIGFuZCBudW1wYXJzZToKICAgICAgICByZXR1cm4gZmxvYXQKICAgIGVsaWYgaXNpbnN0YW5jZShzdHJpbmcsIGJ5dGVzKToKICAgICAgICByZXR1cm4gYnl0ZXMKICAgIGVsc2U6CiAgICAgICAgcmV0dXJuIHN0cgoKCmRlZiBfYWZ0ZXJwb2ludChzdHJpbmcpOgogICAgIiIiU3ltYm9scyBhZnRlciBhIGRlY2ltYWwgcG9pbnQsIC0xIGlmIHRoZSBzdHJpbmcgbGFja3MgdGhlIGRlY2ltYWwgcG9pbnQuCgogICAgPj4+IF9hZnRlcnBvaW50KCIxMjMuNDUiKQogICAgMgogICAgPj4+IF9hZnRlcnBvaW50KCIxMDAxIikKICAgIC0xCiAgICA+Pj4gX2FmdGVycG9pbnQoImVnZ3MiKQogICAgLTEKICAgID4+PiBfYWZ0ZXJwb2ludCgiMTIzZTQ1IikKICAgIDIKICAgID4+PiBfYWZ0ZXJwb2ludCgiMTIzLDQ1Ni43OCIpCiAgICAyCgogICAgIiIiCiAgICBpZiBfaXNudW1iZXIoc3RyaW5nKSBvciBfaXNudW1iZXJfd2l0aF90aG91c2FuZHNfc2VwYXJhdG9yKHN0cmluZyk6CiAgICAgICAgaWYgX2lzaW50KHN0cmluZyk6CiAgICAgICAgICAgIHJldHVybiAtMQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHBvcyA9IHN0cmluZy5yZmluZCgiLiIpCiAgICAgICAgICAgIHBvcyA9IHN0cmluZy5sb3dlcigpLnJmaW5kKCJlIikgaWYgcG9zIDwgMCBlbHNlIHBvcwogICAgICAgICAgICBpZiBwb3MgPj0gMDoKICAgICAgICAgICAgICAgIHJldHVybiBsZW4oc3RyaW5nKSAtIHBvcyAtIDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJldHVybiAtMSAgIyBubyBwb2ludAogICAgZWxzZToKICAgICAgICByZXR1cm4gLTEgICMgbm90IGEgbnVtYmVyCgoKZGVmIF9wYWRsZWZ0KHdpZHRoLCBzKToKICAgICIiIkZsdXNoIHJpZ2h0LgoKICAgID4+PiBfcGFkbGVmdCg2LCAnXHUwNDRmXHUwNDM5XHUwNDQ2XHUwNDMwJykgPT0gJyAgXHUwNDRmXHUwNDM5XHUwNDQ2XHUwNDMwJwogICAgVHJ1ZQoKICAgICIiIgogICAgZm10ID0gInswOj4lZHN9IiAlIHdpZHRoCiAgICByZXR1cm4gZm10LmZvcm1hdChzKQoKCmRlZiBfcGFkcmlnaHQod2lkdGgsIHMpOgogICAgIiIiRmx1c2ggbGVmdC4KCiAgICA+Pj4gX3BhZHJpZ2h0KDYsICdcdTA0NGZcdTA0MzlcdTA0NDZcdTA0MzAnKSA9PSAnXHUwNDRmXHUwNDM5XHUwNDQ2XHUwNDMwICAnCiAgICBUcnVlCgogICAgIiIiCiAgICBmbXQgPSAiezA6PCVkc30iICUgd2lkdGgKICAgIHJldHVybiBmbXQuZm9ybWF0KHMpCgoKZGVmIF9wYWRib3RoKHdpZHRoLCBzKToKICAgICIiIkNlbnRlciBzdHJpbmcuCgogICAgPj4+IF9wYWRib3RoKDYsICdcdTA0NGZcdTA0MzlcdTA0NDZcdTA0MzAnKSA9PSAnIFx1MDQ0Zlx1MDQzOVx1MDQ0Nlx1MDQzMCAnCiAgICBUcnVlCgogICAgIiIiCiAgICBmbXQgPSAiezA6XiVkc30iICUgd2lkdGgKICAgIHJldHVybiBmbXQuZm9ybWF0KHMpCgoKZGVmIF9wYWRub25lKGlnbm9yZV93aWR0aCwgcyk6CiAgICByZXR1cm4gcwoKCmRlZiBfc3RyaXBfYW5zaShzKToKICAgIHIiIiJSZW1vdmUgQU5TSSBlc2NhcGUgc2VxdWVuY2VzLCBib3RoIENTSSAoY29sb3IgY29kZXMsIGV0YykgYW5kIE9TQyBoeXBlcmxpbmtzLgoKICAgIENTSSBzZXF1ZW5jZXMgYXJlIHNpbXBseSByZW1vdmVkIGZyb20gdGhlIG91dHB1dCwgd2hpbGUgT1NDIGh5cGVybGlua3MgYXJlIHJlcGxhY2VkCiAgICB3aXRoIHRoZSBsaW5rIHRleHQuIE5vdGU6IGl0IG1heSBiZSBkZXNpcmFibGUgdG8gc2hvdyB0aGUgVVJJIGluc3RlYWQgYnV0IHRoaXMgaXMgbm90CiAgICBzdXBwb3J0ZWQuCgogICAgPj4+IHJlcHIoX3N0cmlwX2Fuc2koJ1x4MUJdODs7aHR0cHM6Ly9leGFtcGxlLmNvbVx4MUJcXFRoaXMgaXMgYSBsaW5rXHgxQl04OztceDFCXFwnKSkKICAgICInVGhpcyBpcyBhIGxpbmsnIgoKICAgID4+PiByZXByKF9zdHJpcF9hbnNpKCdceDFiWzMxbXJlZFx4MWJbMG0gdGV4dCcpKQogICAgIidyZWQgdGV4dCciCgogICAgIiIiCiAgICBpZiBpc2luc3RhbmNlKHMsIHN0cik6CiAgICAgICAgcmV0dXJuIF9hbnNpX2NvZGVzLnN1YihyIlw0IiwgcykKICAgIGVsc2U6ICAjIGEgYnl0ZXN0cmluZwogICAgICAgIHJldHVybiBfYW5zaV9jb2Rlc19ieXRlcy5zdWIociJcNCIsIHMpCgoKZGVmIF92aXNpYmxlX3dpZHRoKHMpOgogICAgIiIiVmlzaWJsZSB3aWR0aCBvZiBhIHByaW50ZWQgc3RyaW5nLiBBTlNJIGNvbG9yIGNvZGVzIGFyZSByZW1vdmVkLgoKICAgID4+PiBfdmlzaWJsZV93aWR0aCgnXHgxYlszMW1oZWxsb1x4MWJbMG0nKSwgX3Zpc2libGVfd2lkdGgoIndvcmxkIikKICAgICg1LCA1KQoKICAgICIiIgogICAgIyBvcHRpb25hbCB3aWRlLWNoYXJhY3RlciBzdXBwb3J0CiAgICBpZiB3Y3dpZHRoIGlzIG5vdCBOb25lIGFuZCBXSURFX0NIQVJTX01PREU6CiAgICAgICAgbGVuX2ZuID0gd2N3aWR0aC53Y3N3aWR0aAogICAgZWxzZToKICAgICAgICBsZW5fZm4gPSBsZW4KICAgIGlmIGlzaW5zdGFuY2UocywgKHN0ciwgYnl0ZXMpKToKICAgICAgICByZXR1cm4gbGVuX2ZuKF9zdHJpcF9hbnNpKHMpKQogICAgZWxzZToKICAgICAgICByZXR1cm4gbGVuX2ZuKHN0cihzKSkKCgpkZWYgX2lzX211bHRpbGluZShzKToKICAgIGlmIGlzaW5zdGFuY2Uocywgc3RyKToKICAgICAgICByZXR1cm4gYm9vbChyZS5zZWFyY2goX211bHRpbGluZV9jb2RlcywgcykpCiAgICBlbHNlOiAgIyBhIGJ5dGVzdHJpbmcKICAgICAgICByZXR1cm4gYm9vbChyZS5zZWFyY2goX211bHRpbGluZV9jb2Rlc19ieXRlcywgcykpCgoKZGVmIF9tdWx0aWxpbmVfd2lkdGgobXVsdGlsaW5lX3MsIGxpbmVfd2lkdGhfZm49bGVuKToKICAgICIiIlZpc2libGUgd2lkdGggb2YgYSBwb3RlbnRpYWxseSBtdWx0aWxpbmUgY29udGVudC4iIiIKICAgIHJldHVybiBtYXgobWFwKGxpbmVfd2lkdGhfZm4sIHJlLnNwbGl0KCJbXHJcbl0iLCBtdWx0aWxpbmVfcykpKQoKCmRlZiBfY2hvb3NlX3dpZHRoX2ZuKGhhc19pbnZpc2libGUsIGVuYWJsZV93aWRlY2hhcnMsIGlzX211bHRpbGluZSk6CiAgICAiIiJSZXR1cm4gYSBmdW5jdGlvbiB0byBjYWxjdWxhdGUgdmlzaWJsZSBjZWxsIHdpZHRoLiIiIgogICAgaWYgaGFzX2ludmlzaWJsZToKICAgICAgICBsaW5lX3dpZHRoX2ZuID0gX3Zpc2libGVfd2lkdGgKICAgIGVsaWYgZW5hYmxlX3dpZGVjaGFyczogICMgb3B0aW9uYWwgd2lkZS1jaGFyYWN0ZXIgc3VwcG9ydCBpZiBhdmFpbGFibGUKICAgICAgICBsaW5lX3dpZHRoX2ZuID0gd2N3aWR0aC53Y3N3aWR0aAogICAgZWxzZToKICAgICAgICBsaW5lX3dpZHRoX2ZuID0gbGVuCiAgICBpZiBpc19tdWx0aWxpbmU6CiAgICAgICAgd2lkdGhfZm4gPSBsYW1iZGEgczogX211bHRpbGluZV93aWR0aChzLCBsaW5lX3dpZHRoX2ZuKSAgIyBub3FhCiAgICBlbHNlOgogICAgICAgIHdpZHRoX2ZuID0gbGluZV93aWR0aF9mbgogICAgcmV0dXJuIHdpZHRoX2ZuCgoKZGVmIF9hbGlnbl9jb2x1bW5fY2hvb3NlX3BhZGZuKHN0cmluZ3MsIGFsaWdubWVudCwgaGFzX2ludmlzaWJsZSk6CiAgICBpZiBhbGlnbm1lbnQgPT0gInJpZ2h0IjoKICAgICAgICBpZiBub3QgUFJFU0VSVkVfV0hJVEVTUEFDRToKICAgICAgICAgICAgc3RyaW5ncyA9IFtzLnN0cmlwKCkgZm9yIHMgaW4gc3RyaW5nc10KICAgICAgICBwYWRmbiA9IF9wYWRsZWZ0CiAgICBlbGlmIGFsaWdubWVudCA9PSAiY2VudGVyIjoKICAgICAgICBpZiBub3QgUFJFU0VSVkVfV0hJVEVTUEFDRToKICAgICAgICAgICAgc3RyaW5ncyA9IFtzLnN0cmlwKCkgZm9yIHMgaW4gc3RyaW5nc10KICAgICAgICBwYWRmbiA9IF9wYWRib3RoCiAgICBlbGlmIGFsaWdubWVudCA9PSAiZGVjaW1hbCI6CiAgICAgICAgaWYgaGFzX2ludmlzaWJsZToKICAgICAgICAgICAgZGVjaW1hbHMgPSBbX2FmdGVycG9pbnQoX3N0cmlwX2Fuc2kocykpIGZvciBzIGluIHN0cmluZ3NdCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZGVjaW1hbHMgPSBbX2FmdGVycG9pbnQocykgZm9yIHMgaW4gc3RyaW5nc10KICAgICAgICBtYXhkZWNpbWFscyA9IG1heChkZWNpbWFscykKICAgICAgICBzdHJpbmdzID0gW3MgKyAobWF4ZGVjaW1hbHMgLSBkZWNzKSAqICIgIiBmb3IgcywgZGVjcyBpbiB6aXAoc3RyaW5ncywgZGVjaW1hbHMpXQogICAgICAgIHBhZGZuID0gX3BhZGxlZnQKICAgIGVsaWYgbm90IGFsaWdubWVudDoKICAgICAgICBwYWRmbiA9IF9wYWRub25lCiAgICBlbHNlOgogICAgICAgIGlmIG5vdCBQUkVTRVJWRV9XSElURVNQQUNFOgogICAgICAgICAgICBzdHJpbmdzID0gW3Muc3RyaXAoKSBmb3IgcyBpbiBzdHJpbmdzXQogICAgICAgIHBhZGZuID0gX3BhZHJpZ2h0CiAgICByZXR1cm4gc3RyaW5ncywgcGFkZm4KCgpkZWYgX2FsaWduX2NvbHVtbl9jaG9vc2Vfd2lkdGhfZm4oaGFzX2ludmlzaWJsZSwgZW5hYmxlX3dpZGVjaGFycywgaXNfbXVsdGlsaW5lKToKICAgIGlmIGhhc19pbnZpc2libGU6CiAgICAgICAgbGluZV93aWR0aF9mbiA9IF92aXNpYmxlX3dpZHRoCiAgICBlbGlmIGVuYWJsZV93aWRlY2hhcnM6ICAjIG9wdGlvbmFsIHdpZGUtY2hhcmFjdGVyIHN1cHBvcnQgaWYgYXZhaWxhYmxlCiAgICAgICAgbGluZV93aWR0aF9mbiA9IHdjd2lkdGgud2Nzd2lkdGgKICAgIGVsc2U6CiAgICAgICAgbGluZV93aWR0aF9mbiA9IGxlbgogICAgaWYgaXNfbXVsdGlsaW5lOgogICAgICAgIHdpZHRoX2ZuID0gbGFtYmRhIHM6IF9hbGlnbl9jb2x1bW5fbXVsdGlsaW5lX3dpZHRoKHMsIGxpbmVfd2lkdGhfZm4pICAjIG5vcWEKICAgIGVsc2U6CiAgICAgICAgd2lkdGhfZm4gPSBsaW5lX3dpZHRoX2ZuCiAgICByZXR1cm4gd2lkdGhfZm4KCgpkZWYgX2FsaWduX2NvbHVtbl9tdWx0aWxpbmVfd2lkdGgobXVsdGlsaW5lX3MsIGxpbmVfd2lkdGhfZm49bGVuKToKICAgICIiIlZpc2libGUgd2lkdGggb2YgYSBwb3RlbnRpYWxseSBtdWx0aWxpbmUgY29udGVudC4iIiIKICAgIHJldHVybiBsaXN0KG1hcChsaW5lX3dpZHRoX2ZuLCByZS5zcGxpdCgiW1xyXG5dIiwgbXVsdGlsaW5lX3MpKSkKCgpkZWYgX2ZsYXRfbGlzdChuZXN0ZWRfbGlzdCk6CiAgICByZXQgPSBbXQogICAgZm9yIGl0ZW0gaW4gbmVzdGVkX2xpc3Q6CiAgICAgICAgaWYgaXNpbnN0YW5jZShpdGVtLCBsaXN0KToKICAgICAgICAgICAgZm9yIHN1Yml0ZW0gaW4gaXRlbToKICAgICAgICAgICAgICAgIHJldC5hcHBlbmQoc3ViaXRlbSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXQuYXBwZW5kKGl0ZW0pCiAgICByZXR1cm4gcmV0CgoKZGVmIF9hbGlnbl9jb2x1bW4oCiAgICBzdHJpbmdzLAogICAgYWxpZ25tZW50LAogICAgbWlud2lkdGg9MCwKICAgIGhhc19pbnZpc2libGU9VHJ1ZSwKICAgIGVuYWJsZV93aWRlY2hhcnM9RmFsc2UsCiAgICBpc19tdWx0aWxpbmU9RmFsc2UsCik6CiAgICAiIiJbc3RyaW5nXSAtPiBbcGFkZGVkX3N0cmluZ10iIiIKICAgIHN0cmluZ3MsIHBhZGZuID0gX2FsaWduX2NvbHVtbl9jaG9vc2VfcGFkZm4oc3RyaW5ncywgYWxpZ25tZW50LCBoYXNfaW52aXNpYmxlKQogICAgd2lkdGhfZm4gPSBfYWxpZ25fY29sdW1uX2Nob29zZV93aWR0aF9mbigKICAgICAgICBoYXNfaW52aXNpYmxlLCBlbmFibGVfd2lkZWNoYXJzLCBpc19tdWx0aWxpbmUKICAgICkKCiAgICBzX3dpZHRocyA9IGxpc3QobWFwKHdpZHRoX2ZuLCBzdHJpbmdzKSkKICAgIG1heHdpZHRoID0gbWF4KG1heChfZmxhdF9saXN0KHNfd2lkdGhzKSksIG1pbndpZHRoKQogICAgIyBUT0RPOiByZWZhY3RvciBjb2x1bW4gYWxpZ25tZW50IGluIHNpbmdsZS1saW5lIGFuZCBtdWx0aWxpbmUgbW9kZXMKICAgIGlmIGlzX211bHRpbGluZToKICAgICAgICBpZiBub3QgZW5hYmxlX3dpZGVjaGFycyBhbmQgbm90IGhhc19pbnZpc2libGU6CiAgICAgICAgICAgIHBhZGRlZF9zdHJpbmdzID0gWwogICAgICAgICAgICAgICAgIlxuIi5qb2luKFtwYWRmbihtYXh3aWR0aCwgcykgZm9yIHMgaW4gbXMuc3BsaXRsaW5lcygpXSkKICAgICAgICAgICAgICAgIGZvciBtcyBpbiBzdHJpbmdzCiAgICAgICAgICAgIF0KICAgICAgICBlbHNlOgogICAgICAgICAgICAjIGVuYWJsZSB3aWRlLWNoYXJhY3RlciB3aWR0aCBjb3JyZWN0aW9ucwogICAgICAgICAgICBzX2xlbnMgPSBbW2xlbihzKSBmb3IgcyBpbiByZS5zcGxpdCgiW1xyXG5dIiwgbXMpXSBmb3IgbXMgaW4gc3RyaW5nc10KICAgICAgICAgICAgdmlzaWJsZV93aWR0aHMgPSBbCiAgICAgICAgICAgICAgICBbbWF4d2lkdGggLSAodyAtIGwpIGZvciB3LCBsIGluIHppcChtdywgbWwpXQogICAgICAgICAgICAgICAgZm9yIG13LCBtbCBpbiB6aXAoc193aWR0aHMsIHNfbGVucykKICAgICAgICAgICAgXQogICAgICAgICAgICAjIHdjc3dpZHRoIGFuZCBfdmlzaWJsZV93aWR0aCBkb24ndCBjb3VudCBpbnZpc2libGUgY2hhcmFjdGVyczsKICAgICAgICAgICAgIyBwYWRmbiBkb2Vzbid0IG5lZWQgdG8gYXBwbHkgYW5vdGhlciBjb3JyZWN0aW9uCiAgICAgICAgICAgIHBhZGRlZF9zdHJpbmdzID0gWwogICAgICAgICAgICAgICAgIlxuIi5qb2luKFtwYWRmbih3LCBzKSBmb3IgcywgdyBpbiB6aXAoKG1zLnNwbGl0bGluZXMoKSBvciBtcyksIG13KV0pCiAgICAgICAgICAgICAgICBmb3IgbXMsIG13IGluIHppcChzdHJpbmdzLCB2aXNpYmxlX3dpZHRocykKICAgICAgICAgICAgXQogICAgZWxzZTogICMgc2luZ2xlLWxpbmUgY2VsbCB2YWx1ZXMKICAgICAgICBpZiBub3QgZW5hYmxlX3dpZGVjaGFycyBhbmQgbm90IGhhc19pbnZpc2libGU6CiAgICAgICAgICAgIHBhZGRlZF9zdHJpbmdzID0gW3BhZGZuKG1heHdpZHRoLCBzKSBmb3IgcyBpbiBzdHJpbmdzXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgICMgZW5hYmxlIHdpZGUtY2hhcmFjdGVyIHdpZHRoIGNvcnJlY3Rpb25zCiAgICAgICAgICAgIHNfbGVucyA9IGxpc3QobWFwKGxlbiwgc3RyaW5ncykpCiAgICAgICAgICAgIHZpc2libGVfd2lkdGhzID0gW21heHdpZHRoIC0gKHcgLSBsKSBmb3IgdywgbCBpbiB6aXAoc193aWR0aHMsIHNfbGVucyldCiAgICAgICAgICAgICMgd2Nzd2lkdGggYW5kIF92aXNpYmxlX3dpZHRoIGRvbid0IGNvdW50IGludmlzaWJsZSBjaGFyYWN0ZXJzOwogICAgICAgICAgICAjIHBhZGZuIGRvZXNuJ3QgbmVlZCB0byBhcHBseSBhbm90aGVyIGNvcnJlY3Rpb24KICAgICAgICAgICAgcGFkZGVkX3N0cmluZ3MgPSBbcGFkZm4odywgcykgZm9yIHMsIHcgaW4gemlwKHN0cmluZ3MsIHZpc2libGVfd2lkdGhzKV0KICAgIHJldHVybiBwYWRkZWRfc3RyaW5ncwoKCmRlZiBfbW9yZV9nZW5lcmljKHR5cGUxLCB0eXBlMik6CiAgICB0eXBlcyA9IHsKICAgICAgICB0eXBlKE5vbmUpOiAwLAogICAgICAgIGJvb2w6IDEsCiAgICAgICAgaW50OiAyLAogICAgICAgIGZsb2F0OiAzLAogICAgICAgIGJ5dGVzOiA0LAogICAgICAgIHN0cjogNSwKICAgIH0KICAgIGludnR5cGVzID0gewogICAgICAgIDU6IHN0ciwKICAgICAgICA0OiBieXRlcywKICAgICAgICAzOiBmbG9hdCwKICAgICAgICAyOiBpbnQsCiAgICAgICAgMTogYm9vbCwKICAgICAgICAwOiB0eXBlKE5vbmUpLAogICAgfQogICAgbW9yZWdlbmVyaWMgPSBtYXgodHlwZXMuZ2V0KHR5cGUxLCA1KSwgdHlwZXMuZ2V0KHR5cGUyLCA1KSkKICAgIHJldHVybiBpbnZ0eXBlc1ttb3JlZ2VuZXJpY10KCgpkZWYgX2NvbHVtbl90eXBlKHN0cmluZ3MsIGhhc19pbnZpc2libGU9VHJ1ZSwgbnVtcGFyc2U9VHJ1ZSk6CiAgICAiIiJUaGUgbGVhc3QgZ2VuZXJpYyB0eXBlIGFsbCBjb2x1bW4gdmFsdWVzIGFyZSBjb252ZXJ0aWJsZSB0by4KCiAgICA+Pj4gX2NvbHVtbl90eXBlKFtUcnVlLCBGYWxzZV0pIGlzIGJvb2wKICAgIFRydWUKICAgID4+PiBfY29sdW1uX3R5cGUoWyIxIiwgIjIiXSkgaXMgaW50CiAgICBUcnVlCiAgICA+Pj4gX2NvbHVtbl90eXBlKFsiMSIsICIyLjMiXSkgaXMgZmxvYXQKICAgIFRydWUKICAgID4+PiBfY29sdW1uX3R5cGUoWyIxIiwgIjIuMyIsICJmb3VyIl0pIGlzIHN0cgogICAgVHJ1ZQogICAgPj4+IF9jb2x1bW5fdHlwZShbImZvdXIiLCAnXHUwNDNmXHUwNDRmXHUwNDQyXHUwNDRjJ10pIGlzIHN0cgogICAgVHJ1ZQogICAgPj4+IF9jb2x1bW5fdHlwZShbTm9uZSwgImJydXgiXSkgaXMgc3RyCiAgICBUcnVlCiAgICA+Pj4gX2NvbHVtbl90eXBlKFsxLCAyLCBOb25lXSkgaXMgaW50CiAgICBUcnVlCiAgICA+Pj4gaW1wb3J0IGRhdGV0aW1lIGFzIGR0CiAgICA+Pj4gX2NvbHVtbl90eXBlKFtkdC5kYXRldGltZSgxOTkxLDIsMTkpLCBkdC50aW1lKDE3LDM1KV0pIGlzIHN0cgogICAgVHJ1ZQoKICAgICIiIgogICAgdHlwZXMgPSBbX3R5cGUocywgaGFzX2ludmlzaWJsZSwgbnVtcGFyc2UpIGZvciBzIGluIHN0cmluZ3NdCiAgICByZXR1cm4gcmVkdWNlKF9tb3JlX2dlbmVyaWMsIHR5cGVzLCBib29sKQoKCmRlZiBfZm9ybWF0KHZhbCwgdmFsdHlwZSwgZmxvYXRmbXQsIGludGZtdCwgbWlzc2luZ3ZhbD0iIiwgaGFzX2ludmlzaWJsZT1UcnVlKToKICAgICIiIkZvcm1hdCBhIHZhbHVlIGFjY29yZGluZyB0byBpdHMgdHlwZS4KCiAgICBVbmljb2RlIGlzIHN1cHBvcnRlZDoKCiAgICA+Pj4gaHJvdyA9IFsnXHUwNDMxXHUwNDQzXHUwNDNhXHUwNDMyXHUwNDMwJywgJ1x1MDQ0Nlx1MDQzOFx1MDQ0NFx1MDQ0MFx1MDQzMCddIDsgXAogICAgICAgIHRibCA9IFtbJ1x1MDQzMFx1MDQzNycsIDJdLCBbJ1x1MDQzMVx1MDQ0M1x1MDQzYVx1MDQzOCcsIDRdXSA7IFwKICAgICAgICBnb29kX3Jlc3VsdCA9ICdcXHUwNDMxXFx1MDQ0M1xcdTA0M2FcXHUwNDMyXFx1MDQzMCAgICAgIFxcdTA0NDZcXHUwNDM4XFx1MDQ0NFxcdTA0NDBcXHUwNDMwXFxuLS0tLS0tLSAgLS0tLS0tLVxcblxcdTA0MzBcXHUwNDM3ICAgICAgICAgICAgIDJcXG5cXHUwNDMxXFx1MDQ0M1xcdTA0M2FcXHUwNDM4ICAgICAgICAgICA0JyA7IFwKICAgICAgICB0YWJ1bGF0ZSh0YmwsIGhlYWRlcnM9aHJvdykgPT0gZ29vZF9yZXN1bHQKICAgIFRydWUKCiAgICAiIiIgICMgbm9xYQogICAgaWYgdmFsIGlzIE5vbmU6CiAgICAgICAgcmV0dXJuIG1pc3Npbmd2YWwKCiAgICBpZiB2YWx0eXBlIGlzIHN0cjoKICAgICAgICByZXR1cm4gZiJ7dmFsfSIKICAgIGVsaWYgdmFsdHlwZSBpcyBpbnQ6CiAgICAgICAgcmV0dXJuIGZvcm1hdCh2YWwsIGludGZtdCkKICAgIGVsaWYgdmFsdHlwZSBpcyBieXRlczoKICAgICAgICB0cnk6CiAgICAgICAgICAgIHJldHVybiBzdHIodmFsLCAiYXNjaWkiKQogICAgICAgIGV4Y2VwdCAoVHlwZUVycm9yLCBVbmljb2RlRGVjb2RlRXJyb3IpOgogICAgICAgICAgICByZXR1cm4gc3RyKHZhbCkKICAgIGVsaWYgdmFsdHlwZSBpcyBmbG9hdDoKICAgICAgICBpc19hX2NvbG9yZWRfbnVtYmVyID0gaGFzX2ludmlzaWJsZSBhbmQgaXNpbnN0YW5jZSh2YWwsIChzdHIsIGJ5dGVzKSkKICAgICAgICBpZiBpc19hX2NvbG9yZWRfbnVtYmVyOgogICAgICAgICAgICByYXdfdmFsID0gX3N0cmlwX2Fuc2kodmFsKQogICAgICAgICAgICBmb3JtYXR0ZWRfdmFsID0gZm9ybWF0KGZsb2F0KHJhd192YWwpLCBmbG9hdGZtdCkKICAgICAgICAgICAgcmV0dXJuIHZhbC5yZXBsYWNlKHJhd192YWwsIGZvcm1hdHRlZF92YWwpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIGZvcm1hdChmbG9hdCh2YWwpLCBmbG9hdGZtdCkKICAgIGVsc2U6CiAgICAgICAgcmV0dXJuIGYie3ZhbH0iCgoKZGVmIF9hbGlnbl9oZWFkZXIoCiAgICBoZWFkZXIsIGFsaWdubWVudCwgd2lkdGgsIHZpc2libGVfd2lkdGgsIGlzX211bHRpbGluZT1GYWxzZSwgd2lkdGhfZm49Tm9uZQopOgogICAgIlBhZCBzdHJpbmcgaGVhZGVyIHRvIHdpZHRoIGNoYXJzIGdpdmVuIGtub3duIHZpc2libGVfd2lkdGggb2YgdGhlIGhlYWRlci4iCiAgICBpZiBpc19tdWx0aWxpbmU6CiAgICAgICAgaGVhZGVyX2xpbmVzID0gcmUuc3BsaXQoX211bHRpbGluZV9jb2RlcywgaGVhZGVyKQogICAgICAgIHBhZGRlZF9saW5lcyA9IFsKICAgICAgICAgICAgX2FsaWduX2hlYWRlcihoLCBhbGlnbm1lbnQsIHdpZHRoLCB3aWR0aF9mbihoKSkgZm9yIGggaW4gaGVhZGVyX2xpbmVzCiAgICAgICAgXQogICAgICAgIHJldHVybiAiXG4iLmpvaW4ocGFkZGVkX2xpbmVzKQogICAgIyBlbHNlOiBub3QgbXVsdGlsaW5lCiAgICBuaW52aXNpYmxlID0gbGVuKGhlYWRlcikgLSB2aXNpYmxlX3dpZHRoCiAgICB3aWR0aCArPSBuaW52aXNpYmxlCiAgICBpZiBhbGlnbm1lbnQgPT0gImxlZnQiOgogICAgICAgIHJldHVybiBfcGFkcmlnaHQod2lkdGgsIGhlYWRlcikKICAgIGVsaWYgYWxpZ25tZW50ID09ICJjZW50ZXIiOgogICAgICAgIHJldHVybiBfcGFkYm90aCh3aWR0aCwgaGVhZGVyKQogICAgZWxpZiBub3QgYWxpZ25tZW50OgogICAgICAgIHJldHVybiBmIntoZWFkZXJ9IgogICAgZWxzZToKICAgICAgICByZXR1cm4gX3BhZGxlZnQod2lkdGgsIGhlYWRlcikKCgpkZWYgX3JlbW92ZV9zZXBhcmF0aW5nX2xpbmVzKHJvd3MpOgogICAgaWYgdHlwZShyb3dzKSA9PSBsaXN0OgogICAgICAgIHNlcGFyYXRpbmdfbGluZXMgPSBbXQogICAgICAgIHNhbnNfcm93cyA9IFtdCiAgICAgICAgZm9yIGluZGV4LCByb3cgaW4gZW51bWVyYXRlKHJvd3MpOgogICAgICAgICAgICBpZiBfaXNfc2VwYXJhdGluZ19saW5lKHJvdyk6CiAgICAgICAgICAgICAgICBzZXBhcmF0aW5nX2xpbmVzLmFwcGVuZChpbmRleCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNhbnNfcm93cy5hcHBlbmQocm93KQogICAgICAgIHJldHVybiBzYW5zX3Jvd3MsIHNlcGFyYXRpbmdfbGluZXMKICAgIGVsc2U6CiAgICAgICAgcmV0dXJuIHJvd3MsIE5vbmUKCgpkZWYgX3JlaW5zZXJ0X3NlcGFyYXRpbmdfbGluZXMocm93cywgc2VwYXJhdGluZ19saW5lcyk6CiAgICBpZiBzZXBhcmF0aW5nX2xpbmVzOgogICAgICAgIGZvciBpbmRleCBpbiBzZXBhcmF0aW5nX2xpbmVzOgogICAgICAgICAgICByb3dzLmluc2VydChpbmRleCwgU0VQQVJBVElOR19MSU5FKQoKCmRlZiBfcHJlcGVuZF9yb3dfaW5kZXgocm93cywgaW5kZXgpOgogICAgIiIiQWRkIGEgbGVmdC1tb3N0IGluZGV4IGNvbHVtbi4iIiIKICAgIGlmIGluZGV4IGlzIE5vbmUgb3IgaW5kZXggaXMgRmFsc2U6CiAgICAgICAgcmV0dXJuIHJvd3MKICAgIGlmIGlzaW5zdGFuY2UoaW5kZXgsIFNpemVkKSBhbmQgbGVuKGluZGV4KSAhPSBsZW4ocm93cyk6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigKICAgICAgICAgICAgImluZGV4IG11c3QgYmUgYXMgbG9uZyBhcyB0aGUgbnVtYmVyIG9mIGRhdGEgcm93czogIgogICAgICAgICAgICArICJsZW4oaW5kZXgpPXt9IGxlbihyb3dzKT17fSIuZm9ybWF0KGxlbihpbmRleCksIGxlbihyb3dzKSkKICAgICAgICApCiAgICBzYW5zX3Jvd3MsIHNlcGFyYXRpbmdfbGluZXMgPSBfcmVtb3ZlX3NlcGFyYXRpbmdfbGluZXMocm93cykKICAgIG5ld19yb3dzID0gW10KICAgIGluZGV4X2l0ZXIgPSBpdGVyKGluZGV4KQogICAgZm9yIHJvdyBpbiBzYW5zX3Jvd3M6CiAgICAgICAgaW5kZXhfdiA9IG5leHQoaW5kZXhfaXRlcikKICAgICAgICBuZXdfcm93cy5hcHBlbmQoW2luZGV4X3ZdICsgbGlzdChyb3cpKQogICAgcm93cyA9IG5ld19yb3dzCiAgICBfcmVpbnNlcnRfc2VwYXJhdGluZ19saW5lcyhyb3dzLCBzZXBhcmF0aW5nX2xpbmVzKQogICAgcmV0dXJuIHJvd3MKCgpkZWYgX2Jvb2wodmFsKToKICAgICJBIHdyYXBwZXIgYXJvdW5kIHN0YW5kYXJkIGJvb2woKSB3aGljaCBkb2Vzbid0IHRocm93IG9uIE51bVB5IGFycmF5cyIKICAgIHRyeToKICAgICAgICByZXR1cm4gYm9vbCh2YWwpCiAgICBleGNlcHQgVmFsdWVFcnJvcjogICMgdmFsIGlzIGxpa2VseSB0byBiZSBhIG51bXB5IGFycmF5IHdpdGggbWFueSBlbGVtZW50cwogICAgICAgIHJldHVybiBGYWxzZQoKCmRlZiBfbm9ybWFsaXplX3RhYnVsYXJfZGF0YSh0YWJ1bGFyX2RhdGEsIGhlYWRlcnMsIHNob3dpbmRleD0iZGVmYXVsdCIpOgogICAgIiIiVHJhbnNmb3JtIGEgc3VwcG9ydGVkIGRhdGEgdHlwZSB0byBhIGxpc3Qgb2YgbGlzdHMsIGFuZCBhIGxpc3Qgb2YgaGVhZGVycy4KCiAgICBTdXBwb3J0ZWQgdGFidWxhciBkYXRhIHR5cGVzOgoKICAgICogbGlzdC1vZi1saXN0cyBvciBhbm90aGVyIGl0ZXJhYmxlIG9mIGl0ZXJhYmxlcwoKICAgICogbGlzdCBvZiBuYW1lZCB0dXBsZXMgKHVzdWFsbHkgdXNlZCB3aXRoIGhlYWRlcnM9ImtleXMiKQoKICAgICogbGlzdCBvZiBkaWN0cyAodXN1YWxseSB1c2VkIHdpdGggaGVhZGVycz0ia2V5cyIpCgogICAgKiBsaXN0IG9mIE9yZGVyZWREaWN0cyAodXN1YWxseSB1c2VkIHdpdGggaGVhZGVycz0ia2V5cyIpCgogICAgKiBsaXN0IG9mIGRhdGFjbGFzc2VzIChQeXRob24gMy43KyBvbmx5LCB1c3VhbGx5IHVzZWQgd2l0aCBoZWFkZXJzPSJrZXlzIikKCiAgICAqIDJEIE51bVB5IGFycmF5cwoKICAgICogTnVtUHkgcmVjb3JkIGFycmF5cyAodXN1YWxseSB1c2VkIHdpdGggaGVhZGVycz0ia2V5cyIpCgogICAgKiBkaWN0IG9mIGl0ZXJhYmxlcyAodXN1YWxseSB1c2VkIHdpdGggaGVhZGVycz0ia2V5cyIpCgogICAgKiBwYW5kYXMuRGF0YUZyYW1lICh1c3VhbGx5IHVzZWQgd2l0aCBoZWFkZXJzPSJrZXlzIikKCiAgICBUaGUgZmlyc3Qgcm93IGNhbiBiZSB1c2VkIGFzIGhlYWRlcnMgaWYgaGVhZGVycz0iZmlyc3Ryb3ciLAogICAgY29sdW1uIGluZGljZXMgY2FuIGJlIHVzZWQgYXMgaGVhZGVycyBpZiBoZWFkZXJzPSJrZXlzIi4KCiAgICBJZiBzaG93aW5kZXg9ImRlZmF1bHQiLCBzaG93IHJvdyBpbmRpY2VzIG9mIHRoZSBwYW5kYXMuRGF0YUZyYW1lLgogICAgSWYgc2hvd2luZGV4PSJhbHdheXMiLCBzaG93IHJvdyBpbmRpY2VzIGZvciBhbGwgdHlwZXMgb2YgZGF0YS4KICAgIElmIHNob3dpbmRleD0ibmV2ZXIiLCBkb24ndCBzaG93IHJvdyBpbmRpY2VzIGZvciBhbGwgdHlwZXMgb2YgZGF0YS4KICAgIElmIHNob3dpbmRleCBpcyBhbiBpdGVyYWJsZSwgc2hvdyBpdHMgdmFsdWVzIGFzIHJvdyBpbmRpY2VzLgoKICAgICIiIgoKICAgIHRyeToKICAgICAgICBib29sKGhlYWRlcnMpCiAgICAgICAgaXNfaGVhZGVyczJib29sX2Jyb2tlbiA9IEZhbHNlICAjIG5vcWEKICAgIGV4Y2VwdCBWYWx1ZUVycm9yOiAgIyBudW1weS5uZGFycmF5LCBwYW5kYXMuY29yZS5pbmRleC5JbmRleCwgLi4uCiAgICAgICAgaXNfaGVhZGVyczJib29sX2Jyb2tlbiA9IFRydWUgICMgbm9xYQogICAgICAgIGhlYWRlcnMgPSBsaXN0KGhlYWRlcnMpCgogICAgaW5kZXggPSBOb25lCiAgICBpZiBoYXNhdHRyKHRhYnVsYXJfZGF0YSwgImtleXMiKSBhbmQgaGFzYXR0cih0YWJ1bGFyX2RhdGEsICJ2YWx1ZXMiKToKICAgICAgICAjIGRpY3QtbGlrZSBhbmQgcGFuZGFzLkRhdGFGcmFtZT8KICAgICAgICBpZiBoYXNhdHRyKHRhYnVsYXJfZGF0YS52YWx1ZXMsICJfX2NhbGxfXyIpOgogICAgICAgICAgICAjIGxpa2VseSBhIGNvbnZlbnRpb25hbCBkaWN0CiAgICAgICAgICAgIGtleXMgPSB0YWJ1bGFyX2RhdGEua2V5cygpCiAgICAgICAgICAgIHJvd3MgPSBsaXN0KAogICAgICAgICAgICAgICAgaXppcF9sb25nZXN0KCp0YWJ1bGFyX2RhdGEudmFsdWVzKCkpCiAgICAgICAgICAgICkgICMgY29sdW1ucyBoYXZlIHRvIGJlIHRyYW5zcG9zZWQKICAgICAgICBlbGlmIGhhc2F0dHIodGFidWxhcl9kYXRhLCAiaW5kZXgiKToKICAgICAgICAgICAgIyB2YWx1ZXMgaXMgYSBwcm9wZXJ0eSwgaGFzIC5pbmRleCA9PiBpdCdzIGxpa2VseSBhIHBhbmRhcy5EYXRhRnJhbWUgKHBhbmRhcyAwLjExLjApCiAgICAgICAgICAgIGtleXMgPSBsaXN0KHRhYnVsYXJfZGF0YSkKICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgc2hvd2luZGV4IGluIFsiZGVmYXVsdCIsICJhbHdheXMiLCBUcnVlXQogICAgICAgICAgICAgICAgYW5kIHRhYnVsYXJfZGF0YS5pbmRleC5uYW1lIGlzIG5vdCBOb25lCiAgICAgICAgICAgICk6CiAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKHRhYnVsYXJfZGF0YS5pbmRleC5uYW1lLCBsaXN0KToKICAgICAgICAgICAgICAgICAgICBrZXlzWzowXSA9IHRhYnVsYXJfZGF0YS5pbmRleC5uYW1lCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGtleXNbOjBdID0gW3RhYnVsYXJfZGF0YS5pbmRleC5uYW1lXQogICAgICAgICAgICB2YWxzID0gdGFidWxhcl9kYXRhLnZhbHVlcyAgIyB2YWx1ZXMgbWF0cml4IGRvZXNuJ3QgbmVlZCB0byBiZSB0cmFuc3Bvc2VkCiAgICAgICAgICAgICMgZm9yIERhdGFGcmFtZXMgYWRkIGFuIGluZGV4IHBlciBkZWZhdWx0CiAgICAgICAgICAgIGluZGV4ID0gbGlzdCh0YWJ1bGFyX2RhdGEuaW5kZXgpCiAgICAgICAgICAgIHJvd3MgPSBbbGlzdChyb3cpIGZvciByb3cgaW4gdmFsc10KICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJ0YWJ1bGFyIGRhdGEgZG9lc24ndCBhcHBlYXIgdG8gYmUgYSBkaWN0IG9yIGEgRGF0YUZyYW1lIikKCiAgICAgICAgaWYgaGVhZGVycyA9PSAia2V5cyI6CiAgICAgICAgICAgIGhlYWRlcnMgPSBsaXN0KG1hcChzdHIsIGtleXMpKSAgIyBoZWFkZXJzIHNob3VsZCBiZSBzdHJpbmdzCgogICAgZWxzZTogICMgaXQncyBhIHVzdWFsIGl0ZXJhYmxlIG9mIGl0ZXJhYmxlcywgb3IgYSBOdW1QeSBhcnJheSwgb3IgYW4gaXRlcmFibGUgb2YgZGF0YWNsYXNzZXMKICAgICAgICByb3dzID0gbGlzdCh0YWJ1bGFyX2RhdGEpCgogICAgICAgIGlmIGhlYWRlcnMgPT0gImtleXMiIGFuZCBub3Qgcm93czoKICAgICAgICAgICAgIyBhbiBlbXB0eSB0YWJsZSAoaXNzdWUgIzgxKQogICAgICAgICAgICBoZWFkZXJzID0gW10KICAgICAgICBlbGlmICgKICAgICAgICAgICAgaGVhZGVycyA9PSAia2V5cyIKICAgICAgICAgICAgYW5kIGhhc2F0dHIodGFidWxhcl9kYXRhLCAiZHR5cGUiKQogICAgICAgICAgICBhbmQgZ2V0YXR0cih0YWJ1bGFyX2RhdGEuZHR5cGUsICJuYW1lcyIpCiAgICAgICAgKToKICAgICAgICAgICAgIyBudW1weSByZWNvcmQgYXJyYXkKICAgICAgICAgICAgaGVhZGVycyA9IHRhYnVsYXJfZGF0YS5kdHlwZS5uYW1lcwogICAgICAgIGVsaWYgKAogICAgICAgICAgICBoZWFkZXJzID09ICJrZXlzIgogICAgICAgICAgICBhbmQgbGVuKHJvd3MpID4gMAogICAgICAgICAgICBhbmQgaXNpbnN0YW5jZShyb3dzWzBdLCB0dXBsZSkKICAgICAgICAgICAgYW5kIGhhc2F0dHIocm93c1swXSwgIl9maWVsZHMiKQogICAgICAgICk6CiAgICAgICAgICAgICMgbmFtZWR0dXBsZQogICAgICAgICAgICBoZWFkZXJzID0gbGlzdChtYXAoc3RyLCByb3dzWzBdLl9maWVsZHMpKQogICAgICAgIGVsaWYgbGVuKHJvd3MpID4gMCBhbmQgaGFzYXR0cihyb3dzWzBdLCAia2V5cyIpIGFuZCBoYXNhdHRyKHJvd3NbMF0sICJ2YWx1ZXMiKToKICAgICAgICAgICAgIyBkaWN0LWxpa2Ugb2JqZWN0CiAgICAgICAgICAgIHVuaXFfa2V5cyA9IHNldCgpICAjIGltcGxlbWVudHMgaGFzaGVkIGxvb2t1cAogICAgICAgICAgICBrZXlzID0gW10gICMgc3RvcmFnZSBmb3Igc2V0CiAgICAgICAgICAgIGlmIGhlYWRlcnMgPT0gImZpcnN0cm93IjoKICAgICAgICAgICAgICAgIGZpcnN0ZGljdCA9IHJvd3NbMF0gaWYgbGVuKHJvd3MpID4gMCBlbHNlIHt9CiAgICAgICAgICAgICAgICBrZXlzLmV4dGVuZChmaXJzdGRpY3Qua2V5cygpKQogICAgICAgICAgICAgICAgdW5pcV9rZXlzLnVwZGF0ZShrZXlzKQogICAgICAgICAgICAgICAgcm93cyA9IHJvd3NbMTpdCiAgICAgICAgICAgIGZvciByb3cgaW4gcm93czoKICAgICAgICAgICAgICAgIGZvciBrIGluIHJvdy5rZXlzKCk6CiAgICAgICAgICAgICAgICAgICAgIyBTYXZlIHVuaXF1ZSBpdGVtcyBpbiBpbnB1dCBvcmRlcgogICAgICAgICAgICAgICAgICAgIGlmIGsgbm90IGluIHVuaXFfa2V5czoKICAgICAgICAgICAgICAgICAgICAgICAga2V5cy5hcHBlbmQoaykKICAgICAgICAgICAgICAgICAgICAgICAgdW5pcV9rZXlzLmFkZChrKQogICAgICAgICAgICBpZiBoZWFkZXJzID09ICJrZXlzIjoKICAgICAgICAgICAgICAgIGhlYWRlcnMgPSBrZXlzCiAgICAgICAgICAgIGVsaWYgaXNpbnN0YW5jZShoZWFkZXJzLCBkaWN0KToKICAgICAgICAgICAgICAgICMgYSBkaWN0IG9mIGhlYWRlcnMgZm9yIGEgbGlzdCBvZiBkaWN0cwogICAgICAgICAgICAgICAgaGVhZGVycyA9IFtoZWFkZXJzLmdldChrLCBrKSBmb3IgayBpbiBrZXlzXQogICAgICAgICAgICAgICAgaGVhZGVycyA9IGxpc3QobWFwKHN0ciwgaGVhZGVycykpCiAgICAgICAgICAgIGVsaWYgaGVhZGVycyA9PSAiZmlyc3Ryb3ciOgogICAgICAgICAgICAgICAgaWYgbGVuKHJvd3MpID4gMDoKICAgICAgICAgICAgICAgICAgICBoZWFkZXJzID0gW2ZpcnN0ZGljdC5nZXQoaywgaykgZm9yIGsgaW4ga2V5c10KICAgICAgICAgICAgICAgICAgICBoZWFkZXJzID0gbGlzdChtYXAoc3RyLCBoZWFkZXJzKSkKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgaGVhZGVycyA9IFtdCiAgICAgICAgICAgIGVsaWYgaGVhZGVyczoKICAgICAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoCiAgICAgICAgICAgICAgICAgICAgImhlYWRlcnMgZm9yIGEgbGlzdCBvZiBkaWN0cyBpcyBub3QgYSBkaWN0IG9yIGEga2V5d29yZCIKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgcm93cyA9IFtbcm93LmdldChrKSBmb3IgayBpbiBrZXlzXSBmb3Igcm93IGluIHJvd3NdCgogICAgICAgIGVsaWYgKAogICAgICAgICAgICBoZWFkZXJzID09ICJrZXlzIgogICAgICAgICAgICBhbmQgaGFzYXR0cih0YWJ1bGFyX2RhdGEsICJkZXNjcmlwdGlvbiIpCiAgICAgICAgICAgIGFuZCBoYXNhdHRyKHRhYnVsYXJfZGF0YSwgImZldGNob25lIikKICAgICAgICAgICAgYW5kIGhhc2F0dHIodGFidWxhcl9kYXRhLCAicm93Y291bnQiKQogICAgICAgICk6CiAgICAgICAgICAgICMgUHl0aG9uIERhdGFiYXNlIEFQSSBjdXJzb3Igb2JqZWN0IChQRVAgMDI0OSkKICAgICAgICAgICAgIyBwcmludCB0YWJ1bGF0ZShjdXJzb3IsIGhlYWRlcnM9J2tleXMnKQogICAgICAgICAgICBoZWFkZXJzID0gW2NvbHVtblswXSBmb3IgY29sdW1uIGluIHRhYnVsYXJfZGF0YS5kZXNjcmlwdGlvbl0KCiAgICAgICAgZWxpZiAoCiAgICAgICAgICAgIGRhdGFjbGFzc2VzIGlzIG5vdCBOb25lCiAgICAgICAgICAgIGFuZCBsZW4ocm93cykgPiAwCiAgICAgICAgICAgIGFuZCBkYXRhY2xhc3Nlcy5pc19kYXRhY2xhc3Mocm93c1swXSkKICAgICAgICApOgogICAgICAgICAgICAjIFB5dGhvbiAzLjcrJ3MgZGF0YWNsYXNzCiAgICAgICAgICAgIGZpZWxkX25hbWVzID0gW2ZpZWxkLm5hbWUgZm9yIGZpZWxkIGluIGRhdGFjbGFzc2VzLmZpZWxkcyhyb3dzWzBdKV0KICAgICAgICAgICAgaWYgaGVhZGVycyA9PSAia2V5cyI6CiAgICAgICAgICAgICAgICBoZWFkZXJzID0gZmllbGRfbmFtZXMKICAgICAgICAgICAgcm93cyA9IFtbZ2V0YXR0cihyb3csIGYpIGZvciBmIGluIGZpZWxkX25hbWVzXSBmb3Igcm93IGluIHJvd3NdCgogICAgICAgIGVsaWYgaGVhZGVycyA9PSAia2V5cyIgYW5kIGxlbihyb3dzKSA+IDA6CiAgICAgICAgICAgICMga2V5cyBhcmUgY29sdW1uIGluZGljZXMKICAgICAgICAgICAgaGVhZGVycyA9IGxpc3QobWFwKHN0ciwgcmFuZ2UobGVuKHJvd3NbMF0pKSkpCgogICAgIyB0YWtlIGhlYWRlcnMgZnJvbSB0aGUgZmlyc3Qgcm93IGlmIG5lY2Vzc2FyeQogICAgaWYgaGVhZGVycyA9PSAiZmlyc3Ryb3ciIGFuZCBsZW4ocm93cykgPiAwOgogICAgICAgIGlmIGluZGV4IGlzIG5vdCBOb25lOgogICAgICAgICAgICBoZWFkZXJzID0gW2luZGV4WzBdXSArIGxpc3Qocm93c1swXSkKICAgICAgICAgICAgaW5kZXggPSBpbmRleFsxOl0KICAgICAgICBlbHNlOgogICAgICAgICAgICBoZWFkZXJzID0gcm93c1swXQogICAgICAgIGhlYWRlcnMgPSBsaXN0KG1hcChzdHIsIGhlYWRlcnMpKSAgIyBoZWFkZXJzIHNob3VsZCBiZSBzdHJpbmdzCiAgICAgICAgcm93cyA9IHJvd3NbMTpdCiAgICBlbGlmIGhlYWRlcnMgPT0gImZpcnN0cm93IjoKICAgICAgICBoZWFkZXJzID0gW10KCiAgICBoZWFkZXJzID0gbGlzdChtYXAoc3RyLCBoZWFkZXJzKSkKICAgICMgICAgcm93cyA9IGxpc3QobWFwKGxpc3QsIHJvd3MpKQogICAgcm93cyA9IGxpc3QobWFwKGxhbWJkYSByOiByIGlmIF9pc19zZXBhcmF0aW5nX2xpbmUocikgZWxzZSBsaXN0KHIpLCByb3dzKSkKCiAgICAjIGFkZCBvciByZW1vdmUgYW4gaW5kZXggY29sdW1uCiAgICBzaG93aW5kZXhfaXNfYV9zdHIgPSB0eXBlKHNob3dpbmRleCkgaW4gW3N0ciwgYnl0ZXNdCiAgICBpZiBzaG93aW5kZXggPT0gImRlZmF1bHQiIGFuZCBpbmRleCBpcyBub3QgTm9uZToKICAgICAgICByb3dzID0gX3ByZXBlbmRfcm93X2luZGV4KHJvd3MsIGluZGV4KQogICAgZWxpZiBpc2luc3RhbmNlKHNob3dpbmRleCwgU2l6ZWQpIGFuZCBub3Qgc2hvd2luZGV4X2lzX2Ffc3RyOgogICAgICAgIHJvd3MgPSBfcHJlcGVuZF9yb3dfaW5kZXgocm93cywgbGlzdChzaG93aW5kZXgpKQogICAgZWxpZiBpc2luc3RhbmNlKHNob3dpbmRleCwgSXRlcmFibGUpIGFuZCBub3Qgc2hvd2luZGV4X2lzX2Ffc3RyOgogICAgICAgIHJvd3MgPSBfcHJlcGVuZF9yb3dfaW5kZXgocm93cywgc2hvd2luZGV4KQogICAgZWxpZiBzaG93aW5kZXggPT0gImFsd2F5cyIgb3IgKF9ib29sKHNob3dpbmRleCkgYW5kIG5vdCBzaG93aW5kZXhfaXNfYV9zdHIpOgogICAgICAgIGlmIGluZGV4IGlzIE5vbmU6CiAgICAgICAgICAgIGluZGV4ID0gbGlzdChyYW5nZShsZW4ocm93cykpKQogICAgICAgIHJvd3MgPSBfcHJlcGVuZF9yb3dfaW5kZXgocm93cywgaW5kZXgpCiAgICBlbGlmIHNob3dpbmRleCA9PSAibmV2ZXIiIG9yIChub3QgX2Jvb2woc2hvd2luZGV4KSBhbmQgbm90IHNob3dpbmRleF9pc19hX3N0cik6CiAgICAgICAgcGFzcwoKICAgICMgcGFkIHdpdGggZW1wdHkgaGVhZGVycyBmb3IgaW5pdGlhbCBjb2x1bW5zIGlmIG5lY2Vzc2FyeQogICAgaWYgaGVhZGVycyBhbmQgbGVuKHJvd3MpID4gMDoKICAgICAgICBuaHMgPSBsZW4oaGVhZGVycykKICAgICAgICBuY29scyA9IGxlbihyb3dzWzBdKQogICAgICAgIGlmIG5ocyA8IG5jb2xzOgogICAgICAgICAgICBoZWFkZXJzID0gWyIiXSAqIChuY29scyAtIG5ocykgKyBoZWFkZXJzCgogICAgcmV0dXJuIHJvd3MsIGhlYWRlcnMKCgpkZWYgX3dyYXBfdGV4dF90b19jb2x3aWR0aHMobGlzdF9vZl9saXN0cywgY29sd2lkdGhzLCBudW1wYXJzZXM9VHJ1ZSk6CiAgICBudW1wYXJzZXMgPSBfZXhwYW5kX2l0ZXJhYmxlKG51bXBhcnNlcywgbGVuKGxpc3Rfb2ZfbGlzdHNbMF0pLCBUcnVlKQoKICAgIHJlc3VsdCA9IFtdCgogICAgZm9yIHJvdyBpbiBsaXN0X29mX2xpc3RzOgogICAgICAgIG5ld19yb3cgPSBbXQogICAgICAgIGZvciBjZWxsLCB3aWR0aCwgbnVtcGFyc2UgaW4gemlwKHJvdywgY29sd2lkdGhzLCBudW1wYXJzZXMpOgogICAgICAgICAgICBpZiBfaXNudW1iZXIoY2VsbCkgYW5kIG51bXBhcnNlOgogICAgICAgICAgICAgICAgbmV3X3Jvdy5hcHBlbmQoY2VsbCkKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICBpZiB3aWR0aCBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIHdyYXBwZXIgPSBfQ3VzdG9tVGV4dFdyYXAod2lkdGg9d2lkdGgpCiAgICAgICAgICAgICAgICAjIENhc3QgYmFzZWQgb24gb3VyIGludGVybmFsIHR5cGUgaGFuZGxpbmcKICAgICAgICAgICAgICAgICMgQW55IGZ1dHVyZSBjdXN0b20gZm9ybWF0dGluZyBvZiB0eXBlcyAoc3VjaCBhcyBkYXRldGltZXMpCiAgICAgICAgICAgICAgICAjIG1heSBuZWVkIHRvIGJlIG1vcmUgZXhwbGljaXQgdGhhbiBqdXN0IGBzdHJgIG9mIHRoZSBvYmplY3QKICAgICAgICAgICAgICAgIGNhc3RlZF9jZWxsID0gKAogICAgICAgICAgICAgICAgICAgIHN0cihjZWxsKSBpZiBfaXNudW1iZXIoY2VsbCkgZWxzZSBfdHlwZShjZWxsLCBudW1wYXJzZSkoY2VsbCkKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIHdyYXBwZWQgPSB3cmFwcGVyLndyYXAoY2FzdGVkX2NlbGwpCiAgICAgICAgICAgICAgICBuZXdfcm93LmFwcGVuZCgiXG4iLmpvaW4od3JhcHBlZCkpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBuZXdfcm93LmFwcGVuZChjZWxsKQogICAgICAgIHJlc3VsdC5hcHBlbmQobmV3X3JvdykKCiAgICByZXR1cm4gcmVzdWx0CgoKZGVmIF90b19zdHIocywgZW5jb2Rpbmc9InV0ZjgiLCBlcnJvcnM9Imlnbm9yZSIpOgogICAgIiIiCiAgICBBIHR5cGUgc2FmZSB3cmFwcGVyIGZvciBjb252ZXJ0aW5nIGEgYnl0ZXN0cmluZyB0byBzdHIuIFRoaXMgaXMgZXNzZW50aWFsbHkganVzdAogICAgYSB3cmFwcGVyIGFyb3VuZCAuZGVjb2RlKCkgaW50ZW5kZWQgZm9yIHVzZSB3aXRoIHRoaW5ncyBsaWtlIG1hcCgpLCBidXQgd2l0aCBzb21lCiAgICBzcGVjaWZpYyBiZWhhdmlvcjoKCiAgICAxLiBpZiB0aGUgZ2l2ZW4gcGFyYW1ldGVyIGlzIG5vdCBhIGJ5dGVzdHJpbmcsIGl0IGlzIHJldHVybmVkIHVubW9kaWZpZWQKICAgIDIuIGRlY29kZSgpIGlzIGNhbGxlZCBmb3IgdGhlIGdpdmVuIHBhcmFtZXRlciBhbmQgYXNzdW1lcyB1dGY4IGVuY29kaW5nLCBidXQgdGhlCiAgICAgICBkZWZhdWx0IGVycm9yIGJlaGF2aW9yIGlzIGNoYW5nZWQgZnJvbSAnc3RyaWN0JyB0byAnaWdub3JlJwoKICAgID4+PiByZXByKF90b19zdHIoYidmb28nKSkKICAgICInZm9vJyIKCiAgICA+Pj4gcmVwcihfdG9fc3RyKCdmb28nKSkKICAgICInZm9vJyIKCiAgICA+Pj4gcmVwcihfdG9fc3RyKDQyKSkKICAgICInNDInIgoKICAgICIiIgogICAgaWYgaXNpbnN0YW5jZShzLCBieXRlcyk6CiAgICAgICAgcmV0dXJuIHMuZGVjb2RlKGVuY29kaW5nPWVuY29kaW5nLCBlcnJvcnM9ZXJyb3JzKQogICAgcmV0dXJuIHN0cihzKQoKCmRlZiB0YWJ1bGF0ZSgKICAgIHRhYnVsYXJfZGF0YSwKICAgIGhlYWRlcnM9KCksCiAgICB0YWJsZWZtdD0ic2ltcGxlIiwKICAgIGZsb2F0Zm10PV9ERUZBVUxUX0ZMT0FURk1ULAogICAgaW50Zm10PV9ERUZBVUxUX0lOVEZNVCwKICAgIG51bWFsaWduPV9ERUZBVUxUX0FMSUdOLAogICAgc3RyYWxpZ249X0RFRkFVTFRfQUxJR04sCiAgICBtaXNzaW5ndmFsPV9ERUZBVUxUX01JU1NJTkdWQUwsCiAgICBzaG93aW5kZXg9ImRlZmF1bHQiLAogICAgZGlzYWJsZV9udW1wYXJzZT1GYWxzZSwKICAgIGNvbGFsaWduPU5vbmUsCiAgICBtYXhjb2x3aWR0aHM9Tm9uZSwKICAgIHJvd2FsaWduPU5vbmUsCiAgICBtYXhoZWFkZXJjb2x3aWR0aHM9Tm9uZSwKKToKICAgICIiIkZvcm1hdCBhIGZpeGVkIHdpZHRoIHRhYmxlIGZvciBwcmV0dHkgcHJpbnRpbmcuCgogICAgPj4+IHByaW50KHRhYnVsYXRlKFtbMSwgMi4zNF0sIFstNTYsICI4Ljk5OSJdLCBbIjIiLCAiMTAwMDEiXV0pKQogICAgLS0tICAtLS0tLS0tLS0KICAgICAgMSAgICAgIDIuMzQKICAgIC01NiAgICAgIDguOTk5CiAgICAgIDIgIDEwMDAxCiAgICAtLS0gIC0tLS0tLS0tLQoKICAgIFRoZSBmaXJzdCByZXF1aXJlZCBhcmd1bWVudCAoYHRhYnVsYXJfZGF0YWApIGNhbiBiZSBhCiAgICBsaXN0LW9mLWxpc3RzIChvciBhbm90aGVyIGl0ZXJhYmxlIG9mIGl0ZXJhYmxlcyksIGEgbGlzdCBvZiBuYW1lZAogICAgdHVwbGVzLCBhIGRpY3Rpb25hcnkgb2YgaXRlcmFibGVzLCBhbiBpdGVyYWJsZSBvZiBkaWN0aW9uYXJpZXMsCiAgICBhbiBpdGVyYWJsZSBvZiBkYXRhY2xhc3NlcyAoUHl0aG9uIDMuNyspLCBhIHR3by1kaW1lbnNpb25hbCBOdW1QeSBhcnJheSwKICAgIE51bVB5IHJlY29yZCBhcnJheSwgb3IgYSBQYW5kYXMnIGRhdGFmcmFtZS4KCgogICAgVGFibGUgaGVhZGVycwogICAgLS0tLS0tLS0tLS0tLQoKICAgIFRvIHByaW50IG5pY2UgY29sdW1uIGhlYWRlcnMsIHN1cHBseSB0aGUgc2Vjb25kIGFyZ3VtZW50IChgaGVhZGVyc2ApOgoKICAgICAgLSBgaGVhZGVyc2AgY2FuIGJlIGFuIGV4cGxpY2l0IGxpc3Qgb2YgY29sdW1uIGhlYWRlcnMKICAgICAgLSBpZiBgaGVhZGVycz0iZmlyc3Ryb3ciYCwgdGhlbiB0aGUgZmlyc3Qgcm93IG9mIGRhdGEgaXMgdXNlZAogICAgICAtIGlmIGBoZWFkZXJzPSJrZXlzImAsIHRoZW4gZGljdGlvbmFyeSBrZXlzIG9yIGNvbHVtbiBpbmRpY2VzIGFyZSB1c2VkCgogICAgT3RoZXJ3aXNlIGEgaGVhZGVybGVzcyB0YWJsZSBpcyBwcm9kdWNlZC4KCiAgICBJZiB0aGUgbnVtYmVyIG9mIGhlYWRlcnMgaXMgbGVzcyB0aGFuIHRoZSBudW1iZXIgb2YgY29sdW1ucywgdGhleQogICAgYXJlIHN1cHBvc2VkIHRvIGJlIG5hbWVzIG9mIHRoZSBsYXN0IGNvbHVtbnMuIFRoaXMgaXMgY29uc2lzdGVudAogICAgd2l0aCB0aGUgcGxhaW4tdGV4dCBmb3JtYXQgb2YgUiBhbmQgUGFuZGFzJyBkYXRhZnJhbWVzLgoKICAgID4+PiBwcmludCh0YWJ1bGF0ZShbWyJzZXgiLCJhZ2UiXSxbIkFsaWNlIiwiRiIsMjRdLFsiQm9iIiwiTSIsMTldXSwKICAgIC4uLiAgICAgICBoZWFkZXJzPSJmaXJzdHJvdyIpKQogICAgICAgICAgIHNleCAgICAgIGFnZQogICAgLS0tLS0gIC0tLS0tICAtLS0tLQogICAgQWxpY2UgIEYgICAgICAgICAyNAogICAgQm9iICAgIE0gICAgICAgICAxOQoKICAgIEJ5IGRlZmF1bHQsIHBhbmRhcy5EYXRhRnJhbWUgZGF0YSBoYXZlIGFuIGFkZGl0aW9uYWwgY29sdW1uIGNhbGxlZAogICAgcm93IGluZGV4LiBUbyBhZGQgYSBzaW1pbGFyIGNvbHVtbiB0byBhbGwgb3RoZXIgdHlwZXMgb2YgZGF0YSwKICAgIHVzZSBgc2hvd2luZGV4PSJhbHdheXMiYCBvciBgc2hvd2luZGV4PVRydWVgLiBUbyBzdXBwcmVzcyByb3cgaW5kaWNlcwogICAgZm9yIGFsbCB0eXBlcyBvZiBkYXRhLCBwYXNzIGBzaG93aW5kZXg9Im5ldmVyIiBvciBgc2hvd2luZGV4PUZhbHNlYC4KICAgIFRvIGFkZCBhIGN1c3RvbSByb3cgaW5kZXggY29sdW1uLCBwYXNzIGBzaG93aW5kZXg9c29tZV9pdGVyYWJsZWAuCgogICAgPj4+IHByaW50KHRhYnVsYXRlKFtbIkYiLDI0XSxbIk0iLDE5XV0sIHNob3dpbmRleD0iYWx3YXlzIikpCiAgICAtICAtICAtLQogICAgMCAgRiAgMjQKICAgIDEgIE0gIDE5CiAgICAtICAtICAtLQoKCiAgICBDb2x1bW4gYWxpZ25tZW50CiAgICAtLS0tLS0tLS0tLS0tLS0tCgogICAgYHRhYnVsYXRlYCB0cmllcyB0byBkZXRlY3QgY29sdW1uIHR5cGVzIGF1dG9tYXRpY2FsbHksIGFuZCBhbGlnbnMKICAgIHRoZSB2YWx1ZXMgcHJvcGVybHkuIEJ5IGRlZmF1bHQgaXQgYWxpZ25zIGRlY2ltYWwgcG9pbnRzIG9mIHRoZQogICAgbnVtYmVycyAob3IgZmx1c2hlcyBpbnRlZ2VyIG51bWJlcnMgdG8gdGhlIHJpZ2h0KSwgYW5kIGZsdXNoZXMKICAgIGV2ZXJ5dGhpbmcgZWxzZSB0byB0aGUgbGVmdC4gUG9zc2libGUgY29sdW1uIGFsaWdubWVudHMKICAgIChgbnVtYWxpZ25gLCBgc3RyYWxpZ25gKSBhcmU6ICJyaWdodCIsICJjZW50ZXIiLCAibGVmdCIsICJkZWNpbWFsIgogICAgKG9ubHkgZm9yIGBudW1hbGlnbmApLCBhbmQgTm9uZSAodG8gZGlzYWJsZSBhbGlnbm1lbnQpLgoKCiAgICBUYWJsZSBmb3JtYXRzCiAgICAtLS0tLS0tLS0tLS0tCgogICAgYGludGZtdGAgaXMgYSBmb3JtYXQgc3BlY2lmaWNhdGlvbiB1c2VkIGZvciBjb2x1bW5zIHdoaWNoCiAgICBjb250YWluIG51bWVyaWMgZGF0YSB3aXRob3V0IGEgZGVjaW1hbCBwb2ludC4gVGhpcyBjYW4gYWxzbyBiZQogICAgYSBsaXN0IG9yIHR1cGxlIG9mIGZvcm1hdCBzdHJpbmdzLCBvbmUgcGVyIGNvbHVtbi4KCiAgICBgZmxvYXRmbXRgIGlzIGEgZm9ybWF0IHNwZWNpZmljYXRpb24gdXNlZCBmb3IgY29sdW1ucyB3aGljaAogICAgY29udGFpbiBudW1lcmljIGRhdGEgd2l0aCBhIGRlY2ltYWwgcG9pbnQuIFRoaXMgY2FuIGFsc28gYmUKICAgIGEgbGlzdCBvciB0dXBsZSBvZiBmb3JtYXQgc3RyaW5ncywgb25lIHBlciBjb2x1bW4uCgogICAgYE5vbmVgIHZhbHVlcyBhcmUgcmVwbGFjZWQgd2l0aCBhIGBtaXNzaW5ndmFsYCBzdHJpbmcgKGxpa2UKICAgIGBmbG9hdGZtdGAsIHRoaXMgY2FuIGFsc28gYmUgYSBsaXN0IG9mIHZhbHVlcyBmb3IgZGlmZmVyZW50CiAgICBjb2x1bW5zKToKCiAgICA+Pj4gcHJpbnQodGFidWxhdGUoW1sic3BhbSIsIDEsIE5vbmVdLAogICAgLi4uICAgICAgICAgICAgICAgICBbImVnZ3MiLCA0MiwgMy4xNF0sCiAgICAuLi4gICAgICAgICAgICAgICAgIFsib3RoZXIiLCBOb25lLCAyLjddXSwgbWlzc2luZ3ZhbD0iPyIpKQogICAgLS0tLS0gIC0tICAtLS0tCiAgICBzcGFtICAgIDEgID8KICAgIGVnZ3MgICA0MiAgMy4xNAogICAgb3RoZXIgICA/ICAyLjcKICAgIC0tLS0tICAtLSAgLS0tLQoKICAgIFZhcmlvdXMgcGxhaW4tdGV4dCB0YWJsZSBmb3JtYXRzIChgdGFibGVmbXRgKSBhcmUgc3VwcG9ydGVkOgogICAgJ3BsYWluJywgJ3NpbXBsZScsICdncmlkJywgJ3BpcGUnLCAnb3JndGJsJywgJ3JzdCcsICdtZWRpYXdpa2knLAogICAgJ2xhdGV4JywgJ2xhdGV4X3JhdycsICdsYXRleF9ib29rdGFicycsICdsYXRleF9sb25ndGFibGUnIGFuZCB0c3YuCiAgICBWYXJpYWJsZSBgdGFidWxhdGVfZm9ybWF0c2Bjb250YWlucyB0aGUgbGlzdCBvZiBjdXJyZW50bHkgc3VwcG9ydGVkIGZvcm1hdHMuCgogICAgInBsYWluIiBmb3JtYXQgZG9lc24ndCB1c2UgYW55IHBzZXVkb2dyYXBoaWNzIHRvIGRyYXcgdGFibGVzLAogICAgaXQgc2VwYXJhdGVzIGNvbHVtbnMgd2l0aCBhIGRvdWJsZSBzcGFjZToKCiAgICA+Pj4gcHJpbnQodGFidWxhdGUoW1sic3BhbSIsIDQxLjk5OTldLCBbImVnZ3MiLCAiNDUxLjAiXV0sCiAgICAuLi4gICAgICAgICAgICAgICAgIFsic3RyaW5ncyIsICJudW1iZXJzIl0sICJwbGFpbiIpKQogICAgc3RyaW5ncyAgICAgIG51bWJlcnMKICAgIHNwYW0gICAgICAgICA0MS45OTk5CiAgICBlZ2dzICAgICAgICA0NTEKCiAgICA+Pj4gcHJpbnQodGFidWxhdGUoW1sic3BhbSIsIDQxLjk5OTldLCBbImVnZ3MiLCAiNDUxLjAiXV0sIHRhYmxlZm10PSJwbGFpbiIpKQogICAgc3BhbSAgIDQxLjk5OTkKICAgIGVnZ3MgIDQ1MQoKICAgICJzaW1wbGUiIGZvcm1hdCBpcyBsaWtlIFBhbmRvYyBzaW1wbGVfdGFibGVzOgoKICAgID4+PiBwcmludCh0YWJ1bGF0ZShbWyJzcGFtIiwgNDEuOTk5OV0sIFsiZWdncyIsICI0NTEuMCJdXSwKICAgIC4uLiAgICAgICAgICAgICAgICAgWyJzdHJpbmdzIiwgIm51bWJlcnMiXSwgInNpbXBsZSIpKQogICAgc3RyaW5ncyAgICAgIG51bWJlcnMKICAgIC0tLS0tLS0tLSAgLS0tLS0tLS0tCiAgICBzcGFtICAgICAgICAgNDEuOTk5OQogICAgZWdncyAgICAgICAgNDUxCgogICAgPj4+IHByaW50KHRhYnVsYXRlKFtbInNwYW0iLCA0MS45OTk5XSwgWyJlZ2dzIiwgIjQ1MS4wIl1dLCB0YWJsZWZtdD0ic2ltcGxlIikpCiAgICAtLS0tICAtLS0tLS0tLQogICAgc3BhbSAgIDQxLjk5OTkKICAgIGVnZ3MgIDQ1MQogICAgLS0tLSAgLS0tLS0tLS0KCiAgICAiZ3JpZCIgaXMgc2ltaWxhciB0byB0YWJsZXMgcHJvZHVjZWQgYnkgRW1hY3MgdGFibGUuZWwgcGFja2FnZSBvcgogICAgUGFuZG9jIGdyaWRfdGFibGVzOgoKICAgID4+PiBwcmludCh0YWJ1bGF0ZShbWyJzcGFtIiwgNDEuOTk5OV0sIFsiZWdncyIsICI0NTEuMCJdXSwKICAgIC4uLiAgICAgICAgICAgICAgICBbInN0cmluZ3MiLCAibnVtYmVycyJdLCAiZ3JpZCIpKQogICAgKy0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tKwogICAgfCBzdHJpbmdzICAgfCAgIG51bWJlcnMgfAogICAgKz09PT09PT09PT09Kz09PT09PT09PT09KwogICAgfCBzcGFtICAgICAgfCAgIDQxLjk5OTkgfAogICAgKy0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tKwogICAgfCBlZ2dzICAgICAgfCAgNDUxICAgICAgfAogICAgKy0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tKwoKICAgID4+PiBwcmludCh0YWJ1bGF0ZShbWyJzcGFtIiwgNDEuOTk5OV0sIFsiZWdncyIsICI0NTEuMCJdXSwgdGFibGVmbXQ9ImdyaWQiKSkKICAgICstLS0tLS0rLS0tLS0tLS0tLSsKICAgIHwgc3BhbSB8ICA0MS45OTk5IHwKICAgICstLS0tLS0rLS0tLS0tLS0tLSsKICAgIHwgZWdncyB8IDQ1MSAgICAgIHwKICAgICstLS0tLS0rLS0tLS0tLS0tLSsKCiAgICAic2ltcGxlX2dyaWQiIGRyYXdzIGEgZ3JpZCB1c2luZyBzaW5nbGUtbGluZSBib3gtZHJhd2luZwogICAgY2hhcmFjdGVyczoKCiAgICA+Pj4gcHJpbnQodGFidWxhdGUoW1sic3BhbSIsIDQxLjk5OTldLCBbImVnZ3MiLCAiNDUxLjAiXV0sCiAgICAuLi4gICAgICAgICAgICAgICAgWyJzdHJpbmdzIiwgIm51bWJlcnMiXSwgInNpbXBsZV9ncmlkIikpCiAgICDilIzilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilKzilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilJAKICAgIOKUgiBzdHJpbmdzICAg4pSCICAgbnVtYmVycyDilIIKICAgIOKUnOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUvOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUpAogICAg4pSCIHNwYW0gICAgICDilIIgICA0MS45OTk5IOKUggogICAg4pSc4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pS84pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSkCiAgICDilIIgZWdncyAgICAgIOKUgiAgNDUxICAgICAg4pSCCiAgICDilJTilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilLTilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilJgKCiAgICAicm91bmRlZF9ncmlkIiBkcmF3cyBhIGdyaWQgdXNpbmcgc2luZ2xlLWxpbmUgYm94LWRyYXdpbmcKICAgIGNoYXJhY3RlcnMgd2l0aCByb3VuZGVkIGNvcm5lcnM6CgogICAgPj4+IHByaW50KHRhYnVsYXRlKFtbInNwYW0iLCA0MS45OTk5XSwgWyJlZ2dzIiwgIjQ1MS4wIl1dLAogICAgLi4uICAgICAgICAgICAgICAgIFsic3RyaW5ncyIsICJudW1iZXJzIl0sICJyb3VuZGVkX2dyaWQiKSkKICAgIOKVreKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUrOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKVrgogICAg4pSCIHN0cmluZ3MgICDilIIgICBudW1iZXJzIOKUggogICAg4pSc4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pS84pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSkCiAgICDilIIgc3BhbSAgICAgIOKUgiAgIDQxLjk5OTkg4pSCCiAgICDilJzilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilLzilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilKQKICAgIOKUgiBlZ2dzICAgICAg4pSCICA0NTEgICAgICDilIIKICAgIOKVsOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUtOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKVrwoKICAgICJoZWF2eV9ncmlkIiBkcmF3cyBhIGdyaWQgdXNpbmcgYm9sZCAodGhpY2spIHNpbmdsZS1saW5lIGJveC1kcmF3aW5nCiAgICBjaGFyYWN0ZXJzOgoKICAgID4+PiBwcmludCh0YWJ1bGF0ZShbWyJzcGFtIiwgNDEuOTk5OV0sIFsiZWdncyIsICI0NTEuMCJdXSwKICAgIC4uLiAgICAgICAgICAgICAgICBbInN0cmluZ3MiLCAibnVtYmVycyJdLCAiaGVhdnlfZ3JpZCIpKQogICAg4pSP4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSz4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSTCiAgICDilIMgc3RyaW5ncyAgIOKUgyAgIG51bWJlcnMg4pSDCiAgICDilKPilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilYvilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilKsKICAgIOKUgyBzcGFtICAgICAg4pSDICAgNDEuOTk5OSDilIMKICAgIOKUo+KUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKVi+KUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUqwogICAg4pSDIGVnZ3MgICAgICDilIMgIDQ1MSAgICAgIOKUgwogICAg4pSX4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pS74pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSbCgogICAgIm1peGVkX2dyaWQiIGRyYXdzIGEgZ3JpZCB1c2luZyBhIG1peCBvZiBsaWdodCAodGhpbikgYW5kIGhlYXZ5ICh0aGljaykgbGluZXMKICAgIGJveC1kcmF3aW5nIGNoYXJhY3RlcnM6CgogICAgPj4+IHByaW50KHRhYnVsYXRlKFtbInNwYW0iLCA0MS45OTk5XSwgWyJlZ2dzIiwgIjQ1MS4wIl1dLAogICAgLi4uICAgICAgICAgICAgICAgIFsic3RyaW5ncyIsICJudW1iZXJzIl0sICJtaXhlZF9ncmlkIikpCiAgICDilI3ilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilK/ilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilJEKICAgIOKUgiBzdHJpbmdzICAg4pSCICAgbnVtYmVycyDilIIKICAgIOKUneKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUv+KUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUpQogICAg4pSCIHNwYW0gICAgICDilIIgICA0MS45OTk5IOKUggogICAg4pSc4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pS84pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSkCiAgICDilIIgZWdncyAgICAgIOKUgiAgNDUxICAgICAg4pSCCiAgICDilJXilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilLfilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilJkKCiAgICAiZG91YmxlX2dyaWQiIGRyYXdzIGEgZ3JpZCB1c2luZyBkb3VibGUtbGluZSBib3gtZHJhd2luZwogICAgY2hhcmFjdGVyczoKCiAgICA+Pj4gcHJpbnQodGFidWxhdGUoW1sic3BhbSIsIDQxLjk5OTldLCBbImVnZ3MiLCAiNDUxLjAiXV0sCiAgICAuLi4gICAgICAgICAgICAgICAgWyJzdHJpbmdzIiwgIm51bWJlcnMiXSwgImRvdWJsZV9ncmlkIikpCiAgICDilZTilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilabilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZcKICAgIOKVkSBzdHJpbmdzICAg4pWRICAgbnVtYmVycyDilZEKICAgIOKVoOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVrOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVowogICAg4pWRIHNwYW0gICAgICDilZEgICA0MS45OTk5IOKVkQogICAg4pWg4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWs4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWjCiAgICDilZEgZWdncyAgICAgIOKVkSAgNDUxICAgICAg4pWRCiAgICDilZrilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilanilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZ0KCiAgICAiZmFuY3lfZ3JpZCIgZHJhd3MgYSBncmlkIHVzaW5nIGEgbWl4IG9mIHNpbmdsZSBhbmQKICAgIGRvdWJsZS1saW5lIGJveC1kcmF3aW5nIGNoYXJhY3RlcnM6CgogICAgPj4+IHByaW50KHRhYnVsYXRlKFtbInNwYW0iLCA0MS45OTk5XSwgWyJlZ2dzIiwgIjQ1MS4wIl1dLAogICAgLi4uICAgICAgICAgICAgICAgIFsic3RyaW5ncyIsICJudW1iZXJzIl0sICJmYW5jeV9ncmlkIikpCiAgICDilZLilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilaTilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZUKICAgIOKUgiBzdHJpbmdzICAg4pSCICAgbnVtYmVycyDilIIKICAgIOKVnuKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVquKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVoQogICAg4pSCIHNwYW0gICAgICDilIIgICA0MS45OTk5IOKUggogICAg4pSc4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pS84pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSkCiAgICDilIIgZWdncyAgICAgIOKUgiAgNDUxICAgICAg4pSCCiAgICDilZjilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilafilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZsKCiAgICAib3V0bGluZSIgaXMgdGhlIHNhbWUgYXMgdGhlICJncmlkIiBmb3JtYXQgYnV0IGRvZXNuJ3QgZHJhdyBsaW5lcyBiZXR3ZWVuIHJvd3M6CgogICAgPj4+IHByaW50KHRhYnVsYXRlKFtbInNwYW0iLCA0MS45OTk5XSwgWyJlZ2dzIiwgIjQ1MS4wIl1dLAogICAgLi4uICAgICAgICAgICAgICAgIFsic3RyaW5ncyIsICJudW1iZXJzIl0sICJvdXRsaW5lIikpCiAgICArLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0rCiAgICB8IHN0cmluZ3MgICB8ICAgbnVtYmVycyB8CiAgICArPT09PT09PT09PT0rPT09PT09PT09PT0rCiAgICB8IHNwYW0gICAgICB8ICAgNDEuOTk5OSB8CiAgICB8IGVnZ3MgICAgICB8ICA0NTEgICAgICB8CiAgICArLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0rCgogICAgPj4+IHByaW50KHRhYnVsYXRlKFtbInNwYW0iLCA0MS45OTk5XSwgWyJlZ2dzIiwgIjQ1MS4wIl1dLCB0YWJsZWZtdD0ib3V0bGluZSIpKQogICAgKy0tLS0tLSstLS0tLS0tLS0tKwogICAgfCBzcGFtIHwgIDQxLjk5OTkgfAogICAgfCBlZ2dzIHwgNDUxICAgICAgfAogICAgKy0tLS0tLSstLS0tLS0tLS0tKwoKICAgICJzaW1wbGVfb3V0bGluZSIgaXMgdGhlIHNhbWUgYXMgdGhlICJzaW1wbGVfZ3JpZCIgZm9ybWF0IGJ1dCBkb2Vzbid0IGRyYXcgbGluZXMgYmV0d2VlbiByb3dzOgoKICAgID4+PiBwcmludCh0YWJ1bGF0ZShbWyJzcGFtIiwgNDEuOTk5OV0sIFsiZWdncyIsICI0NTEuMCJdXSwKICAgIC4uLiAgICAgICAgICAgICAgICBbInN0cmluZ3MiLCAibnVtYmVycyJdLCAic2ltcGxlX291dGxpbmUiKSkKICAgIOKUjOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUrOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUkAogICAg4pSCIHN0cmluZ3MgICDilIIgICBudW1iZXJzIOKUggogICAg4pSc4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pS84pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSkCiAgICDilIIgc3BhbSAgICAgIOKUgiAgIDQxLjk5OTkg4pSCCiAgICDilIIgZWdncyAgICAgIOKUgiAgNDUxICAgICAg4pSCCiAgICDilJTilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilLTilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilJgKCiAgICAicm91bmRlZF9vdXRsaW5lIiBpcyB0aGUgc2FtZSBhcyB0aGUgInJvdW5kZWRfZ3JpZCIgZm9ybWF0IGJ1dCBkb2Vzbid0IGRyYXcgbGluZXMgYmV0d2VlbiByb3dzOgoKICAgID4+PiBwcmludCh0YWJ1bGF0ZShbWyJzcGFtIiwgNDEuOTk5OV0sIFsiZWdncyIsICI0NTEuMCJdXSwKICAgIC4uLiAgICAgICAgICAgICAgICBbInN0cmluZ3MiLCAibnVtYmVycyJdLCAicm91bmRlZF9vdXRsaW5lIikpCiAgICDila3ilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilKzilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDila4KICAgIOKUgiBzdHJpbmdzICAg4pSCICAgbnVtYmVycyDilIIKICAgIOKUnOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUvOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUpAogICAg4pSCIHNwYW0gICAgICDilIIgICA0MS45OTk5IOKUggogICAg4pSCIGVnZ3MgICAgICDilIIgIDQ1MSAgICAgIOKUggogICAg4pWw4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pS04pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pWvCgogICAgImhlYXZ5X291dGxpbmUiIGlzIHRoZSBzYW1lIGFzIHRoZSAiaGVhdnlfZ3JpZCIgZm9ybWF0IGJ1dCBkb2Vzbid0IGRyYXcgbGluZXMgYmV0d2VlbiByb3dzOgoKICAgID4+PiBwcmludCh0YWJ1bGF0ZShbWyJzcGFtIiwgNDEuOTk5OV0sIFsiZWdncyIsICI0NTEuMCJdXSwKICAgIC4uLiAgICAgICAgICAgICAgICBbInN0cmluZ3MiLCAibnVtYmVycyJdLCAiaGVhdnlfb3V0bGluZSIpKQogICAg4pSP4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSz4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSTCiAgICDilIMgc3RyaW5ncyAgIOKUgyAgIG51bWJlcnMg4pSDCiAgICDilKPilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilYvilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilKsKICAgIOKUgyBzcGFtICAgICAg4pSDICAgNDEuOTk5OSDilIMKICAgIOKUgyBlZ2dzICAgICAg4pSDICA0NTEgICAgICDilIMKICAgIOKUl+KUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUu+KUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUmwoKICAgICJtaXhlZF9vdXRsaW5lIiBpcyB0aGUgc2FtZSBhcyB0aGUgIm1peGVkX2dyaWQiIGZvcm1hdCBidXQgZG9lc24ndCBkcmF3IGxpbmVzIGJldHdlZW4gcm93czoKCiAgICA+Pj4gcHJpbnQodGFidWxhdGUoW1sic3BhbSIsIDQxLjk5OTldLCBbImVnZ3MiLCAiNDUxLjAiXV0sCiAgICAuLi4gICAgICAgICAgICAgICAgWyJzdHJpbmdzIiwgIm51bWJlcnMiXSwgIm1peGVkX291dGxpbmUiKSkKICAgIOKUjeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUr+KUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUkQogICAg4pSCIHN0cmluZ3MgICDilIIgICBudW1iZXJzIOKUggogICAg4pSd4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pS/4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSlCiAgICDilIIgc3BhbSAgICAgIOKUgiAgIDQxLjk5OTkg4pSCCiAgICDilIIgZWdncyAgICAgIOKUgiAgNDUxICAgICAg4pSCCiAgICDilJXilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilLfilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilJkKCiAgICAiZG91YmxlX291dGxpbmUiIGlzIHRoZSBzYW1lIGFzIHRoZSAiZG91YmxlX2dyaWQiIGZvcm1hdCBidXQgZG9lc24ndCBkcmF3IGxpbmVzIGJldHdlZW4gcm93czoKCiAgICA+Pj4gcHJpbnQodGFidWxhdGUoW1sic3BhbSIsIDQxLjk5OTldLCBbImVnZ3MiLCAiNDUxLjAiXV0sCiAgICAuLi4gICAgICAgICAgICAgICAgWyJzdHJpbmdzIiwgIm51bWJlcnMiXSwgImRvdWJsZV9vdXRsaW5lIikpCiAgICDilZTilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilabilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZcKICAgIOKVkSBzdHJpbmdzICAg4pWRICAgbnVtYmVycyDilZEKICAgIOKVoOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVrOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVowogICAg4pWRIHNwYW0gICAgICDilZEgICA0MS45OTk5IOKVkQogICAg4pWRIGVnZ3MgICAgICDilZEgIDQ1MSAgICAgIOKVkQogICAg4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWp4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWdCgogICAgImZhbmN5X291dGxpbmUiIGlzIHRoZSBzYW1lIGFzIHRoZSAiZmFuY3lfZ3JpZCIgZm9ybWF0IGJ1dCBkb2Vzbid0IGRyYXcgbGluZXMgYmV0d2VlbiByb3dzOgoKICAgID4+PiBwcmludCh0YWJ1bGF0ZShbWyJzcGFtIiwgNDEuOTk5OV0sIFsiZWdncyIsICI0NTEuMCJdXSwKICAgIC4uLiAgICAgICAgICAgICAgICBbInN0cmluZ3MiLCAibnVtYmVycyJdLCAiZmFuY3lfb3V0bGluZSIpKQogICAg4pWS4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWk4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWVCiAgICDilIIgc3RyaW5ncyAgIOKUgiAgIG51bWJlcnMg4pSCCiAgICDilZ7ilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilarilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilaEKICAgIOKUgiBzcGFtICAgICAg4pSCICAgNDEuOTk5OSDilIIKICAgIOKUgiBlZ2dzICAgICAg4pSCICA0NTEgICAgICDilIIKICAgIOKVmOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVp+KVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVmwoKICAgICJwaXBlIiBpcyBsaWtlIHRhYmxlcyBpbiBQSFAgTWFya2Rvd24gRXh0cmEgZXh0ZW5zaW9uIG9yIFBhbmRvYwogICAgcGlwZV90YWJsZXM6CgogICAgPj4+IHByaW50KHRhYnVsYXRlKFtbInNwYW0iLCA0MS45OTk5XSwgWyJlZ2dzIiwgIjQ1MS4wIl1dLAogICAgLi4uICAgICAgICAgICAgICAgIFsic3RyaW5ncyIsICJudW1iZXJzIl0sICJwaXBlIikpCiAgICB8IHN0cmluZ3MgICB8ICAgbnVtYmVycyB8CiAgICB8Oi0tLS0tLS0tLS18LS0tLS0tLS0tLTp8CiAgICB8IHNwYW0gICAgICB8ICAgNDEuOTk5OSB8CiAgICB8IGVnZ3MgICAgICB8ICA0NTEgICAgICB8CgogICAgInByZXN0byIgaXMgbGlrZSB0YWJsZXMgcHJvZHVjZSBieSB0aGUgUHJlc3RvIENMSToKCiAgICA+Pj4gcHJpbnQodGFidWxhdGUoW1sic3BhbSIsIDQxLjk5OTldLCBbImVnZ3MiLCAiNDUxLjAiXV0sCiAgICAuLi4gICAgICAgICAgICAgICAgWyJzdHJpbmdzIiwgIm51bWJlcnMiXSwgInByZXN0byIpKQogICAgIHN0cmluZ3MgICB8ICAgbnVtYmVycwogICAgLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0KICAgICBzcGFtICAgICAgfCAgIDQxLjk5OTkKICAgICBlZ2dzICAgICAgfCAgNDUxCgogICAgPj4+IHByaW50KHRhYnVsYXRlKFtbInNwYW0iLCA0MS45OTk5XSwgWyJlZ2dzIiwgIjQ1MS4wIl1dLCB0YWJsZWZtdD0icGlwZSIpKQogICAgfDotLS0tLXwtLS0tLS0tLS06fAogICAgfCBzcGFtIHwgIDQxLjk5OTkgfAogICAgfCBlZ2dzIHwgNDUxICAgICAgfAoKICAgICJvcmd0YmwiIGlzIGxpa2UgdGFibGVzIGluIEVtYWNzIG9yZy1tb2RlIGFuZCBvcmd0YmwtbW9kZS4gVGhleQogICAgYXJlIHNsaWdodGx5IGRpZmZlcmVudCBmcm9tICJwaXBlIiBmb3JtYXQgYnkgbm90IHVzaW5nIGNvbG9ucyB0bwogICAgZGVmaW5lIGNvbHVtbiBhbGlnbm1lbnQsIGFuZCB1c2luZyBhICIrIiBzaWduIHRvIGluZGljYXRlIGxpbmUKICAgIGludGVyc2VjdGlvbnM6CgogICAgPj4+IHByaW50KHRhYnVsYXRlKFtbInNwYW0iLCA0MS45OTk5XSwgWyJlZ2dzIiwgIjQ1MS4wIl1dLAogICAgLi4uICAgICAgICAgICAgICAgIFsic3RyaW5ncyIsICJudW1iZXJzIl0sICJvcmd0YmwiKSkKICAgIHwgc3RyaW5ncyAgIHwgICBudW1iZXJzIHwKICAgIHwtLS0tLS0tLS0tLSstLS0tLS0tLS0tLXwKICAgIHwgc3BhbSAgICAgIHwgICA0MS45OTk5IHwKICAgIHwgZWdncyAgICAgIHwgIDQ1MSAgICAgIHwKCgogICAgPj4+IHByaW50KHRhYnVsYXRlKFtbInNwYW0iLCA0MS45OTk5XSwgWyJlZ2dzIiwgIjQ1MS4wIl1dLCB0YWJsZWZtdD0ib3JndGJsIikpCiAgICB8IHNwYW0gfCAgNDEuOTk5OSB8CiAgICB8IGVnZ3MgfCA0NTEgICAgICB8CgogICAgInJzdCIgaXMgbGlrZSBhIHNpbXBsZSB0YWJsZSBmb3JtYXQgZnJvbSByZVN0cnVjdHVyZWRUZXh0OyBwbGVhc2UKICAgIG5vdGUgdGhhdCByZVN0cnVjdHVyZWRUZXh0IGFjY2VwdHMgYWxzbyAiZ3JpZCIgdGFibGVzOgoKICAgID4+PiBwcmludCh0YWJ1bGF0ZShbWyJzcGFtIiwgNDEuOTk5OV0sIFsiZWdncyIsICI0NTEuMCJdXSwKICAgIC4uLiAgICAgICAgICAgICAgICBbInN0cmluZ3MiLCAibnVtYmVycyJdLCAicnN0IikpCiAgICA9PT09PT09PT0gID09PT09PT09PQogICAgc3RyaW5ncyAgICAgIG51bWJlcnMKICAgID09PT09PT09PSAgPT09PT09PT09CiAgICBzcGFtICAgICAgICAgNDEuOTk5OQogICAgZWdncyAgICAgICAgNDUxCiAgICA9PT09PT09PT0gID09PT09PT09PQoKICAgID4+PiBwcmludCh0YWJ1bGF0ZShbWyJzcGFtIiwgNDEuOTk5OV0sIFsiZWdncyIsICI0NTEuMCJdXSwgdGFibGVmbXQ9InJzdCIpKQogICAgPT09PSAgPT09PT09PT0KICAgIHNwYW0gICA0MS45OTk5CiAgICBlZ2dzICA0NTEKICAgID09PT0gID09PT09PT09CgogICAgIm1lZGlhd2lraSIgcHJvZHVjZXMgYSB0YWJsZSBtYXJrdXAgdXNlZCBpbiBXaWtpcGVkaWEgYW5kIG9uIG90aGVyCiAgICBNZWRpYVdpa2ktYmFzZWQgc2l0ZXM6CgogICAgPj4+IHByaW50KHRhYnVsYXRlKFtbInN0cmluZ3MiLCAibnVtYmVycyJdLCBbInNwYW0iLCA0MS45OTk5XSwgWyJlZ2dzIiwgIjQ1MS4wIl1dLAogICAgLi4uICAgICAgICAgICAgICAgIGhlYWRlcnM9ImZpcnN0cm93IiwgdGFibGVmbXQ9Im1lZGlhd2lraSIpKQogICAge3wgY2xhc3M9Indpa2l0YWJsZSIgc3R5bGU9InRleHQtYWxpZ246IGxlZnQ7IgogICAgfCsgPCEtLSBjYXB0aW9uIC0tPgogICAgfC0KICAgICEgc3RyaW5ncyAgICEhIGFsaWduPSJyaWdodCJ8ICAgbnVtYmVycwogICAgfC0KICAgIHwgc3BhbSAgICAgIHx8IGFsaWduPSJyaWdodCJ8ICAgNDEuOTk5OQogICAgfC0KICAgIHwgZWdncyAgICAgIHx8IGFsaWduPSJyaWdodCJ8ICA0NTEKICAgIHx9CgogICAgImh0bWwiIHByb2R1Y2VzIEhUTUwgbWFya3VwIGFzIGFuIGh0bWwuZXNjYXBlJ2Qgc3RyCiAgICB3aXRoIGEgLl9yZXByX2h0bWxfIG1ldGhvZCBzbyB0aGF0IEp1cHl0ZXIgTGFiIGFuZCBOb3RlYm9vayBkaXNwbGF5IHRoZSBIVE1MCiAgICBhbmQgYSAuc3RyIHByb3BlcnR5IHNvIHRoYXQgdGhlIHJhdyBIVE1MIHJlbWFpbnMgYWNjZXNzaWJsZQogICAgdGhlIHVuc2FmZWh0bWwgdGFibGUgZm9ybWF0IGNhbiBiZSB1c2VkIGlmIGFuIHVuZXNjYXBlZCBIVE1MIGZvcm1hdCBpcyByZXF1aXJlZDoKCiAgICA+Pj4gcHJpbnQodGFidWxhdGUoW1sic3RyaW5ncyIsICJudW1iZXJzIl0sIFsic3BhbSIsIDQxLjk5OTldLCBbImVnZ3MiLCAiNDUxLjAiXV0sCiAgICAuLi4gICAgICAgICAgICAgICAgaGVhZGVycz0iZmlyc3Ryb3ciLCB0YWJsZWZtdD0iaHRtbCIpKQogICAgPHRhYmxlPgogICAgPHRoZWFkPgogICAgPHRyPjx0aD5zdHJpbmdzICA8L3RoPjx0aCBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7Ij4gIG51bWJlcnM8L3RoPjwvdHI+CiAgICA8L3RoZWFkPgogICAgPHRib2R5PgogICAgPHRyPjx0ZD5zcGFtICAgICA8L3RkPjx0ZCBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7Ij4gIDQxLjk5OTk8L3RkPjwvdHI+CiAgICA8dHI+PHRkPmVnZ3MgICAgIDwvdGQ+PHRkIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsiPiA0NTEgICAgIDwvdGQ+PC90cj4KICAgIDwvdGJvZHk+CiAgICA8L3RhYmxlPgoKICAgICJsYXRleCIgcHJvZHVjZXMgYSB0YWJ1bGFyIGVudmlyb25tZW50IG9mIExhVGVYIGRvY3VtZW50IG1hcmt1cDoKCiAgICA+Pj4gcHJpbnQodGFidWxhdGUoW1sic3BhbSIsIDQxLjk5OTldLCBbImVnZ3MiLCAiNDUxLjAiXV0sIHRhYmxlZm10PSJsYXRleCIpKQogICAgXFxiZWdpbnt0YWJ1bGFyfXtscn0KICAgIFxcaGxpbmUKICAgICBzcGFtICYgIDQxLjk5OTkgXFxcXAogICAgIGVnZ3MgJiA0NTEgICAgICBcXFxcCiAgICBcXGhsaW5lCiAgICBcXGVuZHt0YWJ1bGFyfQoKICAgICJsYXRleF9yYXciIGlzIHNpbWlsYXIgdG8gImxhdGV4IiwgYnV0IGRvZXNuJ3QgZXNjYXBlIHNwZWNpYWwgY2hhcmFjdGVycywKICAgIHN1Y2ggYXMgYmFja3NsYXNoIGFuZCB1bmRlcnNjb3JlLCBzbyBMYVRlWCBjb21tYW5kcyBtYXkgZW1iZWRkZWQgaW50bwogICAgY2VsbHMnIHZhbHVlczoKCiAgICA+Pj4gcHJpbnQodGFidWxhdGUoW1sic3BhbSRfOSQiLCA0MS45OTk5XSwgWyJcXFxcZW1waHtlZ2dzfSIsICI0NTEuMCJdXSwgdGFibGVmbXQ9ImxhdGV4X3JhdyIpKQogICAgXFxiZWdpbnt0YWJ1bGFyfXtscn0KICAgIFxcaGxpbmUKICAgICBzcGFtJF85JCAgICAmICA0MS45OTk5IFxcXFwKICAgICBcXGVtcGh7ZWdnc30gJiA0NTEgICAgICBcXFxcCiAgICBcXGhsaW5lCiAgICBcXGVuZHt0YWJ1bGFyfQoKICAgICJsYXRleF9ib29rdGFicyIgcHJvZHVjZXMgYSB0YWJ1bGFyIGVudmlyb25tZW50IG9mIExhVGVYIGRvY3VtZW50IG1hcmt1cAogICAgdXNpbmcgdGhlIGJvb2t0YWJzLnN0eSBwYWNrYWdlOgoKICAgID4+PiBwcmludCh0YWJ1bGF0ZShbWyJzcGFtIiwgNDEuOTk5OV0sIFsiZWdncyIsICI0NTEuMCJdXSwgdGFibGVmbXQ9ImxhdGV4X2Jvb2t0YWJzIikpCiAgICBcXGJlZ2lue3RhYnVsYXJ9e2xyfQogICAgXFx0b3BydWxlCiAgICAgc3BhbSAmICA0MS45OTk5IFxcXFwKICAgICBlZ2dzICYgNDUxICAgICAgXFxcXAogICAgXFxib3R0b21ydWxlCiAgICBcXGVuZHt0YWJ1bGFyfQoKICAgICJsYXRleF9sb25ndGFibGUiIHByb2R1Y2VzIGEgdGFidWxhciBlbnZpcm9ubWVudCB0aGF0IGNhbiBzdHJldGNoIGFsb25nCiAgICBtdWx0aXBsZSBwYWdlcywgdXNpbmcgdGhlIGxvbmd0YWJsZSBwYWNrYWdlIGZvciBMYVRlWC4KCiAgICA+Pj4gcHJpbnQodGFidWxhdGUoW1sic3BhbSIsIDQxLjk5OTldLCBbImVnZ3MiLCAiNDUxLjAiXV0sIHRhYmxlZm10PSJsYXRleF9sb25ndGFibGUiKSkKICAgIFxcYmVnaW57bG9uZ3RhYmxlfXtscn0KICAgIFxcaGxpbmUKICAgICBzcGFtICYgIDQxLjk5OTkgXFxcXAogICAgIGVnZ3MgJiA0NTEgICAgICBcXFxcCiAgICBcXGhsaW5lCiAgICBcXGVuZHtsb25ndGFibGV9CgoKICAgIE51bWJlciBwYXJzaW5nCiAgICAtLS0tLS0tLS0tLS0tLQogICAgQnkgZGVmYXVsdCwgYW55dGhpbmcgd2hpY2ggY2FuIGJlIHBhcnNlZCBhcyBhIG51bWJlciBpcyBhIG51bWJlci4KICAgIFRoaXMgZW5zdXJlcyBudW1iZXJzIHJlcHJlc2VudGVkIGFzIHN0cmluZ3MgYXJlIGFsaWduZWQgcHJvcGVybHkuCiAgICBUaGlzIGNhbiBsZWFkIHRvIHdlaXJkIHJlc3VsdHMgZm9yIHBhcnRpY3VsYXIgc3RyaW5ncyBzdWNoIGFzCiAgICBzcGVjaWZpYyBnaXQgU0hBcyBlLmcuICI0Mjk5MmUxIiB3aWxsIGJlIHBhcnNlZCBpbnRvIHRoZSBudW1iZXIKICAgIDQyOTkyMCBhbmQgYWxpZ25lZCBhcyBzdWNoLgoKICAgIFRvIGNvbXBsZXRlbHkgZGlzYWJsZSBudW1iZXIgcGFyc2luZyAoYW5kIGFsaWdubWVudCksIHVzZQogICAgYGRpc2FibGVfbnVtcGFyc2U9VHJ1ZWAuIEZvciBtb3JlIGZpbmUgZ3JhaW5lZCBjb250cm9sLCBhIGxpc3QgY29sdW1uCiAgICBpbmRpY2VzIGlzIHVzZWQgdG8gZGlzYWJsZSBudW1iZXIgcGFyc2luZyBvbmx5IG9uIHRob3NlIGNvbHVtbnMKICAgIGUuZy4gYGRpc2FibGVfbnVtcGFyc2U9WzAsIDJdYCB3b3VsZCBkaXNhYmxlIG51bWJlciBwYXJzaW5nIG9ubHkgb24gdGhlCiAgICBmaXJzdCBhbmQgdGhpcmQgY29sdW1ucy4KCiAgICBDb2x1bW4gV2lkdGhzIGFuZCBBdXRvIExpbmUgV3JhcHBpbmcKICAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgVGFidWxhdGUgd2lsbCwgYnkgZGVmYXVsdCwgc2V0IHRoZSB3aWR0aCBvZiBlYWNoIGNvbHVtbiB0byB0aGUgbGVuZ3RoIG9mIHRoZQogICAgbG9uZ2VzdCBlbGVtZW50IGluIHRoYXQgY29sdW1uLiBIb3dldmVyLCBpbiBzaXR1YXRpb25zIHdoZXJlIGZpZWxkcyBhcmUgZXhwZWN0ZWQKICAgIHRvIHJlYXNvbmFibHkgYmUgdG9vIGxvbmcgdG8gbG9vayBnb29kIGFzIGEgc2luZ2xlIGxpbmUsIHRhYnVsYXRlIGNhbiBoZWxwIGF1dG9tYXRlCiAgICB3b3JkIHdyYXBwaW5nIGxvbmcgZmllbGRzIGZvciB5b3UuIFVzZSB0aGUgcGFyYW1ldGVyIGBtYXhjb2x3aWR0aGAgdG8gcHJvdmlkZSBhCiAgICBsaXN0IG9mIG1heGltYWwgY29sdW1uIHdpZHRocwoKICAgID4+PiBwcmludCh0YWJ1bGF0ZSggXAogICAgICAgICAgWygnMScsICdKb2huIFNtaXRoJywgXAogICAgICAgICAgICAnVGhpcyBpcyBhIHJhdGhlciBsb25nIGRlc2NyaXB0aW9uIHRoYXQgbWlnaHQgbG9vayBiZXR0ZXIgaWYgaXQgaXMgd3JhcHBlZCBhIGJpdCcpXSwgXAogICAgICAgICAgaGVhZGVycz0oIklzc3VlIElkIiwgIkF1dGhvciIsICJEZXNjcmlwdGlvbiIpLCBcCiAgICAgICAgICBtYXhjb2x3aWR0aHM9W05vbmUsIE5vbmUsIDMwXSwgXAogICAgICAgICAgdGFibGVmbXQ9ImdyaWQiICBcCiAgICAgICAgKSkKICAgICstLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rCiAgICB8ICAgSXNzdWUgSWQgfCBBdXRob3IgICAgIHwgRGVzY3JpcHRpb24gICAgICAgICAgICAgICAgICAgfAogICAgKz09PT09PT09PT09PSs9PT09PT09PT09PT0rPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSsKICAgIHwgICAgICAgICAgMSB8IEpvaG4gU21pdGggfCBUaGlzIGlzIGEgcmF0aGVyIGxvbmcgICAgICAgICB8CiAgICB8ICAgICAgICAgICAgfCAgICAgICAgICAgIHwgZGVzY3JpcHRpb24gdGhhdCBtaWdodCBsb29rICAgfAogICAgfCAgICAgICAgICAgIHwgICAgICAgICAgICB8IGJldHRlciBpZiBpdCBpcyB3cmFwcGVkIGEgYml0IHwKICAgICstLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rCgogICAgSGVhZGVyIGNvbHVtbiB3aWR0aCBjYW4gYmUgc3BlY2lmaWVkIGluIGEgc2ltaWxhciB3YXkgdXNpbmcgYG1heGhlYWRlcmNvbHdpZHRoYAoKICAgICIiIgoKICAgIGlmIHRhYnVsYXJfZGF0YSBpcyBOb25lOgogICAgICAgIHRhYnVsYXJfZGF0YSA9IFtdCgogICAgbGlzdF9vZl9saXN0cywgaGVhZGVycyA9IF9ub3JtYWxpemVfdGFidWxhcl9kYXRhKAogICAgICAgIHRhYnVsYXJfZGF0YSwgaGVhZGVycywgc2hvd2luZGV4PXNob3dpbmRleAogICAgKQogICAgbGlzdF9vZl9saXN0cywgc2VwYXJhdGluZ19saW5lcyA9IF9yZW1vdmVfc2VwYXJhdGluZ19saW5lcyhsaXN0X29mX2xpc3RzKQoKICAgIGlmIG1heGNvbHdpZHRocyBpcyBub3QgTm9uZToKICAgICAgICBudW1fY29scyA9IGxlbihsaXN0X29mX2xpc3RzWzBdKQogICAgICAgIGlmIGlzaW5zdGFuY2UobWF4Y29sd2lkdGhzLCBpbnQpOiAgIyBFeHBhbmQgc2NhbGFyIGZvciBhbGwgY29sdW1ucwogICAgICAgICAgICBtYXhjb2x3aWR0aHMgPSBfZXhwYW5kX2l0ZXJhYmxlKG1heGNvbHdpZHRocywgbnVtX2NvbHMsIG1heGNvbHdpZHRocykKICAgICAgICBlbHNlOiAgIyBJZ25vcmUgY29sIHdpZHRoIGZvciBhbnkgJ3RyYWlsaW5nJyBjb2x1bW5zCiAgICAgICAgICAgIG1heGNvbHdpZHRocyA9IF9leHBhbmRfaXRlcmFibGUobWF4Y29sd2lkdGhzLCBudW1fY29scywgTm9uZSkKCiAgICAgICAgbnVtcGFyc2VzID0gX2V4cGFuZF9udW1wYXJzZShkaXNhYmxlX251bXBhcnNlLCBudW1fY29scykKICAgICAgICBsaXN0X29mX2xpc3RzID0gX3dyYXBfdGV4dF90b19jb2x3aWR0aHMoCiAgICAgICAgICAgIGxpc3Rfb2ZfbGlzdHMsIG1heGNvbHdpZHRocywgbnVtcGFyc2VzPW51bXBhcnNlcwogICAgICAgICkKCiAgICBpZiBtYXhoZWFkZXJjb2x3aWR0aHMgaXMgbm90IE5vbmU6CiAgICAgICAgbnVtX2NvbHMgPSBsZW4obGlzdF9vZl9saXN0c1swXSkKICAgICAgICBpZiBpc2luc3RhbmNlKG1heGhlYWRlcmNvbHdpZHRocywgaW50KTogICMgRXhwYW5kIHNjYWxhciBmb3IgYWxsIGNvbHVtbnMKICAgICAgICAgICAgbWF4aGVhZGVyY29sd2lkdGhzID0gX2V4cGFuZF9pdGVyYWJsZSgKICAgICAgICAgICAgICAgIG1heGhlYWRlcmNvbHdpZHRocywgbnVtX2NvbHMsIG1heGhlYWRlcmNvbHdpZHRocwogICAgICAgICAgICApCiAgICAgICAgZWxzZTogICMgSWdub3JlIGNvbCB3aWR0aCBmb3IgYW55ICd0cmFpbGluZycgY29sdW1ucwogICAgICAgICAgICBtYXhoZWFkZXJjb2x3aWR0aHMgPSBfZXhwYW5kX2l0ZXJhYmxlKG1heGhlYWRlcmNvbHdpZHRocywgbnVtX2NvbHMsIE5vbmUpCgogICAgICAgIG51bXBhcnNlcyA9IF9leHBhbmRfbnVtcGFyc2UoZGlzYWJsZV9udW1wYXJzZSwgbnVtX2NvbHMpCiAgICAgICAgaGVhZGVycyA9IF93cmFwX3RleHRfdG9fY29sd2lkdGhzKAogICAgICAgICAgICBbaGVhZGVyc10sIG1heGhlYWRlcmNvbHdpZHRocywgbnVtcGFyc2VzPW51bXBhcnNlcwogICAgICAgIClbMF0KCiAgICAjIGVtcHR5IHZhbHVlcyBpbiB0aGUgZmlyc3QgY29sdW1uIG9mIFJTVCB0YWJsZXMgc2hvdWxkIGJlIGVzY2FwZWQgKGlzc3VlICM4MikKICAgICMgIiIgc2hvdWxkIGJlIGVzY2FwZWQgYXMgIlxcICIgb3IgIi4uIgogICAgaWYgdGFibGVmbXQgPT0gInJzdCI6CiAgICAgICAgbGlzdF9vZl9saXN0cywgaGVhZGVycyA9IF9yc3RfZXNjYXBlX2ZpcnN0X2NvbHVtbihsaXN0X29mX2xpc3RzLCBoZWFkZXJzKQoKICAgICMgUHJldHR5VGFibGUgZm9ybWF0dGluZyBkb2VzIG5vdCB1c2UgYW55IGV4dHJhIHBhZGRpbmcuCiAgICAjIE51bWJlcnMgYXJlIG5vdCBwYXJzZWQgYW5kIGFyZSB0cmVhdGVkIHRoZSBzYW1lIGFzIHN0cmluZ3MgZm9yIGFsaWdubWVudC4KICAgICMgQ2hlY2sgaWYgcHJldHR5IGlzIHRoZSBmb3JtYXQgYmVpbmcgdXNlZCBhbmQgb3ZlcnJpZGUgdGhlIGRlZmF1bHRzIHNvIGl0CiAgICAjIGRvZXMgbm90IGltcGFjdCBvdGhlciBmb3JtYXRzLgogICAgbWluX3BhZGRpbmcgPSBNSU5fUEFERElORwogICAgaWYgdGFibGVmbXQgPT0gInByZXR0eSI6CiAgICAgICAgbWluX3BhZGRpbmcgPSAwCiAgICAgICAgZGlzYWJsZV9udW1wYXJzZSA9IFRydWUKICAgICAgICBudW1hbGlnbiA9ICJjZW50ZXIiIGlmIG51bWFsaWduID09IF9ERUZBVUxUX0FMSUdOIGVsc2UgbnVtYWxpZ24KICAgICAgICBzdHJhbGlnbiA9ICJjZW50ZXIiIGlmIHN0cmFsaWduID09IF9ERUZBVUxUX0FMSUdOIGVsc2Ugc3RyYWxpZ24KICAgIGVsc2U6CiAgICAgICAgbnVtYWxpZ24gPSAiZGVjaW1hbCIgaWYgbnVtYWxpZ24gPT0gX0RFRkFVTFRfQUxJR04gZWxzZSBudW1hbGlnbgogICAgICAgIHN0cmFsaWduID0gImxlZnQiIGlmIHN0cmFsaWduID09IF9ERUZBVUxUX0FMSUdOIGVsc2Ugc3RyYWxpZ24KCiAgICAjIG9wdGltaXphdGlvbjogbG9vayBmb3IgQU5TSSBjb250cm9sIGNvZGVzIG9uY2UsCiAgICAjIGVuYWJsZSBzbWFydCB3aWR0aCBmdW5jdGlvbnMgb25seSBpZiBhIGNvbnRyb2wgY29kZSBpcyBmb3VuZAogICAgIwogICAgIyBjb252ZXJ0IHRoZSBoZWFkZXJzIGFuZCByb3dzIGludG8gYSBzaW5nbGUsIHRhYi1kZWxpbWl0ZWQgc3RyaW5nIGVuc3VyaW5nCiAgICAjIHRoYXQgYW55IGJ5dGVzdHJpbmdzIGFyZSBkZWNvZGVkIHNhZmVseSAoaS5lLiBlcnJvcnMgaWdub3JlZCkKICAgIHBsYWluX3RleHQgPSAiXHQiLmpvaW4oCiAgICAgICAgY2hhaW4oCiAgICAgICAgICAgICMgaGVhZGVycwogICAgICAgICAgICBtYXAoX3RvX3N0ciwgaGVhZGVycyksCiAgICAgICAgICAgICMgcm93czogY2hhaW4gdGhlIHJvd3MgdG9nZXRoZXIgaW50byBhIHNpbmdsZSBpdGVyYWJsZSBhZnRlciBtYXBwaW5nCiAgICAgICAgICAgICMgdGhlIGJ5dGVzdHJpbmcgY29udmVyc2lubyB0byBlYWNoIGNlbGwgdmFsdWUKICAgICAgICAgICAgY2hhaW4uZnJvbV9pdGVyYWJsZShtYXAoX3RvX3N0ciwgcm93KSBmb3Igcm93IGluIGxpc3Rfb2ZfbGlzdHMpLAogICAgICAgICkKICAgICkKCiAgICBoYXNfaW52aXNpYmxlID0gX2Fuc2lfY29kZXMuc2VhcmNoKHBsYWluX3RleHQpIGlzIG5vdCBOb25lCgogICAgZW5hYmxlX3dpZGVjaGFycyA9IHdjd2lkdGggaXMgbm90IE5vbmUgYW5kIFdJREVfQ0hBUlNfTU9ERQogICAgaWYgKAogICAgICAgIG5vdCBpc2luc3RhbmNlKHRhYmxlZm10LCBUYWJsZUZvcm1hdCkKICAgICAgICBhbmQgdGFibGVmbXQgaW4gbXVsdGlsaW5lX2Zvcm1hdHMKICAgICAgICBhbmQgX2lzX211bHRpbGluZShwbGFpbl90ZXh0KQogICAgKToKICAgICAgICB0YWJsZWZtdCA9IG11bHRpbGluZV9mb3JtYXRzLmdldCh0YWJsZWZtdCwgdGFibGVmbXQpCiAgICAgICAgaXNfbXVsdGlsaW5lID0gVHJ1ZQogICAgZWxzZToKICAgICAgICBpc19tdWx0aWxpbmUgPSBGYWxzZQogICAgd2lkdGhfZm4gPSBfY2hvb3NlX3dpZHRoX2ZuKGhhc19pbnZpc2libGUsIGVuYWJsZV93aWRlY2hhcnMsIGlzX211bHRpbGluZSkKCiAgICAjIGZvcm1hdCByb3dzIGFuZCBjb2x1bW5zLCBjb252ZXJ0IG51bWVyaWMgdmFsdWVzIHRvIHN0cmluZ3MKICAgIGNvbHMgPSBsaXN0KGl6aXBfbG9uZ2VzdCgqbGlzdF9vZl9saXN0cykpCiAgICBudW1wYXJzZXMgPSBfZXhwYW5kX251bXBhcnNlKGRpc2FibGVfbnVtcGFyc2UsIGxlbihjb2xzKSkKICAgIGNvbHR5cGVzID0gW19jb2x1bW5fdHlwZShjb2wsIG51bXBhcnNlPW5wKSBmb3IgY29sLCBucCBpbiB6aXAoY29scywgbnVtcGFyc2VzKV0KICAgIGlmIGlzaW5zdGFuY2UoZmxvYXRmbXQsIHN0cik6ICAjIG9sZCB2ZXJzaW9uCiAgICAgICAgZmxvYXRfZm9ybWF0cyA9IGxlbihjb2xzKSAqIFsKICAgICAgICAgICAgZmxvYXRmbXQKICAgICAgICBdICAjIGp1c3QgZHVwbGljYXRlIHRoZSBzdHJpbmcgdG8gdXNlIGluIGVhY2ggY29sdW1uCiAgICBlbHNlOiAgIyBpZiBmbG9hdGZtdCBpcyBsaXN0LCB0dXBsZSBldGMgd2UgaGF2ZSBvbmUgcGVyIGNvbHVtbgogICAgICAgIGZsb2F0X2Zvcm1hdHMgPSBsaXN0KGZsb2F0Zm10KQogICAgICAgIGlmIGxlbihmbG9hdF9mb3JtYXRzKSA8IGxlbihjb2xzKToKICAgICAgICAgICAgZmxvYXRfZm9ybWF0cy5leHRlbmQoKGxlbihjb2xzKSAtIGxlbihmbG9hdF9mb3JtYXRzKSkgKiBbX0RFRkFVTFRfRkxPQVRGTVRdKQogICAgaWYgaXNpbnN0YW5jZShpbnRmbXQsIHN0cik6ICAjIG9sZCB2ZXJzaW9uCiAgICAgICAgaW50X2Zvcm1hdHMgPSBsZW4oY29scykgKiBbCiAgICAgICAgICAgIGludGZtdAogICAgICAgIF0gICMganVzdCBkdXBsaWNhdGUgdGhlIHN0cmluZyB0byB1c2UgaW4gZWFjaCBjb2x1bW4KICAgIGVsc2U6ICAjIGlmIGludGZtdCBpcyBsaXN0LCB0dXBsZSBldGMgd2UgaGF2ZSBvbmUgcGVyIGNvbHVtbgogICAgICAgIGludF9mb3JtYXRzID0gbGlzdChpbnRmbXQpCiAgICAgICAgaWYgbGVuKGludF9mb3JtYXRzKSA8IGxlbihjb2xzKToKICAgICAgICAgICAgaW50X2Zvcm1hdHMuZXh0ZW5kKChsZW4oY29scykgLSBsZW4oaW50X2Zvcm1hdHMpKSAqIFtfREVGQVVMVF9JTlRGTVRdKQogICAgaWYgaXNpbnN0YW5jZShtaXNzaW5ndmFsLCBzdHIpOgogICAgICAgIG1pc3NpbmdfdmFscyA9IGxlbihjb2xzKSAqIFttaXNzaW5ndmFsXQogICAgZWxzZToKICAgICAgICBtaXNzaW5nX3ZhbHMgPSBsaXN0KG1pc3Npbmd2YWwpCiAgICAgICAgaWYgbGVuKG1pc3NpbmdfdmFscykgPCBsZW4oY29scyk6CiAgICAgICAgICAgIG1pc3NpbmdfdmFscy5leHRlbmQoKGxlbihjb2xzKSAtIGxlbihtaXNzaW5nX3ZhbHMpKSAqIFtfREVGQVVMVF9NSVNTSU5HVkFMXSkKICAgIGNvbHMgPSBbCiAgICAgICAgW19mb3JtYXQodiwgY3QsIGZsX2ZtdCwgaW50X2ZtdCwgbWlzc192LCBoYXNfaW52aXNpYmxlKSBmb3IgdiBpbiBjXQogICAgICAgIGZvciBjLCBjdCwgZmxfZm10LCBpbnRfZm10LCBtaXNzX3YgaW4gemlwKAogICAgICAgICAgICBjb2xzLCBjb2x0eXBlcywgZmxvYXRfZm9ybWF0cywgaW50X2Zvcm1hdHMsIG1pc3NpbmdfdmFscwogICAgICAgICkKICAgIF0KCiAgICAjIGFsaWduIGNvbHVtbnMKICAgIGFsaWducyA9IFtudW1hbGlnbiBpZiBjdCBpbiBbaW50LCBmbG9hdF0gZWxzZSBzdHJhbGlnbiBmb3IgY3QgaW4gY29sdHlwZXNdCiAgICBpZiBjb2xhbGlnbiBpcyBub3QgTm9uZToKICAgICAgICBhc3NlcnQgaXNpbnN0YW5jZShjb2xhbGlnbiwgSXRlcmFibGUpCiAgICAgICAgZm9yIGlkeCwgYWxpZ24gaW4gZW51bWVyYXRlKGNvbGFsaWduKToKICAgICAgICAgICAgYWxpZ25zW2lkeF0gPSBhbGlnbgogICAgbWlud2lkdGhzID0gKAogICAgICAgIFt3aWR0aF9mbihoKSArIG1pbl9wYWRkaW5nIGZvciBoIGluIGhlYWRlcnNdIGlmIGhlYWRlcnMgZWxzZSBbMF0gKiBsZW4oY29scykKICAgICkKICAgIGNvbHMgPSBbCiAgICAgICAgX2FsaWduX2NvbHVtbihjLCBhLCBtaW53LCBoYXNfaW52aXNpYmxlLCBlbmFibGVfd2lkZWNoYXJzLCBpc19tdWx0aWxpbmUpCiAgICAgICAgZm9yIGMsIGEsIG1pbncgaW4gemlwKGNvbHMsIGFsaWducywgbWlud2lkdGhzKQogICAgXQoKICAgIGlmIGhlYWRlcnM6CiAgICAgICAgIyBhbGlnbiBoZWFkZXJzIGFuZCBhZGQgaGVhZGVycwogICAgICAgIHRfY29scyA9IGNvbHMgb3IgW1siIl1dICogbGVuKGhlYWRlcnMpCiAgICAgICAgdF9hbGlnbnMgPSBhbGlnbnMgb3IgW3N0cmFsaWduXSAqIGxlbihoZWFkZXJzKQogICAgICAgIG1pbndpZHRocyA9IFsKICAgICAgICAgICAgbWF4KG1pbncsIG1heCh3aWR0aF9mbihjbCkgZm9yIGNsIGluIGMpKQogICAgICAgICAgICBmb3IgbWludywgYyBpbiB6aXAobWlud2lkdGhzLCB0X2NvbHMpCiAgICAgICAgXQogICAgICAgIGhlYWRlcnMgPSBbCiAgICAgICAgICAgIF9hbGlnbl9oZWFkZXIoaCwgYSwgbWludywgd2lkdGhfZm4oaCksIGlzX211bHRpbGluZSwgd2lkdGhfZm4pCiAgICAgICAgICAgIGZvciBoLCBhLCBtaW53IGluIHppcChoZWFkZXJzLCB0X2FsaWducywgbWlud2lkdGhzKQogICAgICAgIF0KICAgICAgICByb3dzID0gbGlzdCh6aXAoKmNvbHMpKQogICAgZWxzZToKICAgICAgICBtaW53aWR0aHMgPSBbbWF4KHdpZHRoX2ZuKGNsKSBmb3IgY2wgaW4gYykgZm9yIGMgaW4gY29sc10KICAgICAgICByb3dzID0gbGlzdCh6aXAoKmNvbHMpKQoKICAgIGlmIG5vdCBpc2luc3RhbmNlKHRhYmxlZm10LCBUYWJsZUZvcm1hdCk6CiAgICAgICAgdGFibGVmbXQgPSBfdGFibGVfZm9ybWF0cy5nZXQodGFibGVmbXQsIF90YWJsZV9mb3JtYXRzWyJzaW1wbGUiXSkKCiAgICByYV9kZWZhdWx0ID0gcm93YWxpZ24gaWYgaXNpbnN0YW5jZShyb3dhbGlnbiwgc3RyKSBlbHNlIE5vbmUKICAgIHJvd2FsaWducyA9IF9leHBhbmRfaXRlcmFibGUocm93YWxpZ24sIGxlbihyb3dzKSwgcmFfZGVmYXVsdCkKICAgIF9yZWluc2VydF9zZXBhcmF0aW5nX2xpbmVzKHJvd3MsIHNlcGFyYXRpbmdfbGluZXMpCgogICAgcmV0dXJuIF9mb3JtYXRfdGFibGUoCiAgICAgICAgdGFibGVmbXQsIGhlYWRlcnMsIHJvd3MsIG1pbndpZHRocywgYWxpZ25zLCBpc19tdWx0aWxpbmUsIHJvd2FsaWducz1yb3dhbGlnbnMKICAgICkKCgpkZWYgX2V4cGFuZF9udW1wYXJzZShkaXNhYmxlX251bXBhcnNlLCBjb2x1bW5fY291bnQpOgogICAgIiIiCiAgICBSZXR1cm4gYSBsaXN0IG9mIGJvb2xzIG9mIGxlbmd0aCBgY29sdW1uX2NvdW50YCB3aGljaCBpbmRpY2F0ZXMgd2hldGhlcgogICAgbnVtYmVyIHBhcnNpbmcgc2hvdWxkIGJlIHVzZWQgb24gZWFjaCBjb2x1bW4uCiAgICBJZiBgZGlzYWJsZV9udW1wYXJzZWAgaXMgYSBsaXN0IG9mIGluZGljZXMsIGVhY2ggb2YgdGhvc2UgaW5kaWNlcyBhcmUgRmFsc2UsCiAgICBhbmQgZXZlcnl0aGluZyBlbHNlIGlzIFRydWUuCiAgICBJZiBgZGlzYWJsZV9udW1wYXJzZWAgaXMgYSBib29sLCB0aGVuIHRoZSByZXR1cm5lZCBsaXN0IGlzIGFsbCB0aGUgc2FtZS4KICAgICIiIgogICAgaWYgaXNpbnN0YW5jZShkaXNhYmxlX251bXBhcnNlLCBJdGVyYWJsZSk6CiAgICAgICAgbnVtcGFyc2VzID0gW1RydWVdICogY29sdW1uX2NvdW50CiAgICAgICAgZm9yIGluZGV4IGluIGRpc2FibGVfbnVtcGFyc2U6CiAgICAgICAgICAgIG51bXBhcnNlc1tpbmRleF0gPSBGYWxzZQogICAgICAgIHJldHVybiBudW1wYXJzZXMKICAgIGVsc2U6CiAgICAgICAgcmV0dXJuIFtub3QgZGlzYWJsZV9udW1wYXJzZV0gKiBjb2x1bW5fY291bnQKCgpkZWYgX2V4cGFuZF9pdGVyYWJsZShvcmlnaW5hbCwgbnVtX2Rlc2lyZWQsIGRlZmF1bHQpOgogICAgIiIiCiAgICBFeHBhbmRzIHRoZSBgb3JpZ2luYWxgIGFyZ3VtZW50IHRvIHJldHVybiBhIHJldHVybiBhIGxpc3Qgb2YKICAgIGxlbmd0aCBgbnVtX2Rlc2lyZWRgLiBJZiBgb3JpZ2luYWxgIGlzIHNob3J0ZXIgdGhhbiBgbnVtX2Rlc2lyZWRgLCBpdCB3aWxsCiAgICBiZSBwYWRkZWQgd2l0aCB0aGUgdmFsdWUgaW4gYGRlZmF1bHRgLgogICAgSWYgYG9yaWdpbmFsYCBpcyBub3QgYSBsaXN0IHRvIGJlZ2luIHdpdGggKGkuZS4gc2NhbGFyIHZhbHVlKSBhIGxpc3Qgb2YKICAgIGxlbmd0aCBgbnVtX2Rlc2lyZWRgIGNvbXBsZXRlbHkgcG9wdWxhdGVkIHdpdGggYGRlZmF1bHQgd2lsbCBiZSByZXR1cm5lZAogICAgIiIiCiAgICBpZiBpc2luc3RhbmNlKG9yaWdpbmFsLCBJdGVyYWJsZSkgYW5kIG5vdCBpc2luc3RhbmNlKG9yaWdpbmFsLCBzdHIpOgogICAgICAgIHJldHVybiBvcmlnaW5hbCArIFtkZWZhdWx0XSAqIChudW1fZGVzaXJlZCAtIGxlbihvcmlnaW5hbCkpCiAgICBlbHNlOgogICAgICAgIHJldHVybiBbZGVmYXVsdF0gKiBudW1fZGVzaXJlZAoKCmRlZiBfcGFkX3JvdyhjZWxscywgcGFkZGluZyk6CiAgICBpZiBjZWxsczoKICAgICAgICBwYWQgPSAiICIgKiBwYWRkaW5nCiAgICAgICAgcGFkZGVkX2NlbGxzID0gW3BhZCArIGNlbGwgKyBwYWQgZm9yIGNlbGwgaW4gY2VsbHNdCiAgICAgICAgcmV0dXJuIHBhZGRlZF9jZWxscwogICAgZWxzZToKICAgICAgICByZXR1cm4gY2VsbHMKCgpkZWYgX2J1aWxkX3NpbXBsZV9yb3cocGFkZGVkX2NlbGxzLCByb3dmbXQpOgogICAgIkZvcm1hdCByb3cgYWNjb3JkaW5nIHRvIERhdGFSb3cgZm9ybWF0IHdpdGhvdXQgcGFkZGluZy4iCiAgICBiZWdpbiwgc2VwLCBlbmQgPSByb3dmbXQKICAgIHJldHVybiAoYmVnaW4gKyBzZXAuam9pbihwYWRkZWRfY2VsbHMpICsgZW5kKS5yc3RyaXAoKQoKCmRlZiBfYnVpbGRfcm93KHBhZGRlZF9jZWxscywgY29sd2lkdGhzLCBjb2xhbGlnbnMsIHJvd2ZtdCk6CiAgICAiUmV0dXJuIGEgc3RyaW5nIHdoaWNoIHJlcHJlc2VudHMgYSByb3cgb2YgZGF0YSBjZWxscy4iCiAgICBpZiBub3Qgcm93Zm10OgogICAgICAgIHJldHVybiBOb25lCiAgICBpZiBoYXNhdHRyKHJvd2ZtdCwgIl9fY2FsbF9fIik6CiAgICAgICAgcmV0dXJuIHJvd2ZtdChwYWRkZWRfY2VsbHMsIGNvbHdpZHRocywgY29sYWxpZ25zKQogICAgZWxzZToKICAgICAgICByZXR1cm4gX2J1aWxkX3NpbXBsZV9yb3cocGFkZGVkX2NlbGxzLCByb3dmbXQpCgoKZGVmIF9hcHBlbmRfYmFzaWNfcm93KGxpbmVzLCBwYWRkZWRfY2VsbHMsIGNvbHdpZHRocywgY29sYWxpZ25zLCByb3dmbXQsIHJvd2FsaWduPU5vbmUpOgogICAgIyBOT1RFOiByb3dhbGlnbiBpcyBpZ25vcmVkIGFuZCBleGlzdHMgZm9yIGFwaSBjb21wYXRpYmlsaXR5IHdpdGggX2FwcGVuZF9tdWx0aWxpbmVfcm93CiAgICBsaW5lcy5hcHBlbmQoX2J1aWxkX3JvdyhwYWRkZWRfY2VsbHMsIGNvbHdpZHRocywgY29sYWxpZ25zLCByb3dmbXQpKQogICAgcmV0dXJuIGxpbmVzCgoKZGVmIF9hbGlnbl9jZWxsX3Zlcml0aWNhbGx5KHRleHRfbGluZXMsIG51bV9saW5lcywgY29sdW1uX3dpZHRoLCByb3dfYWxpZ25tZW50KToKICAgIGRlbHRhX2xpbmVzID0gbnVtX2xpbmVzIC0gbGVuKHRleHRfbGluZXMpCiAgICBibGFuayA9IFsiICIgKiBjb2x1bW5fd2lkdGhdCiAgICBpZiByb3dfYWxpZ25tZW50ID09ICJib3R0b20iOgogICAgICAgIHJldHVybiBibGFuayAqIGRlbHRhX2xpbmVzICsgdGV4dF9saW5lcwogICAgZWxpZiByb3dfYWxpZ25tZW50ID09ICJjZW50ZXIiOgogICAgICAgIHRvcF9kZWx0YSA9IGRlbHRhX2xpbmVzIC8vIDIKICAgICAgICBib3R0b21fZGVsdGEgPSBkZWx0YV9saW5lcyAtIHRvcF9kZWx0YQogICAgICAgIHJldHVybiB0b3BfZGVsdGEgKiBibGFuayArIHRleHRfbGluZXMgKyBib3R0b21fZGVsdGEgKiBibGFuawogICAgZWxzZToKICAgICAgICByZXR1cm4gdGV4dF9saW5lcyArIGJsYW5rICogZGVsdGFfbGluZXMKCgpkZWYgX2FwcGVuZF9tdWx0aWxpbmVfcm93KAogICAgbGluZXMsIHBhZGRlZF9tdWx0aWxpbmVfY2VsbHMsIHBhZGRlZF93aWR0aHMsIGNvbGFsaWducywgcm93Zm10LCBwYWQsIHJvd2FsaWduPU5vbmUKKToKICAgIGNvbHdpZHRocyA9IFt3IC0gMiAqIHBhZCBmb3IgdyBpbiBwYWRkZWRfd2lkdGhzXQogICAgY2VsbHNfbGluZXMgPSBbYy5zcGxpdGxpbmVzKCkgZm9yIGMgaW4gcGFkZGVkX211bHRpbGluZV9jZWxsc10KICAgIG5saW5lcyA9IG1heChtYXAobGVuLCBjZWxsc19saW5lcykpICAjIG51bWJlciBvZiBsaW5lcyBpbiB0aGUgcm93CiAgICAjIHZlcnRpY2FsbHkgcGFkIGNlbGxzIHdoZXJlIHNvbWUgbGluZXMgYXJlIG1pc3NpbmcKICAgICMgY2VsbHNfbGluZXMgPSBbCiAgICAjICAgICAoY2wgKyBbIiAiICogd10gKiAobmxpbmVzIC0gbGVuKGNsKSkpIGZvciBjbCwgdyBpbiB6aXAoY2VsbHNfbGluZXMsIGNvbHdpZHRocykKICAgICMgXQoKICAgIGNlbGxzX2xpbmVzID0gWwogICAgICAgIF9hbGlnbl9jZWxsX3Zlcml0aWNhbGx5KGNsLCBubGluZXMsIHcsIHJvd2FsaWduKQogICAgICAgIGZvciBjbCwgdyBpbiB6aXAoY2VsbHNfbGluZXMsIGNvbHdpZHRocykKICAgIF0KICAgIGxpbmVzX2NlbGxzID0gW1tjbFtpXSBmb3IgY2wgaW4gY2VsbHNfbGluZXNdIGZvciBpIGluIHJhbmdlKG5saW5lcyldCiAgICBmb3IgbG4gaW4gbGluZXNfY2VsbHM6CiAgICAgICAgcGFkZGVkX2xuID0gX3BhZF9yb3cobG4sIHBhZCkKICAgICAgICBfYXBwZW5kX2Jhc2ljX3JvdyhsaW5lcywgcGFkZGVkX2xuLCBjb2x3aWR0aHMsIGNvbGFsaWducywgcm93Zm10KQogICAgcmV0dXJuIGxpbmVzCgoKZGVmIF9idWlsZF9saW5lKGNvbHdpZHRocywgY29sYWxpZ25zLCBsaW5lZm10KToKICAgICJSZXR1cm4gYSBzdHJpbmcgd2hpY2ggcmVwcmVzZW50cyBhIGhvcml6b250YWwgbGluZS4iCiAgICBpZiBub3QgbGluZWZtdDoKICAgICAgICByZXR1cm4gTm9uZQogICAgaWYgaGFzYXR0cihsaW5lZm10LCAiX19jYWxsX18iKToKICAgICAgICByZXR1cm4gbGluZWZtdChjb2x3aWR0aHMsIGNvbGFsaWducykKICAgIGVsc2U6CiAgICAgICAgYmVnaW4sIGZpbGwsIHNlcCwgZW5kID0gbGluZWZtdAogICAgICAgIGNlbGxzID0gW2ZpbGwgKiB3IGZvciB3IGluIGNvbHdpZHRoc10KICAgICAgICByZXR1cm4gX2J1aWxkX3NpbXBsZV9yb3coY2VsbHMsIChiZWdpbiwgc2VwLCBlbmQpKQoKCmRlZiBfYXBwZW5kX2xpbmUobGluZXMsIGNvbHdpZHRocywgY29sYWxpZ25zLCBsaW5lZm10KToKICAgIGxpbmVzLmFwcGVuZChfYnVpbGRfbGluZShjb2x3aWR0aHMsIGNvbGFsaWducywgbGluZWZtdCkpCiAgICByZXR1cm4gbGluZXMKCgpjbGFzcyBKdXB5dGVySFRNTFN0cihzdHIpOgogICAgIiIiV3JhcCB0aGUgc3RyaW5nIHdpdGggYSBfcmVwcl9odG1sXyBtZXRob2Qgc28gdGhhdCBKdXB5dGVyCiAgICBkaXNwbGF5cyB0aGUgSFRNTCB0YWJsZSIiIgoKICAgIGRlZiBfcmVwcl9odG1sXyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZgoKICAgIEBwcm9wZXJ0eQogICAgZGVmIHN0cihzZWxmKToKICAgICAgICAiIiJhZGQgYSAuc3RyIHByb3BlcnR5IHNvIHRoYXQgdGhlIHJhdyBzdHJpbmcgaXMgc3RpbGwgYWNjZXNzaWJsZSIiIgogICAgICAgIHJldHVybiBzZWxmCgoKZGVmIF9mb3JtYXRfdGFibGUoZm10LCBoZWFkZXJzLCByb3dzLCBjb2x3aWR0aHMsIGNvbGFsaWducywgaXNfbXVsdGlsaW5lLCByb3dhbGlnbnMpOgogICAgIiIiUHJvZHVjZSBhIHBsYWluLXRleHQgcmVwcmVzZW50YXRpb24gb2YgdGhlIHRhYmxlLiIiIgogICAgbGluZXMgPSBbXQogICAgaGlkZGVuID0gZm10LndpdGhfaGVhZGVyX2hpZGUgaWYgKGhlYWRlcnMgYW5kIGZtdC53aXRoX2hlYWRlcl9oaWRlKSBlbHNlIFtdCiAgICBwYWQgPSBmbXQucGFkZGluZwogICAgaGVhZGVycm93ID0gZm10LmhlYWRlcnJvdwoKICAgIHBhZGRlZF93aWR0aHMgPSBbKHcgKyAyICogcGFkKSBmb3IgdyBpbiBjb2x3aWR0aHNdCiAgICBpZiBpc19tdWx0aWxpbmU6CiAgICAgICAgcGFkX3JvdyA9IGxhbWJkYSByb3csIF86IHJvdyAgIyBub3FhIGRvIGl0IGxhdGVyLCBpbiBfYXBwZW5kX211bHRpbGluZV9yb3cKICAgICAgICBhcHBlbmRfcm93ID0gcGFydGlhbChfYXBwZW5kX211bHRpbGluZV9yb3csIHBhZD1wYWQpCiAgICBlbHNlOgogICAgICAgIHBhZF9yb3cgPSBfcGFkX3JvdwogICAgICAgIGFwcGVuZF9yb3cgPSBfYXBwZW5kX2Jhc2ljX3JvdwoKICAgIHBhZGRlZF9oZWFkZXJzID0gcGFkX3JvdyhoZWFkZXJzLCBwYWQpCiAgICBwYWRkZWRfcm93cyA9IFtwYWRfcm93KHJvdywgcGFkKSBmb3Igcm93IGluIHJvd3NdCgogICAgaWYgZm10LmxpbmVhYm92ZSBhbmQgImxpbmVhYm92ZSIgbm90IGluIGhpZGRlbjoKICAgICAgICBfYXBwZW5kX2xpbmUobGluZXMsIHBhZGRlZF93aWR0aHMsIGNvbGFsaWducywgZm10LmxpbmVhYm92ZSkKCiAgICBpZiBwYWRkZWRfaGVhZGVyczoKICAgICAgICBhcHBlbmRfcm93KGxpbmVzLCBwYWRkZWRfaGVhZGVycywgcGFkZGVkX3dpZHRocywgY29sYWxpZ25zLCBoZWFkZXJyb3cpCiAgICAgICAgaWYgZm10LmxpbmViZWxvd2hlYWRlciBhbmQgImxpbmViZWxvd2hlYWRlciIgbm90IGluIGhpZGRlbjoKICAgICAgICAgICAgX2FwcGVuZF9saW5lKGxpbmVzLCBwYWRkZWRfd2lkdGhzLCBjb2xhbGlnbnMsIGZtdC5saW5lYmVsb3doZWFkZXIpCgogICAgaWYgcGFkZGVkX3Jvd3MgYW5kIGZtdC5saW5lYmV0d2VlbnJvd3MgYW5kICJsaW5lYmV0d2VlbnJvd3MiIG5vdCBpbiBoaWRkZW46CiAgICAgICAgIyBpbml0aWFsIHJvd3Mgd2l0aCBhIGxpbmUgYmVsb3cKICAgICAgICBmb3Igcm93LCByYWxpZ24gaW4gemlwKHBhZGRlZF9yb3dzWzotMV0sIHJvd2FsaWducyk6CiAgICAgICAgICAgIGFwcGVuZF9yb3coCiAgICAgICAgICAgICAgICBsaW5lcywgcm93LCBwYWRkZWRfd2lkdGhzLCBjb2xhbGlnbnMsIGZtdC5kYXRhcm93LCByb3dhbGlnbj1yYWxpZ24KICAgICAgICAgICAgKQogICAgICAgICAgICBfYXBwZW5kX2xpbmUobGluZXMsIHBhZGRlZF93aWR0aHMsIGNvbGFsaWducywgZm10LmxpbmViZXR3ZWVucm93cykKICAgICAgICAjIHRoZSBsYXN0IHJvdyB3aXRob3V0IGEgbGluZSBiZWxvdwogICAgICAgIGFwcGVuZF9yb3coCiAgICAgICAgICAgIGxpbmVzLAogICAgICAgICAgICBwYWRkZWRfcm93c1stMV0sCiAgICAgICAgICAgIHBhZGRlZF93aWR0aHMsCiAgICAgICAgICAgIGNvbGFsaWducywKICAgICAgICAgICAgZm10LmRhdGFyb3csCiAgICAgICAgICAgIHJvd2FsaWduPXJvd2FsaWduc1stMV0sCiAgICAgICAgKQogICAgZWxzZToKICAgICAgICBzZXBhcmF0aW5nX2xpbmUgPSAoCiAgICAgICAgICAgIGZtdC5saW5lYmV0d2VlbnJvd3MKICAgICAgICAgICAgb3IgZm10LmxpbmViZWxvd2hlYWRlcgogICAgICAgICAgICBvciBmbXQubGluZWJlbG93CiAgICAgICAgICAgIG9yIGZtdC5saW5lYWJvdmUKICAgICAgICAgICAgb3IgTGluZSgiIiwgIiIsICIiLCAiIikKICAgICAgICApCiAgICAgICAgZm9yIHJvdyBpbiBwYWRkZWRfcm93czoKICAgICAgICAgICAgIyB0ZXN0IHRvIHNlZSBpZiBlaXRoZXIgdGhlIDFzdCBjb2x1bW4gb3IgdGhlIDJuZCBjb2x1bW4gKGFjY291bnQgZm9yIHNob3dpbmRleCkgaGFzCiAgICAgICAgICAgICMgdGhlIFNFUEFSQVRJTkdfTElORSBmbGFnCiAgICAgICAgICAgIGlmIF9pc19zZXBhcmF0aW5nX2xpbmUocm93KToKICAgICAgICAgICAgICAgIF9hcHBlbmRfbGluZShsaW5lcywgcGFkZGVkX3dpZHRocywgY29sYWxpZ25zLCBzZXBhcmF0aW5nX2xpbmUpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBhcHBlbmRfcm93KGxpbmVzLCByb3csIHBhZGRlZF93aWR0aHMsIGNvbGFsaWducywgZm10LmRhdGFyb3cpCgogICAgaWYgZm10LmxpbmViZWxvdyBhbmQgImxpbmViZWxvdyIgbm90IGluIGhpZGRlbjoKICAgICAgICBfYXBwZW5kX2xpbmUobGluZXMsIHBhZGRlZF93aWR0aHMsIGNvbGFsaWducywgZm10LmxpbmViZWxvdykKCiAgICBpZiBoZWFkZXJzIG9yIHJvd3M6CiAgICAgICAgb3V0cHV0ID0gIlxuIi5qb2luKGxpbmVzKQogICAgICAgIGlmIGZtdC5saW5lYWJvdmUgPT0gX2h0bWxfYmVnaW5fdGFibGVfd2l0aG91dF9oZWFkZXI6CiAgICAgICAgICAgIHJldHVybiBKdXB5dGVySFRNTFN0cihvdXRwdXQpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIG91dHB1dAogICAgZWxzZTogICMgYSBjb21wbGV0ZWx5IGVtcHR5IHRhYmxlCiAgICAgICAgcmV0dXJuICIiCgoKY2xhc3MgX0N1c3RvbVRleHRXcmFwKHRleHR3cmFwLlRleHRXcmFwcGVyKToKICAgICIiIkEgY3VzdG9tIGltcGxlbWVudGF0aW9uIG9mIENQeXRob24ncyB0ZXh0d3JhcC5UZXh0V3JhcHBlci4gVGhpcyBzdXBwb3J0cwogICAgYm90aCB3aWRlIGNoYXJhY3RlcnMgKEtvcmVhLCBKYXBhbmVzZSwgQ2hpbmVzZSkgIC0gaW5jbHVkaW5nIG1peGVkIHN0cmluZy4KICAgIEZvciB0aGUgbW9zdCBwYXJ0LCB0aGUgYF9oYW5kbGVfbG9uZ193b3JkYCBhbmQgYF93cmFwX2NodW5rc2AgZnVuY3Rpb25zIHdlcmUKICAgIGNvcHkgcGFzdGVkIG91dCBvZiB0aGUgQ1B5dGhvbiBiYXNlbGluZSwgYW5kIHVwZGF0ZWQgd2l0aCBvdXIgY3VzdG9tIGxlbmd0aAogICAgYW5kIGxpbmUgYXBwZW5kaW5nIGxvZ2ljLgogICAgIiIiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgc2VsZi5fYWN0aXZlX2NvZGVzID0gW10KICAgICAgICBzZWxmLm1heF9saW5lcyA9IE5vbmUgICMgRm9yIHB5dGhvbjIgY29tcGF0aWJpbGl0eQogICAgICAgIHRleHR3cmFwLlRleHRXcmFwcGVyLl9faW5pdF9fKHNlbGYsICphcmdzLCAqKmt3YXJncykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgX2xlbihpdGVtKToKICAgICAgICAiIiJDdXN0b20gbGVuIHRoYXQgZ2V0cyBjb25zb2xlIGNvbHVtbiB3aWR0aCBmb3Igd2lkZQogICAgICAgIGFuZCBub24td2lkZSBjaGFyYWN0ZXJzIGFzIHdlbGwgYXMgaWdub3JlcyBjb2xvciBjb2RlcyIiIgogICAgICAgIHN0cmlwcGVkID0gX3N0cmlwX2Fuc2koaXRlbSkKICAgICAgICBpZiB3Y3dpZHRoOgogICAgICAgICAgICByZXR1cm4gd2N3aWR0aC53Y3N3aWR0aChzdHJpcHBlZCkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gbGVuKHN0cmlwcGVkKQoKICAgIGRlZiBfdXBkYXRlX2xpbmVzKHNlbGYsIGxpbmVzLCBuZXdfbGluZSk6CiAgICAgICAgIiIiQWRkcyBhIG5ldyBsaW5lIHRvIHRoZSBsaXN0IG9mIGxpbmVzIHRoZSB0ZXh0IGlzIGJlaW5nIHdyYXBwZWQgaW50bwogICAgICAgIFRoaXMgZnVuY3Rpb24gd2lsbCBhbHNvIHRyYWNrIGFueSBBTlNJIGNvbG9yIGNvZGVzIGluIHRoaXMgc3RyaW5nIGFzIHdlbGwKICAgICAgICBhcyBhZGQgYW55IGNvbG9ycyBmcm9tIHByZXZpb3VzIGxpbmVzIG9yZGVyIHRvIHByZXNlcnZlIHRoZSBzYW1lIGZvcm1hdHRpbmcKICAgICAgICBhcyBhIHNpbmdsZSB1bndyYXBwZWQgc3RyaW5nLgogICAgICAgICIiIgogICAgICAgIGNvZGVfbWF0Y2hlcyA9IFt4IGZvciB4IGluIF9hbnNpX2NvZGVzLmZpbmRpdGVyKG5ld19saW5lKV0KICAgICAgICBjb2xvcl9jb2RlcyA9IFsKICAgICAgICAgICAgY29kZS5zdHJpbmdbY29kZS5zcGFuKClbMF0gOiBjb2RlLnNwYW4oKVsxXV0gZm9yIGNvZGUgaW4gY29kZV9tYXRjaGVzCiAgICAgICAgXQoKICAgICAgICAjIEFkZCBjb2xvciBjb2RlcyBmcm9tIGVhcmxpZXIgaW4gdGhlIHVud3JhcHBlZCBsaW5lLCBhbmQgdGhlbiB0cmFjayBhbnkgbmV3IG9uZXMgd2UgYWRkLgogICAgICAgIG5ld19saW5lID0gIiIuam9pbihzZWxmLl9hY3RpdmVfY29kZXMpICsgbmV3X2xpbmUKCiAgICAgICAgZm9yIGNvZGUgaW4gY29sb3JfY29kZXM6CiAgICAgICAgICAgIGlmIGNvZGUgIT0gX2Fuc2lfY29sb3JfcmVzZXRfY29kZToKICAgICAgICAgICAgICAgIHNlbGYuX2FjdGl2ZV9jb2Rlcy5hcHBlbmQoY29kZSkKICAgICAgICAgICAgZWxzZTogICMgQSBzaW5nbGUgcmVzZXQgY29kZSByZXNldHMgZXZlcnl0aGluZwogICAgICAgICAgICAgICAgc2VsZi5fYWN0aXZlX2NvZGVzID0gW10KCiAgICAgICAgIyBBbHdheXMgZW5zdXJlIGVhY2ggbGluZSBpcyBjb2xvciB0ZXJtaW50ZWQgaWYgYW55IGNvbG9ycyBhcmUKICAgICAgICAjIHN0aWxsIGFjdGl2ZSwgb3RoZXJ3aXNlIGNvbG9ycyB3aWxsIGJsZWVkIGludG8gb3RoZXIgY2VsbHMgb24gdGhlIGNvbnNvbGUKICAgICAgICBpZiBsZW4oc2VsZi5fYWN0aXZlX2NvZGVzKSA+IDA6CiAgICAgICAgICAgIG5ld19saW5lID0gbmV3X2xpbmUgKyBfYW5zaV9jb2xvcl9yZXNldF9jb2RlCgogICAgICAgIGxpbmVzLmFwcGVuZChuZXdfbGluZSkKCiAgICBkZWYgX2hhbmRsZV9sb25nX3dvcmQoc2VsZiwgcmV2ZXJzZWRfY2h1bmtzLCBjdXJfbGluZSwgY3VyX2xlbiwgd2lkdGgpOgogICAgICAgICIiIl9oYW5kbGVfbG9uZ193b3JkKGNodW5rcyA6IFtzdHJpbmddLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cl9saW5lIDogW3N0cmluZ10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VyX2xlbiA6IGludCwgd2lkdGggOiBpbnQpCiAgICAgICAgSGFuZGxlIGEgY2h1bmsgb2YgdGV4dCAobW9zdCBsaWtlbHkgYSB3b3JkLCBub3Qgd2hpdGVzcGFjZSkgdGhhdAogICAgICAgIGlzIHRvbyBsb25nIHRvIGZpdCBpbiBhbnkgbGluZS4KICAgICAgICAiIiIKICAgICAgICAjIEZpZ3VyZSBvdXQgd2hlbiBpbmRlbnQgaXMgbGFyZ2VyIHRoYW4gdGhlIHNwZWNpZmllZCB3aWR0aCwgYW5kIG1ha2UKICAgICAgICAjIHN1cmUgYXQgbGVhc3Qgb25lIGNoYXJhY3RlciBpcyBzdHJpcHBlZCBvZmYgb24gZXZlcnkgcGFzcwogICAgICAgIGlmIHdpZHRoIDwgMToKICAgICAgICAgICAgc3BhY2VfbGVmdCA9IDEKICAgICAgICBlbHNlOgogICAgICAgICAgICBzcGFjZV9sZWZ0ID0gd2lkdGggLSBjdXJfbGVuCgogICAgICAgICMgSWYgd2UncmUgYWxsb3dlZCB0byBicmVhayBsb25nIHdvcmRzLCB0aGVuIGRvIHNvOiBwdXQgYXMgbXVjaAogICAgICAgICMgb2YgdGhlIG5leHQgY2h1bmsgb250byB0aGUgY3VycmVudCBsaW5lIGFzIHdpbGwgZml0LgogICAgICAgIGlmIHNlbGYuYnJlYWtfbG9uZ193b3JkczoKICAgICAgICAgICAgIyBUYWJ1bGF0ZSBDdXN0b206IEJ1aWxkIHRoZSBzdHJpbmcgdXAgcGllY2UtYnktcGllY2UgaW4gb3JkZXIgdG8KICAgICAgICAgICAgIyB0YWtlIGVhY2ggY2hhcmN0ZXIncyB3aWR0aCBpbnRvIGFjY291bnQKICAgICAgICAgICAgY2h1bmsgPSByZXZlcnNlZF9jaHVua3NbLTFdCiAgICAgICAgICAgIGkgPSAxCiAgICAgICAgICAgIHdoaWxlIHNlbGYuX2xlbihjaHVua1s6aV0pIDw9IHNwYWNlX2xlZnQ6CiAgICAgICAgICAgICAgICBpID0gaSArIDEKICAgICAgICAgICAgY3VyX2xpbmUuYXBwZW5kKGNodW5rWzogaSAtIDFdKQogICAgICAgICAgICByZXZlcnNlZF9jaHVua3NbLTFdID0gY2h1bmtbaSAtIDEgOl0KCiAgICAgICAgIyBPdGhlcndpc2UsIHdlIGhhdmUgdG8gcHJlc2VydmUgdGhlIGxvbmcgd29yZCBpbnRhY3QuICBPbmx5IGFkZAogICAgICAgICMgaXQgdG8gdGhlIGN1cnJlbnQgbGluZSBpZiB0aGVyZSdzIG5vdGhpbmcgYWxyZWFkeSB0aGVyZSAtLQogICAgICAgICMgdGhhdCBtaW5pbWl6ZXMgaG93IG11Y2ggd2UgdmlvbGF0ZSB0aGUgd2lkdGggY29uc3RyYWludC4KICAgICAgICBlbGlmIG5vdCBjdXJfbGluZToKICAgICAgICAgICAgY3VyX2xpbmUuYXBwZW5kKHJldmVyc2VkX2NodW5rcy5wb3AoKSkKCiAgICAgICAgIyBJZiB3ZSdyZSBub3QgYWxsb3dlZCB0byBicmVhayBsb25nIHdvcmRzLCBhbmQgdGhlcmUncyBhbHJlYWR5CiAgICAgICAgIyB0ZXh0IG9uIHRoZSBjdXJyZW50IGxpbmUsIGRvIG5vdGhpbmcuICBOZXh0IHRpbWUgdGhyb3VnaCB0aGUKICAgICAgICAjIG1haW4gbG9vcCBvZiBfd3JhcF9jaHVua3MoKSwgd2UnbGwgd2luZCB1cCBoZXJlIGFnYWluLCBidXQKICAgICAgICAjIGN1cl9sZW4gd2lsbCBiZSB6ZXJvLCBzbyB0aGUgbmV4dCBsaW5lIHdpbGwgYmUgZW50aXJlbHkKICAgICAgICAjIGRldm90ZWQgdG8gdGhlIGxvbmcgd29yZCB0aGF0IHdlIGNhbid0IGhhbmRsZSByaWdodCBub3cuCgogICAgZGVmIF93cmFwX2NodW5rcyhzZWxmLCBjaHVua3MpOgogICAgICAgICIiIl93cmFwX2NodW5rcyhjaHVua3MgOiBbc3RyaW5nXSkgLT4gW3N0cmluZ10KICAgICAgICBXcmFwIGEgc2VxdWVuY2Ugb2YgdGV4dCBjaHVua3MgYW5kIHJldHVybiBhIGxpc3Qgb2YgbGluZXMgb2YKICAgICAgICBsZW5ndGggJ3NlbGYud2lkdGgnIG9yIGxlc3MuICAoSWYgJ2JyZWFrX2xvbmdfd29yZHMnIGlzIGZhbHNlLAogICAgICAgIHNvbWUgbGluZXMgbWF5IGJlIGxvbmdlciB0aGFuIHRoaXMuKSAgQ2h1bmtzIGNvcnJlc3BvbmQgcm91Z2hseQogICAgICAgIHRvIHdvcmRzIGFuZCB0aGUgd2hpdGVzcGFjZSBiZXR3ZWVuIHRoZW06IGVhY2ggY2h1bmsgaXMKICAgICAgICBpbmRpdmlzaWJsZSAobW9kdWxvICdicmVha19sb25nX3dvcmRzJyksIGJ1dCBhIGxpbmUgYnJlYWsgY2FuCiAgICAgICAgY29tZSBiZXR3ZWVuIGFueSB0d28gY2h1bmtzLiAgQ2h1bmtzIHNob3VsZCBub3QgaGF2ZSBpbnRlcm5hbAogICAgICAgIHdoaXRlc3BhY2U7IGllLiBhIGNodW5rIGlzIGVpdGhlciBhbGwgd2hpdGVzcGFjZSBvciBhICJ3b3JkIi4KICAgICAgICBXaGl0ZXNwYWNlIGNodW5rcyB3aWxsIGJlIHJlbW92ZWQgZnJvbSB0aGUgYmVnaW5uaW5nIGFuZCBlbmQgb2YKICAgICAgICBsaW5lcywgYnV0IGFwYXJ0IGZyb20gdGhhdCB3aGl0ZXNwYWNlIGlzIHByZXNlcnZlZC4KICAgICAgICAiIiIKICAgICAgICBsaW5lcyA9IFtdCiAgICAgICAgaWYgc2VsZi53aWR0aCA8PSAwOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJpbnZhbGlkIHdpZHRoICVyIChtdXN0IGJlID4gMCkiICUgc2VsZi53aWR0aCkKICAgICAgICBpZiBzZWxmLm1heF9saW5lcyBpcyBub3QgTm9uZToKICAgICAgICAgICAgaWYgc2VsZi5tYXhfbGluZXMgPiAxOgogICAgICAgICAgICAgICAgaW5kZW50ID0gc2VsZi5zdWJzZXF1ZW50X2luZGVudAogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaW5kZW50ID0gc2VsZi5pbml0aWFsX2luZGVudAogICAgICAgICAgICBpZiBzZWxmLl9sZW4oaW5kZW50KSArIHNlbGYuX2xlbihzZWxmLnBsYWNlaG9sZGVyLmxzdHJpcCgpKSA+IHNlbGYud2lkdGg6CiAgICAgICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJwbGFjZWhvbGRlciB0b28gbGFyZ2UgZm9yIG1heCB3aWR0aCIpCgogICAgICAgICMgQXJyYW5nZSBpbiByZXZlcnNlIG9yZGVyIHNvIGl0ZW1zIGNhbiBiZSBlZmZpY2llbnRseSBwb3BwZWQKICAgICAgICAjIGZyb20gYSBzdGFjayBvZiBjaHVja3MuCiAgICAgICAgY2h1bmtzLnJldmVyc2UoKQoKICAgICAgICB3aGlsZSBjaHVua3M6CgogICAgICAgICAgICAjIFN0YXJ0IHRoZSBsaXN0IG9mIGNodW5rcyB0aGF0IHdpbGwgbWFrZSB1cCB0aGUgY3VycmVudCBsaW5lLgogICAgICAgICAgICAjIGN1cl9sZW4gaXMganVzdCB0aGUgbGVuZ3RoIG9mIGFsbCB0aGUgY2h1bmtzIGluIGN1cl9saW5lLgogICAgICAgICAgICBjdXJfbGluZSA9IFtdCiAgICAgICAgICAgIGN1cl9sZW4gPSAwCgogICAgICAgICAgICAjIEZpZ3VyZSBvdXQgd2hpY2ggc3RhdGljIHN0cmluZyB3aWxsIHByZWZpeCB0aGlzIGxpbmUuCiAgICAgICAgICAgIGlmIGxpbmVzOgogICAgICAgICAgICAgICAgaW5kZW50ID0gc2VsZi5zdWJzZXF1ZW50X2luZGVudAogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaW5kZW50ID0gc2VsZi5pbml0aWFsX2luZGVudAoKICAgICAgICAgICAgIyBNYXhpbXVtIHdpZHRoIGZvciB0aGlzIGxpbmUuCiAgICAgICAgICAgIHdpZHRoID0gc2VsZi53aWR0aCAtIHNlbGYuX2xlbihpbmRlbnQpCgogICAgICAgICAgICAjIEZpcnN0IGNodW5rIG9uIGxpbmUgaXMgd2hpdGVzcGFjZSAtLSBkcm9wIGl0LCB1bmxlc3MgdGhpcwogICAgICAgICAgICAjIGlzIHRoZSB2ZXJ5IGJlZ2lubmluZyBvZiB0aGUgdGV4dCAoaWUuIG5vIGxpbmVzIHN0YXJ0ZWQgeWV0KS4KICAgICAgICAgICAgaWYgc2VsZi5kcm9wX3doaXRlc3BhY2UgYW5kIGNodW5rc1stMV0uc3RyaXAoKSA9PSAiIiBhbmQgbGluZXM6CiAgICAgICAgICAgICAgICBkZWwgY2h1bmtzWy0xXQoKICAgICAgICAgICAgd2hpbGUgY2h1bmtzOgogICAgICAgICAgICAgICAgY2h1bmtfbGVuID0gc2VsZi5fbGVuKGNodW5rc1stMV0pCgogICAgICAgICAgICAgICAgIyBDYW4gYXQgbGVhc3Qgc3F1ZWV6ZSB0aGlzIGNodW5rIG9udG8gdGhlIGN1cnJlbnQgbGluZS4KICAgICAgICAgICAgICAgIGlmIGN1cl9sZW4gKyBjaHVua19sZW4gPD0gd2lkdGg6CiAgICAgICAgICAgICAgICAgICAgY3VyX2xpbmUuYXBwZW5kKGNodW5rcy5wb3AoKSkKICAgICAgICAgICAgICAgICAgICBjdXJfbGVuICs9IGNodW5rX2xlbgoKICAgICAgICAgICAgICAgICMgTm9wZSwgdGhpcyBsaW5lIGlzIGZ1bGwuCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgICAgICAjIFRoZSBjdXJyZW50IGxpbmUgaXMgZnVsbCwgYW5kIHRoZSBuZXh0IGNodW5rIGlzIHRvbyBiaWcgdG8KICAgICAgICAgICAgIyBmaXQgb24gKmFueSogbGluZSAobm90IGp1c3QgdGhpcyBvbmUpLgogICAgICAgICAgICBpZiBjaHVua3MgYW5kIHNlbGYuX2xlbihjaHVua3NbLTFdKSA+IHdpZHRoOgogICAgICAgICAgICAgICAgc2VsZi5faGFuZGxlX2xvbmdfd29yZChjaHVua3MsIGN1cl9saW5lLCBjdXJfbGVuLCB3aWR0aCkKICAgICAgICAgICAgICAgIGN1cl9sZW4gPSBzdW0obWFwKHNlbGYuX2xlbiwgY3VyX2xpbmUpKQoKICAgICAgICAgICAgIyBJZiB0aGUgbGFzdCBjaHVuayBvbiB0aGlzIGxpbmUgaXMgYWxsIHdoaXRlc3BhY2UsIGRyb3AgaXQuCiAgICAgICAgICAgIGlmIHNlbGYuZHJvcF93aGl0ZXNwYWNlIGFuZCBjdXJfbGluZSBhbmQgY3VyX2xpbmVbLTFdLnN0cmlwKCkgPT0gIiI6CiAgICAgICAgICAgICAgICBjdXJfbGVuIC09IHNlbGYuX2xlbihjdXJfbGluZVstMV0pCiAgICAgICAgICAgICAgICBkZWwgY3VyX2xpbmVbLTFdCgogICAgICAgICAgICBpZiBjdXJfbGluZToKICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgICBzZWxmLm1heF9saW5lcyBpcyBOb25lCiAgICAgICAgICAgICAgICAgICAgb3IgbGVuKGxpbmVzKSArIDEgPCBzZWxmLm1heF9saW5lcwogICAgICAgICAgICAgICAgICAgIG9yICgKICAgICAgICAgICAgICAgICAgICAgICAgbm90IGNodW5rcwogICAgICAgICAgICAgICAgICAgICAgICBvciBzZWxmLmRyb3Bfd2hpdGVzcGFjZQogICAgICAgICAgICAgICAgICAgICAgICBhbmQgbGVuKGNodW5rcykgPT0gMQogICAgICAgICAgICAgICAgICAgICAgICBhbmQgbm90IGNodW5rc1swXS5zdHJpcCgpCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIGFuZCBjdXJfbGVuIDw9IHdpZHRoCiAgICAgICAgICAgICAgICApOgogICAgICAgICAgICAgICAgICAgICMgQ29udmVydCBjdXJyZW50IGxpbmUgYmFjayB0byBhIHN0cmluZyBhbmQgc3RvcmUgaXQgaW4KICAgICAgICAgICAgICAgICAgICAjIGxpc3Qgb2YgYWxsIGxpbmVzIChyZXR1cm4gdmFsdWUpLgogICAgICAgICAgICAgICAgICAgIHNlbGYuX3VwZGF0ZV9saW5lcyhsaW5lcywgaW5kZW50ICsgIiIuam9pbihjdXJfbGluZSkpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHdoaWxlIGN1cl9saW5lOgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJfbGluZVstMV0uc3RyaXAoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5kIGN1cl9sZW4gKyBzZWxmLl9sZW4oc2VsZi5wbGFjZWhvbGRlcikgPD0gd2lkdGgKICAgICAgICAgICAgICAgICAgICAgICAgKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cl9saW5lLmFwcGVuZChzZWxmLnBsYWNlaG9sZGVyKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fdXBkYXRlX2xpbmVzKGxpbmVzLCBpbmRlbnQgKyAiIi5qb2luKGN1cl9saW5lKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgIGN1cl9sZW4gLT0gc2VsZi5fbGVuKGN1cl9saW5lWy0xXSkKICAgICAgICAgICAgICAgICAgICAgICAgZGVsIGN1cl9saW5lWy0xXQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGxpbmVzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldl9saW5lID0gbGluZXNbLTFdLnJzdHJpcCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fbGVuKHByZXZfbGluZSkgKyBzZWxmLl9sZW4oc2VsZi5wbGFjZWhvbGRlcikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8PSBzZWxmLndpZHRoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVzWy0xXSA9IHByZXZfbGluZSArIHNlbGYucGxhY2Vob2xkZXIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl91cGRhdGVfbGluZXMobGluZXMsIGluZGVudCArIHNlbGYucGxhY2Vob2xkZXIubHN0cmlwKCkpCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKCiAgICAgICAgcmV0dXJuIGxpbmVzCgoKZGVmIF9tYWluKCk6CiAgICAiIiJcCiAgICBVc2FnZTogdGFidWxhdGUgW29wdGlvbnNdIFtGSUxFIC4uLl0KCiAgICBQcmV0dHktcHJpbnQgdGFidWxhciBkYXRhLgogICAgU2VlIGFsc28gaHR0cHM6Ly9naXRodWIuY29tL2FzdGFuaW4vcHl0aG9uLXRhYnVsYXRlCgogICAgRklMRSAgICAgICAgICAgICAgICAgICAgICBhIGZpbGVuYW1lIG9mIHRoZSBmaWxlIHdpdGggdGFidWxhciBkYXRhOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAiLSIgb3IgbWlzc2luZywgcmVhZCBkYXRhIGZyb20gc3RkaW4uCgogICAgT3B0aW9uczoKCiAgICAtaCwgLS1oZWxwICAgICAgICAgICAgICAgIHNob3cgdGhpcyBtZXNzYWdlCiAgICAtMSwgLS1oZWFkZXIgICAgICAgICAgICAgIHVzZSB0aGUgZmlyc3Qgcm93IG9mIGRhdGEgYXMgYSB0YWJsZSBoZWFkZXIKICAgIC1vIEZJTEUsIC0tb3V0cHV0IEZJTEUgICAgcHJpbnQgdGFibGUgdG8gRklMRSAoZGVmYXVsdDogc3Rkb3V0KQogICAgLXMgUkVHRVhQLCAtLXNlcCBSRUdFWFAgICB1c2UgYSBjdXN0b20gY29sdW1uIHNlcGFyYXRvciAoZGVmYXVsdDogd2hpdGVzcGFjZSkKICAgIC1GIEZQRk1ULCAtLWZsb2F0IEZQRk1UICAgZmxvYXRpbmcgcG9pbnQgbnVtYmVyIGZvcm1hdCAoZGVmYXVsdDogZykKICAgIC1JIElOVEZNVCwgLS1pbnQgSU5URk1UICAgaW50ZWdlciBwb2ludCBudW1iZXIgZm9ybWF0IChkZWZhdWx0OiAiIikKICAgIC1mIEZNVCwgLS1mb3JtYXQgRk1UICAgICAgc2V0IG91dHB1dCB0YWJsZSBmb3JtYXQ7IHN1cHBvcnRlZCBmb3JtYXRzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFpbiwgc2ltcGxlLCBncmlkLCBmYW5jeV9ncmlkLCBwaXBlLCBvcmd0YmwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJzdCwgbWVkaWF3aWtpLCBodG1sLCBsYXRleCwgbGF0ZXhfcmF3LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXRleF9ib29rdGFicywgbGF0ZXhfbG9uZ3RhYmxlLCB0c3YKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGRlZmF1bHQ6IHNpbXBsZSkKICAgICIiIgogICAgaW1wb3J0IGdldG9wdAogICAgaW1wb3J0IHN5cwogICAgaW1wb3J0IHRleHR3cmFwCgogICAgdXNhZ2UgPSB0ZXh0d3JhcC5kZWRlbnQoX21haW4uX19kb2NfXykKICAgIHRyeToKICAgICAgICBvcHRzLCBhcmdzID0gZ2V0b3B0LmdldG9wdCgKICAgICAgICAgICAgc3lzLmFyZ3ZbMTpdLAogICAgICAgICAgICAiaDFvOnM6RjpBOmY6IiwKICAgICAgICAgICAgWyJoZWxwIiwgImhlYWRlciIsICJvdXRwdXQiLCAic2VwPSIsICJmbG9hdD0iLCAiaW50PSIsICJhbGlnbj0iLCAiZm9ybWF0PSJdLAogICAgICAgICkKICAgIGV4Y2VwdCBnZXRvcHQuR2V0b3B0RXJyb3IgYXMgZToKICAgICAgICBwcmludChlKQogICAgICAgIHByaW50KHVzYWdlKQogICAgICAgIHN5cy5leGl0KDIpCiAgICBoZWFkZXJzID0gW10KICAgIGZsb2F0Zm10ID0gX0RFRkFVTFRfRkxPQVRGTVQKICAgIGludGZtdCA9IF9ERUZBVUxUX0lOVEZNVAogICAgY29sYWxpZ24gPSBOb25lCiAgICB0YWJsZWZtdCA9ICJzaW1wbGUiCiAgICBzZXAgPSByIlxzKyIKICAgIG91dGZpbGUgPSAiLSIKICAgIGZvciBvcHQsIHZhbHVlIGluIG9wdHM6CiAgICAgICAgaWYgb3B0IGluIFsiLTEiLCAiLS1oZWFkZXIiXToKICAgICAgICAgICAgaGVhZGVycyA9ICJmaXJzdHJvdyIKICAgICAgICBlbGlmIG9wdCBpbiBbIi1vIiwgIi0tb3V0cHV0Il06CiAgICAgICAgICAgIG91dGZpbGUgPSB2YWx1ZQogICAgICAgIGVsaWYgb3B0IGluIFsiLUYiLCAiLS1mbG9hdCJdOgogICAgICAgICAgICBmbG9hdGZtdCA9IHZhbHVlCiAgICAgICAgZWxpZiBvcHQgaW4gWyItSSIsICItLWludCJdOgogICAgICAgICAgICBpbnRmbXQgPSB2YWx1ZQogICAgICAgIGVsaWYgb3B0IGluIFsiLUMiLCAiLS1jb2xhbGlnbiJdOgogICAgICAgICAgICBjb2xhbGlnbiA9IHZhbHVlLnNwbGl0KCkKICAgICAgICBlbGlmIG9wdCBpbiBbIi1mIiwgIi0tZm9ybWF0Il06CiAgICAgICAgICAgIGlmIHZhbHVlIG5vdCBpbiB0YWJ1bGF0ZV9mb3JtYXRzOgogICAgICAgICAgICAgICAgcHJpbnQoIiVzIGlzIG5vdCBhIHN1cHBvcnRlZCB0YWJsZSBmb3JtYXQiICUgdmFsdWUpCiAgICAgICAgICAgICAgICBwcmludCh1c2FnZSkKICAgICAgICAgICAgICAgIHN5cy5leGl0KDMpCiAgICAgICAgICAgIHRhYmxlZm10ID0gdmFsdWUKICAgICAgICBlbGlmIG9wdCBpbiBbIi1zIiwgIi0tc2VwIl06CiAgICAgICAgICAgIHNlcCA9IHZhbHVlCiAgICAgICAgZWxpZiBvcHQgaW4gWyItaCIsICItLWhlbHAiXToKICAgICAgICAgICAgcHJpbnQodXNhZ2UpCiAgICAgICAgICAgIHN5cy5leGl0KDApCiAgICBmaWxlcyA9IFtzeXMuc3RkaW5dIGlmIG5vdCBhcmdzIGVsc2UgYXJncwogICAgd2l0aCAoc3lzLnN0ZG91dCBpZiBvdXRmaWxlID09ICItIiBlbHNlIG9wZW4ob3V0ZmlsZSwgInciKSkgYXMgb3V0OgogICAgICAgIGZvciBmIGluIGZpbGVzOgogICAgICAgICAgICBpZiBmID09ICItIjoKICAgICAgICAgICAgICAgIGYgPSBzeXMuc3RkaW4KICAgICAgICAgICAgaWYgX2lzX2ZpbGUoZik6CiAgICAgICAgICAgICAgICBfcHByaW50X2ZpbGUoCiAgICAgICAgICAgICAgICAgICAgZiwKICAgICAgICAgICAgICAgICAgICBoZWFkZXJzPWhlYWRlcnMsCiAgICAgICAgICAgICAgICAgICAgdGFibGVmbXQ9dGFibGVmbXQsCiAgICAgICAgICAgICAgICAgICAgc2VwPXNlcCwKICAgICAgICAgICAgICAgICAgICBmbG9hdGZtdD1mbG9hdGZtdCwKICAgICAgICAgICAgICAgICAgICBpbnRmbXQ9aW50Zm10LAogICAgICAgICAgICAgICAgICAgIGZpbGU9b3V0LAogICAgICAgICAgICAgICAgICAgIGNvbGFsaWduPWNvbGFsaWduLAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgd2l0aCBvcGVuKGYpIGFzIGZvYmo6CiAgICAgICAgICAgICAgICAgICAgX3BwcmludF9maWxlKAogICAgICAgICAgICAgICAgICAgICAgICBmb2JqLAogICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzPWhlYWRlcnMsCiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlZm10PXRhYmxlZm10LAogICAgICAgICAgICAgICAgICAgICAgICBzZXA9c2VwLAogICAgICAgICAgICAgICAgICAgICAgICBmbG9hdGZtdD1mbG9hdGZtdCwKICAgICAgICAgICAgICAgICAgICAgICAgaW50Zm10PWludGZtdCwKICAgICAgICAgICAgICAgICAgICAgICAgZmlsZT1vdXQsCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbGFsaWduPWNvbGFsaWduLAogICAgICAgICAgICAgICAgICAgICkKCgpkZWYgX3BwcmludF9maWxlKGZvYmplY3QsIGhlYWRlcnMsIHRhYmxlZm10LCBzZXAsIGZsb2F0Zm10LCBpbnRmbXQsIGZpbGUsIGNvbGFsaWduKToKICAgIHJvd3MgPSBmb2JqZWN0LnJlYWRsaW5lcygpCiAgICB0YWJsZSA9IFtyZS5zcGxpdChzZXAsIHIucnN0cmlwKCkpIGZvciByIGluIHJvd3MgaWYgci5zdHJpcCgpXQogICAgcHJpbnQoCiAgICAgICAgdGFidWxhdGUoCiAgICAgICAgICAgIHRhYmxlLAogICAgICAgICAgICBoZWFkZXJzLAogICAgICAgICAgICB0YWJsZWZtdCwKICAgICAgICAgICAgZmxvYXRmbXQ9ZmxvYXRmbXQsCiAgICAgICAgICAgIGludGZtdD1pbnRmbXQsCiAgICAgICAgICAgIGNvbGFsaWduPWNvbGFsaWduLAogICAgICAgICksCiAgICAgICAgZmlsZT1maWxlLAogICAgKQoKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBfbWFpbigpCg==
