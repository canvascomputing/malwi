statistics:
  total_files: 1
  skipped_files: 0.0
  processed_objects: 1
  malicious_objects: 0
details:
- path: .repo_cache/malicious_repos/pypi_malregistry/python-aliyun-sdk-core/2.13.36/python-aliyun-sdk-core-2.13.36/python-aliyun-sdk-core-2.13.36/aliyunsdkcore/request.py
  contents:
  - name: AcsRequest.__init__
    score: 0.0
    code: |-
      def __init__(self, product, version=None,
                       action_name=None,
                       location_service_code=None,
                       location_endpoint_type='openAPI',
                       accept_format=None,
                       protocol_type=None,
                       method=None):
              """

              :param product:
              :param version:
              :param action_name:
              :param params:
              :param resource_owner_account:
              :param protocol_type:
              :param accept_format:
              :return:
              """
              self._version = version
              self._product = product
              self._action_name = action_name
              self._protocol_type = protocol_type
              if self._protocol_type is None:
                  self._protocol_type = _default_protocol_type

              self._accept_format = accept_format
              self._params = {}
              self._method = method
              self._header = {}
              if action_name is not None:
                  self.add_header('x-acs-action', action_name)
              if version is not None:
                  self.add_header('x-acs-version', version)
              self._body_params = {}
              self._uri_pattern = None
              self._uri_params = None
              self._content = None
              self._location_service_code = location_service_code
              self._location_endpoint_type = location_endpoint_type
              self.add_header('x-sdk-invoke-type', 'normal')
              self.endpoint = None
              self._extra_user_agent = {}
              self.string_to_sign = ''
              self._request_connect_timeout = None
              self._request_read_timeout = None
              self.request_network = "public"
              self.product_suffix = ""
              self.endpoint_map = None
              self.endpoint_regional = None
    tokens: resume load_fast version load_fast self store_attr _version load_fast product load_fast self store_attr _product load_fast action_name load_fast self store_attr _action_name load_fast protocol_type load_fast self store_attr _protocol_type load_fast self load_attr _protocol_type pop_jump_if_not_none TO_NUMBER load_global STRING_LEN_S_ENT_HIGH load_fast self store_attr _protocol_type load_fast accept_format load_fast self store_attr _accept_format build_map load_fast self store_attr _params load_fast method load_fast self store_attr _method build_map load_fast self store_attr _header load_fast action_name pop_jump_if_none TO_NUMBER load_fast self load_attr add_header load_const x-acs-action load_fast action_name call pop_top load_fast version pop_jump_if_none TO_NUMBER load_fast self load_attr add_header load_const x-acs-version load_fast version call pop_top build_map load_fast self store_attr _body_params load_const load_fast self store_attr _uri_pattern load_const load_fast self store_attr _uri_params load_const load_fast self store_attr _content load_fast STRING_LEN_S_ENT_HIGH load_fast self store_attr STRING_LEN_S_ENT_HIGH load_fast STRING_LEN_S_ENT_HIGH load_fast self store_attr STRING_LEN_S_ENT_HIGH load_fast self load_attr add_header load_const STRING_LEN_S_ENT_HIGH load_const normal call pop_top load_const load_fast self store_attr endpoint build_map load_fast self store_attr STRING_LEN_S_ENT_HIGH load_const load_fast self store_attr string_to_sign load_const load_fast self store_attr STRING_LEN_S_ENT_HIGH load_const load_fast self store_attr STRING_LEN_S_ENT_HIGH load_const public load_fast self store_attr request_network load_const load_fast self store_attr product_suffix load_const load_fast self store_attr endpoint_map load_const load_fast self store_attr STRING_LEN_S_ENT_HIGH return_const None
    hash: ed537c27a38d8f3f4beb054e07279f3e1327cecf69e56ba210b00b4dfcee0a97
sources:
  ? .repo_cache/malicious_repos/pypi_malregistry/python-aliyun-sdk-core/2.13.36/python-aliyun-sdk-core-2.13.36/python-aliyun-sdk-core-2.13.36/aliyunsdkcore/request.py
  : IyBMaWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24gKEFTRikgdW5kZXIgb25lCiMgb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiMgZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24KIyByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0YgbGljZW5zZXMgdGhpcyBmaWxlCiMgdG8geW91IHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQojICJMaWNlbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2UKIyB3aXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiMKIyAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCiMKIwojCiMgVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAojIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiMgIkFTIElTIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZCiMgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlCiMgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9ucwojIHVuZGVyIHRoZSBMaWNlbnNlLgoKIyBjb2Rpbmc9dXRmLTgKaW1wb3J0IGFiYwpmcm9tIGFsaXl1bnNka2NvcmUudmVuZG9yZWQuc2l4IGltcG9ydCBpdGVya2V5cwpmcm9tIGFsaXl1bnNka2NvcmUudmVuZG9yZWQuc2l4IGltcG9ydCBpdGVyaXRlbXMKZnJvbSBhbGl5dW5zZGtjb3JlLnZlbmRvcmVkLnNpeCBpbXBvcnQgYWRkX21ldGFjbGFzcwoKZnJvbSBhbGl5dW5zZGtjb3JlLmh0dHAgaW1wb3J0IHByb3RvY29sX3R5cGUKZnJvbSBhbGl5dW5zZGtjb3JlLmh0dHAgaW1wb3J0IG1ldGhvZF90eXBlIGFzIG10CmZyb20gYWxpeXVuc2RrY29yZS5odHRwIGltcG9ydCBmb3JtYXRfdHlwZSBhcyBmdApmcm9tIGFsaXl1bnNka2NvcmUuYXV0aC5jb21wb3NlciBpbXBvcnQgcnBjX3NpZ25hdHVyZV9jb21wb3NlciBhcyBycGNfc2lnbmVyCmZyb20gYWxpeXVuc2RrY29yZS5hdXRoLmNvbXBvc2VyIGltcG9ydCByb2Ffc2lnbmF0dXJlX2NvbXBvc2VyIGFzIHJvYV9zaWduZXIKZnJvbSBhbGl5dW5zZGtjb3JlLnV0aWxzLnBhcmFtZXRlcl9oZWxwZXIgaW1wb3J0IG1kNV9zdW0KZnJvbSBhbGl5dW5zZGtjb3JlLmF1dGguYWxnb3JpdGhtIGltcG9ydCBzaGFfaG1hYzEKZnJvbSBhbGl5dW5zZGtjb3JlLmFjc19leGNlcHRpb24gaW1wb3J0IGV4Y2VwdGlvbnMKZnJvbSBhbGl5dW5zZGtjb3JlLmFjc19leGNlcHRpb24gaW1wb3J0IGVycm9yX2NvZGUKZnJvbSBhbGl5dW5zZGtjb3JlLmNvbXBhdCBpbXBvcnQgZW5zdXJlX3N0cmluZwpmcm9tIGFsaXl1bnNka2NvcmUudmVuZG9yZWQucmVxdWVzdHMuc3RydWN0dXJlcyBpbXBvcnQgQ2FzZUluc2Vuc2l0aXZlRGljdAoKIiIiCkFjcyByZXF1ZXN0IG1vZGVsLgoiIiIKClNUWUxFX1JQQyA9ICdSUEMnClNUWUxFX1JPQSA9ICdST0EnCgpfZGVmYXVsdF9wcm90b2NvbF90eXBlID0gcHJvdG9jb2xfdHlwZS5IVFRQCgoKZGVmIHNldF9kZWZhdWx0X3Byb3RvY29sX3R5cGUodXNlcl9wcm90b2NvbF90eXBlKToKICAgIGdsb2JhbCBfZGVmYXVsdF9wcm90b2NvbF90eXBlCgogICAgaWYgdXNlcl9wcm90b2NvbF90eXBlID09IHByb3RvY29sX3R5cGUuSFRUUCBvciB1c2VyX3Byb3RvY29sX3R5cGUgPT0gcHJvdG9jb2xfdHlwZS5IVFRQUzoKICAgICAgICBfZGVmYXVsdF9wcm90b2NvbF90eXBlID0gdXNlcl9wcm90b2NvbF90eXBlCiAgICBlbHNlOgogICAgICAgIHJhaXNlIGV4Y2VwdGlvbnMuQ2xpZW50RXhjZXB0aW9uKAogICAgICAgICAgICBlcnJvcl9jb2RlLlNES19JTlZBTElEX1BBUkFNUywKICAgICAgICAgICAgIkludmFsaWQgJ3Byb3RvY29sX3R5cGUnLCBzaG91bGQgYmUgJ2h0dHAnIG9yICdodHRwcyciCiAgICAgICAgKQoKCmRlZiBnZXRfZGVmYXVsdF9wcm90b2NvbF90eXBlKCk6CiAgICByZXR1cm4gX2RlZmF1bHRfcHJvdG9jb2xfdHlwZQoKCkBhZGRfbWV0YWNsYXNzKGFiYy5BQkNNZXRhKQpjbGFzcyBBY3NSZXF1ZXN0OgogICAgIiIiCiAgICBBY3MgcmVxdWVzdCBiYXNlIGNsYXNzLiBUaGlzIGNsYXNzIHdyYXBzIHVwIGNvbW1vbiBwYXJhbWV0ZXJzIGZvciBhIHJlcXVlc3QuCiAgICAiIiIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgcHJvZHVjdCwgdmVyc2lvbj1Ob25lLAogICAgICAgICAgICAgICAgIGFjdGlvbl9uYW1lPU5vbmUsCiAgICAgICAgICAgICAgICAgbG9jYXRpb25fc2VydmljZV9jb2RlPU5vbmUsCiAgICAgICAgICAgICAgICAgbG9jYXRpb25fZW5kcG9pbnRfdHlwZT0nb3BlbkFQSScsCiAgICAgICAgICAgICAgICAgYWNjZXB0X2Zvcm1hdD1Ob25lLAogICAgICAgICAgICAgICAgIHByb3RvY29sX3R5cGU9Tm9uZSwKICAgICAgICAgICAgICAgICBtZXRob2Q9Tm9uZSk6CiAgICAgICAgIiIiCgogICAgICAgIDpwYXJhbSBwcm9kdWN0OgogICAgICAgIDpwYXJhbSB2ZXJzaW9uOgogICAgICAgIDpwYXJhbSBhY3Rpb25fbmFtZToKICAgICAgICA6cGFyYW0gcGFyYW1zOgogICAgICAgIDpwYXJhbSByZXNvdXJjZV9vd25lcl9hY2NvdW50OgogICAgICAgIDpwYXJhbSBwcm90b2NvbF90eXBlOgogICAgICAgIDpwYXJhbSBhY2NlcHRfZm9ybWF0OgogICAgICAgIDpyZXR1cm46CiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5fdmVyc2lvbiA9IHZlcnNpb24KICAgICAgICBzZWxmLl9wcm9kdWN0ID0gcHJvZHVjdAogICAgICAgIHNlbGYuX2FjdGlvbl9uYW1lID0gYWN0aW9uX25hbWUKICAgICAgICBzZWxmLl9wcm90b2NvbF90eXBlID0gcHJvdG9jb2xfdHlwZQogICAgICAgIGlmIHNlbGYuX3Byb3RvY29sX3R5cGUgaXMgTm9uZToKICAgICAgICAgICAgc2VsZi5fcHJvdG9jb2xfdHlwZSA9IF9kZWZhdWx0X3Byb3RvY29sX3R5cGUKCiAgICAgICAgc2VsZi5fYWNjZXB0X2Zvcm1hdCA9IGFjY2VwdF9mb3JtYXQKICAgICAgICBzZWxmLl9wYXJhbXMgPSB7fQogICAgICAgIHNlbGYuX21ldGhvZCA9IG1ldGhvZAogICAgICAgIHNlbGYuX2hlYWRlciA9IHt9CiAgICAgICAgaWYgYWN0aW9uX25hbWUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHNlbGYuYWRkX2hlYWRlcigneC1hY3MtYWN0aW9uJywgYWN0aW9uX25hbWUpCiAgICAgICAgaWYgdmVyc2lvbiBpcyBub3QgTm9uZToKICAgICAgICAgICAgc2VsZi5hZGRfaGVhZGVyKCd4LWFjcy12ZXJzaW9uJywgdmVyc2lvbikKICAgICAgICBzZWxmLl9ib2R5X3BhcmFtcyA9IHt9CiAgICAgICAgc2VsZi5fdXJpX3BhdHRlcm4gPSBOb25lCiAgICAgICAgc2VsZi5fdXJpX3BhcmFtcyA9IE5vbmUKICAgICAgICBzZWxmLl9jb250ZW50ID0gTm9uZQogICAgICAgIHNlbGYuX2xvY2F0aW9uX3NlcnZpY2VfY29kZSA9IGxvY2F0aW9uX3NlcnZpY2VfY29kZQogICAgICAgIHNlbGYuX2xvY2F0aW9uX2VuZHBvaW50X3R5cGUgPSBsb2NhdGlvbl9lbmRwb2ludF90eXBlCiAgICAgICAgc2VsZi5hZGRfaGVhZGVyKCd4LXNkay1pbnZva2UtdHlwZScsICdub3JtYWwnKQogICAgICAgIHNlbGYuZW5kcG9pbnQgPSBOb25lCiAgICAgICAgc2VsZi5fZXh0cmFfdXNlcl9hZ2VudCA9IHt9CiAgICAgICAgc2VsZi5zdHJpbmdfdG9fc2lnbiA9ICcnCiAgICAgICAgc2VsZi5fcmVxdWVzdF9jb25uZWN0X3RpbWVvdXQgPSBOb25lCiAgICAgICAgc2VsZi5fcmVxdWVzdF9yZWFkX3RpbWVvdXQgPSBOb25lCiAgICAgICAgc2VsZi5yZXF1ZXN0X25ldHdvcmsgPSAicHVibGljIgogICAgICAgIHNlbGYucHJvZHVjdF9zdWZmaXggPSAiIgogICAgICAgIHNlbGYuZW5kcG9pbnRfbWFwID0gTm9uZQogICAgICAgIHNlbGYuZW5kcG9pbnRfcmVnaW9uYWwgPSBOb25lCgogICAgZGVmIGFkZF9xdWVyeV9wYXJhbShzZWxmLCBrLCB2KToKICAgICAgICBzZWxmLl9wYXJhbXNba10gPSB2CgogICAgZGVmIGFkZF9ib2R5X3BhcmFtcyhzZWxmLCBrLCB2KToKICAgICAgICBzZWxmLl9ib2R5X3BhcmFtc1trXSA9IHYKCiAgICBkZWYgZ2V0X2JvZHlfcGFyYW1zKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLl9ib2R5X3BhcmFtcwoKICAgIGRlZiBnZXRfdXJpX3BhdHRlcm4oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuX3VyaV9wYXR0ZXJuCgogICAgZGVmIGdldF91cmlfcGFyYW1zKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLl91cmlfcGFyYW1zCgogICAgZGVmIGdldF9wcm9kdWN0KHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLl9wcm9kdWN0CgogICAgZGVmIGdldF92ZXJzaW9uKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLl92ZXJzaW9uCgogICAgZGVmIGdldF9hY3Rpb25fbmFtZShzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5fYWN0aW9uX25hbWUKCiAgICBkZWYgZ2V0X2FjY2VwdF9mb3JtYXQoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuX2FjY2VwdF9mb3JtYXQKCiAgICBkZWYgZ2V0X3Byb3RvY29sX3R5cGUoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuX3Byb3RvY29sX3R5cGUKCiAgICBkZWYgZ2V0X3F1ZXJ5X3BhcmFtcyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5fcGFyYW1zCgogICAgZGVmIGdldF9tZXRob2Qoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuX21ldGhvZAoKICAgIGRlZiBzZXRfdXJpX3BhdHRlcm4oc2VsZiwgcGF0dGVybik6CiAgICAgICAgc2VsZi5fdXJpX3BhdHRlcm4gPSBwYXR0ZXJuCgogICAgZGVmIHNldF91cmlfcGFyYW1zKHNlbGYsIHBhcmFtcyk6CiAgICAgICAgc2VsZi5fdXJpX3BhcmFtcyA9IHBhcmFtcwoKICAgIGRlZiBzZXRfbWV0aG9kKHNlbGYsIG1ldGhvZCk6CiAgICAgICAgc2VsZi5fbWV0aG9kID0gbWV0aG9kCgogICAgZGVmIHNldF9wcm9kdWN0KHNlbGYsIHByb2R1Y3QpOgogICAgICAgIHNlbGYuX3Byb2R1Y3QgPSBwcm9kdWN0CgogICAgZGVmIHNldF92ZXJzaW9uKHNlbGYsIHZlcnNpb24pOgogICAgICAgIHNlbGYuX2hlYWRlclsneC1hY3MtdmVyc2lvbiddID0gdmVyc2lvbgogICAgICAgIHNlbGYuX3ZlcnNpb24gPSB2ZXJzaW9uCgogICAgZGVmIHNldF9hY3Rpb25fbmFtZShzZWxmLCBhY3Rpb25fbmFtZSk6CiAgICAgICAgc2VsZi5faGVhZGVyWyd4LWFjcy1hY3Rpb24nXSA9IGFjdGlvbl9uYW1lCiAgICAgICAgc2VsZi5fYWN0aW9uX25hbWUgPSBhY3Rpb25fbmFtZQoKICAgIGRlZiBzZXRfYWNjZXB0X2Zvcm1hdChzZWxmLCBhY2NlcHRfZm9ybWF0KToKICAgICAgICBzZWxmLl9hY2NlcHRfZm9ybWF0ID0gYWNjZXB0X2Zvcm1hdAoKICAgIGRlZiBzZXRfcHJvdG9jb2xfdHlwZShzZWxmLCBwcm90b2NvbF90eXBlKToKICAgICAgICBzZWxmLl9wcm90b2NvbF90eXBlID0gcHJvdG9jb2xfdHlwZQoKICAgIGRlZiBzZXRfcXVlcnlfcGFyYW1zKHNlbGYsIHBhcmFtcyk6CiAgICAgICAgc2VsZi5fcGFyYW1zID0gcGFyYW1zCgogICAgZGVmIHNldF9ib2R5X3BhcmFtcyhzZWxmLCBib2R5X3BhcmFtcyk6CiAgICAgICAgc2VsZi5fYm9keV9wYXJhbXMgPSBib2R5X3BhcmFtcwoKICAgIGRlZiBzZXRfY29udGVudChzZWxmLCBjb250ZW50KToKICAgICAgICAiIiIKCiAgICAgICAgOnBhcmFtIGNvbnRlbnQ6IEJ5dGVBcnJheQogICAgICAgIDpyZXR1cm46CiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5fY29udGVudCA9IGNvbnRlbnQKCiAgICBkZWYgZ2V0X2NvbnRlbnQoc2VsZik6CiAgICAgICAgIiIiCgogICAgICAgIDpyZXR1cm46IEJ5dGVBcnJheQogICAgICAgICIiIgogICAgICAgIHJldHVybiBzZWxmLl9jb250ZW50CgogICAgZGVmIGdldF9oZWFkZXJzKHNlbGYpOgogICAgICAgICIiIgoKICAgICAgICA6cmV0dXJuOiBEaWN0CiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIHNlbGYuX2hlYWRlcgoKICAgIGRlZiBzZXRfaGVhZGVycyhzZWxmLCBoZWFkZXJzKToKICAgICAgICAiIiIKCiAgICAgICAgOnBhcmFtIGhlYWRlcnM6IERpY3QKICAgICAgICA6cmV0dXJuOgogICAgICAgICIiIgogICAgICAgIHNlbGYuX2hlYWRlciA9IGhlYWRlcnMKCiAgICBkZWYgYWRkX2hlYWRlcihzZWxmLCBrLCB2KToKICAgICAgICBzZWxmLl9oZWFkZXJba10gPSB2CgogICAgZGVmIHNldF91c2VyX2FnZW50KHNlbGYsIGFnZW50KToKICAgICAgICBzZWxmLmFkZF9oZWFkZXIoJ1VzZXItQWdlbnQnLCBhZ2VudCkKCiAgICBkZWYgYXBwZW5kX3VzZXJfYWdlbnQoc2VsZiwga2V5LCB2YWx1ZSk6CiAgICAgICAgc2VsZi5fZXh0cmFfdXNlcl9hZ2VudC51cGRhdGUoe2tleTogdmFsdWV9KQoKICAgIGRlZiByZXF1ZXN0X3VzZXJfYWdlbnQoc2VsZik6CiAgICAgICAgcmVxdWVzdF91c2VyX2FnZW50ID0ge30KICAgICAgICBpZiAnVXNlci1BZ2VudCcgaW4gc2VsZi5nZXRfaGVhZGVycygpOgogICAgICAgICAgICByZXF1ZXN0X3VzZXJfYWdlbnQudXBkYXRlKHsKICAgICAgICAgICAgICAgICdyZXF1ZXN0Jzogc2VsZi5nZXRfaGVhZGVycygpLmdldCgnVXNlci1BZ2VudCcpCiAgICAgICAgICAgIH0pCgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJlcXVlc3RfdXNlcl9hZ2VudC51cGRhdGUoc2VsZi5fZXh0cmFfdXNlcl9hZ2VudCkKCiAgICAgICAgcmV0dXJuIENhc2VJbnNlbnNpdGl2ZURpY3QocmVxdWVzdF91c2VyX2FnZW50KQoKICAgIGRlZiBzZXRfbG9jYXRpb25fc2VydmljZV9jb2RlKHNlbGYsIGxvY2F0aW9uX3NlcnZpY2VfY29kZSk6CiAgICAgICAgc2VsZi5fbG9jYXRpb25fc2VydmljZV9jb2RlID0gbG9jYXRpb25fc2VydmljZV9jb2RlCgogICAgZGVmIGdldF9sb2NhdGlvbl9zZXJ2aWNlX2NvZGUoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuX2xvY2F0aW9uX3NlcnZpY2VfY29kZQoKICAgIGRlZiBnZXRfbG9jYXRpb25fZW5kcG9pbnRfdHlwZShzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5fbG9jYXRpb25fZW5kcG9pbnRfdHlwZQoKICAgIGRlZiBzZXRfY29udGVudF90eXBlKHNlbGYsIGNvbnRlbnRfdHlwZSk6CiAgICAgICAgc2VsZi5hZGRfaGVhZGVyKCJDb250ZW50LVR5cGUiLCBjb250ZW50X3R5cGUpCgogICAgQGFiYy5hYnN0cmFjdG1ldGhvZAogICAgZGVmIGdldF9zdHlsZShzZWxmKToKICAgICAgICBwYXNzCgogICAgQGFiYy5hYnN0cmFjdG1ldGhvZAogICAgZGVmIGdldF91cmwoc2VsZiwgcmVnaW9uX2lkLCBhaywgc2VjcmV0KToKICAgICAgICBwYXNzCgogICAgQGFiYy5hYnN0cmFjdG1ldGhvZAogICAgZGVmIGdldF9zaWduZWRfaGVhZGVyKHNlbGYsIHJlZ2lvbl9pZCwgYWssIHNlY3JldCk6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzZXRfZW5kcG9pbnQoc2VsZiwgZW5kcG9pbnQpOgogICAgICAgIHNlbGYuZW5kcG9pbnQgPSBlbmRwb2ludAoKICAgIGRlZiBnZXRfY29ubmVjdF90aW1lb3V0KHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLl9yZXF1ZXN0X2Nvbm5lY3RfdGltZW91dAoKICAgIGRlZiBzZXRfY29ubmVjdF90aW1lb3V0KHNlbGYsIGNvbm5lY3RfdGltZW91dCk6CiAgICAgICAgc2VsZi5fcmVxdWVzdF9jb25uZWN0X3RpbWVvdXQgPSBjb25uZWN0X3RpbWVvdXQKCiAgICBkZWYgZ2V0X3JlYWRfdGltZW91dChzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5fcmVxdWVzdF9yZWFkX3RpbWVvdXQKCiAgICBkZWYgc2V0X3JlYWRfdGltZW91dChzZWxmLCByZWFkX3RpbWVvdXQpOgogICAgICAgIHNlbGYuX3JlcXVlc3RfcmVhZF90aW1lb3V0ID0gcmVhZF90aW1lb3V0CgoKY2xhc3MgUnBjUmVxdWVzdChBY3NSZXF1ZXN0KToKICAgICIiIgogICAgQ2xhc3MgdG8gY29tcG9zZSBhbiBSUEMgc3R5bGUgcmVxdWVzdCB3aXRoLgogICAgIiIiCgogICAgZGVmIF9faW5pdF9fKAogICAgICAgICAgICBzZWxmLAogICAgICAgICAgICBwcm9kdWN0LAogICAgICAgICAgICB2ZXJzaW9uLAogICAgICAgICAgICBhY3Rpb25fbmFtZSwKICAgICAgICAgICAgbG9jYXRpb25fc2VydmljZV9jb2RlPU5vbmUsCiAgICAgICAgICAgIGxvY2F0aW9uX2VuZHBvaW50X3R5cGU9J29wZW5BUEknLAogICAgICAgICAgICBmb3JtYXQ9Tm9uZSwKICAgICAgICAgICAgcHJvdG9jb2w9Tm9uZSwKICAgICAgICAgICAgc2lnbmVyPXNoYV9obWFjMSk6CiAgICAgICAgQWNzUmVxdWVzdC5fX2luaXRfXygKICAgICAgICAgICAgc2VsZiwKICAgICAgICAgICAgcHJvZHVjdCwKICAgICAgICAgICAgdmVyc2lvbiwKICAgICAgICAgICAgYWN0aW9uX25hbWUsCiAgICAgICAgICAgIGxvY2F0aW9uX3NlcnZpY2VfY29kZSwKICAgICAgICAgICAgbG9jYXRpb25fZW5kcG9pbnRfdHlwZSwKICAgICAgICAgICAgZm9ybWF0LAogICAgICAgICAgICBwcm90b2NvbCwKICAgICAgICAgICAgbXQuR0VUKQogICAgICAgIHNlbGYuX3N0eWxlID0gU1RZTEVfUlBDCiAgICAgICAgc2VsZi5fc2lnbmVyID0gc2lnbmVyCgogICAgZGVmIGdldF9zdHlsZShzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5fc3R5bGUKCiAgICBkZWYgX2dldF9zaWduX3BhcmFtcyhzZWxmKToKICAgICAgICByZXFfcGFyYW1zID0gc2VsZi5nZXRfcXVlcnlfcGFyYW1zKCkKICAgICAgICBpZiByZXFfcGFyYW1zIGlzIE5vbmU6CiAgICAgICAgICAgIHJlcV9wYXJhbXMgPSB7fQogICAgICAgIHJlcV9wYXJhbXNbJ1ZlcnNpb24nXSA9IHNlbGYuZ2V0X3ZlcnNpb24oKQogICAgICAgIHJlcV9wYXJhbXNbJ0FjdGlvbiddID0gc2VsZi5nZXRfYWN0aW9uX25hbWUoKQogICAgICAgIHJlcV9wYXJhbXNbJ0Zvcm1hdCddID0gc2VsZi5nZXRfYWNjZXB0X2Zvcm1hdCgpCgogICAgICAgIHJldHVybiByZXFfcGFyYW1zCgogICAgZGVmIGdldF91cmwoc2VsZiwgcmVnaW9uX2lkLCBhY2Nlc3Nfa2V5X2lkLCBhY2Nlc3Nfa2V5X3NlY3JldCk6CiAgICAgICAgc2lnbl9wYXJhbXMgPSBkaWN0KHNlbGYuX2dldF9zaWduX3BhcmFtcygpKQogICAgICAgIGlmICdSZWdpb25JZCcgbm90IGluIGl0ZXJrZXlzKHNpZ25fcGFyYW1zKToKICAgICAgICAgICAgc2lnbl9wYXJhbXNbJ1JlZ2lvbklkJ10gPSByZWdpb25faWQKICAgICAgICB1cmwsIHN0cmluZ190b19zaWduID0gcnBjX3NpZ25lci5nZXRfc2lnbmVkX3VybCgKICAgICAgICAgICAgc2lnbl9wYXJhbXMsCiAgICAgICAgICAgIGFjY2Vzc19rZXlfaWQsCiAgICAgICAgICAgIGFjY2Vzc19rZXlfc2VjcmV0LAogICAgICAgICAgICBzZWxmLmdldF9hY2NlcHRfZm9ybWF0KCksCiAgICAgICAgICAgIHNlbGYuZ2V0X21ldGhvZCgpLAogICAgICAgICAgICBzZWxmLmdldF9ib2R5X3BhcmFtcygpLAogICAgICAgICAgICBzZWxmLl9zaWduZXIpCiAgICAgICAgc2VsZi5zdHJpbmdfdG9fc2lnbiA9IHN0cmluZ190b19zaWduCiAgICAgICAgcmV0dXJuIHVybAoKICAgIGRlZiBnZXRfc2lnbmVkX2hlYWRlcihzZWxmLCByZWdpb25faWQ9Tm9uZSwgYWs9Tm9uZSwgc2VjcmV0PU5vbmUpOgogICAgICAgIGhlYWRlcnMgPSB7fQogICAgICAgIGZvciBoZWFkZXJLZXksIGhlYWRlclZhbHVlIGluIGl0ZXJpdGVtcyhzZWxmLmdldF9oZWFkZXJzKCkpOgogICAgICAgICAgICBpZiBoZWFkZXJLZXkuc3RhcnRzd2l0aCgieC1hY3MtIikgb3IgaGVhZGVyS2V5LnN0YXJ0c3dpdGgoIngtc2RrLSIpOgogICAgICAgICAgICAgICAgaGVhZGVyc1toZWFkZXJLZXldID0gaGVhZGVyVmFsdWUKICAgICAgICByZXR1cm4gaGVhZGVycwoKCmNsYXNzIFJvYVJlcXVlc3QoQWNzUmVxdWVzdCk6CiAgICAiIiIKICAgIENsYXNzIHRvIGNvbXBvc2UgYW4gUk9BIHN0eWxlIHJlcXVlc3Qgd2l0aC4KICAgICIiIgoKICAgIGRlZiBfX2luaXRfXygKICAgICAgICAgICAgc2VsZiwKICAgICAgICAgICAgcHJvZHVjdCwKICAgICAgICAgICAgdmVyc2lvbiwKICAgICAgICAgICAgYWN0aW9uX25hbWUsCiAgICAgICAgICAgIGxvY2F0aW9uX3NlcnZpY2VfY29kZT1Ob25lLAogICAgICAgICAgICBsb2NhdGlvbl9lbmRwb2ludF90eXBlPSdvcGVuQVBJJywKICAgICAgICAgICAgbWV0aG9kPU5vbmUsCiAgICAgICAgICAgIGhlYWRlcnM9Tm9uZSwKICAgICAgICAgICAgdXJpX3BhdHRlcm49Tm9uZSwKICAgICAgICAgICAgcGF0aF9wYXJhbXM9Tm9uZSwKICAgICAgICAgICAgcHJvdG9jb2w9Tm9uZSk6CiAgICAgICAgIiIiCgogICAgICAgIDpwYXJhbSBwcm9kdWN0OiBTdHJpbmcsIG1hbmRhdG9yeQogICAgICAgIDpwYXJhbSB2ZXJzaW9uOiBTdHJpbmcsIG1hbmRhdG9yeQogICAgICAgIDpwYXJhbSBhY3Rpb25fbmFtZTogU3RyaW5nLCBtYW5kYXRvcnkKICAgICAgICA6cGFyYW0gbWV0aG9kOiBTdHJpbmcKICAgICAgICA6cGFyYW0gaGVhZGVyczogRGljdAogICAgICAgIDpwYXJhbSB1cmlfcGF0dGVybjogU3RyaW5nCiAgICAgICAgOnBhcmFtIHBhdGhfcGFyYW1zOiBEaWN0CiAgICAgICAgOnBhcmFtIHByb3RvY29sOiBTdHJpbmcKICAgICAgICA6cmV0dXJuOgogICAgICAgICIiIgogICAgICAgIEFjc1JlcXVlc3QuX19pbml0X18oCiAgICAgICAgICAgIHNlbGYsCiAgICAgICAgICAgIHByb2R1Y3QsCiAgICAgICAgICAgIHZlcnNpb24sCiAgICAgICAgICAgIGFjdGlvbl9uYW1lLAogICAgICAgICAgICBsb2NhdGlvbl9zZXJ2aWNlX2NvZGUsCiAgICAgICAgICAgIGxvY2F0aW9uX2VuZHBvaW50X3R5cGUsCiAgICAgICAgICAgIGZ0LlJBVywKICAgICAgICAgICAgcHJvdG9jb2wsCiAgICAgICAgICAgIG1ldGhvZCkKICAgICAgICBzZWxmLl9zdHlsZSA9IFNUWUxFX1JPQQogICAgICAgIHNlbGYuX21ldGhvZCA9IG1ldGhvZAogICAgICAgIGlmIGhlYWRlcnMgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHNlbGYuX2hlYWRlciA9IGhlYWRlcnMKICAgICAgICBzZWxmLl91cmlfcGF0dGVybiA9IHVyaV9wYXR0ZXJuCiAgICAgICAgc2VsZi5fcGF0aF9wYXJhbXMgPSBwYXRoX3BhcmFtcwoKICAgIGRlZiBnZXRfc3R5bGUoc2VsZik6CiAgICAgICAgIiIiCgogICAgICAgIDpyZXR1cm46IFN0cmluZwogICAgICAgICIiIgogICAgICAgIHJldHVybiBzZWxmLl9zdHlsZQoKICAgIGRlZiBnZXRfcGF0aF9wYXJhbXMoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuX3BhdGhfcGFyYW1zCgogICAgZGVmIHNldF9wYXRoX3BhcmFtcyhzZWxmLCBwYXRoX3BhcmFtcyk6CiAgICAgICAgc2VsZi5fcGF0aF9wYXJhbXMgPSBwYXRoX3BhcmFtcwoKICAgIGRlZiBhZGRfcGF0aF9wYXJhbShzZWxmLCBrLCB2KToKICAgICAgICBpZiBzZWxmLl9wYXRoX3BhcmFtcyBpcyBOb25lOgogICAgICAgICAgICBzZWxmLl9wYXRoX3BhcmFtcyA9IHt9CiAgICAgICAgc2VsZi5fcGF0aF9wYXJhbXNba10gPSB2CgogICAgZGVmIF9nZXRfc2lnbl9wYXJhbXMoc2VsZik6CiAgICAgICAgcmVxX3BhcmFtcyA9IHNlbGYuZ2V0X3F1ZXJ5X3BhcmFtcygpCiAgICAgICAgaWYgcmVxX3BhcmFtcyBpcyBOb25lOgogICAgICAgICAgICByZXFfcGFyYW1zID0ge30KICAgICAgICBzZWxmLmFkZF9oZWFkZXIoIngtYWNzLXZlcnNpb24iLCBzZWxmLmdldF92ZXJzaW9uKCkpCiAgICAgICAgIyByZXFfcGFyYW1zWydWZXJzaW9uJ10gPSBzZWxmLmdldF92ZXJzaW9uKCkKICAgICAgICAjIHJlcV9wYXJhbXNbJ0FjdGlvbiddID0gc2VsZi5nZXRfYWN0aW9uX25hbWUoKQogICAgICAgICMgcmVxX3BhcmFtc1snRm9ybWF0J10gPSBzZWxmLmdldF9hY2NlcHRfZm9ybWF0KCkKICAgICAgICByZXR1cm4gcmVxX3BhcmFtcwoKICAgIGRlZiBnZXRfc2lnbmVkX2hlYWRlcihzZWxmLCByZWdpb25faWQsIGFrLCBzZWNyZXQpOgogICAgICAgICIiIgogICAgICAgIEdlbmVyYXRlIHNpZ25lZCBoZWFkZXIKICAgICAgICA6cGFyYW0gcmVnaW9uX2lkOiBTdHJpbmcKICAgICAgICA6cGFyYW0gYWs6IFN0cmluZwogICAgICAgIDpwYXJhbSBzZWNyZXQ6IFN0cmluZwogICAgICAgIDpyZXR1cm46IERpY3QKICAgICAgICAiIiIKICAgICAgICBzaWduX3BhcmFtcyA9IGRpY3Qoc2VsZi5fZ2V0X3NpZ25fcGFyYW1zKCkpCiAgICAgICAgaWYgc2VsZi5nZXRfY29udGVudCgpIGlzIG5vdCBOb25lOgogICAgICAgICAgICBzZWxmLmFkZF9oZWFkZXIoCiAgICAgICAgICAgICAgICAnQ29udGVudC1NRDUnLCBtZDVfc3VtKHNlbGYuZ2V0X2NvbnRlbnQoKSkpCiAgICAgICAgaWYgJ1JlZ2lvbklkJyBub3QgaW4gc2lnbl9wYXJhbXMua2V5cygpOgogICAgICAgICAgICBzaWduX3BhcmFtc1snUmVnaW9uSWQnXSA9IHJlZ2lvbl9pZAogICAgICAgICAgICBzZWxmLmFkZF9oZWFkZXIoJ3gtYWNzLXJlZ2lvbi1pZCcsIHN0cihyZWdpb25faWQpKQoKICAgICAgICBzaWduZWRfaGVhZGVycywgc2lnbl90b19zdHJpbmcgPSByb2Ffc2lnbmVyLmdldF9zaWduYXR1cmVfaGVhZGVycygKICAgICAgICAgICAgc2lnbl9wYXJhbXMsCiAgICAgICAgICAgIGFrLAogICAgICAgICAgICBzZWNyZXQsCiAgICAgICAgICAgIHNlbGYuZ2V0X2FjY2VwdF9mb3JtYXQoKSwKICAgICAgICAgICAgc2VsZi5nZXRfaGVhZGVycygpLmNvcHkoKSwKICAgICAgICAgICAgc2VsZi5nZXRfdXJpX3BhdHRlcm4oKSwKICAgICAgICAgICAgc2VsZi5nZXRfcGF0aF9wYXJhbXMoKSwKICAgICAgICAgICAgc2VsZi5nZXRfbWV0aG9kKCkpCiAgICAgICAgc2VsZi5zdHJpbmdfdG9fc2lnbiA9IHNpZ25fdG9fc3RyaW5nCiAgICAgICAgcmV0dXJuIHNpZ25lZF9oZWFkZXJzCgogICAgZGVmIGdldF91cmwoc2VsZiwgcmVnaW9uX2lkLCBhaz1Ob25lLCBzZWNyZXQ9Tm9uZSk6CiAgICAgICAgIiIiCiAgICAgICAgQ29tcG9zZSByZXF1ZXN0IHVybCB3aXRob3V0IGRvbWFpbgogICAgICAgIDpwYXJhbSByZWdpb25faWQ6IFN0cmluZwogICAgICAgIDpyZXR1cm46IFN0cmluZwogICAgICAgICIiIgogICAgICAgIHNpZ25fcGFyYW1zID0gZGljdChzZWxmLmdldF9xdWVyeV9wYXJhbXMoKSkKICAgICAgICBpZiAnUmVnaW9uSWQnIG5vdCBpbiBzaWduX3BhcmFtcy5rZXlzKCk6CiAgICAgICAgICAgIHNpZ25fcGFyYW1zWydSZWdpb25JZCddID0gcmVnaW9uX2lkCiAgICAgICAgdXJsID0gcm9hX3NpZ25lci5nZXRfdXJsKAogICAgICAgICAgICBzZWxmLmdldF91cmlfcGF0dGVybigpLAogICAgICAgICAgICBzaWduX3BhcmFtcywKICAgICAgICAgICAgc2VsZi5nZXRfcGF0aF9wYXJhbXMoKSkKICAgICAgICByZXR1cm4gdXJsCgoKY2xhc3MgQ29tbW9uUmVxdWVzdChBY3NSZXF1ZXN0KToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBkb21haW49Tm9uZSwgdmVyc2lvbj1Ob25lLCBhY3Rpb25fbmFtZT1Ob25lLCB1cmlfcGF0dGVybj1Ob25lLCBwcm9kdWN0PU5vbmUsCiAgICAgICAgICAgICAgICAgbG9jYXRpb25fZW5kcG9pbnRfdHlwZT0nb3BlbkFQSScpOgogICAgICAgIHN1cGVyKENvbW1vblJlcXVlc3QsIHNlbGYpLl9faW5pdF9fKHByb2R1Y3QsIHZlcnNpb24sIGFjdGlvbl9uYW1lKQoKICAgICAgICBzZWxmLnJlcXVlc3QgPSBOb25lCiAgICAgICAgc2VsZi5lbmRwb2ludCA9IGRvbWFpbgogICAgICAgIHNlbGYuX3ZlcnNpb24gPSB2ZXJzaW9uCiAgICAgICAgc2VsZi5fYWN0aW9uX25hbWUgPSBhY3Rpb25fbmFtZQogICAgICAgIHNlbGYuX3VyaV9wYXR0ZXJuID0gdXJpX3BhdHRlcm4KICAgICAgICBzZWxmLl9wcm9kdWN0ID0gcHJvZHVjdAogICAgICAgIHNlbGYuX2xvY2F0aW9uX2VuZHBvaW50X3R5cGUgPSBsb2NhdGlvbl9lbmRwb2ludF90eXBlCiAgICAgICAgc2VsZi5fc2lnbmVyID0gc2hhX2htYWMxCiAgICAgICAgc2VsZi5hZGRfaGVhZGVyKCd4LXNkay1pbnZva2UtdHlwZScsICdjb21tb24nKQogICAgICAgIHNlbGYuX3BhdGhfcGFyYW1zID0gTm9uZQogICAgICAgIHNlbGYuX21ldGhvZCA9ICJHRVQiCgogICAgZGVmIGdldF9wYXRoX3BhcmFtcyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5fcGF0aF9wYXJhbXMKCiAgICBkZWYgc2V0X3BhdGhfcGFyYW1zKHNlbGYsIHBhdGhfcGFyYW1zKToKICAgICAgICBzZWxmLl9wYXRoX3BhcmFtcyA9IHBhdGhfcGFyYW1zCgogICAgZGVmIGFkZF9wYXRoX3BhcmFtKHNlbGYsIGssIHYpOgogICAgICAgIGlmIHNlbGYuX3BhdGhfcGFyYW1zIGlzIE5vbmU6CiAgICAgICAgICAgIHNlbGYuX3BhdGhfcGFyYW1zID0ge30KICAgICAgICBzZWxmLl9wYXRoX3BhcmFtc1trXSA9IHYKCiAgICBkZWYgc2V0X2RvbWFpbihzZWxmLCBkb21haW4pOgogICAgICAgIHNlbGYuZW5kcG9pbnQgPSBkb21haW4KCiAgICBkZWYgZ2V0X2RvbWFpbihzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5lbmRwb2ludAoKICAgIGRlZiBzZXRfdXJpX3BhdHRlcm4oc2VsZiwgdXJpX3BhdHRlcm4pOgogICAgICAgIHNlbGYuX3VyaV9wYXR0ZXJuID0gdXJpX3BhdHRlcm4KCiAgICBkZWYgZ2V0X3VyaV9wYXR0ZXJuKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLl91cmlfcGF0dGVybgoKICAgIGRlZiBzZXRfcHJvZHVjdChzZWxmLCBwcm9kdWN0KToKICAgICAgICBzZWxmLl9wcm9kdWN0ID0gcHJvZHVjdAoKICAgIGRlZiBnZXRfcHJvZHVjdChzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5fcHJvZHVjdAoKICAgIGRlZiB0cmFuc190b19hY3NfcmVxdWVzdChzZWxmKToKICAgICAgICBpZiBub3Qgc2VsZi5fdmVyc2lvbjoKICAgICAgICAgICAgcmFpc2UgZXhjZXB0aW9ucy5DbGllbnRFeGNlcHRpb24oCiAgICAgICAgICAgICAgICBlcnJvcl9jb2RlLlNES19JTlZBTElEX1BBUkFNUywKICAgICAgICAgICAgICAgICdjb21tb24gcGFyYW1zIFt2ZXJzaW9uXSBpcyByZXF1aXJlZCwgY2Fubm90IGJlIGVtcHR5JykKICAgICAgICBpZiBub3Qgc2VsZi5fYWN0aW9uX25hbWUgYW5kIG5vdCBzZWxmLl91cmlfcGF0dGVybjoKICAgICAgICAgICAgcmFpc2UgZXhjZXB0aW9ucy5DbGllbnRFeGNlcHRpb24oCiAgICAgICAgICAgICAgICBlcnJvcl9jb2RlLlNES19JTlZBTElEX1BBUkFNUywKICAgICAgICAgICAgICAgICdBdCBsZWFzdCBvbmUgb2YgW2FjdGlvbl0gYW5kIFt1cmlfcGF0dGVybl0gaGFzIGEgdmFsdWUnKQogICAgICAgIGlmIG5vdCBzZWxmLmVuZHBvaW50IGFuZCBub3Qgc2VsZi5fcHJvZHVjdDoKICAgICAgICAgICAgcmFpc2UgZXhjZXB0aW9ucy5DbGllbnRFeGNlcHRpb24oCiAgICAgICAgICAgICAgICBlcnJvcl9jb2RlLlNES19JTlZBTElEX1BBUkFNUywKICAgICAgICAgICAgICAgICdBdCBsZWFzdCBvbmUgb2YgW2RvbWFpbl0gYW5kIFtwcm9kdWN0X25hbWVdIGhhcyBhIHZhbHVlJykKCiAgICAgICAgaWYgc2VsZi5fdXJpX3BhdHRlcm46CiAgICAgICAgICAgIHNlbGYuX3N0eWxlID0gU1RZTEVfUk9BCiAgICAgICAgICAgIHNlbGYucmVxdWVzdCA9IFJvYVJlcXVlc3QocHJvZHVjdD1zZWxmLmdldF9wcm9kdWN0KCksIHZlcnNpb249c2VsZi5nZXRfdmVyc2lvbigpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbl9uYW1lPXNlbGYuZ2V0X2FjdGlvbl9uYW1lKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25fZW5kcG9pbnRfdHlwZT1zZWxmLmdldF9sb2NhdGlvbl9lbmRwb2ludF90eXBlKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIHNlbGYuZmlsbF9wYXJhbXMoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuX3N0eWxlID0gU1RZTEVfUlBDCiAgICAgICAgICAgIHNlbGYucmVxdWVzdCA9IFJwY1JlcXVlc3QocHJvZHVjdD1zZWxmLmdldF9wcm9kdWN0KCksIHZlcnNpb249c2VsZi5nZXRfdmVyc2lvbigpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbl9uYW1lPXNlbGYuZ2V0X2FjdGlvbl9uYW1lKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25fZW5kcG9pbnRfdHlwZT1zZWxmLmdldF9sb2NhdGlvbl9lbmRwb2ludF90eXBlKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICBzZWxmLmZpbGxfcGFyYW1zKCkKCiAgICBkZWYgZ2V0X3N0eWxlKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLl9zdHlsZQoKICAgIGRlZiBnZXRfdXJsKHNlbGYsIHJlZ2lvbl9pZCwgYWssIHNlY3JldCk6CiAgICAgICAgcmV0dXJuIHNlbGYucmVxdWVzdC5nZXRfdXJsKHJlZ2lvbl9pZCwgYWssIHNlY3JldCkKCiAgICBkZWYgZ2V0X3NpZ25lZF9oZWFkZXIoc2VsZiwgcmVnaW9uX2lkLCBhY2Nlc3Nfa2V5X2lkLCBhY2Nlc3Nfa2V5X3NlY3JldCk6CiAgICAgICAgcmV0dXJuIHNlbGYucmVxdWVzdC5nZXRfc2lnbmVkX2hlYWRlcihyZWdpb25faWQsIGFjY2Vzc19rZXlfaWQsIGFjY2Vzc19rZXlfc2VjcmV0KQoKICAgIGRlZiBmaWxsX3BhcmFtcyhzZWxmKToKCiAgICAgICAgc2VsZi5yZXF1ZXN0LnNldF91cmlfcGF0dGVybihzZWxmLmdldF91cmlfcGF0dGVybigpKQoKICAgICAgICBzZWxmLnJlcXVlc3Quc2V0X3VyaV9wYXJhbXMoc2VsZi5nZXRfdXJpX3BhcmFtcygpKQoKICAgICAgICBpZiBzZWxmLmdldF9zdHlsZSgpID09IFNUWUxFX1JPQToKICAgICAgICAgICAgc2VsZi5yZXF1ZXN0LnNldF9wYXRoX3BhcmFtcyhzZWxmLmdldF9wYXRoX3BhcmFtcygpKQoKICAgICAgICBzZWxmLnJlcXVlc3Quc2V0X21ldGhvZChzZWxmLmdldF9tZXRob2QoKSkKCiAgICAgICAgc2VsZi5yZXF1ZXN0LnNldF9wcm9kdWN0KHNlbGYuZ2V0X3Byb2R1Y3QoKSkKCiAgICAgICAgc2VsZi5yZXF1ZXN0LnNldF92ZXJzaW9uKHNlbGYuZ2V0X3ZlcnNpb24oKSkKCiAgICAgICAgc2VsZi5yZXF1ZXN0LnNldF9hY3Rpb25fbmFtZShzZWxmLmdldF9hY3Rpb25fbmFtZSgpKQoKICAgICAgICBzZWxmLnJlcXVlc3Quc2V0X2FjY2VwdF9mb3JtYXQoc2VsZi5nZXRfYWNjZXB0X2Zvcm1hdCgpKQoKICAgICAgICBzZWxmLnJlcXVlc3Quc2V0X3Byb3RvY29sX3R5cGUoc2VsZi5nZXRfcHJvdG9jb2xfdHlwZSgpKQoKICAgICAgICBzZWxmLnJlcXVlc3Quc2V0X3F1ZXJ5X3BhcmFtcyhzZWxmLmdldF9xdWVyeV9wYXJhbXMoKSkKCiAgICAgICAgc2VsZi5yZXF1ZXN0LnNldF9jb250ZW50KHNlbGYuZ2V0X2NvbnRlbnQoKSkKCiAgICAgICAgc2VsZi5yZXF1ZXN0LnNldF9oZWFkZXJzKHNlbGYuZ2V0X2hlYWRlcnMoKSkKCiAgICAgICAgc2VsZi5yZXF1ZXN0LnNldF9sb2NhdGlvbl9zZXJ2aWNlX2NvZGUoCiAgICAgICAgICAgIHNlbGYuZ2V0X2xvY2F0aW9uX3NlcnZpY2VfY29kZSgpKQoKICAgICAgICBzZWxmLnJlcXVlc3Quc2V0X2JvZHlfcGFyYW1zKHNlbGYuZ2V0X2JvZHlfcGFyYW1zKCkpCg==
