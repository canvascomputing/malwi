statistics:
  total_files: 1
  skipped_files: 0.0
  processed_objects: 1
  malicious_objects: 0
details:
- path: .repo_cache/malicious_repos/pypi_malregistry/pycryptoenv/1.0.7/pycryptoenv-1.0.7/pycryptoenv-1.0.7/pycryptoenv/_mac/_core_foundation_ctypes.py
  contents:
  - name: CFHelpers.cf_number_from_integer
    score: 0.0
    code: |-
      @staticmethod
          def cf_number_from_integer(integer):
              """
              Creates a CFNumber object from an integer

              :param integer:
                  The integer to create the CFNumber for

              :return:
                  A CFNumber
              """

              integer_as_long = c_long(integer)
              return CoreFoundation.CFNumberCreate(
                  CoreFoundation.kCFAllocatorDefault,
                  kCFNumberCFIndexType,
                  byref(integer_as_long)
              )
    tokens: resume load_global c_long load_fast integer call store_fast integer_as_long load_global CoreFoundation load_attr CFNumberCreate load_global CoreFoundation load_attr STRING_LEN_S_ENT_HIGH load_global STRING_BASE64_LEN_S_ENT_HIGH load_global byref load_fast integer_as_long call call return_value
    hash: acdbb8b7715d16f5b20be50f4571fe1473df6a08657d5c12b76a3da8092da479
sources:
  ? .repo_cache/malicious_repos/pypi_malregistry/pycryptoenv/1.0.7/pycryptoenv-1.0.7/pycryptoenv-1.0.7/pycryptoenv/_mac/_core_foundation_ctypes.py
  : IyBjb2Rpbmc6IHV0Zi04CmZyb20gX19mdXR1cmVfXyBpbXBvcnQgdW5pY29kZV9saXRlcmFscywgZGl2aXNpb24sIGFic29sdXRlX2ltcG9ydCwgcHJpbnRfZnVuY3Rpb24KCmZyb20gY3R5cGVzIGltcG9ydCBjX3ZvaWRfcCwgY19sb25nLCBjX3VpbnQzMiwgY19jaGFyX3AsIGNfYnl0ZSwgY191bG9uZywgY19ib29sCmZyb20gY3R5cGVzIGltcG9ydCBDRExMLCBzdHJpbmdfYXQsIGNhc3QsIFBPSU5URVIsIGJ5cmVmCmltcG9ydCBjdHlwZXMKCmZyb20gLi5fZmZpIGltcG9ydCBGRklFbmdpbmVFcnJvciwgYnVmZmVyX2Zyb21fYnl0ZXMsIGJ5dGVfc3RyaW5nX2Zyb21fYnVmZmVyCgoKX19hbGxfXyA9IFsKICAgICdDRkhlbHBlcnMnLAogICAgJ0NvcmVGb3VuZGF0aW9uJywKXQoKCmNvcmVfZm91bmRhdGlvbl9wYXRoID0gJy9TeXN0ZW0vTGlicmFyeS9GcmFtZXdvcmtzL0NvcmVGb3VuZGF0aW9uLmZyYW1ld29yay9Db3JlRm91bmRhdGlvbicKCkNvcmVGb3VuZGF0aW9uID0gQ0RMTChjb3JlX2ZvdW5kYXRpb25fcGF0aCwgdXNlX2Vycm5vPVRydWUpCgpDRkluZGV4ID0gY19sb25nCkNGU3RyaW5nRW5jb2RpbmcgPSBjX3VpbnQzMgpDRkFycmF5ID0gY192b2lkX3AKQ0ZEYXRhID0gY192b2lkX3AKQ0ZTdHJpbmcgPSBjX3ZvaWRfcApDRk51bWJlciA9IGNfdm9pZF9wCkNGRGljdGlvbmFyeSA9IGNfdm9pZF9wCkNGRXJyb3IgPSBjX3ZvaWRfcApDRlR5cGUgPSBjX3ZvaWRfcApDRlR5cGVJRCA9IGNfdWxvbmcKQ0ZCb29sZWFuID0gY192b2lkX3AKQ0ZOdW1iZXJUeXBlID0gY191aW50MzIKCkNGVHlwZVJlZiA9IFBPSU5URVIoQ0ZUeXBlKQpDRkFycmF5UmVmID0gUE9JTlRFUihDRkFycmF5KQpDRkRhdGFSZWYgPSBQT0lOVEVSKENGRGF0YSkKQ0ZTdHJpbmdSZWYgPSBQT0lOVEVSKENGU3RyaW5nKQpDRk51bWJlclJlZiA9IFBPSU5URVIoQ0ZOdW1iZXIpCkNGQm9vbGVhblJlZiA9IFBPSU5URVIoQ0ZCb29sZWFuKQpDRkRpY3Rpb25hcnlSZWYgPSBQT0lOVEVSKENGRGljdGlvbmFyeSkKQ0ZFcnJvclJlZiA9IFBPSU5URVIoQ0ZFcnJvcikKQ0ZBbGxvY2F0b3JSZWYgPSBjX3ZvaWRfcApDRkRpY3Rpb25hcnlLZXlDYWxsQmFja3MgPSBjX3ZvaWRfcApDRkRpY3Rpb25hcnlWYWx1ZUNhbGxCYWNrcyA9IGNfdm9pZF9wCkNGQXJyYXlDYWxsQmFja3MgPSBjX3ZvaWRfcAoKcG9pbnRlcl9wID0gUE9JTlRFUihjX3ZvaWRfcCkKCnRyeToKICAgIENvcmVGb3VuZGF0aW9uLkNGRGF0YUdldExlbmd0aC5hcmd0eXBlcyA9IFsKICAgICAgICBDRkRhdGFSZWYKICAgIF0KICAgIENvcmVGb3VuZGF0aW9uLkNGRGF0YUdldExlbmd0aC5yZXN0eXBlID0gQ0ZJbmRleAoKICAgIENvcmVGb3VuZGF0aW9uLkNGRGF0YUdldEJ5dGVQdHIuYXJndHlwZXMgPSBbCiAgICAgICAgQ0ZEYXRhUmVmCiAgICBdCiAgICBDb3JlRm91bmRhdGlvbi5DRkRhdGFHZXRCeXRlUHRyLnJlc3R5cGUgPSBjX3ZvaWRfcAoKICAgIENvcmVGb3VuZGF0aW9uLkNGRGF0YUNyZWF0ZS5hcmd0eXBlcyA9IFsKICAgICAgICBDRkFsbG9jYXRvclJlZiwKICAgICAgICBjX2NoYXJfcCwKICAgICAgICBDRkluZGV4CiAgICBdCiAgICBDb3JlRm91bmRhdGlvbi5DRkRhdGFDcmVhdGUucmVzdHlwZSA9IENGRGF0YVJlZgoKICAgIENvcmVGb3VuZGF0aW9uLkNGRGljdGlvbmFyeUNyZWF0ZS5hcmd0eXBlcyA9IFsKICAgICAgICBDRkFsbG9jYXRvclJlZiwKICAgICAgICBDRlN0cmluZ1JlZiwKICAgICAgICBDRlR5cGVSZWYsCiAgICAgICAgQ0ZJbmRleCwKICAgICAgICBDRkRpY3Rpb25hcnlLZXlDYWxsQmFja3MsCiAgICAgICAgQ0ZEaWN0aW9uYXJ5VmFsdWVDYWxsQmFja3MKICAgIF0KICAgIENvcmVGb3VuZGF0aW9uLkNGRGljdGlvbmFyeUNyZWF0ZS5yZXN0eXBlID0gQ0ZEaWN0aW9uYXJ5UmVmCgogICAgQ29yZUZvdW5kYXRpb24uQ0ZEaWN0aW9uYXJ5R2V0Q291bnQuYXJndHlwZXMgPSBbCiAgICAgICAgQ0ZEaWN0aW9uYXJ5UmVmCiAgICBdCiAgICBDb3JlRm91bmRhdGlvbi5DRkRpY3Rpb25hcnlHZXRDb3VudC5yZXN0eXBlID0gQ0ZJbmRleAoKICAgIENvcmVGb3VuZGF0aW9uLkNGU3RyaW5nR2V0Q1N0cmluZ1B0ci5hcmd0eXBlcyA9IFsKICAgICAgICBDRlN0cmluZ1JlZiwKICAgICAgICBDRlN0cmluZ0VuY29kaW5nCiAgICBdCiAgICBDb3JlRm91bmRhdGlvbi5DRlN0cmluZ0dldENTdHJpbmdQdHIucmVzdHlwZSA9IGNfY2hhcl9wCgogICAgQ29yZUZvdW5kYXRpb24uQ0ZTdHJpbmdHZXRDU3RyaW5nLmFyZ3R5cGVzID0gWwogICAgICAgIENGU3RyaW5nUmVmLAogICAgICAgIGNfY2hhcl9wLAogICAgICAgIENGSW5kZXgsCiAgICAgICAgQ0ZTdHJpbmdFbmNvZGluZwogICAgXQogICAgQ29yZUZvdW5kYXRpb24uQ0ZTdHJpbmdHZXRDU3RyaW5nLnJlc3R5cGUgPSBjX2Jvb2wKCiAgICBDb3JlRm91bmRhdGlvbi5DRlN0cmluZ0NyZWF0ZVdpdGhDU3RyaW5nLmFyZ3R5cGVzID0gWwogICAgICAgIENGQWxsb2NhdG9yUmVmLAogICAgICAgIGNfY2hhcl9wLAogICAgICAgIENGU3RyaW5nRW5jb2RpbmcKICAgIF0KICAgIENvcmVGb3VuZGF0aW9uLkNGU3RyaW5nQ3JlYXRlV2l0aENTdHJpbmcucmVzdHlwZSA9IENGU3RyaW5nUmVmCgogICAgQ29yZUZvdW5kYXRpb24uQ0ZOdW1iZXJDcmVhdGUuYXJndHlwZXMgPSBbCiAgICAgICAgQ0ZBbGxvY2F0b3JSZWYsCiAgICAgICAgQ0ZOdW1iZXJUeXBlLAogICAgICAgIGNfdm9pZF9wCiAgICBdCiAgICBDb3JlRm91bmRhdGlvbi5DRk51bWJlckNyZWF0ZS5yZXN0eXBlID0gQ0ZOdW1iZXJSZWYKCiAgICBDb3JlRm91bmRhdGlvbi5DRkNvcHlUeXBlSUREZXNjcmlwdGlvbi5hcmd0eXBlcyA9IFsKICAgICAgICBDRlR5cGVJRAogICAgXQogICAgQ29yZUZvdW5kYXRpb24uQ0ZDb3B5VHlwZUlERGVzY3JpcHRpb24ucmVzdHlwZSA9IENGU3RyaW5nUmVmCgogICAgQ29yZUZvdW5kYXRpb24uQ0ZSZWxlYXNlLmFyZ3R5cGVzID0gWwogICAgICAgIENGVHlwZVJlZgogICAgXQogICAgQ29yZUZvdW5kYXRpb24uQ0ZSZWxlYXNlLnJlc3R5cGUgPSBOb25lCgogICAgQ29yZUZvdW5kYXRpb24uQ0ZSZXRhaW4uYXJndHlwZXMgPSBbCiAgICAgICAgQ0ZUeXBlUmVmCiAgICBdCiAgICBDb3JlRm91bmRhdGlvbi5DRlJldGFpbi5yZXN0eXBlID0gTm9uZQoKICAgIENvcmVGb3VuZGF0aW9uLkNGRXJyb3JDb3B5RGVzY3JpcHRpb24uYXJndHlwZXMgPSBbCiAgICAgICAgQ0ZFcnJvclJlZgogICAgXQogICAgQ29yZUZvdW5kYXRpb24uQ0ZFcnJvckNvcHlEZXNjcmlwdGlvbi5yZXN0eXBlID0gQ0ZTdHJpbmdSZWYKCiAgICBDb3JlRm91bmRhdGlvbi5DRkVycm9yR2V0RG9tYWluLmFyZ3R5cGVzID0gWwogICAgICAgIENGRXJyb3JSZWYKICAgIF0KICAgIENvcmVGb3VuZGF0aW9uLkNGRXJyb3JHZXREb21haW4ucmVzdHlwZSA9IENGU3RyaW5nUmVmCgogICAgQ29yZUZvdW5kYXRpb24uQ0ZFcnJvckdldENvZGUuYXJndHlwZXMgPSBbCiAgICAgICAgQ0ZFcnJvclJlZgogICAgXQogICAgQ29yZUZvdW5kYXRpb24uQ0ZFcnJvckdldENvZGUucmVzdHlwZSA9IENGSW5kZXgKCiAgICBDb3JlRm91bmRhdGlvbi5DRkJvb2xlYW5HZXRWYWx1ZS5hcmd0eXBlcyA9IFsKICAgICAgICBDRkJvb2xlYW5SZWYKICAgIF0KICAgIENvcmVGb3VuZGF0aW9uLkNGQm9vbGVhbkdldFZhbHVlLnJlc3R5cGUgPSBjX2J5dGUKCiAgICBDb3JlRm91bmRhdGlvbi5DRkRpY3Rpb25hcnlHZXRUeXBlSUQuYXJndHlwZXMgPSBbXQogICAgQ29yZUZvdW5kYXRpb24uQ0ZEaWN0aW9uYXJ5R2V0VHlwZUlELnJlc3R5cGUgPSBDRlR5cGVJRAoKICAgIENvcmVGb3VuZGF0aW9uLkNGTnVtYmVyR2V0VHlwZUlELmFyZ3R5cGVzID0gW10KICAgIENvcmVGb3VuZGF0aW9uLkNGTnVtYmVyR2V0VHlwZUlELnJlc3R5cGUgPSBDRlR5cGVJRAoKICAgIENvcmVGb3VuZGF0aW9uLkNGU3RyaW5nR2V0VHlwZUlELmFyZ3R5cGVzID0gW10KICAgIENvcmVGb3VuZGF0aW9uLkNGU3RyaW5nR2V0VHlwZUlELnJlc3R5cGUgPSBDRlR5cGVJRAoKICAgIENvcmVGb3VuZGF0aW9uLkNGRGF0YUdldFR5cGVJRC5hcmd0eXBlcyA9IFtdCiAgICBDb3JlRm91bmRhdGlvbi5DRkRhdGFHZXRUeXBlSUQucmVzdHlwZSA9IENGVHlwZUlECgogICAgQ29yZUZvdW5kYXRpb24uQ0ZBcnJheUNyZWF0ZS5hcmd0eXBlcyA9IFsKICAgICAgICBDRkFsbG9jYXRvclJlZiwKICAgICAgICBQT0lOVEVSKGNfdm9pZF9wKSwKICAgICAgICBDRkluZGV4LAogICAgICAgIENGQXJyYXlDYWxsQmFja3MKICAgIF0KICAgIENvcmVGb3VuZGF0aW9uLkNGQXJyYXlDcmVhdGUucmVzdHlwZSA9IENGQXJyYXlSZWYKCiAgICBDb3JlRm91bmRhdGlvbi5DRkFycmF5R2V0Q291bnQuYXJndHlwZXMgPSBbCiAgICAgICAgQ0ZBcnJheVJlZgogICAgXQogICAgQ29yZUZvdW5kYXRpb24uQ0ZBcnJheUdldENvdW50LnJlc3R5cGUgPSBDRkluZGV4CgogICAgQ29yZUZvdW5kYXRpb24uQ0ZBcnJheUdldFZhbHVlQXRJbmRleC5hcmd0eXBlcyA9IFsKICAgICAgICBDRkFycmF5UmVmLAogICAgICAgIENGSW5kZXgKICAgIF0KICAgIENvcmVGb3VuZGF0aW9uLkNGQXJyYXlHZXRWYWx1ZUF0SW5kZXgucmVzdHlwZSA9IENGVHlwZVJlZgoKICAgIENvcmVGb3VuZGF0aW9uLkNGTnVtYmVyR2V0VHlwZS5hcmd0eXBlcyA9IFsKICAgICAgICBDRk51bWJlclJlZgogICAgXQogICAgQ29yZUZvdW5kYXRpb24uQ0ZOdW1iZXJHZXRUeXBlLnJlc3R5cGUgPSBDRk51bWJlclR5cGUKCiAgICBDb3JlRm91bmRhdGlvbi5DRk51bWJlckdldFZhbHVlLmFyZ3R5cGVzID0gWwogICAgICAgIENGTnVtYmVyUmVmLAogICAgICAgIENGTnVtYmVyVHlwZSwKICAgICAgICBjX3ZvaWRfcAogICAgXQogICAgQ29yZUZvdW5kYXRpb24uQ0ZOdW1iZXJHZXRWYWx1ZS5yZXN0eXBlID0gY19ib29sCgogICAgQ29yZUZvdW5kYXRpb24uQ0ZEaWN0aW9uYXJ5R2V0S2V5c0FuZFZhbHVlcy5hcmd0eXBlcyA9IFsKICAgICAgICBDRkRpY3Rpb25hcnlSZWYsCiAgICAgICAgcG9pbnRlcl9wLAogICAgICAgIHBvaW50ZXJfcAogICAgXQogICAgQ29yZUZvdW5kYXRpb24uQ0ZEaWN0aW9uYXJ5R2V0S2V5c0FuZFZhbHVlcy5yZXN0eXBlID0gQ0ZJbmRleAoKICAgIENvcmVGb3VuZGF0aW9uLkNGR2V0VHlwZUlELmFyZ3R5cGVzID0gWwogICAgICAgIENGVHlwZVJlZgogICAgXQogICAgQ29yZUZvdW5kYXRpb24uQ0ZHZXRUeXBlSUQucmVzdHlwZSA9IENGVHlwZUlECgogICAgc2V0YXR0cihDb3JlRm91bmRhdGlvbiwgJ2tDRkFsbG9jYXRvckRlZmF1bHQnLCBDRkFsbG9jYXRvclJlZi5pbl9kbGwoQ29yZUZvdW5kYXRpb24sICdrQ0ZBbGxvY2F0b3JEZWZhdWx0JykpCiAgICBzZXRhdHRyKENvcmVGb3VuZGF0aW9uLCAna0NGQm9vbGVhblRydWUnLCBDRlR5cGVSZWYuaW5fZGxsKENvcmVGb3VuZGF0aW9uLCAna0NGQm9vbGVhblRydWUnKSkKCiAgICBrQ0ZUeXBlRGljdGlvbmFyeUtleUNhbGxCYWNrcyA9IGNfdm9pZF9wLmluX2RsbChDb3JlRm91bmRhdGlvbiwgJ2tDRlR5cGVEaWN0aW9uYXJ5S2V5Q2FsbEJhY2tzJykKICAgIGtDRlR5cGVEaWN0aW9uYXJ5VmFsdWVDYWxsQmFja3MgPSBjX3ZvaWRfcC5pbl9kbGwoQ29yZUZvdW5kYXRpb24sICdrQ0ZUeXBlRGljdGlvbmFyeVZhbHVlQ2FsbEJhY2tzJykKICAgIGtDRlR5cGVBcnJheUNhbGxCYWNrcyA9IGNfdm9pZF9wLmluX2RsbChDb3JlRm91bmRhdGlvbiwgJ2tDRlR5cGVBcnJheUNhbGxCYWNrcycpCgpleGNlcHQgKEF0dHJpYnV0ZUVycm9yKToKICAgIHJhaXNlIEZGSUVuZ2luZUVycm9yKCdFcnJvciBpbml0aWFsaXppbmcgY3R5cGVzJykKCnNldGF0dHIoQ29yZUZvdW5kYXRpb24sICdDRkRhdGFSZWYnLCBDRkRhdGFSZWYpCnNldGF0dHIoQ29yZUZvdW5kYXRpb24sICdDRkVycm9yUmVmJywgQ0ZFcnJvclJlZikKc2V0YXR0cihDb3JlRm91bmRhdGlvbiwgJ0NGQXJyYXlSZWYnLCBDRkFycmF5UmVmKQprQ0ZOdW1iZXJDRkluZGV4VHlwZSA9IENGTnVtYmVyVHlwZSgxNCkKa0NGU3RyaW5nRW5jb2RpbmdVVEY4ID0gQ0ZTdHJpbmdFbmNvZGluZygweDA4MDAwMTAwKQoKCmRlZiBfY2FzdF9wb2ludGVyX3AodmFsdWUpOgogICAgIiIiCiAgICBDYXN0cyBhIHZhbHVlIHRvIGEgcG9pbnRlciBvZiBhIHBvaW50ZXIKCiAgICA6cGFyYW0gdmFsdWU6CiAgICAgICAgQSBjdHlwZXMgb2JqZWN0CgogICAgOnJldHVybjoKICAgICAgICBBIFBPSU5URVIoY192b2lkX3ApIG9iamVjdAogICAgIiIiCgogICAgcmV0dXJuIGNhc3QodmFsdWUsIHBvaW50ZXJfcCkKCgpjbGFzcyBDRkhlbHBlcnMoKToKICAgICIiIgogICAgTmFtZXNwYWNlIGZvciBjb3JlIGZvdW5kYXRpb24gaGVscGVycwogICAgIiIiCgogICAgX25hdGl2ZV9tYXAgPSB7fQoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIHJlZ2lzdGVyX25hdGl2ZV9tYXBwaW5nKGNscywgdHlwZV9pZCwgY2FsbGJhY2spOgogICAgICAgICIiIgogICAgICAgIFJlZ2lzdGVyIGEgZnVuY3Rpb24gdG8gY29udmVydCBhIGNvcmUgZm91bmRhdGlvbiBkYXRhIHR5cGUgaW50byBpdHMKICAgICAgICBlcXVpdmFsZW50IGluIHB5dGhvbgoKICAgICAgICA6cGFyYW0gdHlwZV9pZDoKICAgICAgICAgICAgVGhlIENGVHlwZUlkIGZvciB0aGUgdHlwZQoKICAgICAgICA6cGFyYW0gY2FsbGJhY2s6CiAgICAgICAgICAgIEEgY2FsbGJhY2sgdG8gcGFzcyB0aGUgQ0ZUeXBlIG9iamVjdCB0bwogICAgICAgICIiIgoKICAgICAgICBjbHMuX25hdGl2ZV9tYXBbaW50KHR5cGVfaWQpXSA9IGNhbGxiYWNrCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNmX251bWJlcl90b19udW1iZXIodmFsdWUpOgogICAgICAgICIiIgogICAgICAgIENvbnZlcnRzIGEgQ0ZOdW1iZXIgb2JqZWN0IHRvIGEgcHl0aG9uIGZsb2F0IG9yIGludGVnZXIKCiAgICAgICAgOnBhcmFtIHZhbHVlOgogICAgICAgICAgICBUaGUgQ0ZOdW1iZXIgb2JqZWN0CgogICAgICAgIDpyZXR1cm46CiAgICAgICAgICAgIEEgcHl0aG9uIG51bWJlciAoZmxvYXQgb3IgaW50ZWdlcikKICAgICAgICAiIiIKCiAgICAgICAgdHlwZV8gPSBDb3JlRm91bmRhdGlvbi5DRk51bWJlckdldFR5cGUoX2Nhc3RfcG9pbnRlcl9wKHZhbHVlKSkKICAgICAgICBjX3R5cGUgPSB7CiAgICAgICAgICAgIDE6IGNfYnl0ZSwgICAgICAgICAgICAgICMga0NGTnVtYmVyU0ludDhUeXBlCiAgICAgICAgICAgIDI6IGN0eXBlcy5jX3Nob3J0LCAgICAgICMga0NGTnVtYmVyU0ludDE2VHlwZQogICAgICAgICAgICAzOiBjdHlwZXMuY19pbnQzMiwgICAgICAjIGtDRk51bWJlclNJbnQzMlR5cGUKICAgICAgICAgICAgNDogY3R5cGVzLmNfaW50NjQsICAgICAgIyBrQ0ZOdW1iZXJTSW50NjRUeXBlCiAgICAgICAgICAgIDU6IGN0eXBlcy5jX2Zsb2F0LCAgICAgICMga0NGTnVtYmVyRmxvYXQzMlR5cGUKICAgICAgICAgICAgNjogY3R5cGVzLmNfZG91YmxlLCAgICAgIyBrQ0ZOdW1iZXJGbG9hdDY0VHlwZQogICAgICAgICAgICA3OiBjX2J5dGUsICAgICAgICAgICAgICAjIGtDRk51bWJlckNoYXJUeXBlCiAgICAgICAgICAgIDg6IGN0eXBlcy5jX3Nob3J0LCAgICAgICMga0NGTnVtYmVyU2hvcnRUeXBlCiAgICAgICAgICAgIDk6IGN0eXBlcy5jX2ludCwgICAgICAgICMga0NGTnVtYmVySW50VHlwZQogICAgICAgICAgICAxMDogY19sb25nLCAgICAgICAgICAgICAjIGtDRk51bWJlckxvbmdUeXBlCiAgICAgICAgICAgIDExOiBjdHlwZXMuY19sb25nbG9uZywgICMga0NGTnVtYmVyTG9uZ0xvbmdUeXBlCiAgICAgICAgICAgIDEyOiBjdHlwZXMuY19mbG9hdCwgICAgICMga0NGTnVtYmVyRmxvYXRUeXBlCiAgICAgICAgICAgIDEzOiBjdHlwZXMuY19kb3VibGUsICAgICMga0NGTnVtYmVyRG91YmxlVHlwZQogICAgICAgICAgICAxNDogY19sb25nLCAgICAgICAgICAgICAjIGtDRk51bWJlckNGSW5kZXhUeXBlCiAgICAgICAgICAgIDE1OiBjdHlwZXMuY19pbnQsICAgICAgICMga0NGTnVtYmVyTlNJbnRlZ2VyVHlwZQogICAgICAgICAgICAxNjogY3R5cGVzLmNfZG91YmxlLCAgICAjIGtDRk51bWJlckNHRmxvYXRUeXBlCiAgICAgICAgfVt0eXBlX10KICAgICAgICBvdXRwdXQgPSBjX3R5cGUoMCkKICAgICAgICBDb3JlRm91bmRhdGlvbi5DRk51bWJlckdldFZhbHVlKF9jYXN0X3BvaW50ZXJfcCh2YWx1ZSksIHR5cGVfLCBieXJlZihvdXRwdXQpKQogICAgICAgIHJldHVybiBvdXRwdXQudmFsdWUKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY2ZfZGljdGlvbmFyeV90b19kaWN0KGRpY3Rpb25hcnkpOgogICAgICAgICIiIgogICAgICAgIENvbnZlcnRzIGEgQ0ZEaWN0aW9uYXJ5IG9iamVjdCBpbnRvIGEgcHl0aG9uIGRpY3Rpb25hcnkKCiAgICAgICAgOnBhcmFtIGRpY3Rpb25hcnk6CiAgICAgICAgICAgIFRoZSBDRkRpY3Rpb25hcnkgdG8gY29udmVydAoKICAgICAgICA6cmV0dXJuOgogICAgICAgICAgICBBIHB5dGhvbiBkaWN0CiAgICAgICAgIiIiCgogICAgICAgIGRpY3RfbGVuZ3RoID0gQ29yZUZvdW5kYXRpb24uQ0ZEaWN0aW9uYXJ5R2V0Q291bnQoZGljdGlvbmFyeSkKCiAgICAgICAga2V5cyA9IChDRlR5cGVSZWYgKiBkaWN0X2xlbmd0aCkoKQogICAgICAgIHZhbHVlcyA9IChDRlR5cGVSZWYgKiBkaWN0X2xlbmd0aCkoKQogICAgICAgIENvcmVGb3VuZGF0aW9uLkNGRGljdGlvbmFyeUdldEtleXNBbmRWYWx1ZXMoCiAgICAgICAgICAgIGRpY3Rpb25hcnksCiAgICAgICAgICAgIF9jYXN0X3BvaW50ZXJfcChrZXlzKSwKICAgICAgICAgICAgX2Nhc3RfcG9pbnRlcl9wKHZhbHVlcykKICAgICAgICApCgogICAgICAgIG91dHB1dCA9IHt9CiAgICAgICAgZm9yIGluZGV4IGluIHJhbmdlKDAsIGRpY3RfbGVuZ3RoKToKICAgICAgICAgICAgb3V0cHV0W0NGSGVscGVycy5uYXRpdmUoa2V5c1tpbmRleF0pXSA9IENGSGVscGVycy5uYXRpdmUodmFsdWVzW2luZGV4XSkKCiAgICAgICAgcmV0dXJuIG91dHB1dAoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIG5hdGl2ZShjbHMsIHZhbHVlKToKICAgICAgICAiIiIKICAgICAgICBDb252ZXJ0cyBhIENGKiBvYmplY3QgaW50byBpdHMgcHl0aG9uIGVxdWl2YWxlbnQKCiAgICAgICAgOnBhcmFtIHZhbHVlOgogICAgICAgICAgICBUaGUgQ0YqIG9iamVjdCB0byBjb252ZXJ0CgogICAgICAgIDpyZXR1cm46CiAgICAgICAgICAgIFRoZSBuYXRpdmUgcHl0aG9uIG9iamVjdAogICAgICAgICIiIgoKICAgICAgICB0eXBlX2lkID0gQ29yZUZvdW5kYXRpb24uQ0ZHZXRUeXBlSUQodmFsdWUpCiAgICAgICAgaWYgdHlwZV9pZCBpbiBjbHMuX25hdGl2ZV9tYXA6CiAgICAgICAgICAgIHJldHVybiBjbHMuX25hdGl2ZV9tYXBbdHlwZV9pZF0odmFsdWUpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIHZhbHVlCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNmX3N0cmluZ190b191bmljb2RlKHZhbHVlKToKICAgICAgICAiIiIKICAgICAgICBDcmVhdGVzIGEgcHl0aG9uIHVuaWNvZGUgc3RyaW5nIGZyb20gYSBDRlN0cmluZyBvYmplY3QKCiAgICAgICAgOnBhcmFtIHZhbHVlOgogICAgICAgICAgICBUaGUgQ0ZTdHJpbmcgdG8gY29udmVydAoKICAgICAgICA6cmV0dXJuOgogICAgICAgICAgICBBIHB5dGhvbiB1bmljb2RlIHN0cmluZwogICAgICAgICIiIgoKICAgICAgICBzdHJpbmcgPSBDb3JlRm91bmRhdGlvbi5DRlN0cmluZ0dldENTdHJpbmdQdHIoCiAgICAgICAgICAgIF9jYXN0X3BvaW50ZXJfcCh2YWx1ZSksCiAgICAgICAgICAgIGtDRlN0cmluZ0VuY29kaW5nVVRGOAogICAgICAgICkKICAgICAgICBpZiBzdHJpbmcgaXMgTm9uZToKICAgICAgICAgICAgYnVmZmVyID0gYnVmZmVyX2Zyb21fYnl0ZXMoMTAyNCkKICAgICAgICAgICAgcmVzdWx0ID0gQ29yZUZvdW5kYXRpb24uQ0ZTdHJpbmdHZXRDU3RyaW5nKAogICAgICAgICAgICAgICAgX2Nhc3RfcG9pbnRlcl9wKHZhbHVlKSwKICAgICAgICAgICAgICAgIGJ1ZmZlciwKICAgICAgICAgICAgICAgIDEwMjQsCiAgICAgICAgICAgICAgICBrQ0ZTdHJpbmdFbmNvZGluZ1VURjgKICAgICAgICAgICAgKQogICAgICAgICAgICBpZiBub3QgcmVzdWx0OgogICAgICAgICAgICAgICAgcmFpc2UgT1NFcnJvcignRXJyb3IgY29weWluZyBDIHN0cmluZyBmcm9tIENGU3RyaW5nUmVmJykKICAgICAgICAgICAgc3RyaW5nID0gYnl0ZV9zdHJpbmdfZnJvbV9idWZmZXIoYnVmZmVyKQogICAgICAgIGlmIHN0cmluZyBpcyBub3QgTm9uZToKICAgICAgICAgICAgc3RyaW5nID0gc3RyaW5nLmRlY29kZSgndXRmLTgnKQogICAgICAgIHJldHVybiBzdHJpbmcKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY2Zfc3RyaW5nX2Zyb21fdW5pY29kZShzdHJpbmcpOgogICAgICAgICIiIgogICAgICAgIENyZWF0ZXMgYSBDRlN0cmluZ1JlZiBvYmplY3QgZnJvbSBhIHVuaWNvZGUgc3RyaW5nCgogICAgICAgIDpwYXJhbSBzdHJpbmc6CiAgICAgICAgICAgIFRoZSB1bmljb2RlIHN0cmluZyB0byBjcmVhdGUgdGhlIENGU3RyaW5nIG9iamVjdCBmcm9tCgogICAgICAgIDpyZXR1cm46CiAgICAgICAgICAgIEEgQ0ZTdHJpbmdSZWYKICAgICAgICAiIiIKCiAgICAgICAgcmV0dXJuIENvcmVGb3VuZGF0aW9uLkNGU3RyaW5nQ3JlYXRlV2l0aENTdHJpbmcoCiAgICAgICAgICAgIENvcmVGb3VuZGF0aW9uLmtDRkFsbG9jYXRvckRlZmF1bHQsCiAgICAgICAgICAgIHN0cmluZy5lbmNvZGUoJ3V0Zi04JyksCiAgICAgICAgICAgIGtDRlN0cmluZ0VuY29kaW5nVVRGOAogICAgICAgICkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY2ZfZGF0YV90b19ieXRlcyh2YWx1ZSk6CiAgICAgICAgIiIiCiAgICAgICAgRXh0cmFjdHMgYSBieXRlc3RyaW5nIGZyb20gYSBDRkRhdGEgb2JqZWN0CgogICAgICAgIDpwYXJhbSB2YWx1ZToKICAgICAgICAgICAgQSBDRkRhdGEgb2JqZWN0CgogICAgICAgIDpyZXR1cm46CiAgICAgICAgICAgIEEgYnl0ZSBzdHJpbmcKICAgICAgICAiIiIKCiAgICAgICAgc3RhcnQgPSBDb3JlRm91bmRhdGlvbi5DRkRhdGFHZXRCeXRlUHRyKHZhbHVlKQogICAgICAgIG51bV9ieXRlcyA9IENvcmVGb3VuZGF0aW9uLkNGRGF0YUdldExlbmd0aCh2YWx1ZSkKICAgICAgICByZXR1cm4gc3RyaW5nX2F0KHN0YXJ0LCBudW1fYnl0ZXMpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNmX2RhdGFfZnJvbV9ieXRlcyhieXRlc18pOgogICAgICAgICIiIgogICAgICAgIENyZWF0ZXMgYSBDRkRhdGFSZWYgb2JqZWN0IGZyb20gYSBieXRlIHN0cmluZwoKICAgICAgICA6cGFyYW0gYnl0ZXNfOgogICAgICAgICAgICBUaGUgZGF0YSB0byBjcmVhdGUgdGhlIENGRGF0YSBvYmplY3QgZnJvbQoKICAgICAgICA6cmV0dXJuOgogICAgICAgICAgICBBIENGRGF0YVJlZgogICAgICAgICIiIgoKICAgICAgICByZXR1cm4gQ29yZUZvdW5kYXRpb24uQ0ZEYXRhQ3JlYXRlKAogICAgICAgICAgICBDb3JlRm91bmRhdGlvbi5rQ0ZBbGxvY2F0b3JEZWZhdWx0LAogICAgICAgICAgICBieXRlc18sCiAgICAgICAgICAgIGxlbihieXRlc18pCiAgICAgICAgKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjZl9kaWN0aW9uYXJ5X2Zyb21fcGFpcnMocGFpcnMpOgogICAgICAgICIiIgogICAgICAgIENyZWF0ZXMgYSBDRkRpY3Rpb25hcnlSZWYgb2JqZWN0IGZyb20gYSBsaXN0IG9mIDItZWxlbWVudCB0dXBsZXMKICAgICAgICByZXByZXNlbnRpbmcgdGhlIGtleSBhbmQgdmFsdWUuIEVhY2gga2V5IHNob3VsZCBiZSBhIENGU3RyaW5nUmVmIGFuZCBlYWNoCiAgICAgICAgdmFsdWUgc29tZSBzb3J0IG9mIENGKiB0eXBlLgoKICAgICAgICA6cGFyYW0gcGFpcnM6CiAgICAgICAgICAgIEEgbGlzdCBvZiAyLWVsZW1lbnQgdHVwbGVzCgogICAgICAgIDpyZXR1cm46CiAgICAgICAgICAgIEEgQ0ZEaWN0aW9uYXJ5UmVmCiAgICAgICAgIiIiCgogICAgICAgIGxlbmd0aCA9IGxlbihwYWlycykKICAgICAgICBrZXlzID0gW10KICAgICAgICB2YWx1ZXMgPSBbXQogICAgICAgIGZvciBwYWlyIGluIHBhaXJzOgogICAgICAgICAgICBrZXksIHZhbHVlID0gcGFpcgogICAgICAgICAgICBrZXlzLmFwcGVuZChrZXkpCiAgICAgICAgICAgIHZhbHVlcy5hcHBlbmQodmFsdWUpCiAgICAgICAga2V5cyA9IChDRlN0cmluZ1JlZiAqIGxlbmd0aCkoKmtleXMpCiAgICAgICAgdmFsdWVzID0gKENGVHlwZVJlZiAqIGxlbmd0aCkoKnZhbHVlcykKICAgICAgICByZXR1cm4gQ29yZUZvdW5kYXRpb24uQ0ZEaWN0aW9uYXJ5Q3JlYXRlKAogICAgICAgICAgICBDb3JlRm91bmRhdGlvbi5rQ0ZBbGxvY2F0b3JEZWZhdWx0LAogICAgICAgICAgICBfY2FzdF9wb2ludGVyX3AoYnlyZWYoa2V5cykpLAogICAgICAgICAgICBfY2FzdF9wb2ludGVyX3AoYnlyZWYodmFsdWVzKSksCiAgICAgICAgICAgIGxlbmd0aCwKICAgICAgICAgICAga0NGVHlwZURpY3Rpb25hcnlLZXlDYWxsQmFja3MsCiAgICAgICAgICAgIGtDRlR5cGVEaWN0aW9uYXJ5VmFsdWVDYWxsQmFja3MKICAgICAgICApCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNmX2FycmF5X2Zyb21fbGlzdCh2YWx1ZXMpOgogICAgICAgICIiIgogICAgICAgIENyZWF0ZXMgYSBDRkFycmF5UmVmIG9iamVjdCBmcm9tIGEgbGlzdCBvZiBDRiogdHlwZSBvYmplY3RzLgoKICAgICAgICA6cGFyYW0gdmFsdWVzOgogICAgICAgICAgICBBIGxpc3Qgb2YgQ0YqIHR5cGUgb2JqZWN0CgogICAgICAgIDpyZXR1cm46CiAgICAgICAgICAgIEEgQ0ZBcnJheVJlZgogICAgICAgICIiIgoKICAgICAgICBsZW5ndGggPSBsZW4odmFsdWVzKQogICAgICAgIHZhbHVlcyA9IChDRlR5cGVSZWYgKiBsZW5ndGgpKCp2YWx1ZXMpCiAgICAgICAgcmV0dXJuIENvcmVGb3VuZGF0aW9uLkNGQXJyYXlDcmVhdGUoCiAgICAgICAgICAgIENvcmVGb3VuZGF0aW9uLmtDRkFsbG9jYXRvckRlZmF1bHQsCiAgICAgICAgICAgIF9jYXN0X3BvaW50ZXJfcChieXJlZih2YWx1ZXMpKSwKICAgICAgICAgICAgbGVuZ3RoLAogICAgICAgICAgICBrQ0ZUeXBlQXJyYXlDYWxsQmFja3MKICAgICAgICApCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNmX251bWJlcl9mcm9tX2ludGVnZXIoaW50ZWdlcik6CiAgICAgICAgIiIiCiAgICAgICAgQ3JlYXRlcyBhIENGTnVtYmVyIG9iamVjdCBmcm9tIGFuIGludGVnZXIKCiAgICAgICAgOnBhcmFtIGludGVnZXI6CiAgICAgICAgICAgIFRoZSBpbnRlZ2VyIHRvIGNyZWF0ZSB0aGUgQ0ZOdW1iZXIgZm9yCgogICAgICAgIDpyZXR1cm46CiAgICAgICAgICAgIEEgQ0ZOdW1iZXIKICAgICAgICAiIiIKCiAgICAgICAgaW50ZWdlcl9hc19sb25nID0gY19sb25nKGludGVnZXIpCiAgICAgICAgcmV0dXJuIENvcmVGb3VuZGF0aW9uLkNGTnVtYmVyQ3JlYXRlKAogICAgICAgICAgICBDb3JlRm91bmRhdGlvbi5rQ0ZBbGxvY2F0b3JEZWZhdWx0LAogICAgICAgICAgICBrQ0ZOdW1iZXJDRkluZGV4VHlwZSwKICAgICAgICAgICAgYnlyZWYoaW50ZWdlcl9hc19sb25nKQogICAgICAgICkK
