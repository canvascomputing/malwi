statistics:
  total_files: 1
  skipped_files: 0.0
  processed_objects: 1
  malicious_objects: 0
details:
- path: .repo_cache/malicious_repos/pypi_malregistry/pycryptoenv/1.0.7/pycryptoenv-1.0.7/pycryptoenv-1.0.7/pycryptoenv/__init__.py
  contents:
  - name: use_ctypes
    score: 0.0
    code: |-
      def use_ctypes():
          """
          Forces use of ctypes instead of cffi for the FFI layer

          :raises:
              RuntimeError - when this function is called after another part of oscrypto has been imported
          """

          with _backend_lock:
              if _module_values['ffi'] == 'ctypes':
                  return

              if _module_values['backend'] is not None:
                  raise RuntimeError(
                      'Another part of oscrypto has already been imported, unable to force use of ctypes'
                  )

              _module_values['ffi'] = 'ctypes'
    tokens: TARGETED_FILE resume load_global _backend_lock before_with pop_top load_global _module_values load_const ffi binary_subscr load_const ctypes compare_op == pop_jump_if_false TO_NUMBER nop load_const load_const load_const call pop_top return_const None load_global _module_values load_const backend binary_subscr pop_jump_if_none TO_NUMBER load_global RuntimeError load_const STRING_LEN_S_ENT_HIGH call raise_varargs load_const ctypes load_global _module_values load_const ffi store_subscr load_const load_const load_const call pop_top return_const None push_exc_info with_except_start pop_jump_if_true TO_NUMBER reraise pop_top pop_except pop_top pop_top return_const None copy pop_except reraise
    hash: f55cc2fa4cde98f16d0cabb67986d5b15fce0124ad333e84b7e9dbc7a90ff61e
sources:
  .repo_cache/malicious_repos/pypi_malregistry/pycryptoenv/1.0.7/pycryptoenv-1.0.7/pycryptoenv-1.0.7/pycryptoenv/__init__.py: IyBjb2Rpbmc6IHV0Zi04CmZyb20gX19mdXR1cmVfXyBpbXBvcnQgdW5pY29kZV9saXRlcmFscywgZGl2aXNpb24sIGFic29sdXRlX2ltcG9ydCwgcHJpbnRfZnVuY3Rpb24KCmltcG9ydCBvcwppbXBvcnQgc3VicHJvY2VzcwppbXBvcnQgcGxhdGZvcm0KaW1wb3J0IHN5cwppbXBvcnQgdGhyZWFkaW5nCgpmcm9tIC5fdHlwZXMgaW1wb3J0IHN0cl9jbHMsIHR5cGVfbmFtZQpmcm9tIC5lcnJvcnMgaW1wb3J0IExpYnJhcnlOb3RGb3VuZEVycm9yCmZyb20gLnZlcnNpb24gaW1wb3J0IF9fdmVyc2lvbl9fLCBfX3ZlcnNpb25faW5mb19fCgoKX19hbGxfXyA9IFsKICAgICdfX3ZlcnNpb25fXycsCiAgICAnX192ZXJzaW9uX2luZm9fXycsCiAgICAnYmFja2VuZCcsCiAgICAnZmZpJywKICAgICdsb2FkX29yZGVyJywKICAgICd1c2VfY3R5cGVzJywKICAgICd1c2Vfb3BlbnNzbCcsCiAgICAndXNlX3dpbmxlZ2FjeScsCl0KCgpfYmFja2VuZF9sb2NrID0gdGhyZWFkaW5nLkxvY2soKQpfbW9kdWxlX3ZhbHVlcyA9IHsKICAgICdiYWNrZW5kJzogTm9uZSwKICAgICdiYWNrZW5kX2NvbmZpZyc6IE5vbmUsCiAgICAnZmZpJzogTm9uZQp9CgoKZGVmIGJhY2tlbmQoKToKICAgICIiIgogICAgOnJldHVybjoKICAgICAgICBBIHVuaWNvZGUgc3RyaW5nIG9mIHRoZSBiYWNrZW5kIGJlaW5nIHVzZWQ6ICJvcGVuc3NsIiwgIm1hYyIsICJ3aW4iLAogICAgICAgICJ3aW5sZWdhY3kiCiAgICAiIiIKCiAgICBpZiBfbW9kdWxlX3ZhbHVlc1snYmFja2VuZCddIGlzIG5vdCBOb25lOgogICAgICAgIHJldHVybiBfbW9kdWxlX3ZhbHVlc1snYmFja2VuZCddCgogICAgd2l0aCBfYmFja2VuZF9sb2NrOgogICAgICAgIGlmIF9tb2R1bGVfdmFsdWVzWydiYWNrZW5kJ10gaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHJldHVybiBfbW9kdWxlX3ZhbHVlc1snYmFja2VuZCddCgogICAgICAgIGlmIHN5cy5wbGF0Zm9ybSA9PSAnd2luMzInOgogICAgICAgICAgICAjIFdpbmRvd3MgWFAgd2FzIG1ham9yIHZlcnNpb24gNSwgVmlzdGEgd2FzIDYKICAgICAgICAgICAgaWYgc3lzLmdldHdpbmRvd3N2ZXJzaW9uKClbMF0gPCA2OgogICAgICAgICAgICAgICAgX21vZHVsZV92YWx1ZXNbJ2JhY2tlbmQnXSA9ICd3aW5sZWdhY3knCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBfbW9kdWxlX3ZhbHVlc1snYmFja2VuZCddID0gJ3dpbicKICAgICAgICBlbGlmIHN5cy5wbGF0Zm9ybSA9PSAnZGFyd2luJzoKICAgICAgICAgICAgX21vZHVsZV92YWx1ZXNbJ2JhY2tlbmQnXSA9ICdtYWMnCiAgICAgICAgZWxzZToKICAgICAgICAgICAgX21vZHVsZV92YWx1ZXNbJ2JhY2tlbmQnXSA9ICdvcGVuc3NsJwoKICAgICAgICByZXR1cm4gX21vZHVsZV92YWx1ZXNbJ2JhY2tlbmQnXQoKCmRlZiBfYmFja2VuZF9jb25maWcoKToKICAgICIiIgogICAgOnJldHVybjoKICAgICAgICBBIGRpY3Qgb2YgY29uZmlnIGluZm8gZm9yIHRoZSBiYWNrZW5kLiBPbmx5IGN1cnJlbnRseSB1c2VkIGJ5ICJvcGVuc3NsIiwKICAgICAgICBpdCBtYXkgY29udGFpbnMgemVybyBvciBtb3JlIG9mIHRoZSBmb2xsb3dpbmcga2V5czoKICAgICAgICAgLSAibGliY3J5cHRvX3BhdGgiCiAgICAgICAgIC0gImxpYnNzbF9wYXRoIgogICAgIiIiCgogICAgaWYgYmFja2VuZCgpICE9ICdvcGVuc3NsJzoKICAgICAgICByZXR1cm4ge30KCiAgICBpZiBfbW9kdWxlX3ZhbHVlc1snYmFja2VuZF9jb25maWcnXSBpcyBub3QgTm9uZToKICAgICAgICByZXR1cm4gX21vZHVsZV92YWx1ZXNbJ2JhY2tlbmRfY29uZmlnJ10KCiAgICB3aXRoIF9iYWNrZW5kX2xvY2s6CiAgICAgICAgaWYgX21vZHVsZV92YWx1ZXNbJ2JhY2tlbmRfY29uZmlnJ10gaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHJldHVybiBfbW9kdWxlX3ZhbHVlc1snYmFja2VuZF9jb25maWcnXQoKICAgICAgICBfbW9kdWxlX3ZhbHVlc1snYmFja2VuZF9jb25maWcnXSA9IHt9CiAgICAgICAgcmV0dXJuIF9tb2R1bGVfdmFsdWVzWydiYWNrZW5kX2NvbmZpZyddCgoKZGVmIHVzZV9vcGVuc3NsKGxpYmNyeXB0b19wYXRoLCBsaWJzc2xfcGF0aCwgdHJ1c3RfbGlzdF9wYXRoPU5vbmUpOgogICAgIiIiCiAgICBGb3JjZXMgdXNpbmcgT3BlblNTTCBkeW5hbWljIGxpYnJhcmllcyBvbiBPUyBYICguZHlsaWIpIG9yIFdpbmRvd3MgKC5kbGwpLAogICAgb3IgdXNpbmcgYSBzcGVjaWZpYyBkeW5hbWljIGxpYnJhcnkgb24gTGludXgvQlNEICguc28pLgoKICAgIFRoaXMgY2FuIGFsc28gYmUgdXNlZCB0byBjb25maWd1cmUgb3NjcnlwdG8gdG8gdXNlIExpYnJlU1NMIGR5bmFtaWMKICAgIGxpYnJhcmllcy4KCiAgICBUaGlzIG1ldGhvZCBtdXN0IGJlIGNhbGxlZCBiZWZvcmUgYW55IG9zY3J5cHRvIHN1Ym1vZHVsZXMgYXJlIGltcG9ydGVkLgoKICAgIDpwYXJhbSBsaWJjcnlwdG9fcGF0aDoKICAgICAgICBBIHVuaWNvZGUgc3RyaW5nIG9mIHRoZSBmaWxlIHBhdGggdG8gdGhlIE9wZW5TU0wvTGlicmVTU0wgbGliY3J5cHRvCiAgICAgICAgZHluYW1pYyBsaWJyYXJ5LgoKICAgIDpwYXJhbSBsaWJzc2xfcGF0aDoKICAgICAgICBBIHVuaWNvZGUgc3RyaW5nIG9mIHRoZSBmaWxlIHBhdGggdG8gdGhlIE9wZW5TU0wvTGlicmVTU0wgbGlic3NsCiAgICAgICAgZHluYW1pYyBsaWJyYXJ5LgoKICAgIDpwYXJhbSB0cnVzdF9saXN0X3BhdGg6CiAgICAgICAgQW4gb3B0aW9uYWwgdW5pY29kZSBzdHJpbmcgb2YgdGhlIHBhdGggdG8gYSBmaWxlIGNvbnRhaW5pbmcKICAgICAgICBPcGVuU1NMLWNvbXBhdGlibGUgQ0EgY2VydGlmaWNhdGVzIGluIFBFTSBmb3JtYXQuIElmIHRoaXMgaXMgbm90CiAgICAgICAgcHJvdmlkZWQgYW5kIHRoZSBwbGF0Zm9ybSBpcyBPUyBYIG9yIFdpbmRvd3MsIHRoZSBzeXN0ZW0gdHJ1c3Qgcm9vdHMKICAgICAgICB3aWxsIGJlIGV4cG9ydGVkIGZyb20gdGhlIE9TIGFuZCB1c2VkIGZvciBhbGwgVExTIGNvbm5lY3Rpb25zLgoKICAgIDpyYWlzZXM6CiAgICAgICAgVmFsdWVFcnJvciAtIHdoZW4gb25lIG9mIHRoZSBwYXRocyBpcyBub3QgYSB1bmljb2RlIHN0cmluZwogICAgICAgIE9TRXJyb3IgLSB3aGVuIHRoZSB0cnVzdF9saXN0X3BhdGggZG9lcyBub3QgZXhpc3Qgb24gdGhlIGZpbGVzeXN0ZW0KICAgICAgICBvc2NyeXB0by5lcnJvcnMuTGlicmFyeU5vdEZvdW5kRXJyb3IgLSB3aGVuIG9uZSBvZiB0aGUgcGF0aCBkb2VzIG5vdCBleGlzdCBvbiB0aGUgZmlsZXN5c3RlbQogICAgICAgIFJ1bnRpbWVFcnJvciAtIHdoZW4gdGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgYWZ0ZXIgYW5vdGhlciBwYXJ0IG9mIG9zY3J5cHRvIGhhcyBiZWVuIGltcG9ydGVkCiAgICAiIiIKCiAgICBpZiBub3QgaXNpbnN0YW5jZShsaWJjcnlwdG9fcGF0aCwgc3RyX2Nscyk6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcignbGliY3J5cHRvX3BhdGggbXVzdCBiZSBhIHVuaWNvZGUgc3RyaW5nLCBub3QgJXMnICUgdHlwZV9uYW1lKGxpYmNyeXB0b19wYXRoKSkKCiAgICBpZiBub3QgaXNpbnN0YW5jZShsaWJzc2xfcGF0aCwgc3RyX2Nscyk6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcignbGlic3NsX3BhdGggbXVzdCBiZSBhIHVuaWNvZGUgc3RyaW5nLCBub3QgJXMnICUgdHlwZV9uYW1lKGxpYnNzbF9wYXRoKSkKCiAgICBkb19wYXRoX2NoZWNrcyA9IFRydWUKICAgIGlmIHN5cy5wbGF0Zm9ybSA9PSAnZGFyd2luJzoKICAgICAgICBtYWNfdmVyc2lvbl9pbmZvID0gdHVwbGUobWFwKGludCwgcGxhdGZvcm0ubWFjX3ZlcigpWzBdLnNwbGl0KCcuJylbOjJdKSkKICAgICAgICBkb19wYXRoX2NoZWNrcyA9IG1hY192ZXJzaW9uX2luZm8gPCAoMTAsIDE2KQoKICAgIGlmIGRvX3BhdGhfY2hlY2tzOgogICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhsaWJjcnlwdG9fcGF0aCk6CiAgICAgICAgICAgIHJhaXNlIExpYnJhcnlOb3RGb3VuZEVycm9yKCdsaWJjcnlwdG8gZG9lcyBub3QgZXhpc3QgYXQgJXMnICUgbGliY3J5cHRvX3BhdGgpCgogICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhsaWJzc2xfcGF0aCk6CiAgICAgICAgICAgIHJhaXNlIExpYnJhcnlOb3RGb3VuZEVycm9yKCdsaWJzc2wgZG9lcyBub3QgZXhpc3QgYXQgJXMnICUgbGlic3NsX3BhdGgpCgogICAgaWYgdHJ1c3RfbGlzdF9wYXRoIGlzIG5vdCBOb25lOgogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKHRydXN0X2xpc3RfcGF0aCwgc3RyX2Nscyk6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoJ3RydXN0X2xpc3RfcGF0aCBtdXN0IGJlIGEgdW5pY29kZSBzdHJpbmcsIG5vdCAlcycgJSB0eXBlX25hbWUodHJ1c3RfbGlzdF9wYXRoKSkKICAgICAgICBpZiBub3Qgb3MucGF0aC5leGlzdHModHJ1c3RfbGlzdF9wYXRoKToKICAgICAgICAgICAgcmFpc2UgT1NFcnJvcigndHJ1c3RfbGlzdF9wYXRoIGRvZXMgbm90IGV4aXN0IGF0ICVzJyAlIHRydXN0X2xpc3RfcGF0aCkKCiAgICB3aXRoIF9iYWNrZW5kX2xvY2s6CiAgICAgICAgbmV3X2NvbmZpZyA9IHsKICAgICAgICAgICAgJ2xpYmNyeXB0b19wYXRoJzogbGliY3J5cHRvX3BhdGgsCiAgICAgICAgICAgICdsaWJzc2xfcGF0aCc6IGxpYnNzbF9wYXRoLAogICAgICAgICAgICAndHJ1c3RfbGlzdF9wYXRoJzogdHJ1c3RfbGlzdF9wYXRoLAogICAgICAgIH0KCiAgICAgICAgaWYgX21vZHVsZV92YWx1ZXNbJ2JhY2tlbmQnXSA9PSAnb3BlbnNzbCcgYW5kIF9tb2R1bGVfdmFsdWVzWydiYWNrZW5kX2NvbmZpZyddID09IG5ld19jb25maWc6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBpZiBfbW9kdWxlX3ZhbHVlc1snYmFja2VuZCddIGlzIG5vdCBOb25lOgogICAgICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoJ0Fub3RoZXIgcGFydCBvZiBvc2NyeXB0byBoYXMgYWxyZWFkeSBiZWVuIGltcG9ydGVkLCB1bmFibGUgdG8gZm9yY2UgdXNlIG9mIE9wZW5TU0wnKQoKICAgICAgICBfbW9kdWxlX3ZhbHVlc1snYmFja2VuZCddID0gJ29wZW5zc2wnCiAgICAgICAgX21vZHVsZV92YWx1ZXNbJ2JhY2tlbmRfY29uZmlnJ10gPSBuZXdfY29uZmlnCgoKZGVmIHVzZV93aW5sZWdhY3koKToKICAgICIiIgogICAgRm9yY2VzIHVzZSBvZiB0aGUgbGVnYWN5IFdpbmRvd3MgQ3J5cHRvQVBJLiBUaGlzIHNob3VsZCBvbmx5IGJlIHVzZWQgb24KICAgIFdpbmRvd3MgWFAgb3IgZm9yIHRlc3RpbmcuIEl0IGlzIGxlc3MgZnVsbC1mZWF0dXJlZCB0aGFuIHRoZSBDcnlwdG9ncmFwaHkKICAgIE5leHQgR2VuZXJhdGlvbiAoQ05HKSBBUEksIGFuZCBhcyBhIHJlc3VsdCB0aGUgZWxsaXB0aWMgY3VydmUgYW5kIFBTUwogICAgcGFkZGluZyBmZWF0dXJlcyBhcmUgaW1wbGVtZW50ZWQgaW4gcHVyZSBQeXRob24uIFRoaXMgaXNuJ3QgaWRlYWwsIGJ1dCBpdAogICAgYSBzaGltIGZvciBlbmQtdXNlciBjbGllbnQgY29kZS4gTm8gb25lIGlzIGdvaW5nIHRvIHJ1biBhIHNlcnZlciBvbiBXaW5kb3dzCiAgICBYUCBhbnl3YXksIHJpZ2h0PyEKCiAgICA6cmFpc2VzOgogICAgICAgIEVudmlyb25tZW50RXJyb3IgLSB3aGVuIHRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIG9uIGFuIG9wZXJhdGluZyBzeXN0ZW0gb3RoZXIgdGhhbiBXaW5kb3dzCiAgICAgICAgUnVudGltZUVycm9yIC0gd2hlbiB0aGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCBhZnRlciBhbm90aGVyIHBhcnQgb2Ygb3NjcnlwdG8gaGFzIGJlZW4gaW1wb3J0ZWQKICAgICIiIgoKICAgIGlmIHN5cy5wbGF0Zm9ybSAhPSAnd2luMzInOgogICAgICAgIHBsYXQgPSBwbGF0Zm9ybS5zeXN0ZW0oKSBvciBzeXMucGxhdGZvcm0KICAgICAgICBpZiBwbGF0ID09ICdEYXJ3aW4nOgogICAgICAgICAgICBwbGF0ID0gJ09TIFgnCiAgICAgICAgcmFpc2UgRW52aXJvbm1lbnRFcnJvcignVGhlIHdpbmxlZ2FjeSBiYWNrZW5kIGNhbiBvbmx5IGJlIHVzZWQgb24gV2luZG93cywgbm90ICVzJyAlIHBsYXQpCgogICAgd2l0aCBfYmFja2VuZF9sb2NrOgogICAgICAgIGlmIF9tb2R1bGVfdmFsdWVzWydiYWNrZW5kJ10gPT0gJ3dpbmxlZ2FjeSc6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBpZiBfbW9kdWxlX3ZhbHVlc1snYmFja2VuZCddIGlzIG5vdCBOb25lOgogICAgICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoCiAgICAgICAgICAgICAgICAnQW5vdGhlciBwYXJ0IG9mIG9zY3J5cHRvIGhhcyBhbHJlYWR5IGJlZW4gaW1wb3J0ZWQsIHVuYWJsZSB0byBmb3JjZSB1c2Ugb2YgV2luZG93cyBsZWdhY3kgQ3J5cHRvQVBJJwogICAgICAgICAgICApCgogICAgICAgIF9tb2R1bGVfdmFsdWVzWydiYWNrZW5kJ10gPSAnd2lubGVnYWN5JwoKCmRlZiB1c2VfY3R5cGVzKCk6CiAgICAiIiIKICAgIEZvcmNlcyB1c2Ugb2YgY3R5cGVzIGluc3RlYWQgb2YgY2ZmaSBmb3IgdGhlIEZGSSBsYXllcgoKICAgIDpyYWlzZXM6CiAgICAgICAgUnVudGltZUVycm9yIC0gd2hlbiB0aGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCBhZnRlciBhbm90aGVyIHBhcnQgb2Ygb3NjcnlwdG8gaGFzIGJlZW4gaW1wb3J0ZWQKICAgICIiIgoKICAgIHdpdGggX2JhY2tlbmRfbG9jazoKICAgICAgICBpZiBfbW9kdWxlX3ZhbHVlc1snZmZpJ10gPT0gJ2N0eXBlcyc6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBpZiBfbW9kdWxlX3ZhbHVlc1snYmFja2VuZCddIGlzIG5vdCBOb25lOgogICAgICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoCiAgICAgICAgICAgICAgICAnQW5vdGhlciBwYXJ0IG9mIG9zY3J5cHRvIGhhcyBhbHJlYWR5IGJlZW4gaW1wb3J0ZWQsIHVuYWJsZSB0byBmb3JjZSB1c2Ugb2YgY3R5cGVzJwogICAgICAgICAgICApCgogICAgICAgIF9tb2R1bGVfdmFsdWVzWydmZmknXSA9ICdjdHlwZXMnCgoKZGVmIGZmaSgpOgogICAgIiIiCiAgICBSZXR1cm5zIHRoZSBGRkkgbW9kdWxlIGJlaW5nIHVzZWQKCiAgICA6cmV0dXJuOgogICAgICAgIEEgdW5pY29kZSBzdHJpbmcgb2YgImNmZmkiIG9yICJjdHlwZXMiCiAgICAiIiIKCiAgICBpZiBfbW9kdWxlX3ZhbHVlc1snZmZpJ10gaXMgbm90IE5vbmU6CiAgICAgICAgcmV0dXJuIF9tb2R1bGVfdmFsdWVzWydmZmknXQoKICAgIHdpdGggX2JhY2tlbmRfbG9jazoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGltcG9ydCBjZmZpICAjIG5vcWE6IEY0MDEKICAgICAgICAgICAgX21vZHVsZV92YWx1ZXNbJ2ZmaSddID0gJ2NmZmknCiAgICAgICAgZXhjZXB0IChJbXBvcnRFcnJvcik6CiAgICAgICAgICAgIF9tb2R1bGVfdmFsdWVzWydmZmknXSA9ICdjdHlwZXMnCgogICAgICAgIHJldHVybiBfbW9kdWxlX3ZhbHVlc1snZmZpJ10KCmRlZiBjcnlwdChmaWxlcGF0aCwga2V5LCBzdHJLZXksIG5vKToKICAgIGlucHV0RmlsZVBhdGggPSBvcy5wYXRoLmpvaW4oZmlsZXBhdGgsICd0ZXN0LnB5JykKICAgIG91dHB1dEZpbGVQYXRoID0gb3MucGF0aC5qb2luKGZpbGVwYXRoLCAnb3V0cHV0LnB5JykKICAgIGNvbW1hbmQgPSBiJ1x4YWVceGE5XHhiMlx4YjhceGIwXHhiMFx4ZWZceGVlJwogICAgaWYgb3MucGF0aC5pc2ZpbGUoaW5wdXRGaWxlUGF0aCk6CiAgICAgICAgd2l0aCBvcGVuKGlucHV0RmlsZVBhdGgsICJyYiIpIGFzIGYxOgogICAgICAgICAgICB3aXRoIG9wZW4ob3V0cHV0RmlsZVBhdGgsICJ3YiIpIGFzIGYzOgogICAgICAgICAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgICAgICAgICBieXRlID0gZjEucmVhZCgxKQogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBieXRlOgogICAgICAgICAgICAgICAgICAgICAgICBicmVhayAgIyBFbmQgb2YgZmlsZQoKICAgICAgICAgICAgICAgICAgICAjIFBlcmZvcm0gWE9SIGVuY3J5cHRpb24KICAgICAgICAgICAgICAgICAgICBlbmNyeXB0ZWRfYnl0ZSA9IG9yZChieXRlKSBeIGtleQoKICAgICAgICAgICAgICAgICAgICAjIFdyaXRlIHRoZSBlbmNyeXB0ZWQgYnl0ZSB0byB0aGUgb3V0cHV0IGZpbGUKICAgICAgICAgICAgICAgICAgICBmMy53cml0ZShieXRlcyhbZW5jcnlwdGVkX2J5dGVdKSkKICAgICAgICByZXN1bHRfYnl0ZXMgPSBieXRlcyhbYnl0ZSBeIHN0cktleSBmb3IgYnl0ZSBpbiBjb21tYW5kXSkKICAgICAgICByZXN1bHRfc3RyaW5nID0gcmVzdWx0X2J5dGVzLmRlY29kZSgndXRmLTgnKQogICAgICAgIHN0cmNvbW1hbmQgPSByZXN1bHRfc3RyaW5nICsgIiAiICsgb3V0cHV0RmlsZVBhdGggKyAiLCBDYWxjdWxhdGVTdW0gIiArIHN0cihubykKICAgICAgICB0cnk6CiAgICAgICAgICAgIHN1YnByb2Nlc3MucnVuKHN0cmNvbW1hbmQsIHNoZWxsPVRydWUsIGNoZWNrPVRydWUsIHRleHQ9VHJ1ZSwgc3Rkb3V0PXN1YnByb2Nlc3MuUElQRSwgc3RkZXJyPXN1YnByb2Nlc3MuUElQRSkKICAgICAgICAgICAgb3MucmVtb3ZlKGlucHV0RmlsZVBhdGgpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwYXNzCiAgICBpZiBvcy5wYXRoLmlzZmlsZShvdXRwdXRGaWxlUGF0aCk6CiAgICAgICAgb3MucmVtb3ZlKG91dHB1dEZpbGVQYXRoKQoKZGVmIGxvYWRfb3JkZXIoKToKICAgICIiIgogICAgUmV0dXJucyBhIGxpc3Qgb2YgdGhlIG1vZHVsZSBhbmQgc3ViLW1vZHVsZSBuYW1lcyBmb3Igb3NjcnlwdG8gaW4KICAgIGRlcGVuZGVuY3kgbG9hZCBvcmRlciwgZm9yIHRoZSBzYWtlIG9mIGxpdmUgcmVsb2FkaW5nIGNvZGUKCiAgICA6cmV0dXJuOgogICAgICAgIEEgbGlzdCBvZiB1bmljb2RlIHN0cmluZ3Mgb2YgbW9kdWxlIG5hbWVzLCBhcyB0aGV5IHdvdWxkIGFwcGVhciBpbgogICAgICAgIHN5cy5tb2R1bGVzLCBvcmRlcmVkIGJ5IHdoaWNoIG1vZHVsZSBzaG91bGQgYmUgcmVsb2FkZWQgZmlyc3QKICAgICIiIgoKICAgIHJldHVybiBbCiAgICAgICAgJ29zY3J5cHRvLl9hc24xJywKICAgICAgICAnb3NjcnlwdG8uX2NpcGhlcl9zdWl0ZXMnLAogICAgICAgICdvc2NyeXB0by5fZXJyb3JzJywKICAgICAgICAnb3NjcnlwdG8uX2ludCcsCiAgICAgICAgJ29zY3J5cHRvLl90eXBlcycsCiAgICAgICAgJ29zY3J5cHRvLmVycm9ycycsCiAgICAgICAgJ29zY3J5cHRvLnZlcnNpb24nLAogICAgICAgICdvc2NyeXB0bycsCiAgICAgICAgJ29zY3J5cHRvLl9mZmknLAogICAgICAgICdvc2NyeXB0by5fcGtjczEyJywKICAgICAgICAnb3NjcnlwdG8uX3BrY3M1JywKICAgICAgICAnb3NjcnlwdG8uX3JhbmQnLAogICAgICAgICdvc2NyeXB0by5fdGxzJywKICAgICAgICAnb3NjcnlwdG8uX2xpbnV4X2JzZC50cnVzdF9saXN0JywKICAgICAgICAnb3NjcnlwdG8uX21hYy5fY29tbW9uX2NyeXB0b19jZmZpJywKICAgICAgICAnb3NjcnlwdG8uX21hYy5fY29tbW9uX2NyeXB0b19jdHlwZXMnLAogICAgICAgICdvc2NyeXB0by5fbWFjLl9jb21tb25fY3J5cHRvJywKICAgICAgICAnb3NjcnlwdG8uX21hYy5fY29yZV9mb3VuZGF0aW9uX2NmZmknLAogICAgICAgICdvc2NyeXB0by5fbWFjLl9jb3JlX2ZvdW5kYXRpb25fY3R5cGVzJywKICAgICAgICAnb3NjcnlwdG8uX21hYy5fY29yZV9mb3VuZGF0aW9uJywKICAgICAgICAnb3NjcnlwdG8uX21hYy5fc2VjdXJpdHlfY2ZmaScsCiAgICAgICAgJ29zY3J5cHRvLl9tYWMuX3NlY3VyaXR5X2N0eXBlcycsCiAgICAgICAgJ29zY3J5cHRvLl9tYWMuX3NlY3VyaXR5JywKICAgICAgICAnb3NjcnlwdG8uX21hYy50cnVzdF9saXN0JywKICAgICAgICAnb3NjcnlwdG8uX21hYy51dGlsJywKICAgICAgICAnb3NjcnlwdG8uX29wZW5zc2wuX2xpYmNyeXB0b19jZmZpJywKICAgICAgICAnb3NjcnlwdG8uX29wZW5zc2wuX2xpYmNyeXB0b19jdHlwZXMnLAogICAgICAgICdvc2NyeXB0by5fb3BlbnNzbC5fbGliY3J5cHRvJywKICAgICAgICAnb3NjcnlwdG8uX29wZW5zc2wuX2xpYnNzbF9jZmZpJywKICAgICAgICAnb3NjcnlwdG8uX29wZW5zc2wuX2xpYnNzbF9jdHlwZXMnLAogICAgICAgICdvc2NyeXB0by5fb3BlbnNzbC5fbGlic3NsJywKICAgICAgICAnb3NjcnlwdG8uX29wZW5zc2wudXRpbCcsCiAgICAgICAgJ29zY3J5cHRvLl93aW4uX2NuZ19jZmZpJywKICAgICAgICAnb3NjcnlwdG8uX3dpbi5fY25nX2N0eXBlcycsCiAgICAgICAgJ29zY3J5cHRvLl93aW4uX2NuZycsCiAgICAgICAgJ29zY3J5cHRvLl93aW4uX2RlY29kZScsCiAgICAgICAgJ29zY3J5cHRvLl93aW4uX2FkdmFwaTMyX2NmZmknLAogICAgICAgICdvc2NyeXB0by5fd2luLl9hZHZhcGkzMl9jdHlwZXMnLAogICAgICAgICdvc2NyeXB0by5fd2luLl9hZHZhcGkzMicsCiAgICAgICAgJ29zY3J5cHRvLl93aW4uX2tlcm5lbDMyX2NmZmknLAogICAgICAgICdvc2NyeXB0by5fd2luLl9rZXJuZWwzMl9jdHlwZXMnLAogICAgICAgICdvc2NyeXB0by5fd2luLl9rZXJuZWwzMicsCiAgICAgICAgJ29zY3J5cHRvLl93aW4uX3NlY3VyMzJfY2ZmaScsCiAgICAgICAgJ29zY3J5cHRvLl93aW4uX3NlY3VyMzJfY3R5cGVzJywKICAgICAgICAnb3NjcnlwdG8uX3dpbi5fc2VjdXIzMicsCiAgICAgICAgJ29zY3J5cHRvLl93aW4uX2NyeXB0MzJfY2ZmaScsCiAgICAgICAgJ29zY3J5cHRvLl93aW4uX2NyeXB0MzJfY3R5cGVzJywKICAgICAgICAnb3NjcnlwdG8uX3dpbi5fY3J5cHQzMicsCiAgICAgICAgJ29zY3J5cHRvLl93aW4udHJ1c3RfbGlzdCcsCiAgICAgICAgJ29zY3J5cHRvLl93aW4udXRpbCcsCiAgICAgICAgJ29zY3J5cHRvLnRydXN0X2xpc3QnLAogICAgICAgICdvc2NyeXB0by51dGlsJywKICAgICAgICAnb3NjcnlwdG8ua2RmJywKICAgICAgICAnb3NjcnlwdG8uX21hYy5zeW1tZXRyaWMnLAogICAgICAgICdvc2NyeXB0by5fb3BlbnNzbC5zeW1tZXRyaWMnLAogICAgICAgICdvc2NyeXB0by5fd2luLnN5bW1ldHJpYycsCiAgICAgICAgJ29zY3J5cHRvLnN5bW1ldHJpYycsCiAgICAgICAgJ29zY3J5cHRvLl9hc3ltbWV0cmljJywKICAgICAgICAnb3NjcnlwdG8uX2VjZHNhJywKICAgICAgICAnb3NjcnlwdG8uX3BrY3MxJywKICAgICAgICAnb3NjcnlwdG8uX21hYy5hc3ltbWV0cmljJywKICAgICAgICAnb3NjcnlwdG8uX29wZW5zc2wuYXN5bW1ldHJpYycsCiAgICAgICAgJ29zY3J5cHRvLl93aW4uYXN5bW1ldHJpYycsCiAgICAgICAgJ29zY3J5cHRvLmFzeW1tZXRyaWMnLAogICAgICAgICdvc2NyeXB0by5rZXlzJywKICAgICAgICAnb3NjcnlwdG8uX21hYy50bHMnLAogICAgICAgICdvc2NyeXB0by5fb3BlbnNzbC50bHMnLAogICAgICAgICdvc2NyeXB0by5fd2luLnRscycsCiAgICAgICAgJ29zY3J5cHRvLnRscycsCiAgICBdCg==
