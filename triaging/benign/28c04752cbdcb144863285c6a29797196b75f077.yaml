statistics:
  total_files: 1
  skipped_files: 0.0
  processed_objects: 1
  malicious_objects: 0
details:
- path: .repo_cache/malicious_repos/pypi_malregistry/botaa3/1.0.0/botaa3-1.0.0/boto3-1.20.7/boto3/resources/params.py
  contents:
  - name: <module>
    score: 0.0
    code: |-
      # Copyright 2014 Amazon.com, Inc. or its affiliates. All Rights Reserved.
      #
      # Licensed under the Apache License, Version 2.0 (the "License"). You
      # may not use this file except in compliance with the License. A copy of
      # the License is located at
      #
      # https://aws.amazon.com/apache2.0/
      #
      # or in the "license" file accompanying this file. This file is
      # distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF
      # ANY KIND, either express or implied. See the License for the specific
      # language governing permissions and limitations under the License.

      import re

      import jmespath
      from botocore import xform_name

      from ..exceptions import ResourceLoadException


      INDEX_RE = re.compile(r'\[(.*)\]$')


      def get_data_member(parent, path):
          """
          Get a data member from a parent using a JMESPath search query,
          loading the parent if required. If the parent cannot be loaded
          and no data is present then an exception is raised.

          :type parent: ServiceResource
          :param parent: The resource instance to which contains data we
                         are interested in.
          :type path: string
          :param path: The JMESPath expression to query
          :raises ResourceLoadException: When no data is present and the
                                         resource cannot be loaded.
          :returns: The queried data or ``None``.
          """
          # Ensure the parent has its data loaded, if possible.
          if parent.meta.data is None:
              if hasattr(parent, 'load'):
                  parent.load()
              else:
                  raise ResourceLoadException(
                      '{0} has no load method!'.format(parent.__class__.__name__))

          return jmespath.search(path, parent.meta.data)
    tokens: resume load_const INTEGER load_const import_name re store_name re load_const INTEGER load_const import_name jmespath store_name jmespath load_const INTEGER load_const import_name botocore import_from xform_name store_name xform_name pop_top load_const INTEGER load_const import_name exceptions import_from STRING_LEN_S_ENT_HIGH store_name STRING_LEN_S_ENT_HIGH pop_top push_null load_name re load_attr DYNAMIC_CODE_COMPILATION load_const STRING_FILE_PATH call store_name INDEX_RE load_const OBJECT make_function store_name get_data_member load_const load_const OBJECT make_function defaults store_name STRING_LEN_S_ENT_HIGH load_const load_const OBJECT make_function defaults store_name STRING_LEN_S_ENT_HIGH return_const None
    hash: d1e7be0da37a7030cd8a515b8b64c6e309ef7ef902874e7978e2b0ffcc6e4e06
sources:
  .repo_cache/malicious_repos/pypi_malregistry/botaa3/1.0.0/botaa3-1.0.0/boto3-1.20.7/boto3/resources/params.py: IyBDb3B5cmlnaHQgMjAxNCBBbWF6b24uY29tLCBJbmMuIG9yIGl0cyBhZmZpbGlhdGVzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgojCiMgTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIikuIFlvdQojIG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBBIGNvcHkgb2YKIyB0aGUgTGljZW5zZSBpcyBsb2NhdGVkIGF0CiMKIyBodHRwczovL2F3cy5hbWF6b24uY29tL2FwYWNoZTIuMC8KIwojIG9yIGluIHRoZSAibGljZW5zZSIgZmlsZSBhY2NvbXBhbnlpbmcgdGhpcyBmaWxlLiBUaGlzIGZpbGUgaXMKIyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRgojIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYwojIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgppbXBvcnQgcmUKCmltcG9ydCBqbWVzcGF0aApmcm9tIGJvdG9jb3JlIGltcG9ydCB4Zm9ybV9uYW1lCgpmcm9tIC4uZXhjZXB0aW9ucyBpbXBvcnQgUmVzb3VyY2VMb2FkRXhjZXB0aW9uCgoKSU5ERVhfUkUgPSByZS5jb21waWxlKHInXFsoLiopXF0kJykKCgpkZWYgZ2V0X2RhdGFfbWVtYmVyKHBhcmVudCwgcGF0aCk6CiAgICAiIiIKICAgIEdldCBhIGRhdGEgbWVtYmVyIGZyb20gYSBwYXJlbnQgdXNpbmcgYSBKTUVTUGF0aCBzZWFyY2ggcXVlcnksCiAgICBsb2FkaW5nIHRoZSBwYXJlbnQgaWYgcmVxdWlyZWQuIElmIHRoZSBwYXJlbnQgY2Fubm90IGJlIGxvYWRlZAogICAgYW5kIG5vIGRhdGEgaXMgcHJlc2VudCB0aGVuIGFuIGV4Y2VwdGlvbiBpcyByYWlzZWQuCgogICAgOnR5cGUgcGFyZW50OiBTZXJ2aWNlUmVzb3VyY2UKICAgIDpwYXJhbSBwYXJlbnQ6IFRoZSByZXNvdXJjZSBpbnN0YW5jZSB0byB3aGljaCBjb250YWlucyBkYXRhIHdlCiAgICAgICAgICAgICAgICAgICBhcmUgaW50ZXJlc3RlZCBpbi4KICAgIDp0eXBlIHBhdGg6IHN0cmluZwogICAgOnBhcmFtIHBhdGg6IFRoZSBKTUVTUGF0aCBleHByZXNzaW9uIHRvIHF1ZXJ5CiAgICA6cmFpc2VzIFJlc291cmNlTG9hZEV4Y2VwdGlvbjogV2hlbiBubyBkYXRhIGlzIHByZXNlbnQgYW5kIHRoZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc291cmNlIGNhbm5vdCBiZSBsb2FkZWQuCiAgICA6cmV0dXJuczogVGhlIHF1ZXJpZWQgZGF0YSBvciBgYE5vbmVgYC4KICAgICIiIgogICAgIyBFbnN1cmUgdGhlIHBhcmVudCBoYXMgaXRzIGRhdGEgbG9hZGVkLCBpZiBwb3NzaWJsZS4KICAgIGlmIHBhcmVudC5tZXRhLmRhdGEgaXMgTm9uZToKICAgICAgICBpZiBoYXNhdHRyKHBhcmVudCwgJ2xvYWQnKToKICAgICAgICAgICAgcGFyZW50LmxvYWQoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJhaXNlIFJlc291cmNlTG9hZEV4Y2VwdGlvbigKICAgICAgICAgICAgICAgICd7MH0gaGFzIG5vIGxvYWQgbWV0aG9kIScuZm9ybWF0KHBhcmVudC5fX2NsYXNzX18uX19uYW1lX18pKQoKICAgIHJldHVybiBqbWVzcGF0aC5zZWFyY2gocGF0aCwgcGFyZW50Lm1ldGEuZGF0YSkKCgpkZWYgY3JlYXRlX3JlcXVlc3RfcGFyYW1ldGVycyhwYXJlbnQsIHJlcXVlc3RfbW9kZWwsIHBhcmFtcz1Ob25lLCBpbmRleD1Ob25lKToKICAgICIiIgogICAgSGFuZGxlIHJlcXVlc3QgcGFyYW1ldGVycyB0aGF0IGNhbiBiZSBmaWxsZWQgaW4gZnJvbSBpZGVudGlmaWVycywKICAgIHJlc291cmNlIGRhdGEgbWVtYmVycyBvciBjb25zdGFudHMuCgogICAgQnkgcGFzc2luZyBgYHBhcmFtc2BgLCB5b3UgY2FuIGludm9rZSB0aGlzIG1ldGhvZCBtdWx0aXBsZSB0aW1lcyBhbmQKICAgIGJ1aWxkIHVwIGEgcGFyYW1ldGVyIGRpY3Qgb3ZlciB0aW1lLCB3aGljaCBpcyBwYXJ0aWN1bGFybHkgdXNlZnVsCiAgICBmb3IgcmV2ZXJzZSBKTUVTUGF0aCBleHByZXNzaW9ucyB0aGF0IGFwcGVuZCB0byBsaXN0cy4KCiAgICA6dHlwZSBwYXJlbnQ6IFNlcnZpY2VSZXNvdXJjZQogICAgOnBhcmFtIHBhcmVudDogVGhlIHJlc291cmNlIGluc3RhbmNlIHRvIHdoaWNoIHRoaXMgYWN0aW9uIGlzIGF0dGFjaGVkLgogICAgOnR5cGUgcmVxdWVzdF9tb2RlbDogOnB5OmNsYXNzOmB+Ym90bzMucmVzb3VyY2VzLm1vZGVsLlJlcXVlc3RgCiAgICA6cGFyYW0gcmVxdWVzdF9tb2RlbDogVGhlIGFjdGlvbiByZXF1ZXN0IG1vZGVsLgogICAgOnR5cGUgcGFyYW1zOiBkaWN0CiAgICA6cGFyYW0gcGFyYW1zOiBJZiBzZXQsIHRoZW4gYWRkIHRvIHRoaXMgZXhpc3RpbmcgZGljdC4gSXQgaXMgYm90aAogICAgICAgICAgICAgICAgICAgZWRpdGVkIGluLXBsYWNlIGFuZCByZXR1cm5lZC4KICAgIDp0eXBlIGluZGV4OiBpbnQKICAgIDpwYXJhbSBpbmRleDogVGhlIHBvc2l0aW9uIG9mIGFuIGl0ZW0gd2l0aGluIGEgbGlzdAogICAgOnJ0eXBlOiBkaWN0CiAgICA6cmV0dXJuOiBQcmUtZmlsbGVkIHBhcmFtZXRlcnMgdG8gYmUgc2VudCB0byB0aGUgcmVxdWVzdCBvcGVyYXRpb24uCiAgICAiIiIKICAgIGlmIHBhcmFtcyBpcyBOb25lOgogICAgICAgIHBhcmFtcyA9IHt9CgogICAgZm9yIHBhcmFtIGluIHJlcXVlc3RfbW9kZWwucGFyYW1zOgogICAgICAgIHNvdXJjZSA9IHBhcmFtLnNvdXJjZQogICAgICAgIHRhcmdldCA9IHBhcmFtLnRhcmdldAoKICAgICAgICBpZiBzb3VyY2UgPT0gJ2lkZW50aWZpZXInOgogICAgICAgICAgICAjIFJlc291cmNlIGlkZW50aWZpZXIsIGUuZy4gcXVldWUudXJsCiAgICAgICAgICAgIHZhbHVlID0gZ2V0YXR0cihwYXJlbnQsIHhmb3JtX25hbWUocGFyYW0ubmFtZSkpCiAgICAgICAgZWxpZiBzb3VyY2UgPT0gJ2RhdGEnOgogICAgICAgICAgICAjIElmIHRoaXMgaXMgYSBkYXRhIG1lbWJlciB0aGVuIGl0IG1heSBpbmN1ciBhIGxvYWQKICAgICAgICAgICAgIyBhY3Rpb24gYmVmb3JlIHJldHVybmluZyB0aGUgdmFsdWUuCiAgICAgICAgICAgIHZhbHVlID0gZ2V0X2RhdGFfbWVtYmVyKHBhcmVudCwgcGFyYW0ucGF0aCkKICAgICAgICBlbGlmIHNvdXJjZSBpbiBbJ3N0cmluZycsICdpbnRlZ2VyJywgJ2Jvb2xlYW4nXToKICAgICAgICAgICAgIyBUaGVzZSBhcmUgaGFyZC1jb2RlZCB2YWx1ZXMgaW4gdGhlIGRlZmluaXRpb24KICAgICAgICAgICAgdmFsdWUgPSBwYXJhbS52YWx1ZQogICAgICAgIGVsaWYgc291cmNlID09ICdpbnB1dCc6CiAgICAgICAgICAgICMgVGhpcyBpcyBwcm92aWRlZCBieSB0aGUgdXNlciwgc28gaWdub3JlIGl0IGhlcmUKICAgICAgICAgICAgY29udGludWUKICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBOb3RJbXBsZW1lbnRlZEVycm9yKAogICAgICAgICAgICAgICAgJ1Vuc3VwcG9ydGVkIHNvdXJjZSB0eXBlOiB7MH0nLmZvcm1hdChzb3VyY2UpKQoKICAgICAgICBidWlsZF9wYXJhbV9zdHJ1Y3R1cmUocGFyYW1zLCB0YXJnZXQsIHZhbHVlLCBpbmRleCkKCiAgICByZXR1cm4gcGFyYW1zCgoKZGVmIGJ1aWxkX3BhcmFtX3N0cnVjdHVyZShwYXJhbXMsIHRhcmdldCwgdmFsdWUsIGluZGV4PU5vbmUpOgogICAgIiIiCiAgICBUaGlzIG1ldGhvZCBwcm92aWRlcyBhIGJhc2ljIHJldmVyc2UgSk1FU1BhdGggaW1wbGVtZW50YXRpb24gdGhhdAogICAgbGV0cyB5b3UgZ28gZnJvbSBhIEpNRVNQYXRoLWxpa2Ugc3RyaW5nIHRvIGEgcG9zc2libHkgZGVlcGx5IG5lc3RlZAogICAgb2JqZWN0LiBUaGUgYGBwYXJhbXNgYCBhcmUgbXV0YXRlZCBpbi1wbGFjZSwgc28gc3Vic2VxdWVudCBjYWxscwogICAgY2FuIG1vZGlmeSB0aGUgc2FtZSBlbGVtZW50IGJ5IGl0cyBpbmRleC4KCiAgICAgICAgPj4+IGJ1aWxkX3BhcmFtX3N0cnVjdHVyZShwYXJhbXMsICd0ZXN0WzBdJywgMSkKICAgICAgICA+Pj4gcHJpbnQocGFyYW1zKQogICAgICAgIHsndGVzdCc6IFsxXX0KCiAgICAgICAgPj4+IGJ1aWxkX3BhcmFtX3N0cnVjdHVyZShwYXJhbXMsICdmb28uYmFyWzBdLmJheicsICdoZWxsbyB3b3JsZCcpCiAgICAgICAgPj4+IHByaW50KHBhcmFtcykKICAgICAgICB7J3Rlc3QnOiBbMV0sICdmb28nOiB7J2Jhcic6IFt7J2Jheic6ICdoZWxsbywgd29ybGQnfV19fQoKICAgICIiIgogICAgcG9zID0gcGFyYW1zCiAgICBwYXJ0cyA9IHRhcmdldC5zcGxpdCgnLicpCgogICAgIyBGaXJzdCwgc3BsaXQgaW50byBwYXJ0cyBsaWtlICdmb28nLCAnYmFyWzBdJywgJ2JheicgYW5kIHByb2Nlc3MKICAgICMgZWFjaCBwaWVjZS4gSXQgY2FuIGVpdGhlciBiZSBhIGxpc3Qgb3IgYSBkaWN0LCBkZXBlbmRpbmcgb24gaWYKICAgICMgYW4gaW5kZXggbGlrZSBgWzBdYCBpcyBwcmVzZW50LiBXZSBkZXRlY3QgdGhpcyB2aWEgYSByZWd1bGFyCiAgICAjIGV4cHJlc3Npb24sIGFuZCBrZWVwIHRyYWNrIG9mIHdoZXJlIHdlIGFyZSBpbiBwYXJhbXMgdmlhIHRoZQogICAgIyBwb3MgdmFyaWFibGUsIHdhbGtpbmcgZG93biB0byB0aGUgbGFzdCBpdGVtLiBPbmNlIHRoZXJlLCB3ZQogICAgIyBzZXQgdGhlIHZhbHVlLgogICAgZm9yIGksIHBhcnQgaW4gZW51bWVyYXRlKHBhcnRzKToKICAgICAgICAjIElzIGl0IGluZGV4aW5nIGFuIGFycmF5PwogICAgICAgIHJlc3VsdCA9IElOREVYX1JFLnNlYXJjaChwYXJ0KQogICAgICAgIGlmIHJlc3VsdDoKICAgICAgICAgICAgaWYgcmVzdWx0Lmdyb3VwKDEpOgogICAgICAgICAgICAgICAgaWYgcmVzdWx0Lmdyb3VwKDEpID09ICcqJzoKICAgICAgICAgICAgICAgICAgICBwYXJ0ID0gcGFydFs6LTNdCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICMgV2UgaGF2ZSBhbiBleHBsaWNpdCBpbmRleAogICAgICAgICAgICAgICAgICAgIGluZGV4ID0gaW50KHJlc3VsdC5ncm91cCgxKSkKICAgICAgICAgICAgICAgICAgICBwYXJ0ID0gcGFydFs6LWxlbihzdHIoaW5kZXgpICsgJ1tdJyldCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAjIEluZGV4IHdpbGwgYmUgc2V0IGFmdGVyIHdlIGtub3cgdGhlIHByb3BlciBwYXJ0CiAgICAgICAgICAgICAgICAjIG5hbWUgYW5kIHRoYXQgaXQncyBhIGxpc3QgaW5zdGFuY2UuCiAgICAgICAgICAgICAgICBpbmRleCA9IE5vbmUKICAgICAgICAgICAgICAgIHBhcnQgPSBwYXJ0WzotMl0KCiAgICAgICAgICAgIGlmIHBhcnQgbm90IGluIHBvcyBvciBub3QgaXNpbnN0YW5jZShwb3NbcGFydF0sIGxpc3QpOgogICAgICAgICAgICAgICAgcG9zW3BhcnRdID0gW10KCiAgICAgICAgICAgICMgVGhpcyBtZWFucyB3ZSBzaG91bGQgYXBwZW5kLCBlLmcuICdmb29bXScKICAgICAgICAgICAgaWYgaW5kZXggaXMgTm9uZToKICAgICAgICAgICAgICAgIGluZGV4ID0gbGVuKHBvc1twYXJ0XSkKCiAgICAgICAgICAgIHdoaWxlIGxlbihwb3NbcGFydF0pIDw9IGluZGV4OgogICAgICAgICAgICAgICAgIyBBc3N1bWUgaXQncyBhIGRpY3QgdW50aWwgd2Ugc2V0IHRoZSBmaW5hbCB2YWx1ZSBiZWxvdwogICAgICAgICAgICAgICAgcG9zW3BhcnRdLmFwcGVuZCh7fSkKCiAgICAgICAgICAgICMgTGFzdCBpdGVtPyBTZXQgdGhlIHZhbHVlLCBvdGhlcndpc2Ugc2V0IHRoZSBuZXcgcG9zaXRpb24KICAgICAgICAgICAgaWYgaSA9PSBsZW4ocGFydHMpIC0gMToKICAgICAgICAgICAgICAgIHBvc1twYXJ0XVtpbmRleF0gPSB2YWx1ZQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgIyBUaGUgbmV3IHBvcyBpcyB0aGUgKml0ZW0qIGluIHRoZSBhcnJheSwgbm90IHRoZSBhcnJheSEKICAgICAgICAgICAgICAgIHBvcyA9IHBvc1twYXJ0XVtpbmRleF0KICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiBwYXJ0IG5vdCBpbiBwb3M6CiAgICAgICAgICAgICAgICBwb3NbcGFydF0gPSB7fQoKICAgICAgICAgICAgIyBMYXN0IGl0ZW0/IFNldCB0aGUgdmFsdWUsIG90aGVyd2lzZSBzZXQgdGhlIG5ldyBwb3NpdGlvbgogICAgICAgICAgICBpZiBpID09IGxlbihwYXJ0cykgLSAxOgogICAgICAgICAgICAgICAgcG9zW3BhcnRdID0gdmFsdWUKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHBvcyA9IHBvc1twYXJ0XQo=
