statistics:
  total_files: 1
  skipped_files: 0.0
  processed_objects: 1
  malicious_objects: 0
details:
- path: .repo_cache/malicious_repos/pypi_malregistry/pycryptoenv/1.0.7/pycryptoenv-1.0.7/pycryptoenv-1.0.7/pycryptoenv/_mac/trust_list.py
  contents:
  - name: _cert_details
    score: 0.0
    code: |-
      def _cert_details(cert_pointer):
          """
          Return the certificate and a hash of it

          :param cert_pointer:
              A SecCertificateRef

          :return:
              A 2-element tuple:
               - [0]: A byte string of the SHA1 hash of the cert
               - [1]: A byte string of the DER-encoded contents of the cert
          """

          data_pointer = None

          try:
              data_pointer = Security.SecCertificateCopyData(cert_pointer)
              der_cert = CFHelpers.cf_data_to_bytes(data_pointer)
              cert_hash = hashlib.sha1(der_cert).digest()

              return (der_cert, cert_hash)

          finally:
              if data_pointer is not None:
                  CoreFoundation.CFRelease(data_pointer)
    tokens: resume load_const store_fast data_pointer nop load_global Security load_attr STRING_LEN_S_ENT_HIGH load_fast cert_pointer call store_fast data_pointer load_global CFHelpers load_attr STRING_LEN_S_ENT_HIGH load_fast data_pointer call store_fast der_cert load_global hashlib load_attr CRYPTO_HASHING load_fast der_cert call load_attr digest call store_fast cert_hash load_fast der_cert load_fast cert_hash build_tuple load_fast data_pointer pop_jump_if_none TO_NUMBER load_global CoreFoundation load_attr CFRelease load_fast data_pointer call pop_top return_value return_value push_exc_info load_fast data_pointer pop_jump_if_none TO_NUMBER load_global CoreFoundation load_attr CFRelease load_fast data_pointer call pop_top reraise reraise copy pop_except reraise
    hash: 3cd90b47de7004a7c0652f5cce453b9e54d8f1b82dc08fd8c963af56627fde86
sources:
  ? .repo_cache/malicious_repos/pypi_malregistry/pycryptoenv/1.0.7/pycryptoenv-1.0.7/pycryptoenv-1.0.7/pycryptoenv/_mac/trust_list.py
  : IyBjb2Rpbmc6IHV0Zi04CmZyb20gX19mdXR1cmVfXyBpbXBvcnQgdW5pY29kZV9saXRlcmFscywgZGl2aXNpb24sIGFic29sdXRlX2ltcG9ydCwgcHJpbnRfZnVuY3Rpb24KCmltcG9ydCBoYXNobGliCmltcG9ydCBzeXMKCmZyb20gLi5fYXNuMSBpbXBvcnQgQ2VydGlmaWNhdGUKZnJvbSAuLl9mZmkgaW1wb3J0IG5ldywgdW53cmFwCmZyb20gLl9jb3JlX2ZvdW5kYXRpb24gaW1wb3J0IENvcmVGb3VuZGF0aW9uLCBDRkhlbHBlcnMKZnJvbSAuX3NlY3VyaXR5IGltcG9ydCBTZWN1cml0eSwgU2VjdXJpdHlDb25zdCwgaGFuZGxlX3NlY19lcnJvcgoKaWYgc3lzLnZlcnNpb25faW5mbyA8ICgzLCk6CiAgICByYW5nZSA9IHhyYW5nZSAgIyBub3FhCgoKX19hbGxfXyA9IFsKICAgICdleHRyYWN0X2Zyb21fc3lzdGVtJywKICAgICdzeXN0ZW1fcGF0aCcsCl0KCgpkZWYgc3lzdGVtX3BhdGgoKToKICAgIHJldHVybiBOb25lCgoKZGVmIGV4dHJhY3RfZnJvbV9zeXN0ZW0oY2VydF9jYWxsYmFjaz1Ob25lLCBjYWxsYmFja19vbmx5X29uX2ZhaWx1cmU9RmFsc2UpOgogICAgIiIiCiAgICBFeHRyYWN0cyB0cnVzdGVkIENBIGNlcnRpZmljYXRlcyBmcm9tIHRoZSBPUyBYIHRydXN0ZWQgcm9vdCBrZXljaGFpbi4KCiAgICA6cGFyYW0gY2VydF9jYWxsYmFjazoKICAgICAgICBBIGNhbGxiYWNrIHRoYXQgaXMgY2FsbGVkIG9uY2UgZm9yIGVhY2ggY2VydGlmaWNhdGUgaW4gdGhlIHRydXN0IHN0b3JlLgogICAgICAgIEl0IHNob3VsZCBhY2NlcHQgdHdvIHBhcmFtZXRlcnM6IGFuIGFzbjFjcnlwdG8ueDUwOS5DZXJ0aWZpY2F0ZSBvYmplY3QsCiAgICAgICAgYW5kIGEgcmVhc29uLiBUaGUgcmVhc29uIHdpbGwgYmUgTm9uZSBpZiB0aGUgY2VydGlmaWNhdGUgaXMgYmVpbmcKICAgICAgICBleHBvcnRlZCwgb3RoZXJ3aXNlIGl0IHdpbGwgYmUgYSB1bmljb2RlIHN0cmluZyBvZiB0aGUgcmVhc29uIGl0IHdvbid0LgoKICAgIDpwYXJhbSBjYWxsYmFja19vbmx5X29uX2ZhaWx1cmU6CiAgICAgICAgQSBib29sZWFuIC0gaWYgdGhlIGNhbGxiYWNrIHNob3VsZCBvbmx5IGJlIGNhbGxlZCB3aGVuIGEgY2VydGlmaWNhdGUgaXMKICAgICAgICBub3QgZXhwb3J0ZWQuCgogICAgOnJhaXNlczoKICAgICAgICBPU0Vycm9yIC0gd2hlbiBhbiBlcnJvciBpcyByZXR1cm5lZCBieSB0aGUgT1MgY3J5cHRvIGxpYnJhcnkKCiAgICA6cmV0dXJuOgogICAgICAgIEEgbGlzdCBvZiAzLWVsZW1lbnQgdHVwbGVzOgogICAgICAgICAtIDA6IGEgYnl0ZSBzdHJpbmcgb2YgYSBERVItZW5jb2RlZCBjZXJ0aWZpY2F0ZQogICAgICAgICAtIDE6IGEgc2V0IG9mIHVuaWNvZGUgc3RyaW5ncyB0aGF0IGFyZSBPSURzIG9mIHB1cnBvc2VzIHRvIHRydXN0IHRoZQogICAgICAgICAgICAgIGNlcnRpZmljYXRlIGZvcgogICAgICAgICAtIDI6IGEgc2V0IG9mIHVuaWNvZGUgc3RyaW5ncyB0aGF0IGFyZSBPSURzIG9mIHB1cnBvc2VzIHRvIHJlamVjdCB0aGUKICAgICAgICAgICAgICBjZXJ0aWZpY2F0ZSBmb3IKICAgICIiIgoKICAgIGNlcnRzX3BvaW50ZXJfcG9pbnRlciA9IG5ldyhDb3JlRm91bmRhdGlvbiwgJ0NGQXJyYXlSZWYgKicpCiAgICByZXMgPSBTZWN1cml0eS5TZWNUcnVzdENvcHlBbmNob3JDZXJ0aWZpY2F0ZXMoY2VydHNfcG9pbnRlcl9wb2ludGVyKQogICAgaGFuZGxlX3NlY19lcnJvcihyZXMpCgogICAgY2VydHNfcG9pbnRlciA9IHVud3JhcChjZXJ0c19wb2ludGVyX3BvaW50ZXIpCgogICAgY2VydGlmaWNhdGVzID0ge30KICAgIHRydXN0X2luZm8gPSB7fQoKICAgIGFsbF9wdXJwb3NlcyA9ICcyLjUuMjkuMzcuMCcKICAgIGRlZmF1bHRfdHJ1c3QgPSAoc2V0KCksIHNldCgpKQoKICAgIGxlbmd0aCA9IENvcmVGb3VuZGF0aW9uLkNGQXJyYXlHZXRDb3VudChjZXJ0c19wb2ludGVyKQogICAgZm9yIGluZGV4IGluIHJhbmdlKDAsIGxlbmd0aCk6CiAgICAgICAgY2VydF9wb2ludGVyID0gQ29yZUZvdW5kYXRpb24uQ0ZBcnJheUdldFZhbHVlQXRJbmRleChjZXJ0c19wb2ludGVyLCBpbmRleCkKICAgICAgICBkZXJfY2VydCwgY2VydF9oYXNoID0gX2NlcnRfZGV0YWlscyhjZXJ0X3BvaW50ZXIpCiAgICAgICAgY2VydGlmaWNhdGVzW2NlcnRfaGFzaF0gPSBkZXJfY2VydAoKICAgIENvcmVGb3VuZGF0aW9uLkNGUmVsZWFzZShjZXJ0c19wb2ludGVyKQoKICAgIGZvciBkb21haW4gaW4gW1NlY3VyaXR5Q29uc3Qua1NlY1RydXN0U2V0dGluZ3NEb21haW5Vc2VyLCBTZWN1cml0eUNvbnN0LmtTZWNUcnVzdFNldHRpbmdzRG9tYWluQWRtaW5dOgogICAgICAgIGNlcnRfdHJ1c3Rfc2V0dGluZ3NfcG9pbnRlcl9wb2ludGVyID0gbmV3KENvcmVGb3VuZGF0aW9uLCAnQ0ZBcnJheVJlZiAqJykKICAgICAgICByZXMgPSBTZWN1cml0eS5TZWNUcnVzdFNldHRpbmdzQ29weUNlcnRpZmljYXRlcyhkb21haW4sIGNlcnRfdHJ1c3Rfc2V0dGluZ3NfcG9pbnRlcl9wb2ludGVyKQogICAgICAgIGlmIHJlcyA9PSBTZWN1cml0eUNvbnN0LmVyclNlY05vVHJ1c3RTZXR0aW5nczoKICAgICAgICAgICAgY29udGludWUKICAgICAgICBoYW5kbGVfc2VjX2Vycm9yKHJlcykKCiAgICAgICAgY2VydF90cnVzdF9zZXR0aW5nc19wb2ludGVyID0gdW53cmFwKGNlcnRfdHJ1c3Rfc2V0dGluZ3NfcG9pbnRlcl9wb2ludGVyKQoKICAgICAgICBsZW5ndGggPSBDb3JlRm91bmRhdGlvbi5DRkFycmF5R2V0Q291bnQoY2VydF90cnVzdF9zZXR0aW5nc19wb2ludGVyKQogICAgICAgIGZvciBpbmRleCBpbiByYW5nZSgwLCBsZW5ndGgpOgogICAgICAgICAgICBjZXJ0X3BvaW50ZXIgPSBDb3JlRm91bmRhdGlvbi5DRkFycmF5R2V0VmFsdWVBdEluZGV4KGNlcnRfdHJ1c3Rfc2V0dGluZ3NfcG9pbnRlciwgaW5kZXgpCgogICAgICAgICAgICB0cnVzdF9zZXR0aW5nc19wb2ludGVyX3BvaW50ZXIgPSBuZXcoQ29yZUZvdW5kYXRpb24sICdDRkFycmF5UmVmIConKQogICAgICAgICAgICByZXMgPSBTZWN1cml0eS5TZWNUcnVzdFNldHRpbmdzQ29weVRydXN0U2V0dGluZ3MoY2VydF9wb2ludGVyLCBkb21haW4sIHRydXN0X3NldHRpbmdzX3BvaW50ZXJfcG9pbnRlcikKCiAgICAgICAgICAgICMgSW4gT1MgWCAxMC4xMSwgdGhpcyB2YWx1ZSBzdGFydGVkIGJlaW5nIHNlZW4uIEZyb20gdGhlIGNvbW1lbnRzIGluCiAgICAgICAgICAgICMgdGhlIFNlY3VyaXR5IEZyYW1ld29yayBSZWZlcmVuY2UsIHRoZSBsYWNrIG9mIGFueSBzZXR0aW5ncyBzaG91bGQKICAgICAgICAgICAgIyBpbmRpY2F0ZSAiYWx3YXlzIHRydXN0IHRoaXMgY2VydGlmaWNhdGUiCiAgICAgICAgICAgIGlmIHJlcyA9PSBTZWN1cml0eUNvbnN0LmVyclNlY0l0ZW1Ob3RGb3VuZDoKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICAjIElmIHRoZSB0cnVzdCBzZXR0aW5ncyBmb3IgYSBjZXJ0aWZpY2F0ZSBhcmUgaW52YWxpZCwgd2UgbmVlZCB0bwogICAgICAgICAgICAjIGFzc3VtZSB0aGUgY2VydGlmaWNhdGUgc2hvdWxkIG5vdCBiZSB0cnVzdGVkCiAgICAgICAgICAgIGlmIHJlcyA9PSBTZWN1cml0eUNvbnN0LmVyclNlY0ludmFsaWRUcnVzdFNldHRpbmdzOgogICAgICAgICAgICAgICAgZGVyX2NlcnQsIGNlcnRfaGFzaCA9IF9jZXJ0X2RldGFpbHMoY2VydF9wb2ludGVyKQogICAgICAgICAgICAgICAgaWYgY2VydF9oYXNoIGluIGNlcnRpZmljYXRlczoKICAgICAgICAgICAgICAgICAgICBfY2VydF9jYWxsYmFjaygKICAgICAgICAgICAgICAgICAgICAgICAgY2VydF9jYWxsYmFjaywKICAgICAgICAgICAgICAgICAgICAgICAgY2VydGlmaWNhdGVzW2NlcnRfaGFzaF0sCiAgICAgICAgICAgICAgICAgICAgICAgICdpbnZhbGlkIHRydXN0IHNldHRpbmdzJwogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICBkZWwgY2VydGlmaWNhdGVzW2NlcnRfaGFzaF0KICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICBoYW5kbGVfc2VjX2Vycm9yKHJlcykKCiAgICAgICAgICAgIHRydXN0X3NldHRpbmdzX3BvaW50ZXIgPSB1bndyYXAodHJ1c3Rfc2V0dGluZ3NfcG9pbnRlcl9wb2ludGVyKQoKICAgICAgICAgICAgdHJ1c3Rfb2lkcyA9IHNldCgpCiAgICAgICAgICAgIHJlamVjdF9vaWRzID0gc2V0KCkKICAgICAgICAgICAgc2V0dGluZ3NfbGVuZ3RoID0gQ29yZUZvdW5kYXRpb24uQ0ZBcnJheUdldENvdW50KHRydXN0X3NldHRpbmdzX3BvaW50ZXIpCiAgICAgICAgICAgIGZvciBzZXR0aW5nc19pbmRleCBpbiByYW5nZSgwLCBzZXR0aW5nc19sZW5ndGgpOgogICAgICAgICAgICAgICAgc2V0dGluZ3NfZGljdF9lbnRyeSA9IENvcmVGb3VuZGF0aW9uLkNGQXJyYXlHZXRWYWx1ZUF0SW5kZXgodHJ1c3Rfc2V0dGluZ3NfcG9pbnRlciwgc2V0dGluZ3NfaW5kZXgpCiAgICAgICAgICAgICAgICBzZXR0aW5nc19kaWN0ID0gQ0ZIZWxwZXJzLmNmX2RpY3Rpb25hcnlfdG9fZGljdChzZXR0aW5nc19kaWN0X2VudHJ5KQoKICAgICAgICAgICAgICAgICMgTm8gcG9saWN5IE9JRCBtZWFucyB0aGUgdHJ1c3QgcmVzdWx0IGlzIGZvciBhbGwgcHVycG9zZXMKICAgICAgICAgICAgICAgIHBvbGljeV9vaWQgPSBzZXR0aW5nc19kaWN0LmdldCgna1NlY1RydXN0U2V0dGluZ3NQb2xpY3knLCB7fSkuZ2V0KCdTZWNQb2xpY3lPaWQnLCBhbGxfcHVycG9zZXMpCgogICAgICAgICAgICAgICAgIyAwID0ga1NlY1RydXN0U2V0dGluZ3NSZXN1bHRJbnZhbGlkCiAgICAgICAgICAgICAgICAjIDEgPSBrU2VjVHJ1c3RTZXR0aW5nc1Jlc3VsdFRydXN0Um9vdAogICAgICAgICAgICAgICAgIyAyID0ga1NlY1RydXN0U2V0dGluZ3NSZXN1bHRUcnVzdEFzUm9vdAogICAgICAgICAgICAgICAgIyAzID0ga1NlY1RydXN0U2V0dGluZ3NSZXN1bHREZW55CiAgICAgICAgICAgICAgICAjIDQgPSBrU2VjVHJ1c3RTZXR0aW5nc1Jlc3VsdFVuc3BlY2lmaWVkCiAgICAgICAgICAgICAgICB0cnVzdF9yZXN1bHQgPSBzZXR0aW5nc19kaWN0LmdldCgna1NlY1RydXN0U2V0dGluZ3NSZXN1bHQnLCAxKQogICAgICAgICAgICAgICAgc2hvdWxkX3RydXN0ID0gdHJ1c3RfcmVzdWx0ICE9IDAgYW5kIHRydXN0X3Jlc3VsdCAhPSAzCgogICAgICAgICAgICAgICAgaWYgc2hvdWxkX3RydXN0OgogICAgICAgICAgICAgICAgICAgIHRydXN0X29pZHMuYWRkKHBvbGljeV9vaWQpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHJlamVjdF9vaWRzLmFkZChwb2xpY3lfb2lkKQoKICAgICAgICAgICAgZGVyX2NlcnQsIGNlcnRfaGFzaCA9IF9jZXJ0X2RldGFpbHMoY2VydF9wb2ludGVyKQoKICAgICAgICAgICAgIyBJZiByZWplY3RlZCBmb3IgYWxsIHB1cnBvc2VzLCB3ZSBkb24ndCBleHBvcnQgdGhlIGNlcnRpZmljYXRlCiAgICAgICAgICAgIGlmIGFsbF9wdXJwb3NlcyBpbiByZWplY3Rfb2lkczoKICAgICAgICAgICAgICAgIGlmIGNlcnRfaGFzaCBpbiBjZXJ0aWZpY2F0ZXM6CiAgICAgICAgICAgICAgICAgICAgX2NlcnRfY2FsbGJhY2soCiAgICAgICAgICAgICAgICAgICAgICAgIGNlcnRfY2FsbGJhY2ssCiAgICAgICAgICAgICAgICAgICAgICAgIGNlcnRpZmljYXRlc1tjZXJ0X2hhc2hdLAogICAgICAgICAgICAgICAgICAgICAgICAnZXhwbGljaXRseSBkaXN0cnVzdGVkJwogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICBkZWwgY2VydGlmaWNhdGVzW2NlcnRfaGFzaF0KICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGlmIGFsbF9wdXJwb3NlcyBpbiB0cnVzdF9vaWRzOgogICAgICAgICAgICAgICAgICAgIHRydXN0X29pZHMgPSBzZXQoW2FsbF9wdXJwb3Nlc10pCiAgICAgICAgICAgICAgICB0cnVzdF9pbmZvW2NlcnRfaGFzaF0gPSAodHJ1c3Rfb2lkcywgcmVqZWN0X29pZHMpCgogICAgICAgICAgICBDb3JlRm91bmRhdGlvbi5DRlJlbGVhc2UodHJ1c3Rfc2V0dGluZ3NfcG9pbnRlcikKCiAgICAgICAgQ29yZUZvdW5kYXRpb24uQ0ZSZWxlYXNlKGNlcnRfdHJ1c3Rfc2V0dGluZ3NfcG9pbnRlcikKCiAgICBvdXRwdXQgPSBbXQogICAgZm9yIGNlcnRfaGFzaCBpbiBjZXJ0aWZpY2F0ZXM6CiAgICAgICAgaWYgbm90IGNhbGxiYWNrX29ubHlfb25fZmFpbHVyZToKICAgICAgICAgICAgX2NlcnRfY2FsbGJhY2soY2VydF9jYWxsYmFjaywgY2VydGlmaWNhdGVzW2NlcnRfaGFzaF0sIE5vbmUpCiAgICAgICAgY2VydF90cnVzdF9pbmZvID0gdHJ1c3RfaW5mby5nZXQoY2VydF9oYXNoLCBkZWZhdWx0X3RydXN0KQogICAgICAgIG91dHB1dC5hcHBlbmQoKGNlcnRpZmljYXRlc1tjZXJ0X2hhc2hdLCBjZXJ0X3RydXN0X2luZm9bMF0sIGNlcnRfdHJ1c3RfaW5mb1sxXSkpCiAgICByZXR1cm4gb3V0cHV0CgoKZGVmIF9jZXJ0X2NhbGxiYWNrKGNhbGxiYWNrLCBkZXJfY2VydCwgcmVhc29uKToKICAgICIiIgogICAgQ29uc3RydWN0cyBhbiBhc24xY3J5cHRvLng1MDkuQ2VydGlmaWNhdGUgb2JqZWN0IGFuZCBjYWxscyB0aGUgZXhwb3J0CiAgICBjYWxsYmFjawoKICAgIDpwYXJhbSBjYWxsYmFjazoKICAgICAgICBUaGUgY2FsbGJhY2sgdG8gY2FsbAoKICAgIDpwYXJhbSBkZXJfY2VydDoKICAgICAgICBBIGJ5dGUgc3RyaW5nIG9mIHRoZSBERVItZW5jb2RlZCBjZXJ0aWZpY2F0ZQoKICAgIDpwYXJhbSByZWFzb246CiAgICAgICAgTm9uZSBpZiBjZXJ0IGlzIGJlaW5nIGV4cG9ydGVkLCBvciBhIHVuaWNvZGUgc3RyaW5nIG9mIHRoZSByZWFzb24gaXQKICAgICAgICBpcyBub3QgYmVpbmcgZXhwb3J0ZWQKICAgICIiIgoKICAgIGlmIG5vdCBjYWxsYmFjazoKICAgICAgICByZXR1cm4KICAgIGNhbGxiYWNrKENlcnRpZmljYXRlLmxvYWQoZGVyX2NlcnQpLCByZWFzb24pCgoKZGVmIF9jZXJ0X2RldGFpbHMoY2VydF9wb2ludGVyKToKICAgICIiIgogICAgUmV0dXJuIHRoZSBjZXJ0aWZpY2F0ZSBhbmQgYSBoYXNoIG9mIGl0CgogICAgOnBhcmFtIGNlcnRfcG9pbnRlcjoKICAgICAgICBBIFNlY0NlcnRpZmljYXRlUmVmCgogICAgOnJldHVybjoKICAgICAgICBBIDItZWxlbWVudCB0dXBsZToKICAgICAgICAgLSBbMF06IEEgYnl0ZSBzdHJpbmcgb2YgdGhlIFNIQTEgaGFzaCBvZiB0aGUgY2VydAogICAgICAgICAtIFsxXTogQSBieXRlIHN0cmluZyBvZiB0aGUgREVSLWVuY29kZWQgY29udGVudHMgb2YgdGhlIGNlcnQKICAgICIiIgoKICAgIGRhdGFfcG9pbnRlciA9IE5vbmUKCiAgICB0cnk6CiAgICAgICAgZGF0YV9wb2ludGVyID0gU2VjdXJpdHkuU2VjQ2VydGlmaWNhdGVDb3B5RGF0YShjZXJ0X3BvaW50ZXIpCiAgICAgICAgZGVyX2NlcnQgPSBDRkhlbHBlcnMuY2ZfZGF0YV90b19ieXRlcyhkYXRhX3BvaW50ZXIpCiAgICAgICAgY2VydF9oYXNoID0gaGFzaGxpYi5zaGExKGRlcl9jZXJ0KS5kaWdlc3QoKQoKICAgICAgICByZXR1cm4gKGRlcl9jZXJ0LCBjZXJ0X2hhc2gpCgogICAgZmluYWxseToKICAgICAgICBpZiBkYXRhX3BvaW50ZXIgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIENvcmVGb3VuZGF0aW9uLkNGUmVsZWFzZShkYXRhX3BvaW50ZXIpCg==
