statistics:
  total_files: 1
  skipped_files: 0.0
  processed_objects: 1
  malicious_objects: 0
details:
- path: .repo_cache/malicious_repos/pypi_malregistry/urlib3/1.21.1/urlib3-1.21.1/urlib3-1.21.1/dummyserver/testcase.py
  contents:
  - name: IPv6HTTPDummyProxyTestCase
    score: 0.0
    code: |-
      def setUpClass(cls):
              if not socket.has_ipv6:
                  raise SkipTest('IPv6 not available')
              else:
                  super(IPv6HTTPDummyServerTestCase, cls).setUpClass()
    tokens: resume load_name __name__ store_name __module__ load_const STRING_LEN_S_ENT_HIGH store_name __qualname__ load_const localhost store_name http_host load_const STRING_IP store_name http_host_alt load_const localhost store_name https_host load_const STRING_IP store_name https_host_alt load_name DEFAULT_CERTS store_name https_certs load_const STRING_IP store_name proxy_host load_const STRING_IP store_name proxy_host_alt return_const None
    hash: 7d49d20664519ddacef0b44a762c974915e5de2aaaf6a5107b3606baa2800c2b
sources:
  .repo_cache/malicious_repos/pypi_malregistry/urlib3/1.21.1/urlib3-1.21.1/urlib3-1.21.1/dummyserver/testcase.py: aW1wb3J0IHN5cwppbXBvcnQgc29ja2V0CmltcG9ydCB0aHJlYWRpbmcKZnJvbSBub3NlLnBsdWdpbnMuc2tpcCBpbXBvcnQgU2tpcFRlc3QKZnJvbSB0b3JuYWRvIGltcG9ydCBpb2xvb3AsIHdlYgoKZnJvbSBkdW1teXNlcnZlci5zZXJ2ZXIgaW1wb3J0ICgKICAgIFNvY2tldFNlcnZlclRocmVhZCwKICAgIHJ1bl90b3JuYWRvX2FwcCwKICAgIHJ1bl9sb29wX2luX3RocmVhZCwKICAgIERFRkFVTFRfQ0VSVFMsCikKZnJvbSBkdW1teXNlcnZlci5oYW5kbGVycyBpbXBvcnQgVGVzdGluZ0FwcApmcm9tIGR1bW15c2VydmVyLnByb3h5IGltcG9ydCBQcm94eUhhbmRsZXIKCmlmIHN5cy52ZXJzaW9uX2luZm8gPj0gKDIsIDcpOgogICAgaW1wb3J0IHVuaXR0ZXN0CmVsc2U6CiAgICBpbXBvcnQgdW5pdHRlc3QyIGFzIHVuaXR0ZXN0CgoKZGVmIGNvbnN1bWVfc29ja2V0KHNvY2ssIGNodW5rcz02NTUzNik6CiAgICB3aGlsZSBub3Qgc29jay5yZWN2KGNodW5rcykuZW5kc3dpdGgoYidcclxuXHJcbicpOgogICAgICAgIHBhc3MKCgpjbGFzcyBTb2NrZXREdW1teVNlcnZlclRlc3RDYXNlKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICIiIgogICAgQSBzaW1wbGUgc29ja2V0LWJhc2VkIHNlcnZlciBpcyBjcmVhdGVkIGZvciB0aGlzIGNsYXNzIHRoYXQgaXMgZ29vZCBmb3IKICAgIGV4YWN0bHkgb25lIHJlcXVlc3QuCiAgICAiIiIKICAgIHNjaGVtZSA9ICdodHRwJwogICAgaG9zdCA9ICdsb2NhbGhvc3QnCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgX3N0YXJ0X3NlcnZlcihjbHMsIHNvY2tldF9oYW5kbGVyKToKICAgICAgICByZWFkeV9ldmVudCA9IHRocmVhZGluZy5FdmVudCgpCiAgICAgICAgY2xzLnNlcnZlcl90aHJlYWQgPSBTb2NrZXRTZXJ2ZXJUaHJlYWQoc29ja2V0X2hhbmRsZXI9c29ja2V0X2hhbmRsZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhZHlfZXZlbnQ9cmVhZHlfZXZlbnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9zdD1jbHMuaG9zdCkKICAgICAgICBjbHMuc2VydmVyX3RocmVhZC5zdGFydCgpCiAgICAgICAgcmVhZHlfZXZlbnQud2FpdCg1KQogICAgICAgIGlmIG5vdCByZWFkeV9ldmVudC5pc19zZXQoKToKICAgICAgICAgICAgcmFpc2UgRXhjZXB0aW9uKCJtb3N0IGxpa2VseSBmYWlsZWQgdG8gc3RhcnQgc2VydmVyIikKICAgICAgICBjbHMucG9ydCA9IGNscy5zZXJ2ZXJfdGhyZWFkLnBvcnQKCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBzdGFydF9yZXNwb25zZV9oYW5kbGVyKGNscywgcmVzcG9uc2UsIG51bT0xLCBibG9ja19zZW5kPU5vbmUpOgogICAgICAgIHJlYWR5X2V2ZW50ID0gdGhyZWFkaW5nLkV2ZW50KCkKCiAgICAgICAgZGVmIHNvY2tldF9oYW5kbGVyKGxpc3RlbmVyKToKICAgICAgICAgICAgZm9yIF8gaW4gcmFuZ2UobnVtKToKICAgICAgICAgICAgICAgIHJlYWR5X2V2ZW50LnNldCgpCgogICAgICAgICAgICAgICAgc29jayA9IGxpc3RlbmVyLmFjY2VwdCgpWzBdCiAgICAgICAgICAgICAgICBjb25zdW1lX3NvY2tldChzb2NrKQogICAgICAgICAgICAgICAgaWYgYmxvY2tfc2VuZDoKICAgICAgICAgICAgICAgICAgICBibG9ja19zZW5kLndhaXQoKQogICAgICAgICAgICAgICAgICAgIGJsb2NrX3NlbmQuY2xlYXIoKQogICAgICAgICAgICAgICAgc29jay5zZW5kKHJlc3BvbnNlKQogICAgICAgICAgICAgICAgc29jay5jbG9zZSgpCgogICAgICAgIGNscy5fc3RhcnRfc2VydmVyKHNvY2tldF9oYW5kbGVyKQogICAgICAgIHJldHVybiByZWFkeV9ldmVudAoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIHN0YXJ0X2Jhc2ljX2hhbmRsZXIoY2xzLCAqKmt3KToKICAgICAgICByZXR1cm4gY2xzLnN0YXJ0X3Jlc3BvbnNlX2hhbmRsZXIoCiAgICAgICAgICAgIGInSFRUUC8xLjEgMjAwIE9LXHJcbicKICAgICAgICAgICAgYidDb250ZW50LUxlbmd0aDogMFxyXG4nCiAgICAgICAgICAgIGInXHJcbicsICoqa3cpCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgdGVhckRvd25DbGFzcyhjbHMpOgogICAgICAgIGlmIGhhc2F0dHIoY2xzLCAnc2VydmVyX3RocmVhZCcpOgogICAgICAgICAgICBjbHMuc2VydmVyX3RocmVhZC5qb2luKDAuMSkKCgpjbGFzcyBJUFY0U29ja2V0RHVtbXlTZXJ2ZXJUZXN0Q2FzZShTb2NrZXREdW1teVNlcnZlclRlc3RDYXNlKToKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIF9zdGFydF9zZXJ2ZXIoY2xzLCBzb2NrZXRfaGFuZGxlcik6CiAgICAgICAgcmVhZHlfZXZlbnQgPSB0aHJlYWRpbmcuRXZlbnQoKQogICAgICAgIGNscy5zZXJ2ZXJfdGhyZWFkID0gU29ja2V0U2VydmVyVGhyZWFkKHNvY2tldF9oYW5kbGVyPXNvY2tldF9oYW5kbGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWR5X2V2ZW50PXJlYWR5X2V2ZW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvc3Q9Y2xzLmhvc3QpCiAgICAgICAgY2xzLnNlcnZlcl90aHJlYWQuVVNFX0lQVjYgPSBGYWxzZQogICAgICAgIGNscy5zZXJ2ZXJfdGhyZWFkLnN0YXJ0KCkKICAgICAgICByZWFkeV9ldmVudC53YWl0KDUpCiAgICAgICAgaWYgbm90IHJlYWR5X2V2ZW50LmlzX3NldCgpOgogICAgICAgICAgICByYWlzZSBFeGNlcHRpb24oIm1vc3QgbGlrZWx5IGZhaWxlZCB0byBzdGFydCBzZXJ2ZXIiKQogICAgICAgIGNscy5wb3J0ID0gY2xzLnNlcnZlcl90aHJlYWQucG9ydAoKCmNsYXNzIEhUVFBEdW1teVNlcnZlclRlc3RDYXNlKHVuaXR0ZXN0LlRlc3RDYXNlKToKICAgICIiIiBBIHNpbXBsZSBIVFRQIHNlcnZlciB0aGF0IHJ1bnMgd2hlbiB5b3VyIHRlc3QgY2xhc3MgcnVucwoKICAgIEhhdmUgeW91ciB1bml0dGVzdCBjbGFzcyBpbmhlcml0IGZyb20gdGhpcyBvbmUsIGFuZCB0aGVuIGEgc2ltcGxlIHNlcnZlcgogICAgd2lsbCBzdGFydCB3aGVuIHlvdXIgdGVzdHMgcnVuLCBhbmQgYXV0b21hdGljYWxseSBzaHV0IGRvd24gd2hlbiB0aGV5CiAgICBjb21wbGV0ZS4gRm9yIGV4YW1wbGVzIG9mIHdoYXQgdGVzdCByZXF1ZXN0cyB5b3UgY2FuIHNlbmQgdG8gdGhlIHNlcnZlciwKICAgIHNlZSB0aGUgVGVzdGluZ0FwcCBpbiBkdW1teXNlcnZlci9oYW5kbGVycy5weS4KICAgICIiIgogICAgc2NoZW1lID0gJ2h0dHAnCiAgICBob3N0ID0gJ2xvY2FsaG9zdCcKICAgIGhvc3RfYWx0ID0gJzEyNy4wLjAuMScgICMgU29tZSB0ZXN0cyBuZWVkIHR3byBob3N0cwogICAgY2VydHMgPSBERUZBVUxUX0NFUlRTCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgX3N0YXJ0X3NlcnZlcihjbHMpOgogICAgICAgIGNscy5pb19sb29wID0gaW9sb29wLklPTG9vcCgpCiAgICAgICAgYXBwID0gd2ViLkFwcGxpY2F0aW9uKFsociIuKiIsIFRlc3RpbmdBcHApXSkKICAgICAgICBjbHMuc2VydmVyLCBjbHMucG9ydCA9IHJ1bl90b3JuYWRvX2FwcChhcHAsIGNscy5pb19sb29wLCBjbHMuY2VydHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xzLnNjaGVtZSwgY2xzLmhvc3QpCiAgICAgICAgY2xzLnNlcnZlcl90aHJlYWQgPSBydW5fbG9vcF9pbl90aHJlYWQoY2xzLmlvX2xvb3ApCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgX3N0b3Bfc2VydmVyKGNscyk6CiAgICAgICAgY2xzLmlvX2xvb3AuYWRkX2NhbGxiYWNrKGNscy5zZXJ2ZXIuc3RvcCkKICAgICAgICBjbHMuaW9fbG9vcC5hZGRfY2FsbGJhY2soY2xzLmlvX2xvb3Auc3RvcCkKICAgICAgICBjbHMuc2VydmVyX3RocmVhZC5qb2luKCkKCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBzZXRVcENsYXNzKGNscyk6CiAgICAgICAgY2xzLl9zdGFydF9zZXJ2ZXIoKQoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIHRlYXJEb3duQ2xhc3MoY2xzKToKICAgICAgICBjbHMuX3N0b3Bfc2VydmVyKCkKCgpjbGFzcyBIVFRQU0R1bW15U2VydmVyVGVzdENhc2UoSFRUUER1bW15U2VydmVyVGVzdENhc2UpOgogICAgc2NoZW1lID0gJ2h0dHBzJwogICAgaG9zdCA9ICdsb2NhbGhvc3QnCiAgICBjZXJ0cyA9IERFRkFVTFRfQ0VSVFMKCgpjbGFzcyBJUFY2SFRUUFNEdW1teVNlcnZlclRlc3RDYXNlKEhUVFBTRHVtbXlTZXJ2ZXJUZXN0Q2FzZSk6CiAgICBob3N0ID0gJzo6MScKCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBzZXRVcENsYXNzKGNscyk6CiAgICAgICAgaWYgbm90IHNvY2tldC5oYXNfaXB2NjoKICAgICAgICAgICAgcmFpc2UgU2tpcFRlc3QoJ0lQdjYgbm90IGF2YWlsYWJsZScpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc3VwZXIoSVBWNkhUVFBTRHVtbXlTZXJ2ZXJUZXN0Q2FzZSwgY2xzKS5zZXRVcENsYXNzKCkKCgpjbGFzcyBIVFRQRHVtbXlQcm94eVRlc3RDYXNlKHVuaXR0ZXN0LlRlc3RDYXNlKToKCiAgICBodHRwX2hvc3QgPSAnbG9jYWxob3N0JwogICAgaHR0cF9ob3N0X2FsdCA9ICcxMjcuMC4wLjEnCgogICAgaHR0cHNfaG9zdCA9ICdsb2NhbGhvc3QnCiAgICBodHRwc19ob3N0X2FsdCA9ICcxMjcuMC4wLjEnCiAgICBodHRwc19jZXJ0cyA9IERFRkFVTFRfQ0VSVFMKCiAgICBwcm94eV9ob3N0ID0gJ2xvY2FsaG9zdCcKICAgIHByb3h5X2hvc3RfYWx0ID0gJzEyNy4wLjAuMScKCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBzZXRVcENsYXNzKGNscyk6CiAgICAgICAgY2xzLmlvX2xvb3AgPSBpb2xvb3AuSU9Mb29wKCkKCiAgICAgICAgYXBwID0gd2ViLkFwcGxpY2F0aW9uKFsocicuKicsIFRlc3RpbmdBcHApXSkKICAgICAgICBjbHMuaHR0cF9zZXJ2ZXIsIGNscy5odHRwX3BvcnQgPSBydW5fdG9ybmFkb19hcHAoCiAgICAgICAgICAgIGFwcCwgY2xzLmlvX2xvb3AsIE5vbmUsICdodHRwJywgY2xzLmh0dHBfaG9zdCkKCiAgICAgICAgYXBwID0gd2ViLkFwcGxpY2F0aW9uKFsocicuKicsIFRlc3RpbmdBcHApXSkKICAgICAgICBjbHMuaHR0cHNfc2VydmVyLCBjbHMuaHR0cHNfcG9ydCA9IHJ1bl90b3JuYWRvX2FwcCgKICAgICAgICAgICAgYXBwLCBjbHMuaW9fbG9vcCwgY2xzLmh0dHBzX2NlcnRzLCAnaHR0cHMnLCBjbHMuaHR0cF9ob3N0KQoKICAgICAgICBhcHAgPSB3ZWIuQXBwbGljYXRpb24oWyhyJy4qJywgUHJveHlIYW5kbGVyKV0pCiAgICAgICAgY2xzLnByb3h5X3NlcnZlciwgY2xzLnByb3h5X3BvcnQgPSBydW5fdG9ybmFkb19hcHAoCiAgICAgICAgICAgIGFwcCwgY2xzLmlvX2xvb3AsIE5vbmUsICdodHRwJywgY2xzLnByb3h5X2hvc3QpCgogICAgICAgIGNscy5zZXJ2ZXJfdGhyZWFkID0gcnVuX2xvb3BfaW5fdGhyZWFkKGNscy5pb19sb29wKQoKICAgIEBjbGFzc21ldGhvZAogICAgZGVmIHRlYXJEb3duQ2xhc3MoY2xzKToKICAgICAgICBjbHMuaW9fbG9vcC5hZGRfY2FsbGJhY2soY2xzLmh0dHBfc2VydmVyLnN0b3ApCiAgICAgICAgY2xzLmlvX2xvb3AuYWRkX2NhbGxiYWNrKGNscy5odHRwc19zZXJ2ZXIuc3RvcCkKICAgICAgICBjbHMuaW9fbG9vcC5hZGRfY2FsbGJhY2soY2xzLnByb3h5X3NlcnZlci5zdG9wKQogICAgICAgIGNscy5pb19sb29wLmFkZF9jYWxsYmFjayhjbHMuaW9fbG9vcC5zdG9wKQogICAgICAgIGNscy5zZXJ2ZXJfdGhyZWFkLmpvaW4oKQoKCmNsYXNzIElQdjZIVFRQRHVtbXlTZXJ2ZXJUZXN0Q2FzZShIVFRQRHVtbXlTZXJ2ZXJUZXN0Q2FzZSk6CiAgICBob3N0ID0gJzo6MScKCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBzZXRVcENsYXNzKGNscyk6CiAgICAgICAgaWYgbm90IHNvY2tldC5oYXNfaXB2NjoKICAgICAgICAgICAgcmFpc2UgU2tpcFRlc3QoJ0lQdjYgbm90IGF2YWlsYWJsZScpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc3VwZXIoSVB2NkhUVFBEdW1teVNlcnZlclRlc3RDYXNlLCBjbHMpLnNldFVwQ2xhc3MoKQoKCmNsYXNzIElQdjZIVFRQRHVtbXlQcm94eVRlc3RDYXNlKEhUVFBEdW1teVByb3h5VGVzdENhc2UpOgoKICAgIGh0dHBfaG9zdCA9ICdsb2NhbGhvc3QnCiAgICBodHRwX2hvc3RfYWx0ID0gJzEyNy4wLjAuMScKCiAgICBodHRwc19ob3N0ID0gJ2xvY2FsaG9zdCcKICAgIGh0dHBzX2hvc3RfYWx0ID0gJzEyNy4wLjAuMScKICAgIGh0dHBzX2NlcnRzID0gREVGQVVMVF9DRVJUUwoKICAgIHByb3h5X2hvc3QgPSAnOjoxJwogICAgcHJveHlfaG9zdF9hbHQgPSAnMTI3LjAuMC4xJwo=
