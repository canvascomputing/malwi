statistics:
  total_files: 1
  skipped_files: 0.0
  processed_objects: 1
  malicious_objects: 0
details:
- path: .repo_cache/malicious_repos/pypi_malregistry/urlib3/1.21.1/urlib3-1.21.1/urlib3-1.21.1/test/test_poolmanager.py
  contents:
  - name: TestPoolManager.test_http_connection_from_context_case_insensitive
    score: 0.0
    code: |-
      def test_http_connection_from_context_case_insensitive(self):
              """Assert scheme case is ignored when getting the https key class."""
              p = PoolManager()
              self.addCleanup(p.clear)
              context = {'scheme': 'http', 'host': 'example.com', 'port': '8080'}
              other_context = {'scheme': 'HTTP', 'host': 'EXAMPLE.COM', 'port': '8080'}
              pool = p.connection_from_context(context)
              other_pool = p.connection_from_context(other_context)

              self.assertEqual(1, len(p.pools))
              self.assertTrue(pool is other_pool)
              self.assertTrue(all(isinstance(key, PoolKey) for key in p.pools.keys()))
    tokens: resume load_global PoolManager call store_fast p load_fast self load_attr addCleanup load_fast p load_attr clear call pop_top load_const http load_const example.com load_const 8080 load_const build_const_key_map store_fast context load_const HTTP load_const EXAMPLE.COM load_const 8080 load_const build_const_key_map store_fast other_context load_fast p load_attr STRING_LEN_S_ENT_HIGH load_fast context call store_fast pool load_fast p load_attr STRING_LEN_S_ENT_HIGH load_fast other_context call store_fast other_pool load_fast self load_attr assertEqual load_const INTEGER load_global len load_fast p load_attr pools call call pop_top load_fast self load_attr assertTrue load_fast pool load_fast other_pool is_op call pop_top load_fast self load_attr assertTrue load_global all load_const OBJECT make_function load_fast p load_attr pools load_attr keys call get_iter call call call pop_top return_const None
    hash: 0fc1ba62a65ed0459606a57e7edb384685d9e93c2b899ca3d531e62a1cb5d340
sources:
  .repo_cache/malicious_repos/pypi_malregistry/urlib3/1.21.1/urlib3-1.21.1/urlib3-1.21.1/test/test_poolmanager.py: aW1wb3J0IHNvY2tldAppbXBvcnQgc3lzCgpmcm9tIHVybGxpYjMucG9vbG1hbmFnZXIgaW1wb3J0ICgKICAgIFBvb2xLZXksCiAgICBrZXlfZm5fYnlfc2NoZW1lLAogICAgUG9vbE1hbmFnZXIsCikKZnJvbSB1cmxsaWIzIGltcG9ydCBjb25uZWN0aW9uX2Zyb21fdXJsCmZyb20gdXJsbGliMy5leGNlcHRpb25zIGltcG9ydCAoCiAgICBDbG9zZWRQb29sRXJyb3IsCiAgICBMb2NhdGlvblZhbHVlRXJyb3IsCikKZnJvbSB1cmxsaWIzLnV0aWwgaW1wb3J0IHJldHJ5LCB0aW1lb3V0CgppZiBzeXMudmVyc2lvbl9pbmZvID49ICgyLCA3KToKICAgIGltcG9ydCB1bml0dGVzdAplbHNlOgogICAgaW1wb3J0IHVuaXR0ZXN0MiBhcyB1bml0dGVzdAoKCmNsYXNzIFRlc3RQb29sTWFuYWdlcih1bml0dGVzdC5UZXN0Q2FzZSk6CiAgICBkZWYgdGVzdF9zYW1lX3VybChzZWxmKToKICAgICAgICAjIENvbnZpbmNlIG91cnNlbHZlcyB0aGF0IG5vcm1hbGx5IHdlIGRvbid0IGdldCB0aGUgc2FtZSBvYmplY3QKICAgICAgICBjb25uMSA9IGNvbm5lY3Rpb25fZnJvbV91cmwoJ2h0dHA6Ly9sb2NhbGhvc3Q6ODA4MS9mb28nKQogICAgICAgIGNvbm4yID0gY29ubmVjdGlvbl9mcm9tX3VybCgnaHR0cDovL2xvY2FsaG9zdDo4MDgxL2JhcicpCiAgICAgICAgc2VsZi5hZGRDbGVhbnVwKGNvbm4xLmNsb3NlKQogICAgICAgIHNlbGYuYWRkQ2xlYW51cChjb25uMi5jbG9zZSkKCiAgICAgICAgc2VsZi5hc3NlcnROb3RFcXVhbChjb25uMSwgY29ubjIpCgogICAgICAgICMgTm93IHRyeSBhZ2FpbiB1c2luZyB0aGUgUG9vbE1hbmFnZXIKICAgICAgICBwID0gUG9vbE1hbmFnZXIoMSkKICAgICAgICBzZWxmLmFkZENsZWFudXAocC5jbGVhcikKCiAgICAgICAgY29ubjEgPSBwLmNvbm5lY3Rpb25fZnJvbV91cmwoJ2h0dHA6Ly9sb2NhbGhvc3Q6ODA4MS9mb28nKQogICAgICAgIGNvbm4yID0gcC5jb25uZWN0aW9uX2Zyb21fdXJsKCdodHRwOi8vbG9jYWxob3N0OjgwODEvYmFyJykKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChjb25uMSwgY29ubjIpCgogICAgZGVmIHRlc3RfbWFueV91cmxzKHNlbGYpOgogICAgICAgIHVybHMgPSBbCiAgICAgICAgICAgICJodHRwOi8vbG9jYWxob3N0OjgwODEvZm9vIiwKICAgICAgICAgICAgImh0dHA6Ly93d3cuZ29vZ2xlLmNvbS9tYWlsIiwKICAgICAgICAgICAgImh0dHA6Ly9sb2NhbGhvc3Q6ODA4MS9iYXIiLAogICAgICAgICAgICAiaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS8iLAogICAgICAgICAgICAiaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9tYWlsIiwKICAgICAgICAgICAgImh0dHA6Ly95YWhvby5jb20iLAogICAgICAgICAgICAiaHR0cDovL2JpbmcuY29tIiwKICAgICAgICAgICAgImh0dHA6Ly95YWhvby5jb20vIiwKICAgICAgICBdCgogICAgICAgIGNvbm5lY3Rpb25zID0gc2V0KCkKCiAgICAgICAgcCA9IFBvb2xNYW5hZ2VyKDEwKQogICAgICAgIHNlbGYuYWRkQ2xlYW51cChwLmNsZWFyKQoKICAgICAgICBmb3IgdXJsIGluIHVybHM6CiAgICAgICAgICAgIGNvbm4gPSBwLmNvbm5lY3Rpb25fZnJvbV91cmwodXJsKQogICAgICAgICAgICBjb25uZWN0aW9ucy5hZGQoY29ubikKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4oY29ubmVjdGlvbnMpLCA1KQoKICAgIGRlZiB0ZXN0X21hbmFnZXJfY2xlYXIoc2VsZik6CiAgICAgICAgcCA9IFBvb2xNYW5hZ2VyKDUpCiAgICAgICAgc2VsZi5hZGRDbGVhbnVwKHAuY2xlYXIpCgogICAgICAgIGNvbm5fcG9vbCA9IHAuY29ubmVjdGlvbl9mcm9tX3VybCgnaHR0cDovL2dvb2dsZS5jb20nKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHAucG9vbHMpLCAxKQoKICAgICAgICBjb25uID0gY29ubl9wb29sLl9nZXRfY29ubigpCgogICAgICAgIHAuY2xlYXIoKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHAucG9vbHMpLCAwKQoKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhDbG9zZWRQb29sRXJyb3IsIGNvbm5fcG9vbC5fZ2V0X2Nvbm4pCgogICAgICAgIGNvbm5fcG9vbC5fcHV0X2Nvbm4oY29ubikKCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoQ2xvc2VkUG9vbEVycm9yLCBjb25uX3Bvb2wuX2dldF9jb25uKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKGxlbihwLnBvb2xzKSwgMCkKCiAgICBkZWYgdGVzdF9ub2hvc3Qoc2VsZik6CiAgICAgICAgcCA9IFBvb2xNYW5hZ2VyKDUpCiAgICAgICAgc2VsZi5hZGRDbGVhbnVwKHAuY2xlYXIpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoTG9jYXRpb25WYWx1ZUVycm9yLCBwLmNvbm5lY3Rpb25fZnJvbV91cmwsICdodHRwOi8vQCcpCiAgICAgICAgc2VsZi5hc3NlcnRSYWlzZXMoTG9jYXRpb25WYWx1ZUVycm9yLCBwLmNvbm5lY3Rpb25fZnJvbV91cmwsIE5vbmUpCgogICAgZGVmIHRlc3RfY29udGV4dG1hbmFnZXIoc2VsZik6CiAgICAgICAgd2l0aCBQb29sTWFuYWdlcigxKSBhcyBwOgogICAgICAgICAgICBjb25uX3Bvb2wgPSBwLmNvbm5lY3Rpb25fZnJvbV91cmwoJ2h0dHA6Ly9nb29nbGUuY29tJykKICAgICAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4ocC5wb29scyksIDEpCiAgICAgICAgICAgIGNvbm4gPSBjb25uX3Bvb2wuX2dldF9jb25uKCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChsZW4ocC5wb29scyksIDApCgogICAgICAgIHNlbGYuYXNzZXJ0UmFpc2VzKENsb3NlZFBvb2xFcnJvciwgY29ubl9wb29sLl9nZXRfY29ubikKCiAgICAgICAgY29ubl9wb29sLl9wdXRfY29ubihjb25uKQoKICAgICAgICBzZWxmLmFzc2VydFJhaXNlcyhDbG9zZWRQb29sRXJyb3IsIGNvbm5fcG9vbC5fZ2V0X2Nvbm4pCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwobGVuKHAucG9vbHMpLCAwKQoKICAgIGRlZiB0ZXN0X2h0dHBfcG9vbF9rZXlfZmllbGRzKHNlbGYpOgogICAgICAgICIiIkFzc2VydCB0aGUgSFRUUFBvb2xLZXkgZmllbGRzIGFyZSBob25vcmVkIHdoZW4gc2VsZWN0aW5nIGEgcG9vbC4iIiIKICAgICAgICBjb25uZWN0aW9uX3Bvb2xfa3cgPSB7CiAgICAgICAgICAgICd0aW1lb3V0JzogdGltZW91dC5UaW1lb3V0KDMuMTQpLAogICAgICAgICAgICAncmV0cmllcyc6IHJldHJ5LlJldHJ5KHRvdGFsPTYsIGNvbm5lY3Q9MiksCiAgICAgICAgICAgICdibG9jayc6IFRydWUsCiAgICAgICAgICAgICdzdHJpY3QnOiBUcnVlLAogICAgICAgICAgICAnc291cmNlX2FkZHJlc3MnOiAnMTI3LjAuMC4xJywKICAgICAgICB9CiAgICAgICAgcCA9IFBvb2xNYW5hZ2VyKCkKICAgICAgICBzZWxmLmFkZENsZWFudXAocC5jbGVhcikKICAgICAgICBjb25uX3Bvb2xzID0gWwogICAgICAgICAgICBwLmNvbm5lY3Rpb25fZnJvbV91cmwoJ2h0dHA6Ly9leGFtcGxlLmNvbS8nKSwKICAgICAgICAgICAgcC5jb25uZWN0aW9uX2Zyb21fdXJsKCdodHRwOi8vZXhhbXBsZS5jb206ODAwMC8nKSwKICAgICAgICAgICAgcC5jb25uZWN0aW9uX2Zyb21fdXJsKCdodHRwOi8vb3RoZXIuZXhhbXBsZS5jb20vJyksCiAgICAgICAgXQoKICAgICAgICBmb3Iga2V5LCB2YWx1ZSBpbiBjb25uZWN0aW9uX3Bvb2xfa3cuaXRlbXMoKToKICAgICAgICAgICAgcC5jb25uZWN0aW9uX3Bvb2xfa3dba2V5XSA9IHZhbHVlCiAgICAgICAgICAgIGNvbm5fcG9vbHMuYXBwZW5kKHAuY29ubmVjdGlvbl9mcm9tX3VybCgnaHR0cDovL2V4YW1wbGUuY29tLycpKQoKICAgICAgICBzZWxmLmFzc2VydFRydWUoCiAgICAgICAgICAgIGFsbCgKICAgICAgICAgICAgICAgIHggaXMgbm90IHkKICAgICAgICAgICAgICAgIGZvciBpLCB4IGluIGVudW1lcmF0ZShjb25uX3Bvb2xzKQogICAgICAgICAgICAgICAgZm9yIGosIHkgaW4gZW51bWVyYXRlKGNvbm5fcG9vbHMpCiAgICAgICAgICAgICAgICBpZiBpICE9IGoKICAgICAgICAgICAgKQogICAgICAgICkKICAgICAgICBzZWxmLmFzc2VydFRydWUoCiAgICAgICAgICAgIGFsbCgKICAgICAgICAgICAgICAgIGlzaW5zdGFuY2Uoa2V5LCBQb29sS2V5KQogICAgICAgICAgICAgICAgZm9yIGtleSBpbiBwLnBvb2xzLmtleXMoKSkKICAgICAgICApCgogICAgZGVmIHRlc3RfaHR0cHNfcG9vbF9rZXlfZmllbGRzKHNlbGYpOgogICAgICAgICIiIkFzc2VydCB0aGUgSFRUUFNQb29sS2V5IGZpZWxkcyBhcmUgaG9ub3JlZCB3aGVuIHNlbGVjdGluZyBhIHBvb2wuIiIiCiAgICAgICAgY29ubmVjdGlvbl9wb29sX2t3ID0gewogICAgICAgICAgICAndGltZW91dCc6IHRpbWVvdXQuVGltZW91dCgzLjE0KSwKICAgICAgICAgICAgJ3JldHJpZXMnOiByZXRyeS5SZXRyeSh0b3RhbD02LCBjb25uZWN0PTIpLAogICAgICAgICAgICAnYmxvY2snOiBUcnVlLAogICAgICAgICAgICAnc3RyaWN0JzogVHJ1ZSwKICAgICAgICAgICAgJ3NvdXJjZV9hZGRyZXNzJzogJzEyNy4wLjAuMScsCiAgICAgICAgICAgICdrZXlfZmlsZSc6ICcvcm9vdC90b3RhbGx5X2xlZ2l0LmtleScsCiAgICAgICAgICAgICdjZXJ0X2ZpbGUnOiAnL3Jvb3QvdG90YWxseV9sZWdpdC5jcnQnLAogICAgICAgICAgICAnY2VydF9yZXFzJzogJ0NFUlRfUkVRVUlSRUQnLAogICAgICAgICAgICAnY2FfY2VydHMnOiAnL3Jvb3QvcGF0aF90b19wZW0nLAogICAgICAgICAgICAnc3NsX3ZlcnNpb24nOiAnU1NMdjIzX01FVEhPRCcsCiAgICAgICAgfQogICAgICAgIHAgPSBQb29sTWFuYWdlcigpCiAgICAgICAgc2VsZi5hZGRDbGVhbnVwKHAuY2xlYXIpCiAgICAgICAgY29ubl9wb29scyA9IFsKICAgICAgICAgICAgcC5jb25uZWN0aW9uX2Zyb21fdXJsKCdodHRwczovL2V4YW1wbGUuY29tLycpLAogICAgICAgICAgICBwLmNvbm5lY3Rpb25fZnJvbV91cmwoJ2h0dHBzOi8vZXhhbXBsZS5jb206NDMzMy8nKSwKICAgICAgICAgICAgcC5jb25uZWN0aW9uX2Zyb21fdXJsKCdodHRwczovL290aGVyLmV4YW1wbGUuY29tLycpLAogICAgICAgIF0KICAgICAgICAjIEFza2luZyBmb3IgYSBjb25uZWN0aW9uIHBvb2wgd2l0aCB0aGUgc2FtZSBrZXkgc2hvdWxkIGdpdmUgdXMgYW4KICAgICAgICAjIGV4aXN0aW5nIHBvb2wuCiAgICAgICAgZHVwX3Bvb2xzID0gW10KCiAgICAgICAgZm9yIGtleSwgdmFsdWUgaW4gY29ubmVjdGlvbl9wb29sX2t3Lml0ZW1zKCk6CiAgICAgICAgICAgIHAuY29ubmVjdGlvbl9wb29sX2t3W2tleV0gPSB2YWx1ZQogICAgICAgICAgICBjb25uX3Bvb2xzLmFwcGVuZChwLmNvbm5lY3Rpb25fZnJvbV91cmwoJ2h0dHBzOi8vZXhhbXBsZS5jb20vJykpCiAgICAgICAgICAgIGR1cF9wb29scy5hcHBlbmQocC5jb25uZWN0aW9uX2Zyb21fdXJsKCdodHRwczovL2V4YW1wbGUuY29tLycpKQoKICAgICAgICBzZWxmLmFzc2VydFRydWUoCiAgICAgICAgICAgIGFsbCgKICAgICAgICAgICAgICAgIHggaXMgbm90IHkKICAgICAgICAgICAgICAgIGZvciBpLCB4IGluIGVudW1lcmF0ZShjb25uX3Bvb2xzKQogICAgICAgICAgICAgICAgZm9yIGosIHkgaW4gZW51bWVyYXRlKGNvbm5fcG9vbHMpCiAgICAgICAgICAgICAgICBpZiBpICE9IGoKICAgICAgICAgICAgKQogICAgICAgICkKICAgICAgICBzZWxmLmFzc2VydFRydWUoYWxsKHBvb2wgaW4gY29ubl9wb29scyBmb3IgcG9vbCBpbiBkdXBfcG9vbHMpKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZSgKICAgICAgICAgICAgYWxsKAogICAgICAgICAgICAgICAgaXNpbnN0YW5jZShrZXksIFBvb2xLZXkpCiAgICAgICAgICAgICAgICBmb3Iga2V5IGluIHAucG9vbHMua2V5cygpKQogICAgICAgICkKCiAgICBkZWYgdGVzdF9kZWZhdWx0X3Bvb2xfa2V5X2Z1bmNzX2NvcHkoc2VsZik6CiAgICAgICAgIiIiQXNzZXJ0IGVhY2ggUG9vbE1hbmFnZXIgZ2V0cyBhIGNvcHkgb2YgYGBwb29sX2tleXNfYnlfc2NoZW1lYGAuIiIiCiAgICAgICAgcCA9IFBvb2xNYW5hZ2VyKCkKICAgICAgICBzZWxmLmFkZENsZWFudXAocC5jbGVhcikKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHAua2V5X2ZuX2J5X3NjaGVtZSwgcC5rZXlfZm5fYnlfc2NoZW1lKQogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2UocC5rZXlfZm5fYnlfc2NoZW1lIGlzIGtleV9mbl9ieV9zY2hlbWUpCgogICAgZGVmIHRlc3RfcG9vbHNfa2V5ZWRfd2l0aF9mcm9tX2hvc3Qoc2VsZik6CiAgICAgICAgIiIiQXNzZXJ0IHBvb2xzIGFyZSBzdGlsbCBrZXllZCBjb3JyZWN0bHkgd2l0aCBjb25uZWN0aW9uX2Zyb21faG9zdC4iIiIKICAgICAgICBzc2xfa3cgPSB7CiAgICAgICAgICAgICdrZXlfZmlsZSc6ICcvcm9vdC90b3RhbGx5X2xlZ2l0LmtleScsCiAgICAgICAgICAgICdjZXJ0X2ZpbGUnOiAnL3Jvb3QvdG90YWxseV9sZWdpdC5jcnQnLAogICAgICAgICAgICAnY2VydF9yZXFzJzogJ0NFUlRfUkVRVUlSRUQnLAogICAgICAgICAgICAnY2FfY2VydHMnOiAnL3Jvb3QvcGF0aF90b19wZW0nLAogICAgICAgICAgICAnc3NsX3ZlcnNpb24nOiAnU1NMdjIzX01FVEhPRCcsCiAgICAgICAgfQogICAgICAgIHAgPSBQb29sTWFuYWdlcig1LCAqKnNzbF9rdykKICAgICAgICBzZWxmLmFkZENsZWFudXAocC5jbGVhcikKICAgICAgICBjb25ucyA9IFtdCiAgICAgICAgY29ubnMuYXBwZW5kKAogICAgICAgICAgICBwLmNvbm5lY3Rpb25fZnJvbV9ob3N0KCdleGFtcGxlLmNvbScsIDQ0Mywgc2NoZW1lPSdodHRwcycpCiAgICAgICAgKQoKICAgICAgICBmb3IgayBpbiBzc2xfa3c6CiAgICAgICAgICAgIHAuY29ubmVjdGlvbl9wb29sX2t3W2tdID0gJ25ld3ZhbCcKICAgICAgICAgICAgY29ubnMuYXBwZW5kKAogICAgICAgICAgICAgICAgcC5jb25uZWN0aW9uX2Zyb21faG9zdCgnZXhhbXBsZS5jb20nLCA0NDMsIHNjaGVtZT0naHR0cHMnKQogICAgICAgICAgICApCgogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZSgKICAgICAgICAgICAgYWxsKAogICAgICAgICAgICAgICAgeCBpcyBub3QgeQogICAgICAgICAgICAgICAgZm9yIGksIHggaW4gZW51bWVyYXRlKGNvbm5zKQogICAgICAgICAgICAgICAgZm9yIGosIHkgaW4gZW51bWVyYXRlKGNvbm5zKQogICAgICAgICAgICAgICAgaWYgaSAhPSBqCiAgICAgICAgICAgICkKICAgICAgICApCgogICAgZGVmIHRlc3RfaHR0cHNfY29ubmVjdGlvbl9mcm9tX3VybF9jYXNlX2luc2Vuc2l0aXZlKHNlbGYpOgogICAgICAgICIiIkFzc2VydCBzY2hlbWUgY2FzZSBpcyBpZ25vcmVkIHdoZW4gcG9vbGluZyBIVFRQUyBjb25uZWN0aW9ucy4iIiIKICAgICAgICBwID0gUG9vbE1hbmFnZXIoKQogICAgICAgIHNlbGYuYWRkQ2xlYW51cChwLmNsZWFyKQogICAgICAgIHBvb2wgPSBwLmNvbm5lY3Rpb25fZnJvbV91cmwoJ2h0dHBzOi8vZXhhbXBsZS5jb20vJykKICAgICAgICBvdGhlcl9wb29sID0gcC5jb25uZWN0aW9uX2Zyb21fdXJsKCdIVFRQUzovL0VYQU1QTEUuQ09NLycpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoMSwgbGVuKHAucG9vbHMpKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShwb29sIGlzIG90aGVyX3Bvb2wpCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGFsbChpc2luc3RhbmNlKGtleSwgUG9vbEtleSkgZm9yIGtleSBpbiBwLnBvb2xzLmtleXMoKSkpCgogICAgZGVmIHRlc3RfaHR0cHNfY29ubmVjdGlvbl9mcm9tX2hvc3RfY2FzZV9pbnNlbnNpdGl2ZShzZWxmKToKICAgICAgICAiIiJBc3NlcnQgc2NoZW1lIGNhc2UgaXMgaWdub3JlZCB3aGVuIGdldHRpbmcgdGhlIGh0dHBzIGtleSBjbGFzcy4iIiIKICAgICAgICBwID0gUG9vbE1hbmFnZXIoKQogICAgICAgIHNlbGYuYWRkQ2xlYW51cChwLmNsZWFyKQogICAgICAgIHBvb2wgPSBwLmNvbm5lY3Rpb25fZnJvbV9ob3N0KCdleGFtcGxlLmNvbScsIHNjaGVtZT0naHR0cHMnKQogICAgICAgIG90aGVyX3Bvb2wgPSBwLmNvbm5lY3Rpb25fZnJvbV9ob3N0KCdFWEFNUExFLkNPTScsIHNjaGVtZT0nSFRUUFMnKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKDEsIGxlbihwLnBvb2xzKSkKICAgICAgICBzZWxmLmFzc2VydFRydWUocG9vbCBpcyBvdGhlcl9wb29sKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShhbGwoaXNpbnN0YW5jZShrZXksIFBvb2xLZXkpIGZvciBrZXkgaW4gcC5wb29scy5rZXlzKCkpKQoKICAgIGRlZiB0ZXN0X2h0dHBzX2Nvbm5lY3Rpb25fZnJvbV9jb250ZXh0X2Nhc2VfaW5zZW5zaXRpdmUoc2VsZik6CiAgICAgICAgIiIiQXNzZXJ0IHNjaGVtZSBjYXNlIGlzIGlnbm9yZWQgd2hlbiBnZXR0aW5nIHRoZSBodHRwcyBrZXkgY2xhc3MuIiIiCiAgICAgICAgcCA9IFBvb2xNYW5hZ2VyKCkKICAgICAgICBzZWxmLmFkZENsZWFudXAocC5jbGVhcikKICAgICAgICBjb250ZXh0ID0geydzY2hlbWUnOiAnaHR0cHMnLCAnaG9zdCc6ICdleGFtcGxlLmNvbScsICdwb3J0JzogJzQ0Myd9CiAgICAgICAgb3RoZXJfY29udGV4dCA9IHsnc2NoZW1lJzogJ0hUVFBTJywgJ2hvc3QnOiAnRVhBTVBMRS5DT00nLCAncG9ydCc6ICc0NDMnfQogICAgICAgIHBvb2wgPSBwLmNvbm5lY3Rpb25fZnJvbV9jb250ZXh0KGNvbnRleHQpCiAgICAgICAgb3RoZXJfcG9vbCA9IHAuY29ubmVjdGlvbl9mcm9tX2NvbnRleHQob3RoZXJfY29udGV4dCkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCgxLCBsZW4ocC5wb29scykpCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKHBvb2wgaXMgb3RoZXJfcG9vbCkKICAgICAgICBzZWxmLmFzc2VydFRydWUoYWxsKGlzaW5zdGFuY2Uoa2V5LCBQb29sS2V5KSBmb3Iga2V5IGluIHAucG9vbHMua2V5cygpKSkKCiAgICBkZWYgdGVzdF9odHRwX2Nvbm5lY3Rpb25fZnJvbV91cmxfY2FzZV9pbnNlbnNpdGl2ZShzZWxmKToKICAgICAgICAiIiJBc3NlcnQgc2NoZW1lIGNhc2UgaXMgaWdub3JlZCB3aGVuIHBvb2xpbmcgSFRUUCBjb25uZWN0aW9ucy4iIiIKICAgICAgICBwID0gUG9vbE1hbmFnZXIoKQogICAgICAgIHBvb2wgPSBwLmNvbm5lY3Rpb25fZnJvbV91cmwoJ2h0dHA6Ly9leGFtcGxlLmNvbS8nKQogICAgICAgIG90aGVyX3Bvb2wgPSBwLmNvbm5lY3Rpb25fZnJvbV91cmwoJ0hUVFA6Ly9FWEFNUExFLkNPTS8nKQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKDEsIGxlbihwLnBvb2xzKSkKICAgICAgICBzZWxmLmFzc2VydFRydWUocG9vbCBpcyBvdGhlcl9wb29sKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShhbGwoaXNpbnN0YW5jZShrZXksIFBvb2xLZXkpIGZvciBrZXkgaW4gcC5wb29scy5rZXlzKCkpKQoKICAgIGRlZiB0ZXN0X2h0dHBfY29ubmVjdGlvbl9mcm9tX2hvc3RfY2FzZV9pbnNlbnNpdGl2ZShzZWxmKToKICAgICAgICAiIiJBc3NlcnQgc2NoZW1lIGNhc2UgaXMgaWdub3JlZCB3aGVuIGdldHRpbmcgdGhlIGh0dHBzIGtleSBjbGFzcy4iIiIKICAgICAgICBwID0gUG9vbE1hbmFnZXIoKQogICAgICAgIHNlbGYuYWRkQ2xlYW51cChwLmNsZWFyKQogICAgICAgIHBvb2wgPSBwLmNvbm5lY3Rpb25fZnJvbV9ob3N0KCdleGFtcGxlLmNvbScsIHNjaGVtZT0naHR0cCcpCiAgICAgICAgb3RoZXJfcG9vbCA9IHAuY29ubmVjdGlvbl9mcm9tX2hvc3QoJ0VYQU1QTEUuQ09NJywgc2NoZW1lPSdIVFRQJykKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCgxLCBsZW4ocC5wb29scykpCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKHBvb2wgaXMgb3RoZXJfcG9vbCkKICAgICAgICBzZWxmLmFzc2VydFRydWUoYWxsKGlzaW5zdGFuY2Uoa2V5LCBQb29sS2V5KSBmb3Iga2V5IGluIHAucG9vbHMua2V5cygpKSkKCiAgICBkZWYgdGVzdF9hc3NlcnRfaG9zdG5hbWVfYW5kX2ZpbmdlcnByaW50X2ZsYWcoc2VsZik6CiAgICAgICAgIiIiQXNzZXJ0IHRoYXQgcG9vbCBtYW5hZ2VyIGNhbiBhY2NlcHQgaG9zdG5hbWUgYW5kIGZpbmdlcnByaW50IGZsYWdzLiIiIgogICAgICAgIGZpbmdlcnByaW50ID0gJzkyOjgxOkZFOjg1OkY3OjBDOjI2OjYwOkVDOkQ2OkIzOkJGOjkzOkNGOkY5OjcxOkNDOjA3OjdEOjBBJwogICAgICAgIHAgPSBQb29sTWFuYWdlcihhc3NlcnRfaG9zdG5hbWU9VHJ1ZSwgYXNzZXJ0X2ZpbmdlcnByaW50PWZpbmdlcnByaW50KQogICAgICAgIHNlbGYuYWRkQ2xlYW51cChwLmNsZWFyKQogICAgICAgIHBvb2wgPSBwLmNvbm5lY3Rpb25fZnJvbV91cmwoJ2h0dHBzOi8vZXhhbXBsZS5jb20vJykKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKDEsIGxlbihwLnBvb2xzKSkKICAgICAgICBzZWxmLmFzc2VydFRydWUocG9vbC5hc3NlcnRfaG9zdG5hbWUpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChmaW5nZXJwcmludCwgcG9vbC5hc3NlcnRfZmluZ2VycHJpbnQpCgogICAgZGVmIHRlc3RfaHR0cF9jb25uZWN0aW9uX2Zyb21fY29udGV4dF9jYXNlX2luc2Vuc2l0aXZlKHNlbGYpOgogICAgICAgICIiIkFzc2VydCBzY2hlbWUgY2FzZSBpcyBpZ25vcmVkIHdoZW4gZ2V0dGluZyB0aGUgaHR0cHMga2V5IGNsYXNzLiIiIgogICAgICAgIHAgPSBQb29sTWFuYWdlcigpCiAgICAgICAgc2VsZi5hZGRDbGVhbnVwKHAuY2xlYXIpCiAgICAgICAgY29udGV4dCA9IHsnc2NoZW1lJzogJ2h0dHAnLCAnaG9zdCc6ICdleGFtcGxlLmNvbScsICdwb3J0JzogJzgwODAnfQogICAgICAgIG90aGVyX2NvbnRleHQgPSB7J3NjaGVtZSc6ICdIVFRQJywgJ2hvc3QnOiAnRVhBTVBMRS5DT00nLCAncG9ydCc6ICc4MDgwJ30KICAgICAgICBwb29sID0gcC5jb25uZWN0aW9uX2Zyb21fY29udGV4dChjb250ZXh0KQogICAgICAgIG90aGVyX3Bvb2wgPSBwLmNvbm5lY3Rpb25fZnJvbV9jb250ZXh0KG90aGVyX2NvbnRleHQpCgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwoMSwgbGVuKHAucG9vbHMpKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShwb29sIGlzIG90aGVyX3Bvb2wpCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGFsbChpc2luc3RhbmNlKGtleSwgUG9vbEtleSkgZm9yIGtleSBpbiBwLnBvb2xzLmtleXMoKSkpCgogICAgZGVmIHRlc3RfY3VzdG9tX3Bvb2xfa2V5KHNlbGYpOgogICAgICAgICIiIkFzc2VydCBpdCBpcyBwb3NzaWJsZSB0byBkZWZpbmUgYSBjdXN0b20ga2V5IGZ1bmN0aW9uLiIiIgogICAgICAgIHAgPSBQb29sTWFuYWdlcigxMCkKICAgICAgICBzZWxmLmFkZENsZWFudXAocC5jbGVhcikKCiAgICAgICAgcC5rZXlfZm5fYnlfc2NoZW1lWydodHRwJ10gPSBsYW1iZGEgeDogdHVwbGUoeFsna2V5J10pCiAgICAgICAgcG9vbDEgPSBwLmNvbm5lY3Rpb25fZnJvbV91cmwoCiAgICAgICAgICAgICdodHRwOi8vZXhhbXBsZS5jb20nLCBwb29sX2t3YXJncz17J2tleSc6ICd2YWx1ZSd9KQogICAgICAgIHBvb2wyID0gcC5jb25uZWN0aW9uX2Zyb21fdXJsKAogICAgICAgICAgICAnaHR0cDovL2V4YW1wbGUuY29tJywgcG9vbF9rd2FyZ3M9eydrZXknOiAnb3RoZXInfSkKICAgICAgICBwb29sMyA9IHAuY29ubmVjdGlvbl9mcm9tX3VybCgKICAgICAgICAgICAgJ2h0dHA6Ly9leGFtcGxlLmNvbScsIHBvb2xfa3dhcmdzPXsna2V5JzogJ3ZhbHVlJywgJ3gnOiAneSd9KQoKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKDIsIGxlbihwLnBvb2xzKSkKICAgICAgICBzZWxmLmFzc2VydFRydWUocG9vbDEgaXMgcG9vbDMpCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShwb29sMSBpcyBwb29sMikKCiAgICBkZWYgdGVzdF9vdmVycmlkZV9wb29sX2t3YXJnc191cmwoc2VsZik6CiAgICAgICAgIiIiQXNzZXJ0IG92ZXJyaWRpbmcgcG9vbCBrd2FyZ3Mgd29ya3Mgd2l0aCBjb25uZWN0aW9uX2Zyb21fdXJsLiIiIgogICAgICAgIHAgPSBQb29sTWFuYWdlcihzdHJpY3Q9VHJ1ZSkKICAgICAgICBwb29sX2t3YXJncyA9IHsnc3RyaWN0JzogRmFsc2UsICdyZXRyaWVzJzogMTAwLCAnYmxvY2snOiBUcnVlfQoKICAgICAgICBkZWZhdWx0X3Bvb2wgPSBwLmNvbm5lY3Rpb25fZnJvbV91cmwoJ2h0dHA6Ly9leGFtcGxlLmNvbS8nKQogICAgICAgIG92ZXJyaWRlX3Bvb2wgPSBwLmNvbm5lY3Rpb25fZnJvbV91cmwoCiAgICAgICAgICAgICdodHRwOi8vZXhhbXBsZS5jb20vJywgcG9vbF9rd2FyZ3M9cG9vbF9rd2FyZ3MpCgogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShkZWZhdWx0X3Bvb2wuc3RyaWN0KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmV0cnkuUmV0cnkuREVGQVVMVCwgZGVmYXVsdF9wb29sLnJldHJpZXMpCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShkZWZhdWx0X3Bvb2wuYmxvY2spCgogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2Uob3ZlcnJpZGVfcG9vbC5zdHJpY3QpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCgxMDAsIG92ZXJyaWRlX3Bvb2wucmV0cmllcykKICAgICAgICBzZWxmLmFzc2VydFRydWUob3ZlcnJpZGVfcG9vbC5ibG9jaykKCiAgICBkZWYgdGVzdF9vdmVycmlkZV9wb29sX2t3YXJnc19ob3N0KHNlbGYpOgogICAgICAgICIiIkFzc2VydCBvdmVycmlkaW5nIHBvb2wga3dhcmdzIHdvcmtzIHdpdGggY29ubmVjdGlvbl9mcm9tX2hvc3QiIiIKICAgICAgICBwID0gUG9vbE1hbmFnZXIoc3RyaWN0PVRydWUpCiAgICAgICAgcG9vbF9rd2FyZ3MgPSB7J3N0cmljdCc6IEZhbHNlLCAncmV0cmllcyc6IDEwMCwgJ2Jsb2NrJzogVHJ1ZX0KCiAgICAgICAgZGVmYXVsdF9wb29sID0gcC5jb25uZWN0aW9uX2Zyb21faG9zdCgnZXhhbXBsZS5jb20nLCBzY2hlbWU9J2h0dHAnKQogICAgICAgIG92ZXJyaWRlX3Bvb2wgPSBwLmNvbm5lY3Rpb25fZnJvbV9ob3N0KCdleGFtcGxlLmNvbScsIHNjaGVtZT0naHR0cCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9vbF9rd2FyZ3M9cG9vbF9rd2FyZ3MpCgogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShkZWZhdWx0X3Bvb2wuc3RyaWN0KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocmV0cnkuUmV0cnkuREVGQVVMVCwgZGVmYXVsdF9wb29sLnJldHJpZXMpCiAgICAgICAgc2VsZi5hc3NlcnRGYWxzZShkZWZhdWx0X3Bvb2wuYmxvY2spCgogICAgICAgIHNlbGYuYXNzZXJ0RmFsc2Uob3ZlcnJpZGVfcG9vbC5zdHJpY3QpCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCgxMDAsIG92ZXJyaWRlX3Bvb2wucmV0cmllcykKICAgICAgICBzZWxmLmFzc2VydFRydWUob3ZlcnJpZGVfcG9vbC5ibG9jaykKCiAgICBkZWYgdGVzdF9wb29sX2t3YXJnc19zb2NrZXRfb3B0aW9ucyhzZWxmKToKICAgICAgICAiIiJBc3NlcnQgcGFzc2luZyBzb2NrZXQgb3B0aW9ucyB3b3JrcyB3aXRoIGNvbm5lY3Rpb25fZnJvbV9ob3N0IiIiCiAgICAgICAgcCA9IFBvb2xNYW5hZ2VyKHNvY2tldF9vcHRpb25zPVtdKQogICAgICAgIG92ZXJyaWRlX29wdHMgPSBbCiAgICAgICAgICAgIChzb2NrZXQuU09MX1NPQ0tFVCwgc29ja2V0LlNPX1JFVVNFQUREUiwgMSksCiAgICAgICAgICAgIChzb2NrZXQuSVBQUk9UT19UQ1AsIHNvY2tldC5UQ1BfTk9ERUxBWSwgMSkKICAgICAgICBdCiAgICAgICAgcG9vbF9rd2FyZ3MgPSB7J3NvY2tldF9vcHRpb25zJzogb3ZlcnJpZGVfb3B0c30KCiAgICAgICAgZGVmYXVsdF9wb29sID0gcC5jb25uZWN0aW9uX2Zyb21faG9zdCgnZXhhbXBsZS5jb20nLCBzY2hlbWU9J2h0dHAnKQogICAgICAgIG92ZXJyaWRlX3Bvb2wgPSBwLmNvbm5lY3Rpb25fZnJvbV9ob3N0KAogICAgICAgICAgICAnZXhhbXBsZS5jb20nLCBzY2hlbWU9J2h0dHAnLCBwb29sX2t3YXJncz1wb29sX2t3YXJncwogICAgICAgICkKCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbChkZWZhdWx0X3Bvb2wuY29ubl9rd1snc29ja2V0X29wdGlvbnMnXSwgW10pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCgKICAgICAgICAgICAgb3ZlcnJpZGVfcG9vbC5jb25uX2t3Wydzb2NrZXRfb3B0aW9ucyddLCBvdmVycmlkZV9vcHRzCiAgICAgICAgKQoKICAgIGRlZiB0ZXN0X21lcmdlX3Bvb2xfa3dhcmdzKHNlbGYpOgogICAgICAgICIiIkFzc2VydCBfbWVyZ2VfcG9vbF9rd2FyZ3Mgd29ya3MgaW4gdGhlIGhhcHB5IGNhc2UiIiIKICAgICAgICBwID0gUG9vbE1hbmFnZXIoc3RyaWN0PVRydWUpCiAgICAgICAgbWVyZ2VkID0gcC5fbWVyZ2VfcG9vbF9rd2FyZ3MoeyduZXdfa2V5JzogJ3ZhbHVlJ30pCiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbCh7J3N0cmljdCc6IFRydWUsICduZXdfa2V5JzogJ3ZhbHVlJ30sIG1lcmdlZCkKCiAgICBkZWYgdGVzdF9tZXJnZV9wb29sX2t3YXJnc19ub25lKHNlbGYpOgogICAgICAgICIiIkFzc2VydCBmYWxzZS15IHZhbHVlcyB0byBfbWVyZ2VfcG9vbF9rd2FyZ3MgcmVzdWx0IGluIGRlZmF1bHRzIiIiCiAgICAgICAgcCA9IFBvb2xNYW5hZ2VyKHN0cmljdD1UcnVlKQogICAgICAgIG1lcmdlZCA9IHAuX21lcmdlX3Bvb2xfa3dhcmdzKHt9KQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocC5jb25uZWN0aW9uX3Bvb2xfa3csIG1lcmdlZCkKICAgICAgICBtZXJnZWQgPSBwLl9tZXJnZV9wb29sX2t3YXJncyhOb25lKQogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocC5jb25uZWN0aW9uX3Bvb2xfa3csIG1lcmdlZCkKCiAgICBkZWYgdGVzdF9tZXJnZV9wb29sX2t3YXJnc19yZW1vdmVfa2V5KHNlbGYpOgogICAgICAgICIiIkFzc2VydCBrZXlzIGNhbiBiZSByZW1vdmVkIHdpdGggX21lcmdlX3Bvb2xfa3dhcmdzIiIiCiAgICAgICAgcCA9IFBvb2xNYW5hZ2VyKHN0cmljdD1UcnVlKQogICAgICAgIG1lcmdlZCA9IHAuX21lcmdlX3Bvb2xfa3dhcmdzKHsnc3RyaWN0JzogTm9uZX0pCiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKCdzdHJpY3QnIG5vdCBpbiBtZXJnZWQpCgogICAgZGVmIHRlc3RfbWVyZ2VfcG9vbF9rd2FyZ3NfaW52YWxpZF9rZXkoc2VsZik6CiAgICAgICAgIiIiQXNzZXJ0IHJlbW92aW5nIGludmFsaWQga2V5cyB3aXRoIF9tZXJnZV9wb29sX2t3YXJncyBkb2Vzbid0IGJyZWFrIiIiCiAgICAgICAgcCA9IFBvb2xNYW5hZ2VyKHN0cmljdD1UcnVlKQogICAgICAgIG1lcmdlZCA9IHAuX21lcmdlX3Bvb2xfa3dhcmdzKHsnaW52YWxpZF9rZXknOiBOb25lfSkKICAgICAgICBzZWxmLmFzc2VydEVxdWFsKHAuY29ubmVjdGlvbl9wb29sX2t3LCBtZXJnZWQpCgoKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKICAgIHVuaXR0ZXN0Lm1haW4oKQo=
