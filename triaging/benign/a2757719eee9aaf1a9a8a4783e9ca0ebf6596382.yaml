statistics:
  total_files: 1
  skipped_files: 0.0
  processed_objects: 1
  malicious_objects: 0
details:
- path: .repo_cache/malicious_repos/pypi_malregistry/botaa3/1.0.0/botaa3-1.0.0/boto3-1.20.7/boto3/docs/resource.py
  contents:
  - name: <module>
    score: 0.0
    code: |-
      # Copyright 2015 Amazon.com, Inc. or its affiliates. All Rights Reserved.
      #
      # Licensed under the Apache License, Version 2.0 (the "License"). You
      # may not use this file except in compliance with the License. A copy of
      # the License is located at
      #
      # https://aws.amazon.com/apache2.0/
      #
      # or in the "license" file accompanying this file. This file is
      # distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF
      # ANY KIND, either express or implied. See the License for the specific
      # language governing permissions and limitations under the License.
      from botocore import xform_name
      from botocore.docs.utils import get_official_service_name

      from boto3.docs.base import BaseDocumenter
      from boto3.docs.action import ActionDocumenter
      from boto3.docs.waiter import WaiterResourceDocumenter
      from boto3.docs.collection import CollectionDocumenter
      from boto3.docs.subresource import SubResourceDocumenter
      from boto3.docs.attr import document_attribute
      from boto3.docs.attr import document_identifier
      from boto3.docs.attr import document_reference
      from boto3.docs.utils import get_identifier_args_for_signature
      from boto3.docs.utils import get_identifier_values_for_example
      from boto3.docs.utils import get_identifier_description
      from boto3.docs.utils import add_resource_type_overview


      class ResourceDocumenter(BaseDocumenter):
          def __init__(self, resource, botocore_session):
              super(ResourceDocumenter, self).__init__(resource)
              self._botocore_session = botocore_session

          def document_resource(self, section):
              self._add_title(section)
              self._add_intro(section)
              overview_section = section.add_new_section('member-overview')
              self._add_identifiers(section)
              self._add_attributes(section)
              self._add_references(section)
              self._add_actions(section)
              self._add_sub_resources(section)
              self._add_collections(section)
              self._add_waiters(section)
              self._add_overview_of_members(overview_section)

          def _add_title(self, section):
              section.style.h2(self._resource_name)

          def _add_intro(self, section):
              identifier_names = []
              if self._resource_model.identifiers:
                  for identifier in self._resource_model.identifiers:
                      identifier_names.append(identifier.name)

              # Write out the class signature.
              class_args = get_identifier_args_for_signature(identifier_names)
              section.style.start_sphinx_py_class(
                  class_name='%s(%s)' % (self.class_name, class_args))

              # Add as short description about the resource
              description_section = section.add_new_section('description')
              self._add_description(description_section)

              # Add an example of how to instantiate the resource
              example_section = section.add_new_section('example')
              self._add_example(example_section, identifier_names)

              # Add the description for the parameters to instantiate the
              # resource.
              param_section = section.add_new_section('params')
              self._add_params_description(param_section, identifier_names)

          def _add_description(self, section):
              official_service_name = get_official_service_name(
                  self._service_model)
              section.write(
                  'A resource representing an %s %s' % (
                      official_service_name, self._resource_name))

          def _add_example(self, section, identifier_names):
              section.style.start_codeblock()
              section.style.new_line()
              section.write('import boto3')
              section.style.new_line()
              section.style.new_line()
              section.write(
                  '%s = boto3.resource(\'%s\')' % (
                      self._service_name, self._service_name)
              )
              section.style.new_line()
              example_values = get_identifier_values_for_example(identifier_names)
              section.write(
                  '%s = %s.%s(%s)' % (
                      xform_name(self._resource_name), self._service_name,
                      self._resource_name, example_values))
              section.style.end_codeblock()

          def _add_params_description(self, section, identifier_names):
              for identifier_name in identifier_names:
                  description = get_identifier_description(
                      self._resource_name, identifier_name)
                  section.write(':type %s: string' % identifier_name)
                  section.style.new_line()
                  section.write(':param %s: %s' % (
                      identifier_name, description))
                  section.style.new_line()

          def _add_overview_of_members(self, section):
              for resource_member_type in self.member_map:
                  section.style.new_line()
                  section.write('These are the resource\'s available %s:' % (
                      resource_member_type))
                  section.style.new_line()
                  for member in self.member_map[resource_member_type]:
                      if resource_member_type in ['identifiers', 'attributes',
                                                  'references', 'collections']:
                          section.style.li(':py:attr:`%s`' % member)
                      else:
                          section.style.li(':py:meth:`%s()`' % member)

          def _add_identifiers(self, section):
              identifiers = self._resource.meta.resource_model.identifiers
              section = section.add_new_section('identifiers')
              member_list = []
              if identifiers:
                  self.member_map['identifiers'] = member_list
                  add_resource_type_overview(
                      section=section,
                      resource_type='Identifiers',
                      description=(
                          'Identifiers are properties of a resource that are '
                          'set upon instantation of the resource.'),
                      intro_link='identifiers_attributes_intro')
              for identifier in identifiers:
                  identifier_section = section.add_new_section(identifier.name)
                  member_list.append(identifier.name)
                  document_identifier(
                      section=identifier_section,
                      resource_name=self._resource_name,
                      identifier_model=identifier
                  )

          def _add_attributes(self, section):
              service_model = self._resource.meta.client.meta.service_model
              attributes = {}
              if self._resource.meta.resource_model.shape:
                  shape = service_model.shape_for(
                      self._resource.meta.resource_model.shape)
                  attributes = self._resource.meta.resource_model.get_attributes(
                      shape)
              section = section.add_new_section('attributes')
              attribute_list = []
              if attributes:
                  add_resource_type_overview(
                      section=section,
                      resource_type='Attributes',
                      description=(
                          'Attributes provide access'
                          ' to the properties of a resource. Attributes are lazy-'
                          'loaded the first time one is accessed via the'
                          ' :py:meth:`load` method.'),
                      intro_link='identifiers_attributes_intro')
                  self.member_map['attributes'] = attribute_list
              for attr_name in sorted(attributes):
                  _, attr_shape = attributes[attr_name]
                  attribute_section = section.add_new_section(attr_name)
                  attribute_list.append(attr_name)
                  document_attribute(
                      section=attribute_section,
                      service_name=self._service_name,
                      resource_name=self._resource_name,
                      attr_name=attr_name,
                      event_emitter=self._resource.meta.client.meta.events,
                      attr_model=attr_shape
                  )

          def _add_references(self, section):
              section = section.add_new_section('references')
              references = self._resource.meta.resource_model.references
              reference_list = []
              if references:
                  add_resource_type_overview(
                      section=section,
                      resource_type='References',
                      description=(
                          'References are related resource instances that have '
                          'a belongs-to relationship.'),
                      intro_link='references_intro')
                  self.member_map['references'] = reference_list
              for reference in references:
                  reference_section = section.add_new_section(reference.name)
                  reference_list.append(reference.name)
                  document_reference(
                      section=reference_section,
                      reference_model=reference
                  )

          def _add_actions(self, section):
              section = section.add_new_section('actions')
              actions = self._resource.meta.resource_model.actions
              if actions:
                  documenter = ActionDocumenter(self._resource)
                  documenter.member_map = self.member_map
                  documenter.document_actions(section)

          def _add_sub_resources(self, section):
              section = section.add_new_section('sub-resources')
              sub_resources = self._resource.meta.resource_model.subresources
              if sub_resources:
                  documenter = SubResourceDocumenter(self._resource)
                  documenter.member_map = self.member_map
                  documenter.document_sub_resources(section)

          def _add_collections(self, section):
              section = section.add_new_section('collections')
              collections = self._resource.meta.resource_model.collections
              if collections:
                  documenter = CollectionDocumenter(self._resource)
                  documenter.member_map = self.member_map
                  documenter.document_collections(section)

          def _add_waiters(self, section):
              section = section.add_new_section('waiters')
              waiters = self._resource.meta.resource_model.waiters
              if waiters:
                  service_waiter_model = self._botocore_session.get_waiter_model(
                      self._service_name)
                  documenter = WaiterResourceDocumenter(
                      self._resource, service_waiter_model)
                  documenter.member_map = self.member_map
                  documenter.document_resource_waiters(section)
    tokens: resume load_const INTEGER load_const import_name botocore import_from xform_name store_name xform_name pop_top load_const INTEGER load_const import_name STRING_LEN_S_ENT_HIGH import_from STRING_LEN_S_ENT_HIGH store_name STRING_LEN_S_ENT_HIGH pop_top load_const INTEGER load_const import_name boto3.docs.base import_from BaseDocumenter store_name BaseDocumenter pop_top load_const INTEGER load_const import_name STRING_LEN_S_ENT_HIGH import_from STRING_BASE64_LEN_S_ENT_HIGH store_name STRING_BASE64_LEN_S_ENT_HIGH pop_top load_const INTEGER load_const import_name STRING_LEN_S_ENT_HIGH import_from STRING_BASE64_LEN_S_ENT_HIGH store_name STRING_BASE64_LEN_S_ENT_HIGH pop_top load_const INTEGER load_const import_name STRING_LEN_S_ENT_HIGH import_from STRING_BASE64_LEN_S_ENT_HIGH store_name STRING_BASE64_LEN_S_ENT_HIGH pop_top load_const INTEGER load_const import_name STRING_LEN_S_ENT_HIGH import_from STRING_LEN_S_ENT_HIGH store_name STRING_LEN_S_ENT_HIGH pop_top load_const INTEGER load_const import_name boto3.docs.attr import_from STRING_LEN_S_ENT_HIGH store_name STRING_LEN_S_ENT_HIGH pop_top load_const INTEGER load_const import_name boto3.docs.attr import_from STRING_LEN_S_ENT_HIGH store_name STRING_LEN_S_ENT_HIGH pop_top load_const INTEGER load_const import_name boto3.docs.attr import_from STRING_LEN_S_ENT_HIGH store_name STRING_LEN_S_ENT_HIGH pop_top load_const INTEGER load_const import_name STRING_LEN_S_ENT_HIGH import_from STRING_LEN_S_ENT_HIGH store_name STRING_LEN_S_ENT_HIGH pop_top load_const INTEGER load_const import_name STRING_LEN_S_ENT_HIGH import_from STRING_LEN_S_ENT_HIGH store_name STRING_LEN_S_ENT_HIGH pop_top load_const INTEGER load_const import_name STRING_LEN_S_ENT_HIGH import_from STRING_LEN_S_ENT_HIGH store_name STRING_LEN_S_ENT_HIGH pop_top load_const INTEGER load_const import_name STRING_LEN_S_ENT_HIGH import_from STRING_LEN_S_ENT_HIGH store_name STRING_LEN_S_ENT_HIGH pop_top push_null load_build_class load_const OBJECT make_function load_const STRING_LEN_S_ENT_HIGH load_name BaseDocumenter call store_name STRING_LEN_S_ENT_HIGH push_null load_build_class load_const OBJECT make_function load_const STRING_LEN_S_ENT_HIGH load_name STRING_LEN_S_ENT_HIGH call store_name STRING_LEN_S_ENT_HIGH return_const None
    hash: eca9ea77eda2016f5f81dcd808eecd8c91bf58b0300c9a4ae9291a43edd9284d
sources:
  .repo_cache/malicious_repos/pypi_malregistry/botaa3/1.0.0/botaa3-1.0.0/boto3-1.20.7/boto3/docs/resource.py: IyBDb3B5cmlnaHQgMjAxNSBBbWF6b24uY29tLCBJbmMuIG9yIGl0cyBhZmZpbGlhdGVzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgojCiMgTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIikuIFlvdQojIG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBBIGNvcHkgb2YKIyB0aGUgTGljZW5zZSBpcyBsb2NhdGVkIGF0CiMKIyBodHRwczovL2F3cy5hbWF6b24uY29tL2FwYWNoZTIuMC8KIwojIG9yIGluIHRoZSAibGljZW5zZSIgZmlsZSBhY2NvbXBhbnlpbmcgdGhpcyBmaWxlLiBUaGlzIGZpbGUgaXMKIyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRgojIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYwojIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCmZyb20gYm90b2NvcmUgaW1wb3J0IHhmb3JtX25hbWUKZnJvbSBib3RvY29yZS5kb2NzLnV0aWxzIGltcG9ydCBnZXRfb2ZmaWNpYWxfc2VydmljZV9uYW1lCgpmcm9tIGJvdG8zLmRvY3MuYmFzZSBpbXBvcnQgQmFzZURvY3VtZW50ZXIKZnJvbSBib3RvMy5kb2NzLmFjdGlvbiBpbXBvcnQgQWN0aW9uRG9jdW1lbnRlcgpmcm9tIGJvdG8zLmRvY3Mud2FpdGVyIGltcG9ydCBXYWl0ZXJSZXNvdXJjZURvY3VtZW50ZXIKZnJvbSBib3RvMy5kb2NzLmNvbGxlY3Rpb24gaW1wb3J0IENvbGxlY3Rpb25Eb2N1bWVudGVyCmZyb20gYm90bzMuZG9jcy5zdWJyZXNvdXJjZSBpbXBvcnQgU3ViUmVzb3VyY2VEb2N1bWVudGVyCmZyb20gYm90bzMuZG9jcy5hdHRyIGltcG9ydCBkb2N1bWVudF9hdHRyaWJ1dGUKZnJvbSBib3RvMy5kb2NzLmF0dHIgaW1wb3J0IGRvY3VtZW50X2lkZW50aWZpZXIKZnJvbSBib3RvMy5kb2NzLmF0dHIgaW1wb3J0IGRvY3VtZW50X3JlZmVyZW5jZQpmcm9tIGJvdG8zLmRvY3MudXRpbHMgaW1wb3J0IGdldF9pZGVudGlmaWVyX2FyZ3NfZm9yX3NpZ25hdHVyZQpmcm9tIGJvdG8zLmRvY3MudXRpbHMgaW1wb3J0IGdldF9pZGVudGlmaWVyX3ZhbHVlc19mb3JfZXhhbXBsZQpmcm9tIGJvdG8zLmRvY3MudXRpbHMgaW1wb3J0IGdldF9pZGVudGlmaWVyX2Rlc2NyaXB0aW9uCmZyb20gYm90bzMuZG9jcy51dGlscyBpbXBvcnQgYWRkX3Jlc291cmNlX3R5cGVfb3ZlcnZpZXcKCgpjbGFzcyBSZXNvdXJjZURvY3VtZW50ZXIoQmFzZURvY3VtZW50ZXIpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHJlc291cmNlLCBib3RvY29yZV9zZXNzaW9uKToKICAgICAgICBzdXBlcihSZXNvdXJjZURvY3VtZW50ZXIsIHNlbGYpLl9faW5pdF9fKHJlc291cmNlKQogICAgICAgIHNlbGYuX2JvdG9jb3JlX3Nlc3Npb24gPSBib3RvY29yZV9zZXNzaW9uCgogICAgZGVmIGRvY3VtZW50X3Jlc291cmNlKHNlbGYsIHNlY3Rpb24pOgogICAgICAgIHNlbGYuX2FkZF90aXRsZShzZWN0aW9uKQogICAgICAgIHNlbGYuX2FkZF9pbnRybyhzZWN0aW9uKQogICAgICAgIG92ZXJ2aWV3X3NlY3Rpb24gPSBzZWN0aW9uLmFkZF9uZXdfc2VjdGlvbignbWVtYmVyLW92ZXJ2aWV3JykKICAgICAgICBzZWxmLl9hZGRfaWRlbnRpZmllcnMoc2VjdGlvbikKICAgICAgICBzZWxmLl9hZGRfYXR0cmlidXRlcyhzZWN0aW9uKQogICAgICAgIHNlbGYuX2FkZF9yZWZlcmVuY2VzKHNlY3Rpb24pCiAgICAgICAgc2VsZi5fYWRkX2FjdGlvbnMoc2VjdGlvbikKICAgICAgICBzZWxmLl9hZGRfc3ViX3Jlc291cmNlcyhzZWN0aW9uKQogICAgICAgIHNlbGYuX2FkZF9jb2xsZWN0aW9ucyhzZWN0aW9uKQogICAgICAgIHNlbGYuX2FkZF93YWl0ZXJzKHNlY3Rpb24pCiAgICAgICAgc2VsZi5fYWRkX292ZXJ2aWV3X29mX21lbWJlcnMob3ZlcnZpZXdfc2VjdGlvbikKCiAgICBkZWYgX2FkZF90aXRsZShzZWxmLCBzZWN0aW9uKToKICAgICAgICBzZWN0aW9uLnN0eWxlLmgyKHNlbGYuX3Jlc291cmNlX25hbWUpCgogICAgZGVmIF9hZGRfaW50cm8oc2VsZiwgc2VjdGlvbik6CiAgICAgICAgaWRlbnRpZmllcl9uYW1lcyA9IFtdCiAgICAgICAgaWYgc2VsZi5fcmVzb3VyY2VfbW9kZWwuaWRlbnRpZmllcnM6CiAgICAgICAgICAgIGZvciBpZGVudGlmaWVyIGluIHNlbGYuX3Jlc291cmNlX21vZGVsLmlkZW50aWZpZXJzOgogICAgICAgICAgICAgICAgaWRlbnRpZmllcl9uYW1lcy5hcHBlbmQoaWRlbnRpZmllci5uYW1lKQoKICAgICAgICAjIFdyaXRlIG91dCB0aGUgY2xhc3Mgc2lnbmF0dXJlLgogICAgICAgIGNsYXNzX2FyZ3MgPSBnZXRfaWRlbnRpZmllcl9hcmdzX2Zvcl9zaWduYXR1cmUoaWRlbnRpZmllcl9uYW1lcykKICAgICAgICBzZWN0aW9uLnN0eWxlLnN0YXJ0X3NwaGlueF9weV9jbGFzcygKICAgICAgICAgICAgY2xhc3NfbmFtZT0nJXMoJXMpJyAlIChzZWxmLmNsYXNzX25hbWUsIGNsYXNzX2FyZ3MpKQoKICAgICAgICAjIEFkZCBhcyBzaG9ydCBkZXNjcmlwdGlvbiBhYm91dCB0aGUgcmVzb3VyY2UKICAgICAgICBkZXNjcmlwdGlvbl9zZWN0aW9uID0gc2VjdGlvbi5hZGRfbmV3X3NlY3Rpb24oJ2Rlc2NyaXB0aW9uJykKICAgICAgICBzZWxmLl9hZGRfZGVzY3JpcHRpb24oZGVzY3JpcHRpb25fc2VjdGlvbikKCiAgICAgICAgIyBBZGQgYW4gZXhhbXBsZSBvZiBob3cgdG8gaW5zdGFudGlhdGUgdGhlIHJlc291cmNlCiAgICAgICAgZXhhbXBsZV9zZWN0aW9uID0gc2VjdGlvbi5hZGRfbmV3X3NlY3Rpb24oJ2V4YW1wbGUnKQogICAgICAgIHNlbGYuX2FkZF9leGFtcGxlKGV4YW1wbGVfc2VjdGlvbiwgaWRlbnRpZmllcl9uYW1lcykKCiAgICAgICAgIyBBZGQgdGhlIGRlc2NyaXB0aW9uIGZvciB0aGUgcGFyYW1ldGVycyB0byBpbnN0YW50aWF0ZSB0aGUKICAgICAgICAjIHJlc291cmNlLgogICAgICAgIHBhcmFtX3NlY3Rpb24gPSBzZWN0aW9uLmFkZF9uZXdfc2VjdGlvbigncGFyYW1zJykKICAgICAgICBzZWxmLl9hZGRfcGFyYW1zX2Rlc2NyaXB0aW9uKHBhcmFtX3NlY3Rpb24sIGlkZW50aWZpZXJfbmFtZXMpCgogICAgZGVmIF9hZGRfZGVzY3JpcHRpb24oc2VsZiwgc2VjdGlvbik6CiAgICAgICAgb2ZmaWNpYWxfc2VydmljZV9uYW1lID0gZ2V0X29mZmljaWFsX3NlcnZpY2VfbmFtZSgKICAgICAgICAgICAgc2VsZi5fc2VydmljZV9tb2RlbCkKICAgICAgICBzZWN0aW9uLndyaXRlKAogICAgICAgICAgICAnQSByZXNvdXJjZSByZXByZXNlbnRpbmcgYW4gJXMgJXMnICUgKAogICAgICAgICAgICAgICAgb2ZmaWNpYWxfc2VydmljZV9uYW1lLCBzZWxmLl9yZXNvdXJjZV9uYW1lKSkKCiAgICBkZWYgX2FkZF9leGFtcGxlKHNlbGYsIHNlY3Rpb24sIGlkZW50aWZpZXJfbmFtZXMpOgogICAgICAgIHNlY3Rpb24uc3R5bGUuc3RhcnRfY29kZWJsb2NrKCkKICAgICAgICBzZWN0aW9uLnN0eWxlLm5ld19saW5lKCkKICAgICAgICBzZWN0aW9uLndyaXRlKCdpbXBvcnQgYm90bzMnKQogICAgICAgIHNlY3Rpb24uc3R5bGUubmV3X2xpbmUoKQogICAgICAgIHNlY3Rpb24uc3R5bGUubmV3X2xpbmUoKQogICAgICAgIHNlY3Rpb24ud3JpdGUoCiAgICAgICAgICAgICclcyA9IGJvdG8zLnJlc291cmNlKFwnJXNcJyknICUgKAogICAgICAgICAgICAgICAgc2VsZi5fc2VydmljZV9uYW1lLCBzZWxmLl9zZXJ2aWNlX25hbWUpCiAgICAgICAgKQogICAgICAgIHNlY3Rpb24uc3R5bGUubmV3X2xpbmUoKQogICAgICAgIGV4YW1wbGVfdmFsdWVzID0gZ2V0X2lkZW50aWZpZXJfdmFsdWVzX2Zvcl9leGFtcGxlKGlkZW50aWZpZXJfbmFtZXMpCiAgICAgICAgc2VjdGlvbi53cml0ZSgKICAgICAgICAgICAgJyVzID0gJXMuJXMoJXMpJyAlICgKICAgICAgICAgICAgICAgIHhmb3JtX25hbWUoc2VsZi5fcmVzb3VyY2VfbmFtZSksIHNlbGYuX3NlcnZpY2VfbmFtZSwKICAgICAgICAgICAgICAgIHNlbGYuX3Jlc291cmNlX25hbWUsIGV4YW1wbGVfdmFsdWVzKSkKICAgICAgICBzZWN0aW9uLnN0eWxlLmVuZF9jb2RlYmxvY2soKQoKICAgIGRlZiBfYWRkX3BhcmFtc19kZXNjcmlwdGlvbihzZWxmLCBzZWN0aW9uLCBpZGVudGlmaWVyX25hbWVzKToKICAgICAgICBmb3IgaWRlbnRpZmllcl9uYW1lIGluIGlkZW50aWZpZXJfbmFtZXM6CiAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gZ2V0X2lkZW50aWZpZXJfZGVzY3JpcHRpb24oCiAgICAgICAgICAgICAgICBzZWxmLl9yZXNvdXJjZV9uYW1lLCBpZGVudGlmaWVyX25hbWUpCiAgICAgICAgICAgIHNlY3Rpb24ud3JpdGUoJzp0eXBlICVzOiBzdHJpbmcnICUgaWRlbnRpZmllcl9uYW1lKQogICAgICAgICAgICBzZWN0aW9uLnN0eWxlLm5ld19saW5lKCkKICAgICAgICAgICAgc2VjdGlvbi53cml0ZSgnOnBhcmFtICVzOiAlcycgJSAoCiAgICAgICAgICAgICAgICBpZGVudGlmaWVyX25hbWUsIGRlc2NyaXB0aW9uKSkKICAgICAgICAgICAgc2VjdGlvbi5zdHlsZS5uZXdfbGluZSgpCgogICAgZGVmIF9hZGRfb3ZlcnZpZXdfb2ZfbWVtYmVycyhzZWxmLCBzZWN0aW9uKToKICAgICAgICBmb3IgcmVzb3VyY2VfbWVtYmVyX3R5cGUgaW4gc2VsZi5tZW1iZXJfbWFwOgogICAgICAgICAgICBzZWN0aW9uLnN0eWxlLm5ld19saW5lKCkKICAgICAgICAgICAgc2VjdGlvbi53cml0ZSgnVGhlc2UgYXJlIHRoZSByZXNvdXJjZVwncyBhdmFpbGFibGUgJXM6JyAlICgKICAgICAgICAgICAgICAgIHJlc291cmNlX21lbWJlcl90eXBlKSkKICAgICAgICAgICAgc2VjdGlvbi5zdHlsZS5uZXdfbGluZSgpCiAgICAgICAgICAgIGZvciBtZW1iZXIgaW4gc2VsZi5tZW1iZXJfbWFwW3Jlc291cmNlX21lbWJlcl90eXBlXToKICAgICAgICAgICAgICAgIGlmIHJlc291cmNlX21lbWJlcl90eXBlIGluIFsnaWRlbnRpZmllcnMnLCAnYXR0cmlidXRlcycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3JlZmVyZW5jZXMnLCAnY29sbGVjdGlvbnMnXToKICAgICAgICAgICAgICAgICAgICBzZWN0aW9uLnN0eWxlLmxpKCc6cHk6YXR0cjpgJXNgJyAlIG1lbWJlcikKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgc2VjdGlvbi5zdHlsZS5saSgnOnB5Om1ldGg6YCVzKClgJyAlIG1lbWJlcikKCiAgICBkZWYgX2FkZF9pZGVudGlmaWVycyhzZWxmLCBzZWN0aW9uKToKICAgICAgICBpZGVudGlmaWVycyA9IHNlbGYuX3Jlc291cmNlLm1ldGEucmVzb3VyY2VfbW9kZWwuaWRlbnRpZmllcnMKICAgICAgICBzZWN0aW9uID0gc2VjdGlvbi5hZGRfbmV3X3NlY3Rpb24oJ2lkZW50aWZpZXJzJykKICAgICAgICBtZW1iZXJfbGlzdCA9IFtdCiAgICAgICAgaWYgaWRlbnRpZmllcnM6CiAgICAgICAgICAgIHNlbGYubWVtYmVyX21hcFsnaWRlbnRpZmllcnMnXSA9IG1lbWJlcl9saXN0CiAgICAgICAgICAgIGFkZF9yZXNvdXJjZV90eXBlX292ZXJ2aWV3KAogICAgICAgICAgICAgICAgc2VjdGlvbj1zZWN0aW9uLAogICAgICAgICAgICAgICAgcmVzb3VyY2VfdHlwZT0nSWRlbnRpZmllcnMnLAogICAgICAgICAgICAgICAgZGVzY3JpcHRpb249KAogICAgICAgICAgICAgICAgICAgICdJZGVudGlmaWVycyBhcmUgcHJvcGVydGllcyBvZiBhIHJlc291cmNlIHRoYXQgYXJlICcKICAgICAgICAgICAgICAgICAgICAnc2V0IHVwb24gaW5zdGFudGF0aW9uIG9mIHRoZSByZXNvdXJjZS4nKSwKICAgICAgICAgICAgICAgIGludHJvX2xpbms9J2lkZW50aWZpZXJzX2F0dHJpYnV0ZXNfaW50cm8nKQogICAgICAgIGZvciBpZGVudGlmaWVyIGluIGlkZW50aWZpZXJzOgogICAgICAgICAgICBpZGVudGlmaWVyX3NlY3Rpb24gPSBzZWN0aW9uLmFkZF9uZXdfc2VjdGlvbihpZGVudGlmaWVyLm5hbWUpCiAgICAgICAgICAgIG1lbWJlcl9saXN0LmFwcGVuZChpZGVudGlmaWVyLm5hbWUpCiAgICAgICAgICAgIGRvY3VtZW50X2lkZW50aWZpZXIoCiAgICAgICAgICAgICAgICBzZWN0aW9uPWlkZW50aWZpZXJfc2VjdGlvbiwKICAgICAgICAgICAgICAgIHJlc291cmNlX25hbWU9c2VsZi5fcmVzb3VyY2VfbmFtZSwKICAgICAgICAgICAgICAgIGlkZW50aWZpZXJfbW9kZWw9aWRlbnRpZmllcgogICAgICAgICAgICApCgogICAgZGVmIF9hZGRfYXR0cmlidXRlcyhzZWxmLCBzZWN0aW9uKToKICAgICAgICBzZXJ2aWNlX21vZGVsID0gc2VsZi5fcmVzb3VyY2UubWV0YS5jbGllbnQubWV0YS5zZXJ2aWNlX21vZGVsCiAgICAgICAgYXR0cmlidXRlcyA9IHt9CiAgICAgICAgaWYgc2VsZi5fcmVzb3VyY2UubWV0YS5yZXNvdXJjZV9tb2RlbC5zaGFwZToKICAgICAgICAgICAgc2hhcGUgPSBzZXJ2aWNlX21vZGVsLnNoYXBlX2ZvcigKICAgICAgICAgICAgICAgIHNlbGYuX3Jlc291cmNlLm1ldGEucmVzb3VyY2VfbW9kZWwuc2hhcGUpCiAgICAgICAgICAgIGF0dHJpYnV0ZXMgPSBzZWxmLl9yZXNvdXJjZS5tZXRhLnJlc291cmNlX21vZGVsLmdldF9hdHRyaWJ1dGVzKAogICAgICAgICAgICAgICAgc2hhcGUpCiAgICAgICAgc2VjdGlvbiA9IHNlY3Rpb24uYWRkX25ld19zZWN0aW9uKCdhdHRyaWJ1dGVzJykKICAgICAgICBhdHRyaWJ1dGVfbGlzdCA9IFtdCiAgICAgICAgaWYgYXR0cmlidXRlczoKICAgICAgICAgICAgYWRkX3Jlc291cmNlX3R5cGVfb3ZlcnZpZXcoCiAgICAgICAgICAgICAgICBzZWN0aW9uPXNlY3Rpb24sCiAgICAgICAgICAgICAgICByZXNvdXJjZV90eXBlPSdBdHRyaWJ1dGVzJywKICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uPSgKICAgICAgICAgICAgICAgICAgICAnQXR0cmlidXRlcyBwcm92aWRlIGFjY2VzcycKICAgICAgICAgICAgICAgICAgICAnIHRvIHRoZSBwcm9wZXJ0aWVzIG9mIGEgcmVzb3VyY2UuIEF0dHJpYnV0ZXMgYXJlIGxhenktJwogICAgICAgICAgICAgICAgICAgICdsb2FkZWQgdGhlIGZpcnN0IHRpbWUgb25lIGlzIGFjY2Vzc2VkIHZpYSB0aGUnCiAgICAgICAgICAgICAgICAgICAgJyA6cHk6bWV0aDpgbG9hZGAgbWV0aG9kLicpLAogICAgICAgICAgICAgICAgaW50cm9fbGluaz0naWRlbnRpZmllcnNfYXR0cmlidXRlc19pbnRybycpCiAgICAgICAgICAgIHNlbGYubWVtYmVyX21hcFsnYXR0cmlidXRlcyddID0gYXR0cmlidXRlX2xpc3QKICAgICAgICBmb3IgYXR0cl9uYW1lIGluIHNvcnRlZChhdHRyaWJ1dGVzKToKICAgICAgICAgICAgXywgYXR0cl9zaGFwZSA9IGF0dHJpYnV0ZXNbYXR0cl9uYW1lXQogICAgICAgICAgICBhdHRyaWJ1dGVfc2VjdGlvbiA9IHNlY3Rpb24uYWRkX25ld19zZWN0aW9uKGF0dHJfbmFtZSkKICAgICAgICAgICAgYXR0cmlidXRlX2xpc3QuYXBwZW5kKGF0dHJfbmFtZSkKICAgICAgICAgICAgZG9jdW1lbnRfYXR0cmlidXRlKAogICAgICAgICAgICAgICAgc2VjdGlvbj1hdHRyaWJ1dGVfc2VjdGlvbiwKICAgICAgICAgICAgICAgIHNlcnZpY2VfbmFtZT1zZWxmLl9zZXJ2aWNlX25hbWUsCiAgICAgICAgICAgICAgICByZXNvdXJjZV9uYW1lPXNlbGYuX3Jlc291cmNlX25hbWUsCiAgICAgICAgICAgICAgICBhdHRyX25hbWU9YXR0cl9uYW1lLAogICAgICAgICAgICAgICAgZXZlbnRfZW1pdHRlcj1zZWxmLl9yZXNvdXJjZS5tZXRhLmNsaWVudC5tZXRhLmV2ZW50cywKICAgICAgICAgICAgICAgIGF0dHJfbW9kZWw9YXR0cl9zaGFwZQogICAgICAgICAgICApCgogICAgZGVmIF9hZGRfcmVmZXJlbmNlcyhzZWxmLCBzZWN0aW9uKToKICAgICAgICBzZWN0aW9uID0gc2VjdGlvbi5hZGRfbmV3X3NlY3Rpb24oJ3JlZmVyZW5jZXMnKQogICAgICAgIHJlZmVyZW5jZXMgPSBzZWxmLl9yZXNvdXJjZS5tZXRhLnJlc291cmNlX21vZGVsLnJlZmVyZW5jZXMKICAgICAgICByZWZlcmVuY2VfbGlzdCA9IFtdCiAgICAgICAgaWYgcmVmZXJlbmNlczoKICAgICAgICAgICAgYWRkX3Jlc291cmNlX3R5cGVfb3ZlcnZpZXcoCiAgICAgICAgICAgICAgICBzZWN0aW9uPXNlY3Rpb24sCiAgICAgICAgICAgICAgICByZXNvdXJjZV90eXBlPSdSZWZlcmVuY2VzJywKICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uPSgKICAgICAgICAgICAgICAgICAgICAnUmVmZXJlbmNlcyBhcmUgcmVsYXRlZCByZXNvdXJjZSBpbnN0YW5jZXMgdGhhdCBoYXZlICcKICAgICAgICAgICAgICAgICAgICAnYSBiZWxvbmdzLXRvIHJlbGF0aW9uc2hpcC4nKSwKICAgICAgICAgICAgICAgIGludHJvX2xpbms9J3JlZmVyZW5jZXNfaW50cm8nKQogICAgICAgICAgICBzZWxmLm1lbWJlcl9tYXBbJ3JlZmVyZW5jZXMnXSA9IHJlZmVyZW5jZV9saXN0CiAgICAgICAgZm9yIHJlZmVyZW5jZSBpbiByZWZlcmVuY2VzOgogICAgICAgICAgICByZWZlcmVuY2Vfc2VjdGlvbiA9IHNlY3Rpb24uYWRkX25ld19zZWN0aW9uKHJlZmVyZW5jZS5uYW1lKQogICAgICAgICAgICByZWZlcmVuY2VfbGlzdC5hcHBlbmQocmVmZXJlbmNlLm5hbWUpCiAgICAgICAgICAgIGRvY3VtZW50X3JlZmVyZW5jZSgKICAgICAgICAgICAgICAgIHNlY3Rpb249cmVmZXJlbmNlX3NlY3Rpb24sCiAgICAgICAgICAgICAgICByZWZlcmVuY2VfbW9kZWw9cmVmZXJlbmNlCiAgICAgICAgICAgICkKCiAgICBkZWYgX2FkZF9hY3Rpb25zKHNlbGYsIHNlY3Rpb24pOgogICAgICAgIHNlY3Rpb24gPSBzZWN0aW9uLmFkZF9uZXdfc2VjdGlvbignYWN0aW9ucycpCiAgICAgICAgYWN0aW9ucyA9IHNlbGYuX3Jlc291cmNlLm1ldGEucmVzb3VyY2VfbW9kZWwuYWN0aW9ucwogICAgICAgIGlmIGFjdGlvbnM6CiAgICAgICAgICAgIGRvY3VtZW50ZXIgPSBBY3Rpb25Eb2N1bWVudGVyKHNlbGYuX3Jlc291cmNlKQogICAgICAgICAgICBkb2N1bWVudGVyLm1lbWJlcl9tYXAgPSBzZWxmLm1lbWJlcl9tYXAKICAgICAgICAgICAgZG9jdW1lbnRlci5kb2N1bWVudF9hY3Rpb25zKHNlY3Rpb24pCgogICAgZGVmIF9hZGRfc3ViX3Jlc291cmNlcyhzZWxmLCBzZWN0aW9uKToKICAgICAgICBzZWN0aW9uID0gc2VjdGlvbi5hZGRfbmV3X3NlY3Rpb24oJ3N1Yi1yZXNvdXJjZXMnKQogICAgICAgIHN1Yl9yZXNvdXJjZXMgPSBzZWxmLl9yZXNvdXJjZS5tZXRhLnJlc291cmNlX21vZGVsLnN1YnJlc291cmNlcwogICAgICAgIGlmIHN1Yl9yZXNvdXJjZXM6CiAgICAgICAgICAgIGRvY3VtZW50ZXIgPSBTdWJSZXNvdXJjZURvY3VtZW50ZXIoc2VsZi5fcmVzb3VyY2UpCiAgICAgICAgICAgIGRvY3VtZW50ZXIubWVtYmVyX21hcCA9IHNlbGYubWVtYmVyX21hcAogICAgICAgICAgICBkb2N1bWVudGVyLmRvY3VtZW50X3N1Yl9yZXNvdXJjZXMoc2VjdGlvbikKCiAgICBkZWYgX2FkZF9jb2xsZWN0aW9ucyhzZWxmLCBzZWN0aW9uKToKICAgICAgICBzZWN0aW9uID0gc2VjdGlvbi5hZGRfbmV3X3NlY3Rpb24oJ2NvbGxlY3Rpb25zJykKICAgICAgICBjb2xsZWN0aW9ucyA9IHNlbGYuX3Jlc291cmNlLm1ldGEucmVzb3VyY2VfbW9kZWwuY29sbGVjdGlvbnMKICAgICAgICBpZiBjb2xsZWN0aW9uczoKICAgICAgICAgICAgZG9jdW1lbnRlciA9IENvbGxlY3Rpb25Eb2N1bWVudGVyKHNlbGYuX3Jlc291cmNlKQogICAgICAgICAgICBkb2N1bWVudGVyLm1lbWJlcl9tYXAgPSBzZWxmLm1lbWJlcl9tYXAKICAgICAgICAgICAgZG9jdW1lbnRlci5kb2N1bWVudF9jb2xsZWN0aW9ucyhzZWN0aW9uKQoKICAgIGRlZiBfYWRkX3dhaXRlcnMoc2VsZiwgc2VjdGlvbik6CiAgICAgICAgc2VjdGlvbiA9IHNlY3Rpb24uYWRkX25ld19zZWN0aW9uKCd3YWl0ZXJzJykKICAgICAgICB3YWl0ZXJzID0gc2VsZi5fcmVzb3VyY2UubWV0YS5yZXNvdXJjZV9tb2RlbC53YWl0ZXJzCiAgICAgICAgaWYgd2FpdGVyczoKICAgICAgICAgICAgc2VydmljZV93YWl0ZXJfbW9kZWwgPSBzZWxmLl9ib3RvY29yZV9zZXNzaW9uLmdldF93YWl0ZXJfbW9kZWwoCiAgICAgICAgICAgICAgICBzZWxmLl9zZXJ2aWNlX25hbWUpCiAgICAgICAgICAgIGRvY3VtZW50ZXIgPSBXYWl0ZXJSZXNvdXJjZURvY3VtZW50ZXIoCiAgICAgICAgICAgICAgICBzZWxmLl9yZXNvdXJjZSwgc2VydmljZV93YWl0ZXJfbW9kZWwpCiAgICAgICAgICAgIGRvY3VtZW50ZXIubWVtYmVyX21hcCA9IHNlbGYubWVtYmVyX21hcAogICAgICAgICAgICBkb2N1bWVudGVyLmRvY3VtZW50X3Jlc291cmNlX3dhaXRlcnMoc2VjdGlvbikKCgpjbGFzcyBTZXJ2aWNlUmVzb3VyY2VEb2N1bWVudGVyKFJlc291cmNlRG9jdW1lbnRlcik6CiAgICBAcHJvcGVydHkKICAgIGRlZiBjbGFzc19uYW1lKHNlbGYpOgogICAgICAgIHJldHVybiAnJXMuU2VydmljZVJlc291cmNlJyAlIHNlbGYuX3NlcnZpY2VfZG9jc19uYW1lCgogICAgZGVmIF9hZGRfdGl0bGUoc2VsZiwgc2VjdGlvbik6CiAgICAgICAgc2VjdGlvbi5zdHlsZS5oMignU2VydmljZSBSZXNvdXJjZScpCgogICAgZGVmIF9hZGRfZGVzY3JpcHRpb24oc2VsZiwgc2VjdGlvbik6CiAgICAgICAgb2ZmaWNpYWxfc2VydmljZV9uYW1lID0gZ2V0X29mZmljaWFsX3NlcnZpY2VfbmFtZSgKICAgICAgICAgICAgc2VsZi5fc2VydmljZV9tb2RlbCkKICAgICAgICBzZWN0aW9uLndyaXRlKAogICAgICAgICAgICAnQSByZXNvdXJjZSByZXByZXNlbnRpbmcgJXMnICUgb2ZmaWNpYWxfc2VydmljZV9uYW1lKQoKICAgIGRlZiBfYWRkX2V4YW1wbGUoc2VsZiwgc2VjdGlvbiwgaWRlbnRpZmllcl9uYW1lcyk6CiAgICAgICAgc2VjdGlvbi5zdHlsZS5zdGFydF9jb2RlYmxvY2soKQogICAgICAgIHNlY3Rpb24uc3R5bGUubmV3X2xpbmUoKQogICAgICAgIHNlY3Rpb24ud3JpdGUoJ2ltcG9ydCBib3RvMycpCiAgICAgICAgc2VjdGlvbi5zdHlsZS5uZXdfbGluZSgpCiAgICAgICAgc2VjdGlvbi5zdHlsZS5uZXdfbGluZSgpCiAgICAgICAgc2VjdGlvbi53cml0ZSgKICAgICAgICAgICAgJyVzID0gYm90bzMucmVzb3VyY2UoXCclc1wnKScgJSAoCiAgICAgICAgICAgICAgICBzZWxmLl9zZXJ2aWNlX25hbWUsIHNlbGYuX3NlcnZpY2VfbmFtZSkpCiAgICAgICAgc2VjdGlvbi5zdHlsZS5lbmRfY29kZWJsb2NrKCkK
