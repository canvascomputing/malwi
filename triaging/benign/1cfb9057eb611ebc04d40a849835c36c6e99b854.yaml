statistics:
  total_files: 1
  skipped_files: 0.0
  processed_objects: 1
  malicious_objects: 0
details:
- path: .repo_cache/malicious_repos/pypi_malregistry/python-aliyun-sdk-core/2.13.36/python-aliyun-sdk-core-2.13.36/python-aliyun-sdk-core-2.13.36/aliyunsdkcore/vendored/requests/packages/urllib3/util/timeout.py
  contents:
  - name: Timeout.read_timeout
    score: 0.0
    code: |-
      @property
          def read_timeout(self):
              """ Get the value for the read timeout.

              This assumes some time has elapsed in the connection timeout and
              computes the read timeout appropriately.

              If self.total is set, the read timeout is dependent on the amount of
              time taken by the connect timeout. If the connection time has not been
              established, a :exc:`~urllib3.exceptions.TimeoutStateError` will be
              raised.

              :return: Value to use for the read timeout.
              :rtype: int, float, :attr:`Timeout.DEFAULT_TIMEOUT` or None
              :raises urllib3.exceptions.TimeoutStateError: If :meth:`start_connect`
                  has not yet been called on this object.
              """
              if (self.total is not None and
                      self.total is not self.DEFAULT_TIMEOUT and
                      self._read is not None and
                      self._read is not self.DEFAULT_TIMEOUT):
                  # In case the connect timeout has not yet been established.
                  if self._start_connect is None:
                      return self._read
                  return max(0, min(self.total - self.get_connect_duration(),
                                    self._read))
              elif self.total is not None and self.total is not self.DEFAULT_TIMEOUT:
                  return max(0, self.total - self.get_connect_duration())
              else:
                  return self._read
    tokens: resume load_fast self load_attr total pop_jump_if_none TO_NUMBER load_fast self load_attr total load_fast self load_attr DEFAULT_TIMEOUT is_op pop_jump_if_false TO_NUMBER load_fast self load_attr _read pop_jump_if_none TO_NUMBER load_fast self load_attr _read load_fast self load_attr DEFAULT_TIMEOUT is_op pop_jump_if_false TO_NUMBER load_fast self load_attr _start_connect pop_jump_if_not_none TO_NUMBER load_fast self load_attr _read return_value load_global max load_const INTEGER load_global min load_fast self load_attr total load_fast self load_attr STRING_LEN_S_ENT_HIGH call binary_op - load_fast self load_attr _read call call return_value load_fast self load_attr total pop_jump_if_none TO_NUMBER load_fast self load_attr total load_fast self load_attr DEFAULT_TIMEOUT is_op pop_jump_if_false TO_NUMBER load_global max load_const INTEGER load_fast self load_attr total load_fast self load_attr STRING_LEN_S_ENT_HIGH call binary_op - call return_value load_fast self load_attr _read return_value
    hash: 8a563837a9f2587887947d7d6c4b070e579e9e0815c766389cf26a66ccb4a43b
sources:
  ? .repo_cache/malicious_repos/pypi_malregistry/python-aliyun-sdk-core/2.13.36/python-aliyun-sdk-core-2.13.36/python-aliyun-sdk-core-2.13.36/aliyunsdkcore/vendored/requests/packages/urllib3/util/timeout.py
  : ZnJvbSBfX2Z1dHVyZV9fIGltcG9ydCBhYnNvbHV0ZV9pbXBvcnQKIyBUaGUgZGVmYXVsdCBzb2NrZXQgdGltZW91dCwgdXNlZCBieSBodHRwbGliIHRvIGluZGljYXRlIHRoYXQgbm8gdGltZW91dCB3YXMKIyBzcGVjaWZpZWQgYnkgdGhlIHVzZXIKZnJvbSBzb2NrZXQgaW1wb3J0IF9HTE9CQUxfREVGQVVMVF9USU1FT1VUCmltcG9ydCB0aW1lCgpmcm9tIC4uZXhjZXB0aW9ucyBpbXBvcnQgVGltZW91dFN0YXRlRXJyb3IKCiMgQSBzZW50aW5lbCB2YWx1ZSB0byBpbmRpY2F0ZSB0aGF0IG5vIHRpbWVvdXQgd2FzIHNwZWNpZmllZCBieSB0aGUgdXNlciBpbgojIHVybGxpYjMKX0RlZmF1bHQgPSBvYmplY3QoKQoKCiMgVXNlIHRpbWUubW9ub3RvbmljIGlmIGF2YWlsYWJsZS4KY3VycmVudF90aW1lID0gZ2V0YXR0cih0aW1lLCAibW9ub3RvbmljIiwgdGltZS50aW1lKQoKCmNsYXNzIFRpbWVvdXQob2JqZWN0KToKICAgICIiIiBUaW1lb3V0IGNvbmZpZ3VyYXRpb24uCgogICAgVGltZW91dHMgY2FuIGJlIGRlZmluZWQgYXMgYSBkZWZhdWx0IGZvciBhIHBvb2w6OgoKICAgICAgICB0aW1lb3V0ID0gVGltZW91dChjb25uZWN0PTIuMCwgcmVhZD03LjApCiAgICAgICAgaHR0cCA9IFBvb2xNYW5hZ2VyKHRpbWVvdXQ9dGltZW91dCkKICAgICAgICByZXNwb25zZSA9IGh0dHAucmVxdWVzdCgnR0VUJywgJ2h0dHA6Ly9leGFtcGxlLmNvbS8nKQoKICAgIE9yIHBlci1yZXF1ZXN0ICh3aGljaCBvdmVycmlkZXMgdGhlIGRlZmF1bHQgZm9yIHRoZSBwb29sKTo6CgogICAgICAgIHJlc3BvbnNlID0gaHR0cC5yZXF1ZXN0KCdHRVQnLCAnaHR0cDovL2V4YW1wbGUuY29tLycsIHRpbWVvdXQ9VGltZW91dCgxMCkpCgogICAgVGltZW91dHMgY2FuIGJlIGRpc2FibGVkIGJ5IHNldHRpbmcgYWxsIHRoZSBwYXJhbWV0ZXJzIHRvIGBgTm9uZWBgOjoKCiAgICAgICAgbm9fdGltZW91dCA9IFRpbWVvdXQoY29ubmVjdD1Ob25lLCByZWFkPU5vbmUpCiAgICAgICAgcmVzcG9uc2UgPSBodHRwLnJlcXVlc3QoJ0dFVCcsICdodHRwOi8vZXhhbXBsZS5jb20vLCB0aW1lb3V0PW5vX3RpbWVvdXQpCgoKICAgIDpwYXJhbSB0b3RhbDoKICAgICAgICBUaGlzIGNvbWJpbmVzIHRoZSBjb25uZWN0IGFuZCByZWFkIHRpbWVvdXRzIGludG8gb25lOyB0aGUgcmVhZCB0aW1lb3V0CiAgICAgICAgd2lsbCBiZSBzZXQgdG8gdGhlIHRpbWUgbGVmdG92ZXIgZnJvbSB0aGUgY29ubmVjdCBhdHRlbXB0LiBJbiB0aGUKICAgICAgICBldmVudCB0aGF0IGJvdGggYSBjb25uZWN0IHRpbWVvdXQgYW5kIGEgdG90YWwgYXJlIHNwZWNpZmllZCwgb3IgYSByZWFkCiAgICAgICAgdGltZW91dCBhbmQgYSB0b3RhbCBhcmUgc3BlY2lmaWVkLCB0aGUgc2hvcnRlciB0aW1lb3V0IHdpbGwgYmUgYXBwbGllZC4KCiAgICAgICAgRGVmYXVsdHMgdG8gTm9uZS4KCiAgICA6dHlwZSB0b3RhbDogaW50ZWdlciwgZmxvYXQsIG9yIE5vbmUKCiAgICA6cGFyYW0gY29ubmVjdDoKICAgICAgICBUaGUgbWF4aW11bSBhbW91bnQgb2YgdGltZSB0byB3YWl0IGZvciBhIGNvbm5lY3Rpb24gYXR0ZW1wdCB0byBhIHNlcnZlcgogICAgICAgIHRvIHN1Y2NlZWQuIE9taXR0aW5nIHRoZSBwYXJhbWV0ZXIgd2lsbCBkZWZhdWx0IHRoZSBjb25uZWN0IHRpbWVvdXQgdG8KICAgICAgICB0aGUgc3lzdGVtIGRlZmF1bHQsIHByb2JhYmx5IGB0aGUgZ2xvYmFsIGRlZmF1bHQgdGltZW91dCBpbiBzb2NrZXQucHkKICAgICAgICA8aHR0cDovL2hnLnB5dGhvbi5vcmcvY3B5dGhvbi9maWxlLzYwM2I0ZDU5Mzc1OC9MaWIvc29ja2V0LnB5I2w1MzU+YF8uCiAgICAgICAgTm9uZSB3aWxsIHNldCBhbiBpbmZpbml0ZSB0aW1lb3V0IGZvciBjb25uZWN0aW9uIGF0dGVtcHRzLgoKICAgIDp0eXBlIGNvbm5lY3Q6IGludGVnZXIsIGZsb2F0LCBvciBOb25lCgogICAgOnBhcmFtIHJlYWQ6CiAgICAgICAgVGhlIG1heGltdW0gYW1vdW50IG9mIHRpbWUgdG8gd2FpdCBiZXR3ZWVuIGNvbnNlY3V0aXZlCiAgICAgICAgcmVhZCBvcGVyYXRpb25zIGZvciBhIHJlc3BvbnNlIGZyb20gdGhlIHNlcnZlci4gT21pdHRpbmcKICAgICAgICB0aGUgcGFyYW1ldGVyIHdpbGwgZGVmYXVsdCB0aGUgcmVhZCB0aW1lb3V0IHRvIHRoZSBzeXN0ZW0KICAgICAgICBkZWZhdWx0LCBwcm9iYWJseSBgdGhlIGdsb2JhbCBkZWZhdWx0IHRpbWVvdXQgaW4gc29ja2V0LnB5CiAgICAgICAgPGh0dHA6Ly9oZy5weXRob24ub3JnL2NweXRob24vZmlsZS82MDNiNGQ1OTM3NTgvTGliL3NvY2tldC5weSNsNTM1PmBfLgogICAgICAgIE5vbmUgd2lsbCBzZXQgYW4gaW5maW5pdGUgdGltZW91dC4KCiAgICA6dHlwZSByZWFkOiBpbnRlZ2VyLCBmbG9hdCwgb3IgTm9uZQoKICAgIC4uIG5vdGU6OgoKICAgICAgICBNYW55IGZhY3RvcnMgY2FuIGFmZmVjdCB0aGUgdG90YWwgYW1vdW50IG9mIHRpbWUgZm9yIHVybGxpYjMgdG8gcmV0dXJuCiAgICAgICAgYW4gSFRUUCByZXNwb25zZS4KCiAgICAgICAgRm9yIGV4YW1wbGUsIFB5dGhvbidzIEROUyByZXNvbHZlciBkb2VzIG5vdCBvYmV5IHRoZSB0aW1lb3V0IHNwZWNpZmllZAogICAgICAgIG9uIHRoZSBzb2NrZXQuIE90aGVyIGZhY3RvcnMgdGhhdCBjYW4gYWZmZWN0IHRvdGFsIHJlcXVlc3QgdGltZSBpbmNsdWRlCiAgICAgICAgaGlnaCBDUFUgbG9hZCwgaGlnaCBzd2FwLCB0aGUgcHJvZ3JhbSBydW5uaW5nIGF0IGEgbG93IHByaW9yaXR5IGxldmVsLAogICAgICAgIG9yIG90aGVyIGJlaGF2aW9ycy4KCiAgICAgICAgSW4gYWRkaXRpb24sIHRoZSByZWFkIGFuZCB0b3RhbCB0aW1lb3V0cyBvbmx5IG1lYXN1cmUgdGhlIHRpbWUgYmV0d2VlbgogICAgICAgIHJlYWQgb3BlcmF0aW9ucyBvbiB0aGUgc29ja2V0IGNvbm5lY3RpbmcgdGhlIGNsaWVudCBhbmQgdGhlIHNlcnZlciwKICAgICAgICBub3QgdGhlIHRvdGFsIGFtb3VudCBvZiB0aW1lIGZvciB0aGUgcmVxdWVzdCB0byByZXR1cm4gYSBjb21wbGV0ZQogICAgICAgIHJlc3BvbnNlLiBGb3IgbW9zdCByZXF1ZXN0cywgdGhlIHRpbWVvdXQgaXMgcmFpc2VkIGJlY2F1c2UgdGhlIHNlcnZlcgogICAgICAgIGhhcyBub3Qgc2VudCB0aGUgZmlyc3QgYnl0ZSBpbiB0aGUgc3BlY2lmaWVkIHRpbWUuIFRoaXMgaXMgbm90IGFsd2F5cwogICAgICAgIHRoZSBjYXNlOyBpZiBhIHNlcnZlciBzdHJlYW1zIG9uZSBieXRlIGV2ZXJ5IGZpZnRlZW4gc2Vjb25kcywgYSB0aW1lb3V0CiAgICAgICAgb2YgMjAgc2Vjb25kcyB3aWxsIG5vdCB0cmlnZ2VyLCBldmVuIHRob3VnaCB0aGUgcmVxdWVzdCB3aWxsIHRha2UKICAgICAgICBzZXZlcmFsIG1pbnV0ZXMgdG8gY29tcGxldGUuCgogICAgICAgIElmIHlvdXIgZ29hbCBpcyB0byBjdXQgb2ZmIGFueSByZXF1ZXN0IGFmdGVyIGEgc2V0IGFtb3VudCBvZiB3YWxsIGNsb2NrCiAgICAgICAgdGltZSwgY29uc2lkZXIgaGF2aW5nIGEgc2Vjb25kICJ3YXRjaGVyIiB0aHJlYWQgdG8gY3V0IG9mZiBhIHNsb3cKICAgICAgICByZXF1ZXN0LgogICAgIiIiCgogICAgIzogQSBzZW50aW5lbCBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSBkZWZhdWx0IHRpbWVvdXQgdmFsdWUKICAgIERFRkFVTFRfVElNRU9VVCA9IF9HTE9CQUxfREVGQVVMVF9USU1FT1VUCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHRvdGFsPU5vbmUsIGNvbm5lY3Q9X0RlZmF1bHQsIHJlYWQ9X0RlZmF1bHQpOgogICAgICAgIHNlbGYuX2Nvbm5lY3QgPSBzZWxmLl92YWxpZGF0ZV90aW1lb3V0KGNvbm5lY3QsICdjb25uZWN0JykKICAgICAgICBzZWxmLl9yZWFkID0gc2VsZi5fdmFsaWRhdGVfdGltZW91dChyZWFkLCAncmVhZCcpCiAgICAgICAgc2VsZi50b3RhbCA9IHNlbGYuX3ZhbGlkYXRlX3RpbWVvdXQodG90YWwsICd0b3RhbCcpCiAgICAgICAgc2VsZi5fc3RhcnRfY29ubmVjdCA9IE5vbmUKCiAgICBkZWYgX19zdHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gJyVzKGNvbm5lY3Q9JXIsIHJlYWQ9JXIsIHRvdGFsPSVyKScgJSAoCiAgICAgICAgICAgIHR5cGUoc2VsZikuX19uYW1lX18sIHNlbGYuX2Nvbm5lY3QsIHNlbGYuX3JlYWQsIHNlbGYudG90YWwpCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgX3ZhbGlkYXRlX3RpbWVvdXQoY2xzLCB2YWx1ZSwgbmFtZSk6CiAgICAgICAgIiIiIENoZWNrIHRoYXQgYSB0aW1lb3V0IGF0dHJpYnV0ZSBpcyB2YWxpZC4KCiAgICAgICAgOnBhcmFtIHZhbHVlOiBUaGUgdGltZW91dCB2YWx1ZSB0byB2YWxpZGF0ZQogICAgICAgIDpwYXJhbSBuYW1lOiBUaGUgbmFtZSBvZiB0aGUgdGltZW91dCBhdHRyaWJ1dGUgdG8gdmFsaWRhdGUuIFRoaXMgaXMKICAgICAgICAgICAgdXNlZCB0byBzcGVjaWZ5IGluIGVycm9yIG1lc3NhZ2VzLgogICAgICAgIDpyZXR1cm46IFRoZSB2YWxpZGF0ZWQgYW5kIGNhc3RlZCB2ZXJzaW9uIG9mIHRoZSBnaXZlbiB2YWx1ZS4KICAgICAgICA6cmFpc2VzIFZhbHVlRXJyb3I6IElmIGl0IGlzIGEgbnVtZXJpYyB2YWx1ZSBsZXNzIHRoYW4gb3IgZXF1YWwgdG8KICAgICAgICAgICAgemVybywgb3IgdGhlIHR5cGUgaXMgbm90IGFuIGludGVnZXIsIGZsb2F0LCBvciBOb25lLgogICAgICAgICIiIgogICAgICAgIGlmIHZhbHVlIGlzIF9EZWZhdWx0OgogICAgICAgICAgICByZXR1cm4gY2xzLkRFRkFVTFRfVElNRU9VVAoKICAgICAgICBpZiB2YWx1ZSBpcyBOb25lIG9yIHZhbHVlIGlzIGNscy5ERUZBVUxUX1RJTUVPVVQ6CiAgICAgICAgICAgIHJldHVybiB2YWx1ZQoKICAgICAgICBpZiBpc2luc3RhbmNlKHZhbHVlLCBib29sKToKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiVGltZW91dCBjYW5ub3QgYmUgYSBib29sZWFuIHZhbHVlLiBJdCBtdXN0ICIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiYmUgYW4gaW50LCBmbG9hdCBvciBOb25lLiIpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBmbG9hdCh2YWx1ZSkKICAgICAgICBleGNlcHQgKFR5cGVFcnJvciwgVmFsdWVFcnJvcik6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIlRpbWVvdXQgdmFsdWUgJXMgd2FzICVzLCBidXQgaXQgbXVzdCBiZSBhbiAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImludCwgZmxvYXQgb3IgTm9uZS4iICUgKG5hbWUsIHZhbHVlKSkKCiAgICAgICAgdHJ5OgogICAgICAgICAgICBpZiB2YWx1ZSA8PSAwOgogICAgICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiQXR0ZW1wdGVkIHRvIHNldCAlcyB0aW1lb3V0IHRvICVzLCBidXQgdGhlICIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInRpbWVvdXQgY2Fubm90IGJlIHNldCB0byBhIHZhbHVlIGxlc3MgIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidGhhbiBvciBlcXVhbCB0byAwLiIgJSAobmFtZSwgdmFsdWUpKQogICAgICAgIGV4Y2VwdCBUeXBlRXJyb3I6ICAjIFB5dGhvbiAzCiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIlRpbWVvdXQgdmFsdWUgJXMgd2FzICVzLCBidXQgaXQgbXVzdCBiZSBhbiAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImludCwgZmxvYXQgb3IgTm9uZS4iICUgKG5hbWUsIHZhbHVlKSkKCiAgICAgICAgcmV0dXJuIHZhbHVlCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgZnJvbV9mbG9hdChjbHMsIHRpbWVvdXQpOgogICAgICAgICIiIiBDcmVhdGUgYSBuZXcgVGltZW91dCBmcm9tIGEgbGVnYWN5IHRpbWVvdXQgdmFsdWUuCgogICAgICAgIFRoZSB0aW1lb3V0IHZhbHVlIHVzZWQgYnkgaHR0cGxpYi5weSBzZXRzIHRoZSBzYW1lIHRpbWVvdXQgb24gdGhlCiAgICAgICAgY29ubmVjdCgpLCBhbmQgcmVjdigpIHNvY2tldCByZXF1ZXN0cy4gVGhpcyBjcmVhdGVzIGEgOmNsYXNzOmBUaW1lb3V0YAogICAgICAgIG9iamVjdCB0aGF0IHNldHMgdGhlIGluZGl2aWR1YWwgdGltZW91dHMgdG8gdGhlIGBgdGltZW91dGBgIHZhbHVlCiAgICAgICAgcGFzc2VkIHRvIHRoaXMgZnVuY3Rpb24uCgogICAgICAgIDpwYXJhbSB0aW1lb3V0OiBUaGUgbGVnYWN5IHRpbWVvdXQgdmFsdWUuCiAgICAgICAgOnR5cGUgdGltZW91dDogaW50ZWdlciwgZmxvYXQsIHNlbnRpbmVsIGRlZmF1bHQgb2JqZWN0LCBvciBOb25lCiAgICAgICAgOnJldHVybjogVGltZW91dCBvYmplY3QKICAgICAgICA6cnR5cGU6IDpjbGFzczpgVGltZW91dGAKICAgICAgICAiIiIKICAgICAgICByZXR1cm4gVGltZW91dChyZWFkPXRpbWVvdXQsIGNvbm5lY3Q9dGltZW91dCkKCiAgICBkZWYgY2xvbmUoc2VsZik6CiAgICAgICAgIiIiIENyZWF0ZSBhIGNvcHkgb2YgdGhlIHRpbWVvdXQgb2JqZWN0CgogICAgICAgIFRpbWVvdXQgcHJvcGVydGllcyBhcmUgc3RvcmVkIHBlci1wb29sIGJ1dCBlYWNoIHJlcXVlc3QgbmVlZHMgYSBmcmVzaAogICAgICAgIFRpbWVvdXQgb2JqZWN0IHRvIGVuc3VyZSBlYWNoIG9uZSBoYXMgaXRzIG93biBzdGFydC9zdG9wIGNvbmZpZ3VyZWQuCgogICAgICAgIDpyZXR1cm46IGEgY29weSBvZiB0aGUgdGltZW91dCBvYmplY3QKICAgICAgICA6cnR5cGU6IDpjbGFzczpgVGltZW91dGAKICAgICAgICAiIiIKICAgICAgICAjIFdlIGNhbid0IHVzZSBjb3B5LmRlZXBjb3B5IGJlY2F1c2UgdGhhdCB3aWxsIGFsc28gY3JlYXRlIGEgbmV3IG9iamVjdAogICAgICAgICMgZm9yIF9HTE9CQUxfREVGQVVMVF9USU1FT1VULCB3aGljaCBzb2NrZXQucHkgdXNlcyBhcyBhIHNlbnRpbmVsIHRvCiAgICAgICAgIyBkZXRlY3QgdGhlIHVzZXIgZGVmYXVsdC4KICAgICAgICByZXR1cm4gVGltZW91dChjb25uZWN0PXNlbGYuX2Nvbm5lY3QsIHJlYWQ9c2VsZi5fcmVhZCwKICAgICAgICAgICAgICAgICAgICAgICB0b3RhbD1zZWxmLnRvdGFsKQoKICAgIGRlZiBzdGFydF9jb25uZWN0KHNlbGYpOgogICAgICAgICIiIiBTdGFydCB0aGUgdGltZW91dCBjbG9jaywgdXNlZCBkdXJpbmcgYSBjb25uZWN0KCkgYXR0ZW1wdAoKICAgICAgICA6cmFpc2VzIHVybGxpYjMuZXhjZXB0aW9ucy5UaW1lb3V0U3RhdGVFcnJvcjogaWYgeW91IGF0dGVtcHQKICAgICAgICAgICAgdG8gc3RhcnQgYSB0aW1lciB0aGF0IGhhcyBiZWVuIHN0YXJ0ZWQgYWxyZWFkeS4KICAgICAgICAiIiIKICAgICAgICBpZiBzZWxmLl9zdGFydF9jb25uZWN0IGlzIG5vdCBOb25lOgogICAgICAgICAgICByYWlzZSBUaW1lb3V0U3RhdGVFcnJvcigiVGltZW91dCB0aW1lciBoYXMgYWxyZWFkeSBiZWVuIHN0YXJ0ZWQuIikKICAgICAgICBzZWxmLl9zdGFydF9jb25uZWN0ID0gY3VycmVudF90aW1lKCkKICAgICAgICByZXR1cm4gc2VsZi5fc3RhcnRfY29ubmVjdAoKICAgIGRlZiBnZXRfY29ubmVjdF9kdXJhdGlvbihzZWxmKToKICAgICAgICAiIiIgR2V0cyB0aGUgdGltZSBlbGFwc2VkIHNpbmNlIHRoZSBjYWxsIHRvIDptZXRoOmBzdGFydF9jb25uZWN0YC4KCiAgICAgICAgOnJldHVybjogRWxhcHNlZCB0aW1lLgogICAgICAgIDpydHlwZTogZmxvYXQKICAgICAgICA6cmFpc2VzIHVybGxpYjMuZXhjZXB0aW9ucy5UaW1lb3V0U3RhdGVFcnJvcjogaWYgeW91IGF0dGVtcHQKICAgICAgICAgICAgdG8gZ2V0IGR1cmF0aW9uIGZvciBhIHRpbWVyIHRoYXQgaGFzbid0IGJlZW4gc3RhcnRlZC4KICAgICAgICAiIiIKICAgICAgICBpZiBzZWxmLl9zdGFydF9jb25uZWN0IGlzIE5vbmU6CiAgICAgICAgICAgIHJhaXNlIFRpbWVvdXRTdGF0ZUVycm9yKCJDYW4ndCBnZXQgY29ubmVjdCBkdXJhdGlvbiBmb3IgdGltZXIgIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidGhhdCBoYXMgbm90IHN0YXJ0ZWQuIikKICAgICAgICByZXR1cm4gY3VycmVudF90aW1lKCkgLSBzZWxmLl9zdGFydF9jb25uZWN0CgogICAgQHByb3BlcnR5CiAgICBkZWYgY29ubmVjdF90aW1lb3V0KHNlbGYpOgogICAgICAgICIiIiBHZXQgdGhlIHZhbHVlIHRvIHVzZSB3aGVuIHNldHRpbmcgYSBjb25uZWN0aW9uIHRpbWVvdXQuCgogICAgICAgIFRoaXMgd2lsbCBiZSBhIHBvc2l0aXZlIGZsb2F0IG9yIGludGVnZXIsIHRoZSB2YWx1ZSBOb25lCiAgICAgICAgKG5ldmVyIHRpbWVvdXQpLCBvciB0aGUgZGVmYXVsdCBzeXN0ZW0gdGltZW91dC4KCiAgICAgICAgOnJldHVybjogQ29ubmVjdCB0aW1lb3V0LgogICAgICAgIDpydHlwZTogaW50LCBmbG9hdCwgOmF0dHI6YFRpbWVvdXQuREVGQVVMVF9USU1FT1VUYCBvciBOb25lCiAgICAgICAgIiIiCiAgICAgICAgaWYgc2VsZi50b3RhbCBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gc2VsZi5fY29ubmVjdAoKICAgICAgICBpZiBzZWxmLl9jb25uZWN0IGlzIE5vbmUgb3Igc2VsZi5fY29ubmVjdCBpcyBzZWxmLkRFRkFVTFRfVElNRU9VVDoKICAgICAgICAgICAgcmV0dXJuIHNlbGYudG90YWwKCiAgICAgICAgcmV0dXJuIG1pbihzZWxmLl9jb25uZWN0LCBzZWxmLnRvdGFsKQoKICAgIEBwcm9wZXJ0eQogICAgZGVmIHJlYWRfdGltZW91dChzZWxmKToKICAgICAgICAiIiIgR2V0IHRoZSB2YWx1ZSBmb3IgdGhlIHJlYWQgdGltZW91dC4KCiAgICAgICAgVGhpcyBhc3N1bWVzIHNvbWUgdGltZSBoYXMgZWxhcHNlZCBpbiB0aGUgY29ubmVjdGlvbiB0aW1lb3V0IGFuZAogICAgICAgIGNvbXB1dGVzIHRoZSByZWFkIHRpbWVvdXQgYXBwcm9wcmlhdGVseS4KCiAgICAgICAgSWYgc2VsZi50b3RhbCBpcyBzZXQsIHRoZSByZWFkIHRpbWVvdXQgaXMgZGVwZW5kZW50IG9uIHRoZSBhbW91bnQgb2YKICAgICAgICB0aW1lIHRha2VuIGJ5IHRoZSBjb25uZWN0IHRpbWVvdXQuIElmIHRoZSBjb25uZWN0aW9uIHRpbWUgaGFzIG5vdCBiZWVuCiAgICAgICAgZXN0YWJsaXNoZWQsIGEgOmV4YzpgfnVybGxpYjMuZXhjZXB0aW9ucy5UaW1lb3V0U3RhdGVFcnJvcmAgd2lsbCBiZQogICAgICAgIHJhaXNlZC4KCiAgICAgICAgOnJldHVybjogVmFsdWUgdG8gdXNlIGZvciB0aGUgcmVhZCB0aW1lb3V0LgogICAgICAgIDpydHlwZTogaW50LCBmbG9hdCwgOmF0dHI6YFRpbWVvdXQuREVGQVVMVF9USU1FT1VUYCBvciBOb25lCiAgICAgICAgOnJhaXNlcyB1cmxsaWIzLmV4Y2VwdGlvbnMuVGltZW91dFN0YXRlRXJyb3I6IElmIDptZXRoOmBzdGFydF9jb25uZWN0YAogICAgICAgICAgICBoYXMgbm90IHlldCBiZWVuIGNhbGxlZCBvbiB0aGlzIG9iamVjdC4KICAgICAgICAiIiIKICAgICAgICBpZiAoc2VsZi50b3RhbCBpcyBub3QgTm9uZSBhbmQKICAgICAgICAgICAgICAgIHNlbGYudG90YWwgaXMgbm90IHNlbGYuREVGQVVMVF9USU1FT1VUIGFuZAogICAgICAgICAgICAgICAgc2VsZi5fcmVhZCBpcyBub3QgTm9uZSBhbmQKICAgICAgICAgICAgICAgIHNlbGYuX3JlYWQgaXMgbm90IHNlbGYuREVGQVVMVF9USU1FT1VUKToKICAgICAgICAgICAgIyBJbiBjYXNlIHRoZSBjb25uZWN0IHRpbWVvdXQgaGFzIG5vdCB5ZXQgYmVlbiBlc3RhYmxpc2hlZC4KICAgICAgICAgICAgaWYgc2VsZi5fc3RhcnRfY29ubmVjdCBpcyBOb25lOgogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuX3JlYWQKICAgICAgICAgICAgcmV0dXJuIG1heCgwLCBtaW4oc2VsZi50b3RhbCAtIHNlbGYuZ2V0X2Nvbm5lY3RfZHVyYXRpb24oKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fcmVhZCkpCiAgICAgICAgZWxpZiBzZWxmLnRvdGFsIGlzIG5vdCBOb25lIGFuZCBzZWxmLnRvdGFsIGlzIG5vdCBzZWxmLkRFRkFVTFRfVElNRU9VVDoKICAgICAgICAgICAgcmV0dXJuIG1heCgwLCBzZWxmLnRvdGFsIC0gc2VsZi5nZXRfY29ubmVjdF9kdXJhdGlvbigpKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9yZWFkCg==
