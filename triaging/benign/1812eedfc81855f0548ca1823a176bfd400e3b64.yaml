statistics:
  total_files: 1
  skipped_files: 0.0
  processed_objects: 1
  malicious_objects: 0
details:
- path: .repo_cache/malicious_repos/pypi_malregistry/pycryptoenv/1.0.7/pycryptoenv-1.0.7/pycryptoenv-1.0.7/pycryptoenv/_ffi.py
  contents:
  - name: 'null'
    score: null
    code: |-
      def null():
              return ffi.NULL
    tokens: resume load_global ffi load_attr NULL return_value
    hash: e18eba3264d40fc59f76221cbeceafaceae34557983508025722d5e2f1573206
sources:
  .repo_cache/malicious_repos/pypi_malregistry/pycryptoenv/1.0.7/pycryptoenv-1.0.7/pycryptoenv-1.0.7/pycryptoenv/_ffi.py: IyBjb2Rpbmc6IHV0Zi04CgoiIiIKRXhjZXB0aW9ucyBhbmQgY29tcGF0aWJpbGl0eSBzaGltcyBmb3IgY29uc2lzdGVudGx5IHVzaW5nIGN0eXBlcyBhbmQgY2ZmaQoiIiIKCmZyb20gX19mdXR1cmVfXyBpbXBvcnQgdW5pY29kZV9saXRlcmFscywgZGl2aXNpb24sIGFic29sdXRlX2ltcG9ydCwgcHJpbnRfZnVuY3Rpb24KCmltcG9ydCBzeXMKaW1wb3J0IHBsYXRmb3JtCgpmcm9tIGN0eXBlcy51dGlsIGltcG9ydCBmaW5kX2xpYnJhcnkKCmZyb20gLiBpbXBvcnQgZmZpCmZyb20gLl90eXBlcyBpbXBvcnQgc3RyX2NscywgYnl0ZV9jbHMsIGludF90eXBlcywgYnl0ZXNfdG9fbGlzdAoKCl9fYWxsX18gPSBbCiAgICAnYXJyYXlfZnJvbV9wb2ludGVyJywKICAgICdhcnJheV9zZXQnLAogICAgJ2J1ZmZlcl9mcm9tX2J5dGVzJywKICAgICdidWZmZXJfZnJvbV91bmljb2RlJywKICAgICdidWZmZXJfcG9pbnRlcicsCiAgICAnYnl0ZV9hcnJheScsCiAgICAnYnl0ZV9zdHJpbmdfZnJvbV9idWZmZXInLAogICAgJ2J5dGVzX2Zyb21fYnVmZmVyJywKICAgICdjYWxsYmFjaycsCiAgICAnY2FzdCcsCiAgICAnZGVyZWYnLAogICAgJ2Vycm5vJywKICAgICdGRklFbmdpbmVFcnJvcicsCiAgICAnZ2V0X2xpYnJhcnknLAogICAgJ2lzX251bGwnLAogICAgJ25hdGl2ZScsCiAgICAnbmV3JywKICAgICdudWxsJywKICAgICdwb2ludGVyX3NldCcsCiAgICAncmVmJywKICAgICdyZWdpc3Rlcl9mZmknLAogICAgJ3NpemVvZicsCiAgICAnc3RydWN0JywKICAgICdzdHJ1Y3RfYnl0ZXMnLAogICAgJ3N0cnVjdF9mcm9tX2J1ZmZlcicsCiAgICAndW53cmFwJywKICAgICd3cml0ZV90b19idWZmZXInLApdCgoKaWYgZmZpKCkgPT0gJ2NmZmknOgogICAgZnJvbSBjZmZpIGltcG9ydCBGRkkKCiAgICBfZmZpX3JlZ2lzdHJ5ID0ge30KCiAgICBmZmkgPSBGRkkoKQoKICAgIGRlZiByZWdpc3Rlcl9mZmkobGlicmFyeSwgZmZpX29iaik6CiAgICAgICAgX2ZmaV9yZWdpc3RyeVtsaWJyYXJ5XSA9IGZmaV9vYmoKCiAgICBkZWYgX2dldF9mZmkobGlicmFyeSk6CiAgICAgICAgaWYgbGlicmFyeSBpbiBfZmZpX3JlZ2lzdHJ5OgogICAgICAgICAgICByZXR1cm4gX2ZmaV9yZWdpc3RyeVtsaWJyYXJ5XQogICAgICAgIHJldHVybiBmZmkKCiAgICBkZWYgYnVmZmVyX2Zyb21fYnl0ZXMoaW5pdGlhbGl6ZXIpOgogICAgICAgIGlmIHN5cy5wbGF0Zm9ybSA9PSAnd2luMzInOgogICAgICAgICAgICByZXR1cm4gZmZpLm5ldygndW5zaWduZWQgY2hhcltdJywgaW5pdGlhbGl6ZXIpCiAgICAgICAgcmV0dXJuIGZmaS5uZXcoJ2NoYXJbXScsIGluaXRpYWxpemVyKQoKICAgIGRlZiBidWZmZXJfZnJvbV91bmljb2RlKGluaXRpYWxpemVyKToKICAgICAgICByZXR1cm4gZmZpLm5ldygnd2NoYXJfdCBbXScsIGluaXRpYWxpemVyKQoKICAgIGRlZiB3cml0ZV90b19idWZmZXIoYnVmZmVyLCBkYXRhLCBvZmZzZXQ9MCk6CiAgICAgICAgYnVmZmVyW29mZnNldDpvZmZzZXQgKyBsZW4oZGF0YSldID0gZGF0YQoKICAgIGRlZiBidWZmZXJfcG9pbnRlcihidWZmZXIpOgogICAgICAgIHJldHVybiBmZmkubmV3KCdjaGFyICpbXScsIFtidWZmZXJdKQoKICAgIGRlZiBjYXN0KGxpYnJhcnksIHR5cGVfLCB2YWx1ZSk6CiAgICAgICAgZmZpX29iaiA9IF9nZXRfZmZpKGxpYnJhcnkpCiAgICAgICAgcmV0dXJuIGZmaV9vYmouY2FzdCh0eXBlXywgdmFsdWUpCgogICAgZGVmIHNpemVvZihsaWJyYXJ5LCB2YWx1ZSk6CiAgICAgICAgZmZpX29iaiA9IF9nZXRfZmZpKGxpYnJhcnkpCiAgICAgICAgcmV0dXJuIGZmaV9vYmouc2l6ZW9mKHZhbHVlKQoKICAgIGRlZiBieXRlc19mcm9tX2J1ZmZlcihidWZmZXIsIG1heGxlbj1Ob25lKToKICAgICAgICBpZiBtYXhsZW4gaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHJldHVybiBmZmkuYnVmZmVyKGJ1ZmZlciwgbWF4bGVuKVs6XQogICAgICAgIHJldHVybiBmZmkuYnVmZmVyKGJ1ZmZlcilbOl0KCiAgICBkZWYgYnl0ZV9zdHJpbmdfZnJvbV9idWZmZXIoYnVmZmVyKToKICAgICAgICByZXR1cm4gZmZpLnN0cmluZyhidWZmZXIpCgogICAgZGVmIGJ5dGVfYXJyYXkoYnl0ZV9zdHJpbmcpOgogICAgICAgIHJldHVybiBieXRlX3N0cmluZwoKICAgIGRlZiBwb2ludGVyX3NldChwb2ludGVyXywgdmFsdWUpOgogICAgICAgIHBvaW50ZXJfWzBdID0gdmFsdWUKCiAgICBkZWYgYXJyYXlfc2V0KGFycmF5LCB2YWx1ZSk6CiAgICAgICAgZm9yIGluZGV4LCB2YWwgaW4gZW51bWVyYXRlKHZhbHVlKToKICAgICAgICAgICAgYXJyYXlbaW5kZXhdID0gdmFsCgogICAgZGVmIG51bGwoKToKICAgICAgICByZXR1cm4gZmZpLk5VTEwKCiAgICBkZWYgaXNfbnVsbChwb2ludCk6CiAgICAgICAgaWYgcG9pbnQgaXMgTm9uZToKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICBpZiBwb2ludCA9PSBmZmkuTlVMTDoKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICBpZiBmZmkuZ2V0Y3R5cGUoZmZpLnR5cGVvZihwb2ludCkpID09ICd2b2lkIConOgogICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBkZWYgZXJybm8oKToKICAgICAgICByZXR1cm4gZmZpLmVycm5vCgogICAgZGVmIG5ldyhsaWJyYXJ5LCB0eXBlXywgdmFsdWU9Tm9uZSk6CiAgICAgICAgZmZpX29iaiA9IF9nZXRfZmZpKGxpYnJhcnkpCgogICAgICAgIHBhcmFtcyA9IFtdCiAgICAgICAgaWYgdmFsdWUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHBhcmFtcy5hcHBlbmQodmFsdWUpCiAgICAgICAgaWYgdHlwZV8gaW4gc2V0KFsnQkNSWVBUX0tFWV9IQU5ETEUnLCAnQkNSWVBUX0FMR19IQU5ETEUnXSk6CiAgICAgICAgICAgIHJldHVybiBmZmlfb2JqLmNhc3QodHlwZV8sIDApCiAgICAgICAgcmV0dXJuIGZmaV9vYmoubmV3KHR5cGVfLCAqcGFyYW1zKQoKICAgIGRlZiByZWYodmFsdWUsIG9mZnNldD0wKToKICAgICAgICByZXR1cm4gdmFsdWUgKyBvZmZzZXQKCiAgICBkZWYgbmF0aXZlKHR5cGVfLCB2YWx1ZSk6CiAgICAgICAgaWYgdHlwZV8gPT0gc3RyX2NsczoKICAgICAgICAgICAgcmV0dXJuIGZmaS5zdHJpbmcodmFsdWUpCiAgICAgICAgaWYgdHlwZV8gPT0gYnl0ZV9jbHM6CiAgICAgICAgICAgIHJldHVybiBmZmkuYnVmZmVyKHZhbHVlKVs6XQogICAgICAgIHJldHVybiB0eXBlXyh2YWx1ZSkKCiAgICBkZWYgZGVyZWYocG9pbnQpOgogICAgICAgIHJldHVybiBwb2ludFswXQoKICAgIGRlZiB1bndyYXAocG9pbnQpOgogICAgICAgIHJldHVybiBwb2ludFswXQoKICAgIGRlZiBzdHJ1Y3QobGlicmFyeSwgbmFtZSk6CiAgICAgICAgZmZpX29iaiA9IF9nZXRfZmZpKGxpYnJhcnkpCiAgICAgICAgcmV0dXJuIGZmaV9vYmoubmV3KCclcyAqJyAlIG5hbWUpCgogICAgZGVmIHN0cnVjdF9ieXRlcyhzdHJ1Y3RfKToKICAgICAgICByZXR1cm4gZmZpLmJ1ZmZlcihzdHJ1Y3RfKVs6XQoKICAgIGRlZiBzdHJ1Y3RfZnJvbV9idWZmZXIobGlicmFyeSwgbmFtZSwgYnVmZmVyKToKICAgICAgICBmZmlfb2JqID0gX2dldF9mZmkobGlicmFyeSkKICAgICAgICBuZXdfc3RydWN0X3BvaW50ZXIgPSBmZmlfb2JqLm5ldygnJXMgKicgJSBuYW1lKQogICAgICAgIG5ld19zdHJ1Y3QgPSBuZXdfc3RydWN0X3BvaW50ZXJbMF0KICAgICAgICBzdHJ1Y3Rfc2l6ZSA9IHNpemVvZihsaWJyYXJ5LCBuZXdfc3RydWN0KQogICAgICAgIHN0cnVjdF9idWZmZXIgPSBmZmlfb2JqLmJ1ZmZlcihuZXdfc3RydWN0X3BvaW50ZXIpCiAgICAgICAgc3RydWN0X2J1ZmZlcls6XSA9IGZmaV9vYmouYnVmZmVyKGJ1ZmZlciwgc3RydWN0X3NpemUpWzpdCiAgICAgICAgcmV0dXJuIG5ld19zdHJ1Y3RfcG9pbnRlcgoKICAgIGRlZiBhcnJheV9mcm9tX3BvaW50ZXIobGlicmFyeSwgbmFtZSwgcG9pbnQsIHNpemUpOgogICAgICAgIGZmaV9vYmogPSBfZ2V0X2ZmaShsaWJyYXJ5KQogICAgICAgIGFycmF5ID0gZmZpX29iai5jYXN0KCclc1slc10nICUgKG5hbWUsIHNpemUpLCBwb2ludCkKICAgICAgICB0b3RhbF9ieXRlcyA9IGZmaV9vYmouc2l6ZW9mKGFycmF5KQogICAgICAgIGlmIHRvdGFsX2J5dGVzID09IDA6CiAgICAgICAgICAgIHJldHVybiBbXQogICAgICAgIG91dHB1dCA9IFtdCgogICAgICAgIHN0cmluZ190eXBlcyA9IHsKICAgICAgICAgICAgJ0xQU1RSJzogVHJ1ZSwKICAgICAgICAgICAgJ0xQQ1NUUic6IFRydWUsCiAgICAgICAgICAgICdMUFdTVFInOiBUcnVlLAogICAgICAgICAgICAnTFBDV1NUUic6IFRydWUsCiAgICAgICAgICAgICdjaGFyIConOiBUcnVlLAogICAgICAgICAgICAnd2NoYXJfdCAqJzogVHJ1ZSwKICAgICAgICB9CiAgICAgICAgc3RyaW5nX3R5cGUgPSBuYW1lIGluIHN0cmluZ190eXBlcwoKICAgICAgICBmb3IgaSBpbiByYW5nZSgwLCBzaXplKToKICAgICAgICAgICAgdmFsdWUgPSBhcnJheVtpXQogICAgICAgICAgICBpZiBzdHJpbmdfdHlwZToKICAgICAgICAgICAgICAgIHZhbHVlID0gZmZpX29iai5zdHJpbmcodmFsdWUpCiAgICAgICAgICAgIG91dHB1dC5hcHBlbmQodmFsdWUpCiAgICAgICAgcmV0dXJuIG91dHB1dAoKICAgIGRlZiBjYWxsYmFjayhsaWJyYXJ5LCBzaWduYXR1cmVfbmFtZSwgZnVuYyk6CiAgICAgICAgZmZpX29iaiA9IF9nZXRfZmZpKGxpYnJhcnkpCiAgICAgICAgcmV0dXJuIGZmaV9vYmouY2FsbGJhY2soc2lnbmF0dXJlX25hbWUsIGZ1bmMpCgogICAgZW5naW5lID0gJ2NmZmknCgplbHNlOgoKICAgIGltcG9ydCBjdHlwZXMKICAgIGZyb20gY3R5cGVzIGltcG9ydCBwb2ludGVyLCBjX2ludCwgY19jaGFyX3AsIGNfdWludCwgY192b2lkX3AsIGNfd2NoYXJfcAoKICAgIF9wb2ludGVyX2ludF90eXBlcyA9IGludF90eXBlcyArIChjX2NoYXJfcCwgY3R5cGVzLlBPSU5URVIoY3R5cGVzLmNfYnl0ZSkpCgogICAgX3BvaW50ZXJfdHlwZXMgPSB7CiAgICAgICAgJ3ZvaWQgKic6IFRydWUsCiAgICAgICAgJ3djaGFyX3QgKic6IFRydWUsCiAgICAgICAgJ2NoYXIgKic6IFRydWUsCiAgICAgICAgJ2NoYXIgKionOiBUcnVlLAogICAgfQogICAgX3R5cGVfbWFwID0gewogICAgICAgICd2b2lkIConOiBjX3ZvaWRfcCwKICAgICAgICAnd2NoYXJfdCAqJzogY193Y2hhcl9wLAogICAgICAgICdjaGFyIConOiBjX2NoYXJfcCwKICAgICAgICAnY2hhciAqKic6IGN0eXBlcy5QT0lOVEVSKGNfY2hhcl9wKSwKICAgICAgICAnaW50JzogY19pbnQsCiAgICAgICAgJ3Vuc2lnbmVkIGludCc6IGNfdWludCwKICAgICAgICAnc2l6ZV90JzogY3R5cGVzLmNfc2l6ZV90LAogICAgICAgICd1aW50MTZfdCc6IGN0eXBlcy5jX3VpbnQxNiwKICAgICAgICAndWludDMyX3QnOiBjdHlwZXMuY191aW50MzIsCiAgICB9CiAgICBpZiBzeXMucGxhdGZvcm0gPT0gJ3dpbjMyJzoKICAgICAgICBmcm9tIGN0eXBlcyBpbXBvcnQgd2ludHlwZXMKICAgICAgICBfcG9pbnRlcl90eXBlcy51cGRhdGUoewogICAgICAgICAgICAnTFBTVFInOiBUcnVlLAogICAgICAgICAgICAnTFBXU1RSJzogVHJ1ZSwKICAgICAgICAgICAgJ0xQQ1NUUic6IFRydWUsCiAgICAgICAgICAgICdMUENXU1RSJzogVHJ1ZSwKICAgICAgICB9KQogICAgICAgIF90eXBlX21hcC51cGRhdGUoewogICAgICAgICAgICAnQllURSc6IGN0eXBlcy5jX2J5dGUsCiAgICAgICAgICAgICdMUFNUUic6IGNfY2hhcl9wLAogICAgICAgICAgICAnTFBXU1RSJzogY193Y2hhcl9wLAogICAgICAgICAgICAnTFBDU1RSJzogY19jaGFyX3AsCiAgICAgICAgICAgICdMUENXU1RSJzogY193Y2hhcl9wLAogICAgICAgICAgICAnVUxPTkcnOiB3aW50eXBlcy5VTE9ORywKICAgICAgICAgICAgJ0RXT1JEJzogd2ludHlwZXMuRFdPUkQsCiAgICAgICAgICAgICdjaGFyIConOiBjdHlwZXMuUE9JTlRFUihjdHlwZXMuY19ieXRlKSwKICAgICAgICAgICAgJ2NoYXIgKionOiBjdHlwZXMuUE9JTlRFUihjdHlwZXMuUE9JTlRFUihjdHlwZXMuY19ieXRlKSksCiAgICAgICAgfSkKCiAgICBkZWYgX3R5cGVfaW5mbyhsaWJyYXJ5LCB0eXBlXyk6CiAgICAgICAgaXNfZG91YmxlX3BvaW50ZXIgPSB0eXBlX1stMzpdID09ICcgKionCiAgICAgICAgaWYgaXNfZG91YmxlX3BvaW50ZXI6CiAgICAgICAgICAgIHR5cGVfID0gdHlwZV9bOi0xXQogICAgICAgIGlzX3BvaW50ZXIgPSB0eXBlX1stMjpdID09ICcgKicgYW5kIHR5cGVfIG5vdCBpbiBfcG9pbnRlcl90eXBlcwogICAgICAgIGlmIGlzX3BvaW50ZXI6CiAgICAgICAgICAgIHR5cGVfID0gdHlwZV9bOi0yXQoKICAgICAgICBpc19hcnJheSA9IHR5cGVfLmZpbmQoJ1snKSAhPSAtMQogICAgICAgIGlmIGlzX2FycmF5OgogICAgICAgICAgICBpc19hcnJheSA9IHR5cGVfW3R5cGVfLmZpbmQoJ1snKSArIDE6dHlwZV8uZmluZCgnXScpXQogICAgICAgICAgICBpZiBpc19hcnJheSA9PSAnJzoKICAgICAgICAgICAgICAgIGlzX2FycmF5ID0gVHJ1ZQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaXNfYXJyYXkgPSBpbnQoaXNfYXJyYXkpCiAgICAgICAgICAgIHR5cGVfID0gdHlwZV9bMDp0eXBlXy5maW5kKCdbJyldCgogICAgICAgIGlmIHR5cGVfIGluIF90eXBlX21hcDoKICAgICAgICAgICAgdHlwZV8gPSBfdHlwZV9tYXBbdHlwZV9dCiAgICAgICAgZWxzZToKICAgICAgICAgICAgdHlwZV8gPSBnZXRhdHRyKGxpYnJhcnksIHR5cGVfKQoKICAgICAgICBpZiBpc19kb3VibGVfcG9pbnRlcjoKICAgICAgICAgICAgdHlwZV8gPSBjdHlwZXMuUE9JTlRFUih0eXBlXykKCiAgICAgICAgcmV0dXJuIChpc19wb2ludGVyLCBpc19hcnJheSwgdHlwZV8pCgogICAgZGVmIHJlZ2lzdGVyX2ZmaShsaWJyYXJ5LCBmZmlfb2JqKToKICAgICAgICBwYXNzCgogICAgZGVmIGJ1ZmZlcl9mcm9tX2J5dGVzKGluaXRpYWxpemVyKToKICAgICAgICByZXR1cm4gY3R5cGVzLmNyZWF0ZV9zdHJpbmdfYnVmZmVyKGluaXRpYWxpemVyKQoKICAgIGRlZiBidWZmZXJfZnJvbV91bmljb2RlKGluaXRpYWxpemVyKToKICAgICAgICByZXR1cm4gY3R5cGVzLmNyZWF0ZV91bmljb2RlX2J1ZmZlcihpbml0aWFsaXplcikKCiAgICBkZWYgd3JpdGVfdG9fYnVmZmVyKGJ1ZmZlciwgZGF0YSwgb2Zmc2V0PTApOgogICAgICAgIGlmIGlzaW5zdGFuY2UoYnVmZmVyLCBjdHlwZXMuUE9JTlRFUihjdHlwZXMuY19ieXRlKSk6CiAgICAgICAgICAgIGN0eXBlcy5tZW1tb3ZlKGJ1ZmZlciwgZGF0YSwgbGVuKGRhdGEpKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgaWYgb2Zmc2V0ID09IDA6CiAgICAgICAgICAgIGJ1ZmZlci52YWx1ZSA9IGRhdGEKICAgICAgICBlbHNlOgogICAgICAgICAgICBidWZmZXIudmFsdWUgPSBidWZmZXIucmF3WzA6b2Zmc2V0XSArIGRhdGEKCiAgICBkZWYgYnVmZmVyX3BvaW50ZXIoYnVmZmVyKToKICAgICAgICByZXR1cm4gcG9pbnRlcihjdHlwZXMuY2FzdChidWZmZXIsIGNfY2hhcl9wKSkKCiAgICBkZWYgY2FzdChsaWJyYXJ5LCB0eXBlXywgdmFsdWUpOgogICAgICAgIGlzX3BvaW50ZXIsIGlzX2FycmF5LCB0eXBlXyA9IF90eXBlX2luZm8obGlicmFyeSwgdHlwZV8pCgogICAgICAgIGlmIGlzX3BvaW50ZXI6CiAgICAgICAgICAgIHR5cGVfID0gY3R5cGVzLlBPSU5URVIodHlwZV8pCiAgICAgICAgZWxpZiBpc19hcnJheToKICAgICAgICAgICAgdHlwZV8gPSB0eXBlXyAqIGlzX2FycmF5CgogICAgICAgIHJldHVybiBjdHlwZXMuY2FzdCh2YWx1ZSwgdHlwZV8pCgogICAgZGVmIHNpemVvZihsaWJyYXJ5LCB2YWx1ZSk6CiAgICAgICAgaWYgaXNpbnN0YW5jZSh2YWx1ZSwgc3RyX2Nscyk6CiAgICAgICAgICAgIHJldHVybiBjdHlwZXMuc2l6ZW9mKGdldGF0dHIobGlicmFyeSwgdmFsdWUpKQogICAgICAgIHJldHVybiBjdHlwZXMuc2l6ZW9mKHZhbHVlKQoKICAgIGRlZiBieXRlc19mcm9tX2J1ZmZlcihidWZmZXIsIG1heGxlbj1Ob25lKToKICAgICAgICBpZiBpc2luc3RhbmNlKGJ1ZmZlciwgX3BvaW50ZXJfaW50X3R5cGVzKToKICAgICAgICAgICAgcmV0dXJuIGN0eXBlcy5zdHJpbmdfYXQoYnVmZmVyLCBtYXhsZW4pCiAgICAgICAgaWYgbWF4bGVuIGlzIG5vdCBOb25lOgogICAgICAgICAgICByZXR1cm4gYnVmZmVyLnJhd1swOm1heGxlbl0KICAgICAgICByZXR1cm4gYnVmZmVyLnJhdwoKICAgIGRlZiBieXRlX3N0cmluZ19mcm9tX2J1ZmZlcihidWZmZXIpOgogICAgICAgIHJldHVybiBidWZmZXIudmFsdWUKCiAgICBkZWYgYnl0ZV9hcnJheShieXRlX3N0cmluZyk6CiAgICAgICAgcmV0dXJuIChjdHlwZXMuY19ieXRlICogbGVuKGJ5dGVfc3RyaW5nKSkoKmJ5dGVzX3RvX2xpc3QoYnl0ZV9zdHJpbmcpKQoKICAgIGRlZiBwb2ludGVyX3NldChwb2ludGVyXywgdmFsdWUpOgogICAgICAgIHBvaW50ZXJfLmNvbnRlbnRzLnZhbHVlID0gdmFsdWUKCiAgICBkZWYgYXJyYXlfc2V0KGFycmF5LCB2YWx1ZSk6CiAgICAgICAgZm9yIGluZGV4LCB2YWwgaW4gZW51bWVyYXRlKHZhbHVlKToKICAgICAgICAgICAgYXJyYXlbaW5kZXhdID0gdmFsCgogICAgZGVmIG51bGwoKToKICAgICAgICByZXR1cm4gTm9uZQoKICAgIGRlZiBpc19udWxsKHBvaW50KToKICAgICAgICByZXR1cm4gbm90IGJvb2wocG9pbnQpCgogICAgZGVmIGVycm5vKCk6CiAgICAgICAgcmV0dXJuIGN0eXBlcy5nZXRfZXJybm8oKQoKICAgIGRlZiBuZXcobGlicmFyeSwgdHlwZV8sIHZhbHVlPU5vbmUpOgogICAgICAgIGlzX3BvaW50ZXIsIGlzX2FycmF5LCB0eXBlXyA9IF90eXBlX2luZm8obGlicmFyeSwgdHlwZV8pCiAgICAgICAgaWYgaXNfYXJyYXk6CiAgICAgICAgICAgIGlmIGlzX2FycmF5IGlzIFRydWU6CiAgICAgICAgICAgICAgICB0eXBlXyA9IHR5cGVfICogdmFsdWUKICAgICAgICAgICAgICAgIHZhbHVlID0gTm9uZQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdHlwZV8gPSB0eXBlXyAqIGlzX2FycmF5CgogICAgICAgIHBhcmFtcyA9IFtdCiAgICAgICAgaWYgdmFsdWUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHBhcmFtcy5hcHBlbmQodmFsdWUpCiAgICAgICAgb3V0cHV0ID0gdHlwZV8oKnBhcmFtcykKCiAgICAgICAgaWYgaXNfcG9pbnRlcjoKICAgICAgICAgICAgb3V0cHV0ID0gcG9pbnRlcihvdXRwdXQpCgogICAgICAgIHJldHVybiBvdXRwdXQKCiAgICBkZWYgcmVmKHZhbHVlLCBvZmZzZXQ9MCk6CiAgICAgICAgaWYgb2Zmc2V0ID09IDA6CiAgICAgICAgICAgIHJldHVybiBjdHlwZXMuYnlyZWYodmFsdWUpCiAgICAgICAgcmV0dXJuIGN0eXBlcy5jYXN0KGN0eXBlcy5hZGRyZXNzb2YodmFsdWUpICsgb2Zmc2V0LCBjdHlwZXMuUE9JTlRFUihjdHlwZXMuY19ieXRlKSkKCiAgICBkZWYgbmF0aXZlKHR5cGVfLCB2YWx1ZSk6CiAgICAgICAgaWYgaXNpbnN0YW5jZSh2YWx1ZSwgdHlwZV8pOgogICAgICAgICAgICByZXR1cm4gdmFsdWUKICAgICAgICBpZiBzeXMudmVyc2lvbl9pbmZvIDwgKDMsKSBhbmQgdHlwZV8gPT0gaW50IGFuZCBpc2luc3RhbmNlKHZhbHVlLCBpbnRfdHlwZXMpOgogICAgICAgICAgICByZXR1cm4gdmFsdWUKICAgICAgICBpZiBpc2luc3RhbmNlKHZhbHVlLCBjdHlwZXMuQXJyYXkpIGFuZCB2YWx1ZS5fdHlwZV8gPT0gY3R5cGVzLmNfYnl0ZToKICAgICAgICAgICAgcmV0dXJuIGN0eXBlcy5zdHJpbmdfYXQoY3R5cGVzLmFkZHJlc3NvZih2YWx1ZSksIHZhbHVlLl9sZW5ndGhfKQogICAgICAgIHJldHVybiB0eXBlXyh2YWx1ZS52YWx1ZSkKCiAgICBkZWYgZGVyZWYocG9pbnQpOgogICAgICAgIHJldHVybiBwb2ludFswXQoKICAgIGRlZiB1bndyYXAocG9pbnQpOgogICAgICAgIHJldHVybiBwb2ludC5jb250ZW50cwoKICAgIGRlZiBzdHJ1Y3QobGlicmFyeSwgbmFtZSk6CiAgICAgICAgcmV0dXJuIHBvaW50ZXIoZ2V0YXR0cihsaWJyYXJ5LCBuYW1lKSgpKQoKICAgIGRlZiBzdHJ1Y3RfYnl0ZXMoc3RydWN0Xyk6CiAgICAgICAgcmV0dXJuIGN0eXBlcy5zdHJpbmdfYXQoc3RydWN0XywgY3R5cGVzLnNpemVvZihzdHJ1Y3RfLmNvbnRlbnRzKSkKCiAgICBkZWYgc3RydWN0X2Zyb21fYnVmZmVyKGxpYnJhcnksIHR5cGVfLCBidWZmZXIpOgogICAgICAgIGNsYXNzXyA9IGdldGF0dHIobGlicmFyeSwgdHlwZV8pCiAgICAgICAgdmFsdWUgPSBjbGFzc18oKQogICAgICAgIGN0eXBlcy5tZW1tb3ZlKGN0eXBlcy5hZGRyZXNzb2YodmFsdWUpLCBidWZmZXIsIGN0eXBlcy5zaXplb2YoY2xhc3NfKSkKICAgICAgICByZXR1cm4gY3R5cGVzLnBvaW50ZXIodmFsdWUpCgogICAgZGVmIGFycmF5X2Zyb21fcG9pbnRlcihsaWJyYXJ5LCB0eXBlXywgcG9pbnQsIHNpemUpOgogICAgICAgIF8sIF8sIHR5cGVfID0gX3R5cGVfaW5mbyhsaWJyYXJ5LCB0eXBlXykKICAgICAgICBhcnJheSA9IGN0eXBlcy5jYXN0KHBvaW50LCBjdHlwZXMuUE9JTlRFUih0eXBlXykpCiAgICAgICAgb3V0cHV0ID0gW10KICAgICAgICBmb3IgaSBpbiByYW5nZSgwLCBzaXplKToKICAgICAgICAgICAgb3V0cHV0LmFwcGVuZChhcnJheVtpXSkKICAgICAgICByZXR1cm4gb3V0cHV0CgogICAgZGVmIGNhbGxiYWNrKGxpYnJhcnksIHNpZ25hdHVyZV90eXBlLCBmdW5jKToKICAgICAgICByZXR1cm4gZ2V0YXR0cihsaWJyYXJ5LCBzaWduYXR1cmVfdHlwZSkoZnVuYykKCiAgICBlbmdpbmUgPSAnY3R5cGVzJwoKCmRlZiBnZXRfbGlicmFyeShuYW1lLCBkeWxpYl9uYW1lLCB2ZXJzaW9uKToKICAgICIiIgogICAgUmV0cmlldmUgdGhlIEMgbGlicmFyeSBwYXRoIHdpdGggc3BlY2lhbCBoYW5kbGluZyBmb3IgTWFjCgogICAgOnBhcmFtIG5hbWU6CiAgICAgICAgQSB1bmljb2RlIHN0cmluZyBvZiB0aGUgbGlicmFyeSB0byBzZWFyY2ggdGhlIHN5c3RlbSBmb3IKCiAgICA6cGFyYW0gZHlsaWJfbmFtZToKICAgICAgICBNYWMgb25seSAtIGEgdW5pY29kZSBzdHJpbmcgb2YgdGhlIHVudmVyc2lvbmVkIGR5bGliIG5hbWUKCiAgICA6cGFyYW0gdmVyc2lvbjoKICAgICAgICBNYWMgb25seSAtIGEgdW5pY29kZSBzdHJpbmcgb2YgdGhlIGR5bGliIHZlcnNpb24gdG8gdXNlLiBVc2VkIG9uIG1hY09TCiAgICAgICAgMTAuMTUrIHdoZW4gdGhlIHVudmVyc2lvbmVkIGR5bGliIGlzIGZvdW5kLCBzaW5jZSB1bnZlcnNpb25lZAogICAgICAgIE9wZW5TU0wvTGlicmVTU0wgYXJlIGp1c3QgcGxhY2Vob2xkZXJzLCBhbmQgYSB2ZXJzaW9uZWQgZHlsaWIgbXVzdCBiZQogICAgICAgIGltcG9ydGVkLiBVc2VkIG9uIG1hY09TIDEwLjE2KyB3aGVuIGZpbmRfbGlicmFyeSgpIGRvZXNuJ3QgcmV0dXJuIGEKICAgICAgICByZXN1bHQsIGR1ZSB0byBzeXN0ZW0gZHlsaWJzIG5vdCBiZWluZyBwcmVzZW50IG9uIHRoZSBmaWxlc3lzdGVtIGFueQogICAgICAgIGxvbmdlci4KCiAgICA6cmV0dXJuOgogICAgICAgIEEgdW5pY29kZSBzdHJpbmcgb2YgdGhlIHBhdGggdG8gdGhlIGxpYnJhcnkKICAgICIiIgoKICAgIGxpYnJhcnkgPSBmaW5kX2xpYnJhcnkobmFtZSkKCiAgICBpZiBzeXMucGxhdGZvcm0gPT0gJ2Rhcndpbic6CiAgICAgICAgdW52ZXJzaW9uZWQgPSAnL3Vzci9saWIvJXMnICUgZHlsaWJfbmFtZQogICAgICAgIHZlcnNpb25lZCA9IHVudmVyc2lvbmVkLnJlcGxhY2UoJy5keWxpYicsICcuJXMuZHlsaWInICUgdmVyc2lvbikKICAgICAgICBtYWNfdmVyID0gdHVwbGUobWFwKGludCwgcGxhdGZvcm0ubWFjX3ZlcigpWzBdLnNwbGl0KCcuJykpKQogICAgICAgIGlmIG5vdCBsaWJyYXJ5IGFuZCBtYWNfdmVyID49ICgxMCwgMTYpOgogICAgICAgICAgICAjIE9uIG1hY09TIDEwLjE2KywgZmluZF9saWJyYXJ5IGRvZXNuJ3Qgd29yaywgc28gd2Ugc2V0IGEgc3RhdGljIHBhdGgKICAgICAgICAgICAgbGlicmFyeSA9IHZlcnNpb25lZAogICAgICAgIGVsaWYgbWFjX3ZlciA+PSAoMTAsIDE1KSBhbmQgbGlicmFyeSA9PSB1bnZlcnNpb25lZDoKICAgICAgICAgICAgIyBPbiBtYWNPUyAxMC4xNSssIHdlIHdhbnQgdG8gc3Ryb25nbHkgdmVyc2lvbiBzaW5jZSB1bnZlcnNpb25lZCBsaWJjcnlwdG8gaGFzIGEgbm9uLXN0YWJsZSBBQkkKICAgICAgICAgICAgbGlicmFyeSA9IHZlcnNpb25lZAoKICAgIHJldHVybiBsaWJyYXJ5CgoKY2xhc3MgRkZJRW5naW5lRXJyb3IoRXhjZXB0aW9uKToKCiAgICAiIiIKICAgIEFuIGV4Y2VwdGlvbiB3aGVuIHRyeWluZyB0byBpbnN0YW50aWF0ZSBjdHlwZXMgb3IgY2ZmaQogICAgIiIiCgogICAgcGFzcwo=
