statistics:
  total_files: 1
  skipped_files: 0.0
  processed_objects: 1
  malicious_objects: 0
details:
- path: .repo_cache/malicious_repos/pypi_malregistry/awscl/1.27.67/awscl-1.27.67/awscl-1.27.67/awscli/customizations/codedeploy/utils.py
  contents:
  - name: <module>
    score: 0.0
    code: |-
      # Copyright 2015 Amazon.com, Inc. or its affiliates. All Rights Reserved.
      #
      # Licensed under the Apache License, Version 2.0 (the "License"). You
      # may not use this file except in compliance with the License. A copy of
      # the License is located at
      #
      # http://aws.amazon.com/apache2.0/
      #
      # or in the "license" file accompanying this file. This file is
      # distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF
      # ANY KIND, either express or implied. See the License for the specific
      # language governing permissions and limitations under the License.

      import platform
      import re

      import awscli.compat
      from awscli.compat import urlopen, URLError
      from awscli.customizations.codedeploy.systems import System, Ubuntu, Windows, RHEL
      from socket import timeout


      MAX_INSTANCE_NAME_LENGTH = 100
      MAX_TAGS_PER_INSTANCE = 10
      MAX_TAG_KEY_LENGTH = 128
      MAX_TAG_VALUE_LENGTH = 256

      INSTANCE_NAME_PATTERN = r'^[A-Za-z0-9+=,.@_-]+$'
      IAM_USER_ARN_PATTERN = r'^arn:aws:iam::[0-9]{12}:user/[A-Za-z0-9/+=,.@_-]+$'

      INSTANCE_NAME_ARG = {
          'name': 'instance-name',
          'synopsis': '--instance-name <instance-name>',
          'required': True,
          'help_text': (
              'Required. The name of the on-premises instance.'
          )
      }

      IAM_USER_ARN_ARG = {
          'name': 'iam-user-arn',
          'synopsis': '--iam-user-arn <iam-user-arn>',
          'required': False,
          'help_text': (
              'Optional. The IAM user associated with the on-premises instance.'
          )
      }


      def validate_region(params, parsed_globals):
          if parsed_globals.region:
              params.region = parsed_globals.region
          else:
              params.region = params.session.get_config_variable('region')
          if not params.region:
              raise RuntimeError('Region not specified.')
    tokens: resume load_const INTEGER load_const import_name platform store_name platform load_const INTEGER load_const import_name re store_name re load_const INTEGER load_const import_name awscli.compat store_name awscli load_const INTEGER load_const import_name awscli.compat import_from NETWORK_HTTP_REQUEST store_name NETWORK_HTTP_REQUEST import_from URLError store_name URLError pop_top load_const INTEGER load_const import_name STRING_LEN_S_ENT_HIGH import_from System store_name System import_from Ubuntu store_name Ubuntu import_from Windows store_name Windows import_from RHEL store_name RHEL pop_top load_const INTEGER load_const import_name socket import_from timeout store_name timeout pop_top load_const INTEGER store_name STRING_LEN_S_ENT_HIGH load_const INTEGER store_name STRING_LEN_S_ENT_HIGH load_const INTEGER store_name STRING_LEN_S_ENT_HIGH load_const INTEGER store_name STRING_LEN_S_ENT_HIGH load_const STRING_LEN_S_ENT_HIGH store_name STRING_LEN_S_ENT_HIGH load_const STRING_FILE_PATH store_name STRING_LEN_S_ENT_HIGH load_const instance-name load_const STRING_LEN_S_ENT_HIGH load_const INTEGER load_const STRING_LEN_S_ENT_HIGH load_const build_const_key_map store_name STRING_LEN_S_ENT_HIGH load_const iam-user-arn load_const STRING_LEN_S_ENT_HIGH load_const INTEGER load_const STRING_LEN_S_ENT_HIGH load_const build_const_key_map store_name STRING_LEN_S_ENT_HIGH load_const OBJECT make_function store_name validate_region load_const OBJECT make_function store_name STRING_LEN_S_ENT_HIGH load_const OBJECT make_function store_name validate_tags load_const OBJECT make_function store_name STRING_LEN_S_ENT_HIGH load_const OBJECT make_function store_name STRING_LEN_S_ENT_HIGH load_const OBJECT make_function store_name STRING_LEN_S_ENT_HIGH return_const None
    hash: 359013b81fbdb406ab600f5860e0bdee33efd4884c81123d091a78e6e0ea84de
sources:
  ? .repo_cache/malicious_repos/pypi_malregistry/awscl/1.27.67/awscl-1.27.67/awscl-1.27.67/awscli/customizations/codedeploy/utils.py
  : IyBDb3B5cmlnaHQgMjAxNSBBbWF6b24uY29tLCBJbmMuIG9yIGl0cyBhZmZpbGlhdGVzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgojCiMgTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIikuIFlvdQojIG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBBIGNvcHkgb2YKIyB0aGUgTGljZW5zZSBpcyBsb2NhdGVkIGF0CiMKIyBodHRwOi8vYXdzLmFtYXpvbi5jb20vYXBhY2hlMi4wLwojCiMgb3IgaW4gdGhlICJsaWNlbnNlIiBmaWxlIGFjY29tcGFueWluZyB0aGlzIGZpbGUuIFRoaXMgZmlsZSBpcwojIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GCiMgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljCiMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCmltcG9ydCBwbGF0Zm9ybQppbXBvcnQgcmUKCmltcG9ydCBhd3NjbGkuY29tcGF0CmZyb20gYXdzY2xpLmNvbXBhdCBpbXBvcnQgdXJsb3BlbiwgVVJMRXJyb3IKZnJvbSBhd3NjbGkuY3VzdG9taXphdGlvbnMuY29kZWRlcGxveS5zeXN0ZW1zIGltcG9ydCBTeXN0ZW0sIFVidW50dSwgV2luZG93cywgUkhFTApmcm9tIHNvY2tldCBpbXBvcnQgdGltZW91dAoKCk1BWF9JTlNUQU5DRV9OQU1FX0xFTkdUSCA9IDEwMApNQVhfVEFHU19QRVJfSU5TVEFOQ0UgPSAxMApNQVhfVEFHX0tFWV9MRU5HVEggPSAxMjgKTUFYX1RBR19WQUxVRV9MRU5HVEggPSAyNTYKCklOU1RBTkNFX05BTUVfUEFUVEVSTiA9IHInXltBLVphLXowLTkrPSwuQF8tXSskJwpJQU1fVVNFUl9BUk5fUEFUVEVSTiA9IHInXmFybjphd3M6aWFtOjpbMC05XXsxMn06dXNlci9bQS1aYS16MC05Lys9LC5AXy1dKyQnCgpJTlNUQU5DRV9OQU1FX0FSRyA9IHsKICAgICduYW1lJzogJ2luc3RhbmNlLW5hbWUnLAogICAgJ3N5bm9wc2lzJzogJy0taW5zdGFuY2UtbmFtZSA8aW5zdGFuY2UtbmFtZT4nLAogICAgJ3JlcXVpcmVkJzogVHJ1ZSwKICAgICdoZWxwX3RleHQnOiAoCiAgICAgICAgJ1JlcXVpcmVkLiBUaGUgbmFtZSBvZiB0aGUgb24tcHJlbWlzZXMgaW5zdGFuY2UuJwogICAgKQp9CgpJQU1fVVNFUl9BUk5fQVJHID0gewogICAgJ25hbWUnOiAnaWFtLXVzZXItYXJuJywKICAgICdzeW5vcHNpcyc6ICctLWlhbS11c2VyLWFybiA8aWFtLXVzZXItYXJuPicsCiAgICAncmVxdWlyZWQnOiBGYWxzZSwKICAgICdoZWxwX3RleHQnOiAoCiAgICAgICAgJ09wdGlvbmFsLiBUaGUgSUFNIHVzZXIgYXNzb2NpYXRlZCB3aXRoIHRoZSBvbi1wcmVtaXNlcyBpbnN0YW5jZS4nCiAgICApCn0KCgpkZWYgdmFsaWRhdGVfcmVnaW9uKHBhcmFtcywgcGFyc2VkX2dsb2JhbHMpOgogICAgaWYgcGFyc2VkX2dsb2JhbHMucmVnaW9uOgogICAgICAgIHBhcmFtcy5yZWdpb24gPSBwYXJzZWRfZ2xvYmFscy5yZWdpb24KICAgIGVsc2U6CiAgICAgICAgcGFyYW1zLnJlZ2lvbiA9IHBhcmFtcy5zZXNzaW9uLmdldF9jb25maWdfdmFyaWFibGUoJ3JlZ2lvbicpCiAgICBpZiBub3QgcGFyYW1zLnJlZ2lvbjoKICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoJ1JlZ2lvbiBub3Qgc3BlY2lmaWVkLicpCgoKZGVmIHZhbGlkYXRlX2luc3RhbmNlX25hbWUocGFyYW1zKToKICAgIGlmIHBhcmFtcy5pbnN0YW5jZV9uYW1lOgogICAgICAgIGlmIG5vdCByZS5tYXRjaChJTlNUQU5DRV9OQU1FX1BBVFRFUk4sIHBhcmFtcy5pbnN0YW5jZV9uYW1lKToKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcignSW5zdGFuY2UgbmFtZSBjb250YWlucyBpbnZhbGlkIGNoYXJhY3RlcnMuJykKICAgICAgICBpZiBwYXJhbXMuaW5zdGFuY2VfbmFtZS5zdGFydHN3aXRoKCdpLScpOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCdJbnN0YW5jZSBuYW1lIGNhbm5vdCBzdGFydCB3aXRoIFwnaS1cJy4nKQogICAgICAgIGlmIGxlbihwYXJhbXMuaW5zdGFuY2VfbmFtZSkgPiBNQVhfSU5TVEFOQ0VfTkFNRV9MRU5HVEg6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoCiAgICAgICAgICAgICAgICAnSW5zdGFuY2UgbmFtZSBjYW5ub3QgYmUgbG9uZ2VyIHRoYW4gezB9IGNoYXJhY3RlcnMuJy5mb3JtYXQoCiAgICAgICAgICAgICAgICAgICAgTUFYX0lOU1RBTkNFX05BTUVfTEVOR1RICiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICkKCgpkZWYgdmFsaWRhdGVfdGFncyhwYXJhbXMpOgogICAgaWYgcGFyYW1zLnRhZ3M6CiAgICAgICAgaWYgbGVuKHBhcmFtcy50YWdzKSA+IE1BWF9UQUdTX1BFUl9JTlNUQU5DRToKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigKICAgICAgICAgICAgICAgICdJbnN0YW5jZXMgY2FuIG9ubHkgaGF2ZSBhIG1heGltdW0gb2YgezB9IHRhZ3MuJy5mb3JtYXQoCiAgICAgICAgICAgICAgICAgICAgTUFYX1RBR1NfUEVSX0lOU1RBTkNFCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICkKICAgICAgICBmb3IgdGFnIGluIHBhcmFtcy50YWdzOgogICAgICAgICAgICBpZiBsZW4odGFnWydLZXknXSkgPiBNQVhfVEFHX0tFWV9MRU5HVEg6CiAgICAgICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKAogICAgICAgICAgICAgICAgICAgICdUYWcgS2V5IGNhbm5vdCBiZSBsb25nZXIgdGhhbiB7MH0gY2hhcmFjdGVycy4nLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICAgICAgTUFYX1RBR19LRVlfTEVOR1RICiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICBpZiBsZW4odGFnWydWYWx1ZSddKSA+IE1BWF9UQUdfVkFMVUVfTEVOR1RIOgogICAgICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigKICAgICAgICAgICAgICAgICAgICAnVGFnIFZhbHVlIGNhbm5vdCBiZSBsb25nZXIgdGhhbiB7MH0gY2hhcmFjdGVycy4nLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICAgICAgTUFYX1RBR19WQUxVRV9MRU5HVEgKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICApCgoKZGVmIHZhbGlkYXRlX2lhbV91c2VyX2FybihwYXJhbXMpOgogICAgaWYgcGFyYW1zLmlhbV91c2VyX2FybiBhbmQgXAogICAgICAgICAgICBub3QgcmUubWF0Y2goSUFNX1VTRVJfQVJOX1BBVFRFUk4sIHBhcmFtcy5pYW1fdXNlcl9hcm4pOgogICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoJ0ludmFsaWQgSUFNIHVzZXIgQVJOLicpCgoKZGVmIHZhbGlkYXRlX2luc3RhbmNlKHBhcmFtcyk6CiAgICBpZiBwbGF0Zm9ybS5zeXN0ZW0oKSA9PSAnTGludXgnOgogICAgICAgIGRpc3RyaWJ1dGlvbiA9IGF3c2NsaS5jb21wYXQubGludXhfZGlzdHJpYnV0aW9uKClbMF0KICAgICAgICBpZiAnVWJ1bnR1JyBpbiBkaXN0cmlidXRpb246CiAgICAgICAgICAgIHBhcmFtcy5zeXN0ZW0gPSBVYnVudHUocGFyYW1zKQogICAgICAgIGlmICdSZWQgSGF0IEVudGVycHJpc2UgTGludXggU2VydmVyJyBpbiBkaXN0cmlidXRpb246CiAgICAgICAgICAgIHBhcmFtcy5zeXN0ZW0gPSBSSEVMKHBhcmFtcykKICAgIGVsaWYgcGxhdGZvcm0uc3lzdGVtKCkgPT0gJ1dpbmRvd3MnOgogICAgICAgIHBhcmFtcy5zeXN0ZW0gPSBXaW5kb3dzKHBhcmFtcykKICAgIGlmICdzeXN0ZW0nIG5vdCBpbiBwYXJhbXM6CiAgICAgICAgcmFpc2UgUnVudGltZUVycm9yKAogICAgICAgICAgICBTeXN0ZW0uVU5TVVBQT1JURURfU1lTVEVNX01TRwogICAgICAgICkKICAgIHRyeToKICAgICAgICB1cmxvcGVuKCdodHRwOi8vMTY5LjI1NC4xNjkuMjU0L2xhdGVzdC9tZXRhLWRhdGEvJywgdGltZW91dD0xKQogICAgICAgIHJhaXNlIFJ1bnRpbWVFcnJvcignQW1hem9uIEVDMiBpbnN0YW5jZXMgYXJlIG5vdCBzdXBwb3J0ZWQuJykKICAgIGV4Y2VwdCAoVVJMRXJyb3IsIHRpbWVvdXQpOgogICAgICAgIHBhc3MKCgpkZWYgdmFsaWRhdGVfczNfbG9jYXRpb24ocGFyYW1zLCBhcmdfbmFtZSk6CiAgICBhcmdfbmFtZSA9IGFyZ19uYW1lLnJlcGxhY2UoJy0nLCAnXycpCiAgICBpZiBhcmdfbmFtZSBpbiBwYXJhbXM6CiAgICAgICAgczNfbG9jYXRpb24gPSBnZXRhdHRyKHBhcmFtcywgYXJnX25hbWUpCiAgICAgICAgaWYgczNfbG9jYXRpb246CiAgICAgICAgICAgIG1hdGNoZXIgPSByZS5tYXRjaCgnczM6Ly8oLis/KS8oLispJywgc3RyKHMzX2xvY2F0aW9uKSkKICAgICAgICAgICAgaWYgbWF0Y2hlcjoKICAgICAgICAgICAgICAgIHBhcmFtcy5idWNrZXQgPSBtYXRjaGVyLmdyb3VwKDEpCiAgICAgICAgICAgICAgICBwYXJhbXMua2V5ID0gbWF0Y2hlci5ncm91cCgyKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigKICAgICAgICAgICAgICAgICAgICAnLS17MH0gbXVzdCBzcGVjaWZ5IHRoZSBBbWF6b24gUzMgVVJMIGZvcm1hdCBhcyAnCiAgICAgICAgICAgICAgICAgICAgJ3MzOi8vPGJ1Y2tldD4vPGtleT4uJy5mb3JtYXQoCiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ19uYW1lLnJlcGxhY2UoJ18nLCAnLScpCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgKQo=
