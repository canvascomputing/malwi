statistics:
  total_files: 1
  skipped_files: 0.0
  processed_objects: 1
  malicious_objects: 0
details:
- path: .repo_cache/malicious_repos/pypi_malregistry/awscl/1.27.67/awscl-1.27.67/awscl-1.27.67/awscli/paramfile.py
  contents:
  - name: URIArgumentHandler._check_for_uri_param
    score: 0.0
    code: |-
      def _check_for_uri_param(self, param, value):
              if isinstance(value, list) and len(value) == 1:
                  value = value[0]
              try:
                  return get_paramfile(value, self._prefixes)
              except ResourceLoadingError as e:
                  raise ParamError(param.cli_name, six.text_type(e))
    tokens: resume load_global isinstance load_fast value load_global list call pop_jump_if_false TO_NUMBER load_global len load_fast value call load_const INTEGER compare_op == pop_jump_if_false TO_NUMBER load_fast value load_const INTEGER binary_subscr store_fast value nop load_global get_paramfile load_fast value load_fast self load_attr _prefixes call return_value push_exc_info load_global STRING_BASE64_LEN_S_ENT_HIGH check_exc_match pop_jump_if_false TO_NUMBER store_fast e load_global ParamError load_fast param load_attr cli_name load_global six load_attr text_type load_fast e call call raise_varargs load_const store_fast e delete_fast e reraise reraise copy pop_except reraise
    hash: 68e467629a9283909446f44b8d696b15701c35e64373f48a29da41f74e2c28c4
sources:
  .repo_cache/malicious_repos/pypi_malregistry/awscl/1.27.67/awscl-1.27.67/awscl-1.27.67/awscli/paramfile.py: IyBDb3B5cmlnaHQgMjAxMi0yMDEzIEFtYXpvbi5jb20sIEluYy4gb3IgaXRzIGFmZmlsaWF0ZXMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiMKIyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKS4gWW91CiMgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuIEEgY29weSBvZgojIHRoZSBMaWNlbnNlIGlzIGxvY2F0ZWQgYXQKIwojICAgICBodHRwOi8vYXdzLmFtYXpvbi5jb20vYXBhY2hlMi4wLwojCiMgb3IgaW4gdGhlICJsaWNlbnNlIiBmaWxlIGFjY29tcGFueWluZyB0aGlzIGZpbGUuIFRoaXMgZmlsZSBpcwojIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GCiMgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljCiMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KaW1wb3J0IGxvZ2dpbmcKaW1wb3J0IG9zCmltcG9ydCBjb3B5Cgpmcm9tIGJvdG9jb3JlLmF3c3JlcXVlc3QgaW1wb3J0IEFXU1JlcXVlc3QKZnJvbSBib3RvY29yZS5odHRwc2Vzc2lvbiBpbXBvcnQgVVJMTGliM1Nlc3Npb24KZnJvbSBib3RvY29yZS5leGNlcHRpb25zIGltcG9ydCBQcm9maWxlTm90Rm91bmQKZnJvbSBhd3NjbGkuY29tcGF0IGltcG9ydCBzaXgKCmZyb20gYXdzY2xpLmNvbXBhdCBpbXBvcnQgY29tcGF0X29wZW4KZnJvbSBhd3NjbGkuYXJncHJvY2VzcyBpbXBvcnQgUGFyYW1FcnJvcgoKCmxvZ2dlciA9IGxvZ2dpbmcuZ2V0TG9nZ2VyKF9fbmFtZV9fKQoKIyBUaGVzZSBhcmUgc3BlY2lhbCBjYXNlZCBhcmd1bWVudHMgdGhhdCBkbyBfbm90XyBnZXQgdGhlCiMgc3BlY2lhbCBwYXJhbSBmaWxlIHByb2Nlc3NpbmcuICBUaGlzIGlzIHR5cGljYWxseSBiZWNhdXNlIGl0CiMgcmVmZXJzIHRvIGFuIGFjdHVhbCBVUkkgb2Ygc29tZSBzb3J0IGFuZCB3ZSBkb24ndCB3YW50IHRvIGFjdHVhbGx5CiMgZG93bmxvYWQgdGhlIGNvbnRlbnQgKGkuZSBUZW1wbGF0ZVVSTCBpbiBjbG91ZGZvcm1hdGlvbikuClBBUkFNRklMRV9ESVNBQkxFRCA9IHNldChbCiAgICAnYXBpLWdhdGV3YXkucHV0LWludGVncmF0aW9uLnVyaScsCiAgICAnYXBpLWdhdGV3YXkuY3JlYXRlLWludGVncmF0aW9uLmludGVncmF0aW9uLXVyaScsCiAgICAnYXBpLWdhdGV3YXkudXBkYXRlLWludGVncmF0aW9uLmludGVncmF0aW9uLXVyaScsCiAgICAnYXBpLWdhdGV3YXkuY3JlYXRlLWFwaS50YXJnZXQnLAogICAgJ2FwaS1nYXRld2F5LnVwZGF0ZS1hcGkudGFyZ2V0JywKICAgICdhcHBzdHJlYW0uY3JlYXRlLXN0YWNrLnJlZGlyZWN0LXVybCcsCiAgICAnYXBwc3RyZWFtLmNyZWF0ZS1zdGFjay5mZWVkYmFjay11cmwnLAogICAgJ2FwcHN0cmVhbS51cGRhdGUtc3RhY2sucmVkaXJlY3QtdXJsJywKICAgICdhcHBzdHJlYW0udXBkYXRlLXN0YWNrLmZlZWRiYWNrLXVybCcsCiAgICAnY2xvdWRmb3JtYXRpb24uY3JlYXRlLXN0YWNrLnRlbXBsYXRlLXVybCcsCiAgICAnY2xvdWRmb3JtYXRpb24udXBkYXRlLXN0YWNrLnRlbXBsYXRlLXVybCcsCiAgICAnY2xvdWRmb3JtYXRpb24uY3JlYXRlLXN0YWNrLXNldC50ZW1wbGF0ZS11cmwnLAogICAgJ2Nsb3VkZm9ybWF0aW9uLnVwZGF0ZS1zdGFjay1zZXQudGVtcGxhdGUtdXJsJywKICAgICdjbG91ZGZvcm1hdGlvbi5jcmVhdGUtY2hhbmdlLXNldC50ZW1wbGF0ZS11cmwnLAogICAgJ2Nsb3VkZm9ybWF0aW9uLnZhbGlkYXRlLXRlbXBsYXRlLnRlbXBsYXRlLXVybCcsCiAgICAnY2xvdWRmb3JtYXRpb24uZXN0aW1hdGUtdGVtcGxhdGUtY29zdC50ZW1wbGF0ZS11cmwnLAogICAgJ2Nsb3VkZm9ybWF0aW9uLmdldC10ZW1wbGF0ZS1zdW1tYXJ5LnRlbXBsYXRlLXVybCcsCgogICAgJ2Nsb3VkZm9ybWF0aW9uLmNyZWF0ZS1zdGFjay5zdGFjay1wb2xpY3ktdXJsJywKICAgICdjbG91ZGZvcm1hdGlvbi51cGRhdGUtc3RhY2suc3RhY2stcG9saWN5LXVybCcsCiAgICAnY2xvdWRmb3JtYXRpb24uc2V0LXN0YWNrLXBvbGljeS5zdGFjay1wb2xpY3ktdXJsJywKICAgICMgYXdzIGNsb3VkZm9ybWF0aW9uIHBhY2thZ2UgLS10ZW1wbGF0ZS1maWxlCiAgICAnY3VzdG9tLnBhY2thZ2UudGVtcGxhdGUtZmlsZScsCiAgICAjIGF3cyBjbG91ZGZvcm1hdGlvbiBkZXBsb3kgLS10ZW1wbGF0ZS1maWxlCiAgICAnY3VzdG9tLmRlcGxveS50ZW1wbGF0ZS1maWxlJywKCiAgICAnY2xvdWRmb3JtYXRpb24udXBkYXRlLXN0YWNrLnN0YWNrLXBvbGljeS1kdXJpbmctdXBkYXRlLXVybCcsCiAgICAnY2xvdWRmb3JtYXRpb24ucmVnaXN0ZXItdHlwZS5zY2hlbWEtaGFuZGxlci1wYWNrYWdlJywKICAgICMgV2Ugd2lsbCB3YW50IHRvIGNoYW5nZSB0aGUgZXZlbnQgbmFtZSB0byBgYHMzYGAgYXMgb3Bwb3NlZCB0bwogICAgIyBjdXN0b20gaW4gdGhlIG5lYXIgZnV0dXJlIGFsb25nIHdpdGggYGBzM2BgIHRvIGBgczNhcGlgYC4KICAgICdjdXN0b20uY3Aud2Vic2l0ZS1yZWRpcmVjdCcsCiAgICAnY3VzdG9tLm12LndlYnNpdGUtcmVkaXJlY3QnLAogICAgJ2N1c3RvbS5zeW5jLndlYnNpdGUtcmVkaXJlY3QnLAoKICAgICdndWFyZGR1dHkuY3JlYXRlLWlwLXNldC5sb2NhdGlvbicsCiAgICAnZ3VhcmRkdXR5LnVwZGF0ZS1pcC1zZXQubG9jYXRpb24nLAogICAgJ2d1YXJkZHV0eS5jcmVhdGUtdGhyZWF0LWludGVsLXNldC5sb2NhdGlvbicsCiAgICAnZ3VhcmRkdXR5LnVwZGF0ZS10aHJlYXQtaW50ZWwtc2V0LmxvY2F0aW9uJywKICAgICdjb21wcmVoZW5kLmRldGVjdC1kb21pbmFudC1sYW5ndWFnZS50ZXh0JywKICAgICdjb21wcmVoZW5kLmJhdGNoLWRldGVjdC1kb21pbmFudC1sYW5ndWFnZS50ZXh0LWxpc3QnLAogICAgJ2NvbXByZWhlbmQuZGV0ZWN0LWVudGl0aWVzLnRleHQnLAogICAgJ2NvbXByZWhlbmQuYmF0Y2gtZGV0ZWN0LWVudGl0aWVzLnRleHQtbGlzdCcsCiAgICAnY29tcHJlaGVuZC5kZXRlY3Qta2V5LXBocmFzZXMudGV4dCcsCiAgICAnY29tcHJlaGVuZC5iYXRjaC1kZXRlY3Qta2V5LXBocmFzZXMudGV4dC1saXN0JywKICAgICdjb21wcmVoZW5kLmRldGVjdC1zZW50aW1lbnQudGV4dCcsCiAgICAnY29tcHJlaGVuZC5iYXRjaC1kZXRlY3Qtc2VudGltZW50LnRleHQtbGlzdCcsCgogICAgJ2Vtci5jcmVhdGUtc3R1ZGlvLmlkcC1hdXRoLXVybCcsCgogICAgJ2lhbS5jcmVhdGUtb3Blbi1pZC1jb25uZWN0LXByb3ZpZGVyLnVybCcsCgogICAgJ21hY2hpbmUtbGVhcm5pbmcucHJlZGljdC5wcmVkaWN0LWVuZHBvaW50JywKCiAgICAnbWVkaWF0YWlsb3IucHV0LXBsYXliYWNrLWNvbmZpZ3VyYXRpb24uYWQtZGVjaXNpb24tc2VydmVyLXVybCcsCiAgICAnbWVkaWF0YWlsb3IucHV0LXBsYXliYWNrLWNvbmZpZ3VyYXRpb24uc2xhdGUtYWQtdXJsJywKICAgICdtZWRpYXRhaWxvci5wdXQtcGxheWJhY2stY29uZmlndXJhdGlvbi52aWRlby1jb250ZW50LXNvdXJjZS11cmwnLAoKICAgICdyZHMuY29weS1kYi1jbHVzdGVyLXNuYXBzaG90LnByZS1zaWduZWQtdXJsJywKICAgICdyZHMuY3JlYXRlLWRiLWNsdXN0ZXIucHJlLXNpZ25lZC11cmwnLAogICAgJ3Jkcy5jb3B5LWRiLXNuYXBzaG90LnByZS1zaWduZWQtdXJsJywKICAgICdyZHMuY3JlYXRlLWRiLWluc3RhbmNlLXJlYWQtcmVwbGljYS5wcmUtc2lnbmVkLXVybCcsCgogICAgJ3NhZ2VtYWtlci5jcmVhdGUtbm90ZWJvb2staW5zdGFuY2UuZGVmYXVsdC1jb2RlLXJlcG9zaXRvcnknLAogICAgJ3NhZ2VtYWtlci5jcmVhdGUtbm90ZWJvb2staW5zdGFuY2UuYWRkaXRpb25hbC1jb2RlLXJlcG9zaXRvcmllcycsCiAgICAnc2FnZW1ha2VyLnVwZGF0ZS1ub3RlYm9vay1pbnN0YW5jZS5kZWZhdWx0LWNvZGUtcmVwb3NpdG9yeScsCiAgICAnc2FnZW1ha2VyLnVwZGF0ZS1ub3RlYm9vay1pbnN0YW5jZS5hZGRpdGlvbmFsLWNvZGUtcmVwb3NpdG9yaWVzJywKCiAgICAnc2VydmVybGVzc2FwcGxpY2F0aW9ucmVwb3NpdG9yeS5jcmVhdGUtYXBwbGljYXRpb24uaG9tZS1wYWdlLXVybCcsCiAgICAnc2VydmVybGVzc2FwcGxpY2F0aW9ucmVwb3NpdG9yeS5jcmVhdGUtYXBwbGljYXRpb24ubGljZW5zZS11cmwnLAogICAgJ3NlcnZlcmxlc3NhcHBsaWNhdGlvbnJlcG9zaXRvcnkuY3JlYXRlLWFwcGxpY2F0aW9uLnJlYWRtZS11cmwnLAogICAgJ3NlcnZlcmxlc3NhcHBsaWNhdGlvbnJlcG9zaXRvcnkuY3JlYXRlLWFwcGxpY2F0aW9uLnNvdXJjZS1jb2RlLXVybCcsCiAgICAnc2VydmVybGVzc2FwcGxpY2F0aW9ucmVwb3NpdG9yeS5jcmVhdGUtYXBwbGljYXRpb24udGVtcGxhdGUtdXJsJywKICAgICdzZXJ2ZXJsZXNzYXBwbGljYXRpb25yZXBvc2l0b3J5LmNyZWF0ZS1hcHBsaWNhdGlvbi12ZXJzaW9uLnNvdXJjZS1jb2RlLXVybCcsCiAgICAnc2VydmVybGVzc2FwcGxpY2F0aW9ucmVwb3NpdG9yeS5jcmVhdGUtYXBwbGljYXRpb24tdmVyc2lvbi50ZW1wbGF0ZS11cmwnLAogICAgJ3NlcnZlcmxlc3NhcHBsaWNhdGlvbnJlcG9zaXRvcnkudXBkYXRlLWFwcGxpY2F0aW9uLmhvbWUtcGFnZS11cmwnLAogICAgJ3NlcnZlcmxlc3NhcHBsaWNhdGlvbnJlcG9zaXRvcnkudXBkYXRlLWFwcGxpY2F0aW9uLnJlYWRtZS11cmwnLAoKICAgICdzZXJ2aWNlLWNhdGFsb2cuY3JlYXRlLXByb2R1Y3Quc3VwcG9ydC11cmwnLAogICAgJ3NlcnZpY2UtY2F0YWxvZy51cGRhdGUtcHJvZHVjdC5zdXBwb3J0LXVybCcsCgogICAgJ3Nlcy5wdXQtYWNjb3VudC1kZXRhaWxzLndlYnNpdGUtdXJsJywKCiAgICAnc3FzLmFkZC1wZXJtaXNzaW9uLnF1ZXVlLXVybCcsCiAgICAnc3FzLmNoYW5nZS1tZXNzYWdlLXZpc2liaWxpdHkucXVldWUtdXJsJywKICAgICdzcXMuY2hhbmdlLW1lc3NhZ2UtdmlzaWJpbGl0eS1iYXRjaC5xdWV1ZS11cmwnLAogICAgJ3Nxcy5kZWxldGUtbWVzc2FnZS5xdWV1ZS11cmwnLAogICAgJ3Nxcy5kZWxldGUtbWVzc2FnZS1iYXRjaC5xdWV1ZS11cmwnLAogICAgJ3Nxcy5kZWxldGUtcXVldWUucXVldWUtdXJsJywKICAgICdzcXMuZ2V0LXF1ZXVlLWF0dHJpYnV0ZXMucXVldWUtdXJsJywKICAgICdzcXMubGlzdC1kZWFkLWxldHRlci1zb3VyY2UtcXVldWVzLnF1ZXVlLXVybCcsCiAgICAnc3FzLnJlY2VpdmUtbWVzc2FnZS5xdWV1ZS11cmwnLAogICAgJ3Nxcy5yZW1vdmUtcGVybWlzc2lvbi5xdWV1ZS11cmwnLAogICAgJ3Nxcy5zZW5kLW1lc3NhZ2UucXVldWUtdXJsJywKICAgICdzcXMuc2VuZC1tZXNzYWdlLWJhdGNoLnF1ZXVlLXVybCcsCiAgICAnc3FzLnNldC1xdWV1ZS1hdHRyaWJ1dGVzLnF1ZXVlLXVybCcsCiAgICAnc3FzLnB1cmdlLXF1ZXVlLnF1ZXVlLXVybCcsCiAgICAnc3FzLmxpc3QtcXVldWUtdGFncy5xdWV1ZS11cmwnLAogICAgJ3Nxcy50YWctcXVldWUucXVldWUtdXJsJywKICAgICdzcXMudW50YWctcXVldWUucXVldWUtdXJsJywKCiAgICAnczMuY29weS1vYmplY3Qud2Vic2l0ZS1yZWRpcmVjdC1sb2NhdGlvbicsCiAgICAnczMuY3JlYXRlLW11bHRpcGFydC11cGxvYWQud2Vic2l0ZS1yZWRpcmVjdC1sb2NhdGlvbicsCiAgICAnczMucHV0LW9iamVjdC53ZWJzaXRlLXJlZGlyZWN0LWxvY2F0aW9uJywKCiAgICAjIERvdWJsZSBjaGVjayB0aGF0IHRoaXMgaGFzIGJlZW4gcmVuYW1lZCEKICAgICdzbnMuc3Vic2NyaWJlLm5vdGlmaWNhdGlvbi1lbmRwb2ludCcsCgogICAgJ2lvdC5jcmVhdGUtam9iLmRvY3VtZW50LXNvdXJjZScsCiAgICAndHJhbnNsYXRlLnRyYW5zbGF0ZS10ZXh0LnRleHQnLAoKICAgICd3b3JrZG9jcy5jcmVhdGUtbm90aWZpY2F0aW9uLXN1YnNjcmlwdGlvbi5ub3RpZmljYXRpb24tZW5kcG9pbnQnCl0pCgoKY2xhc3MgUmVzb3VyY2VMb2FkaW5nRXJyb3IoRXhjZXB0aW9uKToKICAgIHBhc3MKCgpkZWYgcmVnaXN0ZXJfdXJpX3BhcmFtX2hhbmRsZXIoc2Vzc2lvbiwgKiprd2FyZ3MpOgogICAgcHJlZml4X21hcCA9IGNvcHkuZGVlcGNvcHkoTE9DQUxfUFJFRklYX01BUCkKICAgIHRyeToKICAgICAgICBmZXRjaF91cmwgPSBzZXNzaW9uLmdldF9zY29wZWRfY29uZmlnKCkuZ2V0KAogICAgICAgICAgICAnY2xpX2ZvbGxvd191cmxwYXJhbScsICd0cnVlJykgPT0gJ3RydWUnCiAgICBleGNlcHQgUHJvZmlsZU5vdEZvdW5kOgogICAgICAgICMgSWYgYSAtLXByb2ZpbGUgaXMgcHJvdmlkZWQgdGhhdCBkb2VzIG5vdCBleGlzdCwgbG9hZGluZwogICAgICAgICMgYSB2YWx1ZSBmcm9tIGdldF9zY29wZWRfY29uZmlnIHdpbGwgY3Jhc2ggdGhlIENMSS4KICAgICAgICAjIFRoaXMgZnVuY3Rpb24gY2FuIGJlIGNhbGxlZCBhcyB0aGUgZmlyc3QgaGFuZGxlciBmb3IKICAgICAgICAjIHRoZSBzZXNzaW9uLWluaXRpYWxpemVkIGV2ZW50LCB3aGljaCBoYXBwZW5zIGJlZm9yZSBhCiAgICAgICAgIyBwcm9maWxlIGNhbiBiZSBjcmVhdGVkLCBldmVuIGlmIHRoZSBjb21tYW5kIHdvdWxkIGhhdmUKICAgICAgICAjIHN1Y2Nlc3NmdWxseSBjcmVhdGVkIGEgcHJvZmlsZS4gSW5zdGVhZCBvZiBjcmFzaGluZyBoZXJlCiAgICAgICAgIyBvbiBhIFByb2ZpbGVOb3RGb3VuZCB0aGUgQ0xJIHNob3VsZCBqdXN0IHVzZSAnbm9uZScuCiAgICAgICAgZmV0Y2hfdXJsID0gVHJ1ZQoKICAgIGlmIGZldGNoX3VybDoKICAgICAgICBwcmVmaXhfbWFwLnVwZGF0ZShSRU1PVEVfUFJFRklYX01BUCkKCiAgICBoYW5kbGVyID0gVVJJQXJndW1lbnRIYW5kbGVyKHByZWZpeF9tYXApCiAgICBzZXNzaW9uLnJlZ2lzdGVyKCdsb2FkLWNsaS1hcmcnLCBoYW5kbGVyKQoKCmNsYXNzIFVSSUFyZ3VtZW50SGFuZGxlcihvYmplY3QpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHByZWZpeGVzPU5vbmUpOgogICAgICAgIGlmIHByZWZpeGVzIGlzIE5vbmU6CiAgICAgICAgICAgIHByZWZpeGVzID0gY29weS5kZWVwY29weShMT0NBTF9QUkVGSVhfTUFQKQogICAgICAgICAgICBwcmVmaXhlcy51cGRhdGUoUkVNT1RFX1BSRUZJWF9NQVApCiAgICAgICAgc2VsZi5fcHJlZml4ZXMgPSBwcmVmaXhlcwoKICAgIGRlZiBfX2NhbGxfXyhzZWxmLCBldmVudF9uYW1lLCBwYXJhbSwgdmFsdWUsICoqa3dhcmdzKToKICAgICAgICAiIiJIYW5kbGVyIHRoYXQgc3VwcG9ydHMgcGFyYW0gdmFsdWVzIGZyb20gVVJJcy4iIiIKICAgICAgICBjbGlfYXJndW1lbnQgPSBwYXJhbQogICAgICAgIHF1YWxpZmllZF9wYXJhbV9uYW1lID0gJy4nLmpvaW4oZXZlbnRfbmFtZS5zcGxpdCgnLicpWzE6XSkKICAgICAgICBpZiBxdWFsaWZpZWRfcGFyYW1fbmFtZSBpbiBQQVJBTUZJTEVfRElTQUJMRUQgb3IgXAogICAgICAgICAgICAgICAgZ2V0YXR0cihjbGlfYXJndW1lbnQsICdub19wYXJhbWZpbGUnLCBOb25lKToKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2NoZWNrX2Zvcl91cmlfcGFyYW0oY2xpX2FyZ3VtZW50LCB2YWx1ZSkKCiAgICBkZWYgX2NoZWNrX2Zvcl91cmlfcGFyYW0oc2VsZiwgcGFyYW0sIHZhbHVlKToKICAgICAgICBpZiBpc2luc3RhbmNlKHZhbHVlLCBsaXN0KSBhbmQgbGVuKHZhbHVlKSA9PSAxOgogICAgICAgICAgICB2YWx1ZSA9IHZhbHVlWzBdCiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXR1cm4gZ2V0X3BhcmFtZmlsZSh2YWx1ZSwgc2VsZi5fcHJlZml4ZXMpCiAgICAgICAgZXhjZXB0IFJlc291cmNlTG9hZGluZ0Vycm9yIGFzIGU6CiAgICAgICAgICAgIHJhaXNlIFBhcmFtRXJyb3IocGFyYW0uY2xpX25hbWUsIHNpeC50ZXh0X3R5cGUoZSkpCgoKZGVmIGdldF9wYXJhbWZpbGUocGF0aCwgY2FzZXMpOgogICAgIiIiTG9hZCBwYXJhbWV0ZXIgYmFzZWQgb24gYSByZXNvdXJjZSBVUkkuCgogICAgSXQgaXMgcG9zc2libGUgdG8gcGFzcyBwYXJhbWV0ZXJzIHRvIG9wZXJhdGlvbnMgYnkgcmVmZXJyaW5nCiAgICB0byBmaWxlcyBvciBVUkkncy4gIElmIHN1Y2ggYSByZWZlcmVuY2UgaXMgZGV0ZWN0ZWQsIHRoaXMKICAgIGZ1bmN0aW9uIGF0dGVtcHRzIHRvIHJldHJpZXZlIHRoZSBkYXRhIGZyb20gdGhlIGZpbGUgb3IgVVJJCiAgICBhbmQgcmV0dXJucyBpdC4gIElmIHRoZXJlIGFyZSBhbnkgZXJyb3JzIG9yIGlmIHRoZSBgYHBhdGhgYAogICAgZG9lcyBub3QgYXBwZWFyIHRvIHJlZmVyIHRvIGEgZmlsZSBvciBVUkksIGEgYGBOb25lYGAgaXMKICAgIHJldHVybmVkLgoKICAgIDp0eXBlIHBhdGg6IHN0cgogICAgOnBhcmFtIHBhdGg6IFRoZSByZXNvdXJjZSBVUkksIGUuZy4gZmlsZTovL2Zvby50eHQuICBUaGlzIHZhbHVlCiAgICAgICAgbWF5IGFsc28gYmUgYSBub24gcmVzb3VyY2UgVVJJLCBpbiB3aGljaCBjYXNlIGBgTm9uZWBgIGlzIHJldHVybmVkLgoKICAgIDp0eXBlIGNhc2VzOiBkaWN0CiAgICA6cGFyYW0gY2FzZXM6IEEgZGljdGlvbmFyeSBvZiBVUkkgcHJlZml4ZXMgdG8gZnVuY3Rpb24gbWFwcGluZ3MKICAgICAgICB0aGF0IGEgcGFyYW1ldGVyIGlzIGNoZWNrZWQgYWdhaW5zdC4KCiAgICA6cmV0dXJuOiBUaGUgbG9hZGVkIHZhbHVlIGFzc29jaWF0ZWQgd2l0aCB0aGUgcmVzb3VyY2UgVVJJLgogICAgICAgIElmIHRoZSBwcm92aWRlZCBgYHBhdGhgYCBpcyBub3QgYSByZXNvdXJjZSBVUkksIHRoZW4gYQogICAgICAgIHZhbHVlIG9mIGBgTm9uZWBgIGlzIHJldHVybmVkLgoKICAgICIiIgogICAgZGF0YSA9IE5vbmUKICAgIGlmIGlzaW5zdGFuY2UocGF0aCwgc2l4LnN0cmluZ190eXBlcyk6CiAgICAgICAgZm9yIHByZWZpeCwgZnVuY3Rpb25fc3BlYyBpbiBjYXNlcy5pdGVtcygpOgogICAgICAgICAgICBpZiBwYXRoLnN0YXJ0c3dpdGgocHJlZml4KToKICAgICAgICAgICAgICAgIGZ1bmN0aW9uLCBrd2FyZ3MgPSBmdW5jdGlvbl9zcGVjCiAgICAgICAgICAgICAgICBkYXRhID0gZnVuY3Rpb24ocHJlZml4LCBwYXRoLCAqKmt3YXJncykKICAgIHJldHVybiBkYXRhCgoKZGVmIGdldF9maWxlKHByZWZpeCwgcGF0aCwgbW9kZSk6CiAgICBmaWxlX3BhdGggPSBvcy5wYXRoLmV4cGFuZHZhcnMob3MucGF0aC5leHBhbmR1c2VyKHBhdGhbbGVuKHByZWZpeCk6XSkpCiAgICB0cnk6CiAgICAgICAgd2l0aCBjb21wYXRfb3BlbihmaWxlX3BhdGgsIG1vZGUpIGFzIGY6CiAgICAgICAgICAgIHJldHVybiBmLnJlYWQoKQogICAgZXhjZXB0IFVuaWNvZGVEZWNvZGVFcnJvcjoKICAgICAgICByYWlzZSBSZXNvdXJjZUxvYWRpbmdFcnJvcigKICAgICAgICAgICAgJ1VuYWJsZSB0byBsb2FkIHBhcmFtZmlsZSAoJXMpLCB0ZXh0IGNvbnRlbnRzIGNvdWxkICcKICAgICAgICAgICAgJ25vdCBiZSBkZWNvZGVkLiAgSWYgdGhpcyBpcyBhIGJpbmFyeSBmaWxlLCBwbGVhc2UgdXNlIHRoZSAnCiAgICAgICAgICAgICdmaWxlYjovLyBwcmVmaXggaW5zdGVhZCBvZiB0aGUgZmlsZTovLyBwcmVmaXguJyAlIGZpbGVfcGF0aCkKICAgIGV4Y2VwdCAoT1NFcnJvciwgSU9FcnJvcikgYXMgZToKICAgICAgICByYWlzZSBSZXNvdXJjZUxvYWRpbmdFcnJvcignVW5hYmxlIHRvIGxvYWQgcGFyYW1maWxlICVzOiAlcycgJSAoCiAgICAgICAgICAgIHBhdGgsIGUpKQoKCmRlZiBnZXRfdXJpKHByZWZpeCwgdXJpKToKICAgIHRyeToKICAgICAgICBzZXNzaW9uID0gVVJMTGliM1Nlc3Npb24oKQogICAgICAgIHIgPSBzZXNzaW9uLnNlbmQoQVdTUmVxdWVzdCgnR0VUJywgdXJpKS5wcmVwYXJlKCkpCiAgICAgICAgaWYgci5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgIHJldHVybiByLnRleHQKICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBSZXNvdXJjZUxvYWRpbmdFcnJvcigKICAgICAgICAgICAgICAgICJyZWNlaXZlZCBub24gMjAwIHN0YXR1cyBjb2RlIG9mICVzIiAlICgKICAgICAgICAgICAgICAgICAgICByLnN0YXR1c19jb2RlKSkKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICByYWlzZSBSZXNvdXJjZUxvYWRpbmdFcnJvcignVW5hYmxlIHRvIHJldHJpZXZlICVzOiAlcycgJSAodXJpLCBlKSkKCgpMT0NBTF9QUkVGSVhfTUFQID0gewogICAgJ2ZpbGU6Ly8nOiAoZ2V0X2ZpbGUsIHsnbW9kZSc6ICdyJ30pLAogICAgJ2ZpbGViOi8vJzogKGdldF9maWxlLCB7J21vZGUnOiAncmInfSksCn0KCgpSRU1PVEVfUFJFRklYX01BUCA9IHsKICAgICdodHRwOi8vJzogKGdldF91cmksIHt9KSwKICAgICdodHRwczovLyc6IChnZXRfdXJpLCB7fSksCn0K
