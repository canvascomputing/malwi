statistics:
  total_files: 1
  skipped_files: 0.0
  processed_objects: 1
  malicious_objects: 0
details:
- path: .repo_cache/malicious_repos/pypi_malregistry/python-aliyun-sdk-core/2.13.36/python-aliyun-sdk-core-2.13.36/python-aliyun-sdk-core-2.13.36/aliyunsdkcore/vendored/requests/packages/chardet/universaldetector.py
  contents:
  - name: UniversalDetector.__init__
    score: 0.0
    code: |-
      def __init__(self, lang_filter=LanguageFilter.ALL):
              self._esc_charset_prober = None
              self._charset_probers = []
              self.result = None
              self.done = None
              self._got_data = None
              self._input_state = None
              self._last_char = None
              self.lang_filter = lang_filter
              self.logger = logging.getLogger(__name__)
              self._has_win_bytes = None
              self.reset()
    tokens: resume load_const load_fast self store_attr STRING_LEN_S_ENT_HIGH build_list load_fast self store_attr STRING_LEN_S_ENT_HIGH load_const load_fast self store_attr result load_const load_fast self store_attr done load_const load_fast self store_attr _got_data load_const load_fast self store_attr _input_state load_const load_fast self store_attr _last_char load_fast lang_filter load_fast self store_attr lang_filter load_global logging load_attr getLogger load_global __name__ call load_fast self store_attr logger load_const load_fast self store_attr _has_win_bytes load_fast self load_attr reset call pop_top return_const None
    hash: fa3757f9c3103f82fc623951f1ed34c2f56142293e929ff86b70cf02bce76e24
sources:
  ? .repo_cache/malicious_repos/pypi_malregistry/python-aliyun-sdk-core/2.13.36/python-aliyun-sdk-core-2.13.36/python-aliyun-sdk-core-2.13.36/aliyunsdkcore/vendored/requests/packages/chardet/universaldetector.py
  : IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIEJFR0lOIExJQ0VOU0UgQkxPQ0sgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMgVGhlIE9yaWdpbmFsIENvZGUgaXMgTW96aWxsYSBVbml2ZXJzYWwgY2hhcnNldCBkZXRlY3RvciBjb2RlLgojCiMgVGhlIEluaXRpYWwgRGV2ZWxvcGVyIG9mIHRoZSBPcmlnaW5hbCBDb2RlIGlzCiMgTmV0c2NhcGUgQ29tbXVuaWNhdGlvbnMgQ29ycG9yYXRpb24uCiMgUG9ydGlvbnMgY3JlYXRlZCBieSB0aGUgSW5pdGlhbCBEZXZlbG9wZXIgYXJlIENvcHlyaWdodCAoQykgMjAwMQojIHRoZSBJbml0aWFsIERldmVsb3Blci4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KIwojIENvbnRyaWJ1dG9yKHMpOgojICAgTWFyayBQaWxncmltIC0gcG9ydCB0byBQeXRob24KIyAgIFNoeSBTaGFsb20gLSBvcmlnaW5hbCBDIGNvZGUKIwojIFRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IKIyBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCiMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyCiMgdmVyc2lvbiAyLjEgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCiMKIyBUaGlzIGxpYnJhcnkgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKIyBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgojIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUgR05VCiMgTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KIwojIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKIyBMaWNlbnNlIGFsb25nIHdpdGggdGhpcyBsaWJyYXJ5OyBpZiBub3QsIHdyaXRlIHRvIHRoZSBGcmVlIFNvZnR3YXJlCiMgRm91bmRhdGlvbiwgSW5jLiwgNTEgRnJhbmtsaW4gU3QsIEZpZnRoIEZsb29yLCBCb3N0b24sIE1BCiMgMDIxMTAtMTMwMSAgVVNBCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgRU5EIExJQ0VOU0UgQkxPQ0sgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoiIiIKTW9kdWxlIGNvbnRhaW5pbmcgdGhlIFVuaXZlcnNhbERldGVjdG9yIGRldGVjdG9yIGNsYXNzLCB3aGljaCBpcyB0aGUgcHJpbWFyeQpjbGFzcyBhIHVzZXIgb2YgYGBjaGFyZGV0YGAgc2hvdWxkIHVzZS4KCjphdXRob3I6IE1hcmsgUGlsZ3JpbSAoaW5pdGlhbCBwb3J0IHRvIFB5dGhvbikKOmF1dGhvcjogU2h5IFNoYWxvbSAob3JpZ2luYWwgQyBjb2RlKQo6YXV0aG9yOiBEYW4gQmxhbmNoYXJkIChtYWpvciByZWZhY3RvcmluZyBmb3IgMy4wKQo6YXV0aG9yOiBJYW4gQ29yZGFzY28KIiIiCgoKaW1wb3J0IGNvZGVjcwppbXBvcnQgbG9nZ2luZwppbXBvcnQgcmUKCmZyb20gLmNoYXJzZXRncm91cHByb2JlciBpbXBvcnQgQ2hhclNldEdyb3VwUHJvYmVyCmZyb20gLmVudW1zIGltcG9ydCBJbnB1dFN0YXRlLCBMYW5ndWFnZUZpbHRlciwgUHJvYmluZ1N0YXRlCmZyb20gLmVzY3Byb2JlciBpbXBvcnQgRXNjQ2hhclNldFByb2Jlcgpmcm9tIC5sYXRpbjFwcm9iZXIgaW1wb3J0IExhdGluMVByb2Jlcgpmcm9tIC5tYmNzZ3JvdXBwcm9iZXIgaW1wb3J0IE1CQ1NHcm91cFByb2Jlcgpmcm9tIC5zYmNzZ3JvdXBwcm9iZXIgaW1wb3J0IFNCQ1NHcm91cFByb2JlcgoKCmNsYXNzIFVuaXZlcnNhbERldGVjdG9yKG9iamVjdCk6CiAgICAiIiIKICAgIFRoZSBgYFVuaXZlcnNhbERldGVjdG9yYGAgY2xhc3MgdW5kZXJsaWVzIHRoZSBgYGNoYXJkZXQuZGV0ZWN0YGAgZnVuY3Rpb24KICAgIGFuZCBjb29yZGluYXRlcyBhbGwgb2YgdGhlIGRpZmZlcmVudCBjaGFyc2V0IHByb2JlcnMuCgogICAgVG8gZ2V0IGEgYGBkaWN0YGAgY29udGFpbmluZyBhbiBlbmNvZGluZyBhbmQgaXRzIGNvbmZpZGVuY2UsIHlvdSBjYW4gc2ltcGx5CiAgICBydW46CgogICAgLi4gY29kZTo6CgogICAgICAgICAgICB1ID0gVW5pdmVyc2FsRGV0ZWN0b3IoKQogICAgICAgICAgICB1LmZlZWQoc29tZV9ieXRlcykKICAgICAgICAgICAgdS5jbG9zZSgpCiAgICAgICAgICAgIGRldGVjdGVkID0gdS5yZXN1bHQKCiAgICAiIiIKCiAgICBNSU5JTVVNX1RIUkVTSE9MRCA9IDAuMjAKICAgIEhJR0hfQllURV9ERVRFQ1RPUiA9IHJlLmNvbXBpbGUoYidbXHg4MC1ceEZGXScpCiAgICBFU0NfREVURUNUT1IgPSByZS5jb21waWxlKGInKFwwMzN8fnspJykKICAgIFdJTl9CWVRFX0RFVEVDVE9SID0gcmUuY29tcGlsZShiJ1tceDgwLVx4OUZdJykKICAgIElTT19XSU5fTUFQID0geydpc28tODg1OS0xJzogJ1dpbmRvd3MtMTI1MicsCiAgICAgICAgICAgICAgICAgICAnaXNvLTg4NTktMic6ICdXaW5kb3dzLTEyNTAnLAogICAgICAgICAgICAgICAgICAgJ2lzby04ODU5LTUnOiAnV2luZG93cy0xMjUxJywKICAgICAgICAgICAgICAgICAgICdpc28tODg1OS02JzogJ1dpbmRvd3MtMTI1NicsCiAgICAgICAgICAgICAgICAgICAnaXNvLTg4NTktNyc6ICdXaW5kb3dzLTEyNTMnLAogICAgICAgICAgICAgICAgICAgJ2lzby04ODU5LTgnOiAnV2luZG93cy0xMjU1JywKICAgICAgICAgICAgICAgICAgICdpc28tODg1OS05JzogJ1dpbmRvd3MtMTI1NCcsCiAgICAgICAgICAgICAgICAgICAnaXNvLTg4NTktMTMnOiAnV2luZG93cy0xMjU3J30KCiAgICBkZWYgX19pbml0X18oc2VsZiwgbGFuZ19maWx0ZXI9TGFuZ3VhZ2VGaWx0ZXIuQUxMKToKICAgICAgICBzZWxmLl9lc2NfY2hhcnNldF9wcm9iZXIgPSBOb25lCiAgICAgICAgc2VsZi5fY2hhcnNldF9wcm9iZXJzID0gW10KICAgICAgICBzZWxmLnJlc3VsdCA9IE5vbmUKICAgICAgICBzZWxmLmRvbmUgPSBOb25lCiAgICAgICAgc2VsZi5fZ290X2RhdGEgPSBOb25lCiAgICAgICAgc2VsZi5faW5wdXRfc3RhdGUgPSBOb25lCiAgICAgICAgc2VsZi5fbGFzdF9jaGFyID0gTm9uZQogICAgICAgIHNlbGYubGFuZ19maWx0ZXIgPSBsYW5nX2ZpbHRlcgogICAgICAgIHNlbGYubG9nZ2VyID0gbG9nZ2luZy5nZXRMb2dnZXIoX19uYW1lX18pCiAgICAgICAgc2VsZi5faGFzX3dpbl9ieXRlcyA9IE5vbmUKICAgICAgICBzZWxmLnJlc2V0KCkKCiAgICBkZWYgcmVzZXQoc2VsZik6CiAgICAgICAgIiIiCiAgICAgICAgUmVzZXQgdGhlIFVuaXZlcnNhbERldGVjdG9yIGFuZCBhbGwgb2YgaXRzIHByb2JlcnMgYmFjayB0byB0aGVpcgogICAgICAgIGluaXRpYWwgc3RhdGVzLiAgVGhpcyBpcyBjYWxsZWQgYnkgYGBfX2luaXRfX2BgLCBzbyB5b3Ugb25seSBuZWVkIHRvCiAgICAgICAgY2FsbCB0aGlzIGRpcmVjdGx5IGluIGJldHdlZW4gYW5hbHlzZXMgb2YgZGlmZmVyZW50IGRvY3VtZW50cy4KICAgICAgICAiIiIKICAgICAgICBzZWxmLnJlc3VsdCA9IHsnZW5jb2RpbmcnOiBOb25lLCAnY29uZmlkZW5jZSc6IDAuMCwgJ2xhbmd1YWdlJzogTm9uZX0KICAgICAgICBzZWxmLmRvbmUgPSBGYWxzZQogICAgICAgIHNlbGYuX2dvdF9kYXRhID0gRmFsc2UKICAgICAgICBzZWxmLl9oYXNfd2luX2J5dGVzID0gRmFsc2UKICAgICAgICBzZWxmLl9pbnB1dF9zdGF0ZSA9IElucHV0U3RhdGUuUFVSRV9BU0NJSQogICAgICAgIHNlbGYuX2xhc3RfY2hhciA9IGInJwogICAgICAgIGlmIHNlbGYuX2VzY19jaGFyc2V0X3Byb2JlcjoKICAgICAgICAgICAgc2VsZi5fZXNjX2NoYXJzZXRfcHJvYmVyLnJlc2V0KCkKICAgICAgICBmb3IgcHJvYmVyIGluIHNlbGYuX2NoYXJzZXRfcHJvYmVyczoKICAgICAgICAgICAgcHJvYmVyLnJlc2V0KCkKCiAgICBkZWYgZmVlZChzZWxmLCBieXRlX3N0cik6CiAgICAgICAgIiIiCiAgICAgICAgVGFrZXMgYSBjaHVuayBvZiBhIGRvY3VtZW50IGFuZCBmZWVkcyBpdCB0aHJvdWdoIGFsbCBvZiB0aGUgcmVsZXZhbnQKICAgICAgICBjaGFyc2V0IHByb2JlcnMuCgogICAgICAgIEFmdGVyIGNhbGxpbmcgYGBmZWVkYGAsIHlvdSBjYW4gY2hlY2sgdGhlIHZhbHVlIG9mIHRoZSBgYGRvbmVgYAogICAgICAgIGF0dHJpYnV0ZSB0byBzZWUgaWYgeW91IG5lZWQgdG8gY29udGludWUgZmVlZGluZyB0aGUKICAgICAgICBgYFVuaXZlcnNhbERldGVjdG9yYGAgbW9yZSBkYXRhLCBvciBpZiBpdCBoYXMgbWFkZSBhIHByZWRpY3Rpb24KICAgICAgICAoaW4gdGhlIGBgcmVzdWx0YGAgYXR0cmlidXRlKS4KCiAgICAgICAgLi4gbm90ZTo6CiAgICAgICAgICAgWW91IHNob3VsZCBhbHdheXMgY2FsbCBgYGNsb3NlYGAgd2hlbiB5b3UncmUgZG9uZSBmZWVkaW5nIGluIHlvdXIKICAgICAgICAgICBkb2N1bWVudCBpZiBgYGRvbmVgYCBpcyBub3QgYWxyZWFkeSBgYFRydWVgYC4KICAgICAgICAiIiIKICAgICAgICBpZiBzZWxmLmRvbmU6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBpZiBub3QgbGVuKGJ5dGVfc3RyKToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKGJ5dGVfc3RyLCBieXRlYXJyYXkpOgogICAgICAgICAgICBieXRlX3N0ciA9IGJ5dGVhcnJheShieXRlX3N0cikKCiAgICAgICAgIyBGaXJzdCBjaGVjayBmb3Iga25vd24gQk9Ncywgc2luY2UgdGhlc2UgYXJlIGd1YXJhbnRlZWQgdG8gYmUgY29ycmVjdAogICAgICAgIGlmIG5vdCBzZWxmLl9nb3RfZGF0YToKICAgICAgICAgICAgIyBJZiB0aGUgZGF0YSBzdGFydHMgd2l0aCBCT00sIHdlIGtub3cgaXQgaXMgVVRGCiAgICAgICAgICAgIGlmIGJ5dGVfc3RyLnN0YXJ0c3dpdGgoY29kZWNzLkJPTV9VVEY4KToKICAgICAgICAgICAgICAgICMgRUYgQkIgQkYgIFVURi04IHdpdGggQk9NCiAgICAgICAgICAgICAgICBzZWxmLnJlc3VsdCA9IHsnZW5jb2RpbmcnOiAiVVRGLTgtU0lHIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb25maWRlbmNlJzogMS4wLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2xhbmd1YWdlJzogJyd9CiAgICAgICAgICAgIGVsaWYgYnl0ZV9zdHIuc3RhcnRzd2l0aCgoY29kZWNzLkJPTV9VVEYzMl9MRSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2RlY3MuQk9NX1VURjMyX0JFKSk6CiAgICAgICAgICAgICAgICAjIEZGIEZFIDAwIDAwICBVVEYtMzIsIGxpdHRsZS1lbmRpYW4gQk9NCiAgICAgICAgICAgICAgICAjIDAwIDAwIEZFIEZGICBVVEYtMzIsIGJpZy1lbmRpYW4gQk9NCiAgICAgICAgICAgICAgICBzZWxmLnJlc3VsdCA9IHsnZW5jb2RpbmcnOiAiVVRGLTMyIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb25maWRlbmNlJzogMS4wLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2xhbmd1YWdlJzogJyd9CiAgICAgICAgICAgIGVsaWYgYnl0ZV9zdHIuc3RhcnRzd2l0aChiJ1x4RkVceEZGXHgwMFx4MDAnKToKICAgICAgICAgICAgICAgICMgRkUgRkYgMDAgMDAgIFVDUy00LCB1bnVzdWFsIG9jdGV0IG9yZGVyIEJPTSAoMzQxMikKICAgICAgICAgICAgICAgIHNlbGYucmVzdWx0ID0geydlbmNvZGluZyc6ICJYLUlTTy0xMDY0Ni1VQ1MtNC0zNDEyIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb25maWRlbmNlJzogMS4wLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2xhbmd1YWdlJzogJyd9CiAgICAgICAgICAgIGVsaWYgYnl0ZV9zdHIuc3RhcnRzd2l0aChiJ1x4MDBceDAwXHhGRlx4RkUnKToKICAgICAgICAgICAgICAgICMgMDAgMDAgRkYgRkUgIFVDUy00LCB1bnVzdWFsIG9jdGV0IG9yZGVyIEJPTSAoMjE0MykKICAgICAgICAgICAgICAgIHNlbGYucmVzdWx0ID0geydlbmNvZGluZyc6ICJYLUlTTy0xMDY0Ni1VQ1MtNC0yMTQzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb25maWRlbmNlJzogMS4wLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2xhbmd1YWdlJzogJyd9CiAgICAgICAgICAgIGVsaWYgYnl0ZV9zdHIuc3RhcnRzd2l0aCgoY29kZWNzLkJPTV9MRSwgY29kZWNzLkJPTV9CRSkpOgogICAgICAgICAgICAgICAgIyBGRiBGRSAgVVRGLTE2LCBsaXR0bGUgZW5kaWFuIEJPTQogICAgICAgICAgICAgICAgIyBGRSBGRiAgVVRGLTE2LCBiaWcgZW5kaWFuIEJPTQogICAgICAgICAgICAgICAgc2VsZi5yZXN1bHQgPSB7J2VuY29kaW5nJzogIlVURi0xNiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY29uZmlkZW5jZSc6IDEuMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdsYW5ndWFnZSc6ICcnfQoKICAgICAgICAgICAgc2VsZi5fZ290X2RhdGEgPSBUcnVlCiAgICAgICAgICAgIGlmIHNlbGYucmVzdWx0WydlbmNvZGluZyddIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgc2VsZi5kb25lID0gVHJ1ZQogICAgICAgICAgICAgICAgcmV0dXJuCgogICAgICAgICMgSWYgbm9uZSBvZiB0aG9zZSBtYXRjaGVkIGFuZCB3ZSd2ZSBvbmx5IHNlZSBBU0NJSSBzbyBmYXIsIGNoZWNrCiAgICAgICAgIyBmb3IgaGlnaCBieXRlcyBhbmQgZXNjYXBlIHNlcXVlbmNlcwogICAgICAgIGlmIHNlbGYuX2lucHV0X3N0YXRlID09IElucHV0U3RhdGUuUFVSRV9BU0NJSToKICAgICAgICAgICAgaWYgc2VsZi5ISUdIX0JZVEVfREVURUNUT1Iuc2VhcmNoKGJ5dGVfc3RyKToKICAgICAgICAgICAgICAgIHNlbGYuX2lucHV0X3N0YXRlID0gSW5wdXRTdGF0ZS5ISUdIX0JZVEUKICAgICAgICAgICAgZWxpZiBzZWxmLl9pbnB1dF9zdGF0ZSA9PSBJbnB1dFN0YXRlLlBVUkVfQVNDSUkgYW5kIFwKICAgICAgICAgICAgICAgICAgICBzZWxmLkVTQ19ERVRFQ1RPUi5zZWFyY2goc2VsZi5fbGFzdF9jaGFyICsgYnl0ZV9zdHIpOgogICAgICAgICAgICAgICAgc2VsZi5faW5wdXRfc3RhdGUgPSBJbnB1dFN0YXRlLkVTQ19BU0NJSQoKICAgICAgICBzZWxmLl9sYXN0X2NoYXIgPSBieXRlX3N0clstMTpdCgogICAgICAgICMgSWYgd2UndmUgc2VlbiBlc2NhcGUgc2VxdWVuY2VzLCB1c2UgdGhlIEVzY0NoYXJTZXRQcm9iZXIsIHdoaWNoCiAgICAgICAgIyB1c2VzIGEgc2ltcGxlIHN0YXRlIG1hY2hpbmUgdG8gY2hlY2sgZm9yIGtub3duIGVzY2FwZSBzZXF1ZW5jZXMgaW4KICAgICAgICAjIEhaIGFuZCBJU08tMjAyMiBlbmNvZGluZ3MsIHNpbmNlIHRob3NlIGFyZSB0aGUgb25seSBlbmNvZGluZ3MgdGhhdAogICAgICAgICMgdXNlIHN1Y2ggc2VxdWVuY2VzLgogICAgICAgIGlmIHNlbGYuX2lucHV0X3N0YXRlID09IElucHV0U3RhdGUuRVNDX0FTQ0lJOgogICAgICAgICAgICBpZiBub3Qgc2VsZi5fZXNjX2NoYXJzZXRfcHJvYmVyOgogICAgICAgICAgICAgICAgc2VsZi5fZXNjX2NoYXJzZXRfcHJvYmVyID0gRXNjQ2hhclNldFByb2JlcihzZWxmLmxhbmdfZmlsdGVyKQogICAgICAgICAgICBpZiBzZWxmLl9lc2NfY2hhcnNldF9wcm9iZXIuZmVlZChieXRlX3N0cikgPT0gUHJvYmluZ1N0YXRlLkZPVU5EX0lUOgogICAgICAgICAgICAgICAgc2VsZi5yZXN1bHQgPSB7J2VuY29kaW5nJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2VzY19jaGFyc2V0X3Byb2Jlci5jaGFyc2V0X25hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY29uZmlkZW5jZSc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9lc2NfY2hhcnNldF9wcm9iZXIuZ2V0X2NvbmZpZGVuY2UoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdsYW5ndWFnZSc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9lc2NfY2hhcnNldF9wcm9iZXIubGFuZ3VhZ2V9CiAgICAgICAgICAgICAgICBzZWxmLmRvbmUgPSBUcnVlCiAgICAgICAgIyBJZiB3ZSd2ZSBzZWVuIGhpZ2ggYnl0ZXMgKGkuZS4sIHRob3NlIHdpdGggdmFsdWVzIGdyZWF0ZXIgdGhhbiAxMjcpLAogICAgICAgICMgd2UgbmVlZCB0byBkbyBtb3JlIGNvbXBsaWNhdGVkIGNoZWNrcyB1c2luZyBhbGwgb3VyIG11bHRpLWJ5dGUgYW5kCiAgICAgICAgIyBzaW5nbGUtYnl0ZSBwcm9iZXJzIHRoYXQgYXJlIGxlZnQuICBUaGUgc2luZ2xlLWJ5dGUgcHJvYmVycwogICAgICAgICMgdXNlIGNoYXJhY3RlciBiaWdyYW0gZGlzdHJpYnV0aW9ucyB0byBkZXRlcm1pbmUgdGhlIGVuY29kaW5nLCB3aGVyZWFzCiAgICAgICAgIyB0aGUgbXVsdGktYnl0ZSBwcm9iZXJzIHVzZSBhIGNvbWJpbmF0aW9uIG9mIGNoYXJhY3RlciB1bmlncmFtIGFuZAogICAgICAgICMgYmlncmFtIGRpc3RyaWJ1dGlvbnMuCiAgICAgICAgZWxpZiBzZWxmLl9pbnB1dF9zdGF0ZSA9PSBJbnB1dFN0YXRlLkhJR0hfQllURToKICAgICAgICAgICAgaWYgbm90IHNlbGYuX2NoYXJzZXRfcHJvYmVyczoKICAgICAgICAgICAgICAgIHNlbGYuX2NoYXJzZXRfcHJvYmVycyA9IFtNQkNTR3JvdXBQcm9iZXIoc2VsZi5sYW5nX2ZpbHRlcildCiAgICAgICAgICAgICAgICAjIElmIHdlJ3JlIGNoZWNraW5nIG5vbi1DSksgZW5jb2RpbmdzLCB1c2Ugc2luZ2xlLWJ5dGUgcHJvYmVyCiAgICAgICAgICAgICAgICBpZiBzZWxmLmxhbmdfZmlsdGVyICYgTGFuZ3VhZ2VGaWx0ZXIuTk9OX0NKSzoKICAgICAgICAgICAgICAgICAgICBzZWxmLl9jaGFyc2V0X3Byb2JlcnMuYXBwZW5kKFNCQ1NHcm91cFByb2JlcigpKQogICAgICAgICAgICAgICAgc2VsZi5fY2hhcnNldF9wcm9iZXJzLmFwcGVuZChMYXRpbjFQcm9iZXIoKSkKICAgICAgICAgICAgZm9yIHByb2JlciBpbiBzZWxmLl9jaGFyc2V0X3Byb2JlcnM6CiAgICAgICAgICAgICAgICBpZiBwcm9iZXIuZmVlZChieXRlX3N0cikgPT0gUHJvYmluZ1N0YXRlLkZPVU5EX0lUOgogICAgICAgICAgICAgICAgICAgIHNlbGYucmVzdWx0ID0geydlbmNvZGluZyc6IHByb2Jlci5jaGFyc2V0X25hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NvbmZpZGVuY2UnOiBwcm9iZXIuZ2V0X2NvbmZpZGVuY2UoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbGFuZ3VhZ2UnOiBwcm9iZXIubGFuZ3VhZ2V9CiAgICAgICAgICAgICAgICAgICAgc2VsZi5kb25lID0gVHJ1ZQogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGlmIHNlbGYuV0lOX0JZVEVfREVURUNUT1Iuc2VhcmNoKGJ5dGVfc3RyKToKICAgICAgICAgICAgICAgIHNlbGYuX2hhc193aW5fYnl0ZXMgPSBUcnVlCgogICAgZGVmIGNsb3NlKHNlbGYpOgogICAgICAgICIiIgogICAgICAgIFN0b3AgYW5hbHl6aW5nIHRoZSBjdXJyZW50IGRvY3VtZW50IGFuZCBjb21lIHVwIHdpdGggYSBmaW5hbAogICAgICAgIHByZWRpY3Rpb24uCgogICAgICAgIDpyZXR1cm5zOiAgVGhlIGBgcmVzdWx0YGAgYXR0cmlidXRlLCBhIGBgZGljdGBgIHdpdGggdGhlIGtleXMKICAgICAgICAgICAgICAgICAgIGBlbmNvZGluZ2AsIGBjb25maWRlbmNlYCwgYW5kIGBsYW5ndWFnZWAuCiAgICAgICAgIiIiCiAgICAgICAgIyBEb24ndCBib3RoZXIgd2l0aCBjaGVja3MgaWYgd2UncmUgYWxyZWFkeSBkb25lCiAgICAgICAgaWYgc2VsZi5kb25lOgogICAgICAgICAgICByZXR1cm4gc2VsZi5yZXN1bHQKICAgICAgICBzZWxmLmRvbmUgPSBUcnVlCgogICAgICAgIGlmIG5vdCBzZWxmLl9nb3RfZGF0YToKICAgICAgICAgICAgc2VsZi5sb2dnZXIuZGVidWcoJ25vIGRhdGEgcmVjZWl2ZWQhJykKCiAgICAgICAgIyBEZWZhdWx0IHRvIEFTQ0lJIGlmIGl0IGlzIGFsbCB3ZSd2ZSBzZWVuIHNvIGZhcgogICAgICAgIGVsaWYgc2VsZi5faW5wdXRfc3RhdGUgPT0gSW5wdXRTdGF0ZS5QVVJFX0FTQ0lJOgogICAgICAgICAgICBzZWxmLnJlc3VsdCA9IHsnZW5jb2RpbmcnOiAnYXNjaWknLAogICAgICAgICAgICAgICAgICAgICAgICAgICAnY29uZmlkZW5jZSc6IDEuMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2xhbmd1YWdlJzogJyd9CgogICAgICAgICMgSWYgd2UgaGF2ZSBzZWVuIG5vbi1BU0NJSSwgcmV0dXJuIHRoZSBiZXN0IHRoYXQgbWV0IE1JTklNVU1fVEhSRVNIT0xECiAgICAgICAgZWxpZiBzZWxmLl9pbnB1dF9zdGF0ZSA9PSBJbnB1dFN0YXRlLkhJR0hfQllURToKICAgICAgICAgICAgcHJvYmVyX2NvbmZpZGVuY2UgPSBOb25lCiAgICAgICAgICAgIG1heF9wcm9iZXJfY29uZmlkZW5jZSA9IDAuMAogICAgICAgICAgICBtYXhfcHJvYmVyID0gTm9uZQogICAgICAgICAgICBmb3IgcHJvYmVyIGluIHNlbGYuX2NoYXJzZXRfcHJvYmVyczoKICAgICAgICAgICAgICAgIGlmIG5vdCBwcm9iZXI6CiAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgIHByb2Jlcl9jb25maWRlbmNlID0gcHJvYmVyLmdldF9jb25maWRlbmNlKCkKICAgICAgICAgICAgICAgIGlmIHByb2Jlcl9jb25maWRlbmNlID4gbWF4X3Byb2Jlcl9jb25maWRlbmNlOgogICAgICAgICAgICAgICAgICAgIG1heF9wcm9iZXJfY29uZmlkZW5jZSA9IHByb2Jlcl9jb25maWRlbmNlCiAgICAgICAgICAgICAgICAgICAgbWF4X3Byb2JlciA9IHByb2JlcgogICAgICAgICAgICBpZiBtYXhfcHJvYmVyIGFuZCAobWF4X3Byb2Jlcl9jb25maWRlbmNlID4gc2VsZi5NSU5JTVVNX1RIUkVTSE9MRCk6CiAgICAgICAgICAgICAgICBjaGFyc2V0X25hbWUgPSBtYXhfcHJvYmVyLmNoYXJzZXRfbmFtZQogICAgICAgICAgICAgICAgbG93ZXJfY2hhcnNldF9uYW1lID0gbWF4X3Byb2Jlci5jaGFyc2V0X25hbWUubG93ZXIoKQogICAgICAgICAgICAgICAgY29uZmlkZW5jZSA9IG1heF9wcm9iZXIuZ2V0X2NvbmZpZGVuY2UoKQogICAgICAgICAgICAgICAgIyBVc2UgV2luZG93cyBlbmNvZGluZyBuYW1lIGluc3RlYWQgb2YgSVNPLTg4NTkgaWYgd2Ugc2F3IGFueQogICAgICAgICAgICAgICAgIyBleHRyYSBXaW5kb3dzLXNwZWNpZmljIGJ5dGVzCiAgICAgICAgICAgICAgICBpZiBsb3dlcl9jaGFyc2V0X25hbWUuc3RhcnRzd2l0aCgnaXNvLTg4NTknKToKICAgICAgICAgICAgICAgICAgICBpZiBzZWxmLl9oYXNfd2luX2J5dGVzOgogICAgICAgICAgICAgICAgICAgICAgICBjaGFyc2V0X25hbWUgPSBzZWxmLklTT19XSU5fTUFQLmdldChsb3dlcl9jaGFyc2V0X25hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJzZXRfbmFtZSkKICAgICAgICAgICAgICAgIHNlbGYucmVzdWx0ID0geydlbmNvZGluZyc6IGNoYXJzZXRfbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb25maWRlbmNlJzogY29uZmlkZW5jZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdsYW5ndWFnZSc6IG1heF9wcm9iZXIubGFuZ3VhZ2V9CgogICAgICAgICMgTG9nIGFsbCBwcm9iZXIgY29uZmlkZW5jZXMgaWYgbm9uZSBtZXQgTUlOSU1VTV9USFJFU0hPTEQKICAgICAgICBpZiBzZWxmLmxvZ2dlci5nZXRFZmZlY3RpdmVMZXZlbCgpID09IGxvZ2dpbmcuREVCVUc6CiAgICAgICAgICAgIGlmIHNlbGYucmVzdWx0WydlbmNvZGluZyddIGlzIE5vbmU6CiAgICAgICAgICAgICAgICBzZWxmLmxvZ2dlci5kZWJ1Zygnbm8gcHJvYmVycyBoaXQgbWluaW11bSB0aHJlc2hvbGQnKQogICAgICAgICAgICAgICAgZm9yIGdyb3VwX3Byb2JlciBpbiBzZWxmLl9jaGFyc2V0X3Byb2JlcnM6CiAgICAgICAgICAgICAgICAgICAgaWYgbm90IGdyb3VwX3Byb2JlcjoKICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKGdyb3VwX3Byb2JlciwgQ2hhclNldEdyb3VwUHJvYmVyKToKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIHByb2JlciBpbiBncm91cF9wcm9iZXIucHJvYmVyczoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubG9nZ2VyLmRlYnVnKCclcyAlcyBjb25maWRlbmNlID0gJXMnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvYmVyLmNoYXJzZXRfbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Jlci5sYW5ndWFnZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Jlci5nZXRfY29uZmlkZW5jZSgpKQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubG9nZ2VyLmRlYnVnKCclcyAlcyBjb25maWRlbmNlID0gJXMnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9iZXIuY2hhcnNldF9uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9iZXIubGFuZ3VhZ2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Jlci5nZXRfY29uZmlkZW5jZSgpKQogICAgICAgIHJldHVybiBzZWxmLnJlc3VsdAo=
