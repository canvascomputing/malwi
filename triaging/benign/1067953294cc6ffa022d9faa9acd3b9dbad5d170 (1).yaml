statistics:
  total_files: 1
  skipped_files: 0.0
  processed_objects: 1
  malicious_objects: 0
details:
- path: .repo_cache/malicious_repos/pypi_malregistry/urlib3/1.21.1/urlib3-1.21.1/urlib3-1.21.1/dummyserver/server.py
  contents:
  - name: _has_ipv6
    score: 0.0
    code: |-
      def _has_ipv6(host):
          """ Returns True if the system can bind an IPv6 address. """
          sock = None
          has_ipv6 = False

          if socket.has_ipv6:
              # has_ipv6 returns true if cPython was compiled with IPv6 support.
              # It does not tell us if the system has IPv6 support enabled. To
              # determine that we must bind to an IPv6 address.
              # https://github.com/shazow/urllib3/pull/611
              # https://bugs.python.org/issue658327
              try:
                  sock = socket.socket(socket.AF_INET6)
                  sock.bind((host, 0))
                  has_ipv6 = True
              except:
                  pass

          if sock:
              sock.close()
          return has_ipv6
    tokens: resume load_const store_fast sock load_const INTEGER store_fast has_ipv6 load_global socket load_attr has_ipv6 pop_jump_if_false TO_NUMBER nop load_global socket load_attr socket load_global socket load_attr AF_INET6 call store_fast sock load_fast sock load_attr bind load_fast host load_const INTEGER build_tuple call pop_top load_const INTEGER store_fast has_ipv6 load_fast sock pop_jump_if_false TO_NUMBER load_fast sock load_attr close call pop_top load_fast has_ipv6 return_value push_exc_info pop_top pop_except jump_backward TO_NUMBER copy pop_except reraise
    hash: 92ca01e750ee713cad04bdb62b63436afbb8a1c8c329cbce348c4c3ad2142109
sources:
  .repo_cache/malicious_repos/pypi_malregistry/urlib3/1.21.1/urlib3-1.21.1/urlib3-1.21.1/dummyserver/server.py: IyEvdXNyL2Jpbi9lbnYgcHl0aG9uCgoiIiIKRHVtbXkgc2VydmVyIHVzZWQgZm9yIHVuaXQgdGVzdGluZy4KIiIiCmZyb20gX19mdXR1cmVfXyBpbXBvcnQgcHJpbnRfZnVuY3Rpb24KCmltcG9ydCBlcnJubwppbXBvcnQgbG9nZ2luZwppbXBvcnQgb3MKaW1wb3J0IHJhbmRvbQppbXBvcnQgc3RyaW5nCmltcG9ydCBzeXMKaW1wb3J0IHRocmVhZGluZwppbXBvcnQgc29ja2V0CmltcG9ydCB3YXJuaW5ncwpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQoKZnJvbSB1cmxsaWIzLmV4Y2VwdGlvbnMgaW1wb3J0IEhUVFBXYXJuaW5nCgpmcm9tIHRvcm5hZG8ucGxhdGZvcm0uYXV0byBpbXBvcnQgc2V0X2Nsb3NlX2V4ZWMKaW1wb3J0IHRvcm5hZG8uaHR0cHNlcnZlcgppbXBvcnQgdG9ybmFkby5pb2xvb3AKaW1wb3J0IHRvcm5hZG8ud2ViCgoKbG9nID0gbG9nZ2luZy5nZXRMb2dnZXIoX19uYW1lX18pCgpDRVJUU19QQVRIID0gb3MucGF0aC5qb2luKG9zLnBhdGguZGlybmFtZShfX2ZpbGVfXyksICdjZXJ0cycpCkRFRkFVTFRfQ0VSVFMgPSB7CiAgICAnY2VydGZpbGUnOiBvcy5wYXRoLmpvaW4oQ0VSVFNfUEFUSCwgJ3NlcnZlci5jcnQnKSwKICAgICdrZXlmaWxlJzogb3MucGF0aC5qb2luKENFUlRTX1BBVEgsICdzZXJ2ZXIua2V5JyksCn0KTk9fU0FOX0NFUlRTID0gewogICAgJ2NlcnRmaWxlJzogb3MucGF0aC5qb2luKENFUlRTX1BBVEgsICdzZXJ2ZXIubm9fc2FuLmNydCcpLAogICAgJ2tleWZpbGUnOiBERUZBVUxUX0NFUlRTWydrZXlmaWxlJ10KfQpJUF9TQU5fQ0VSVFMgPSB7CiAgICAnY2VydGZpbGUnOiBvcy5wYXRoLmpvaW4oQ0VSVFNfUEFUSCwgJ3NlcnZlci5pcF9zYW4uY3J0JyksCiAgICAna2V5ZmlsZSc6IERFRkFVTFRfQ0VSVFNbJ2tleWZpbGUnXQp9CklQVjZfQUREUl9DRVJUUyA9IHsKICAgICdjZXJ0ZmlsZSc6IG9zLnBhdGguam9pbihDRVJUU19QQVRILCAnc2VydmVyLmlwdjZhZGRyLmNydCcpLAogICAgJ2tleWZpbGUnOiBvcy5wYXRoLmpvaW4oQ0VSVFNfUEFUSCwgJ3NlcnZlci5pcHY2YWRkci5rZXknKSwKfQpERUZBVUxUX0NBID0gb3MucGF0aC5qb2luKENFUlRTX1BBVEgsICdjYWNlcnQucGVtJykKREVGQVVMVF9DQV9CQUQgPSBvcy5wYXRoLmpvaW4oQ0VSVFNfUEFUSCwgJ2NsaWVudF9iYWQucGVtJykKTk9fU0FOX0NBID0gb3MucGF0aC5qb2luKENFUlRTX1BBVEgsICdjYWNlcnQubm9fc2FuLnBlbScpCkRFRkFVTFRfQ0FfRElSID0gb3MucGF0aC5qb2luKENFUlRTX1BBVEgsICdjYV9wYXRoX3Rlc3QnKQpJUFY2X0FERFJfQ0EgPSBvcy5wYXRoLmpvaW4oQ0VSVFNfUEFUSCwgJ3NlcnZlci5pcHY2YWRkci5jcnQnKQpDT01CSU5FRF9DRVJUX0FORF9LRVkgPSBvcy5wYXRoLmpvaW4oQ0VSVFNfUEFUSCwgJ3NlcnZlci5jb21iaW5lZC5wZW0nKQoKCmRlZiBfaGFzX2lwdjYoaG9zdCk6CiAgICAiIiIgUmV0dXJucyBUcnVlIGlmIHRoZSBzeXN0ZW0gY2FuIGJpbmQgYW4gSVB2NiBhZGRyZXNzLiAiIiIKICAgIHNvY2sgPSBOb25lCiAgICBoYXNfaXB2NiA9IEZhbHNlCgogICAgaWYgc29ja2V0Lmhhc19pcHY2OgogICAgICAgICMgaGFzX2lwdjYgcmV0dXJucyB0cnVlIGlmIGNQeXRob24gd2FzIGNvbXBpbGVkIHdpdGggSVB2NiBzdXBwb3J0LgogICAgICAgICMgSXQgZG9lcyBub3QgdGVsbCB1cyBpZiB0aGUgc3lzdGVtIGhhcyBJUHY2IHN1cHBvcnQgZW5hYmxlZC4gVG8KICAgICAgICAjIGRldGVybWluZSB0aGF0IHdlIG11c3QgYmluZCB0byBhbiBJUHY2IGFkZHJlc3MuCiAgICAgICAgIyBodHRwczovL2dpdGh1Yi5jb20vc2hhem93L3VybGxpYjMvcHVsbC82MTEKICAgICAgICAjIGh0dHBzOi8vYnVncy5weXRob24ub3JnL2lzc3VlNjU4MzI3CiAgICAgICAgdHJ5OgogICAgICAgICAgICBzb2NrID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVDYpCiAgICAgICAgICAgIHNvY2suYmluZCgoaG9zdCwgMCkpCiAgICAgICAgICAgIGhhc19pcHY2ID0gVHJ1ZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcGFzcwoKICAgIGlmIHNvY2s6CiAgICAgICAgc29jay5jbG9zZSgpCiAgICByZXR1cm4gaGFzX2lwdjYKCgojIFNvbWUgc3lzdGVtcyBtYXkgaGF2ZSBJUHY2IHN1cHBvcnQgYnV0IEROUyBtYXkgbm90IGJlIGNvbmZpZ3VyZWQKIyBwcm9wZXJseS4gV2UgY2FuIG5vdCBjb3VudCB0aGF0IGxvY2FsaG9zdCB3aWxsIHJlc29sdmUgdG8gOjoxIG9uIGFsbAojIHN5c3RlbXMuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vc2hhem93L3VybGxpYjMvcHVsbC82MTEgYW5kCiMgaHR0cHM6Ly9idWdzLnB5dGhvbi5vcmcvaXNzdWUxODc5MgpIQVNfSVBWNl9BTkRfRE5TID0gX2hhc19pcHY2KCdsb2NhbGhvc3QnKQpIQVNfSVBWNiA9IF9oYXNfaXB2NignOjoxJykKCgojIERpZmZlcmVudCB0eXBlcyBvZiBzZXJ2ZXJzIHdlIGhhdmU6CgoKY2xhc3MgTm9JUHY2V2FybmluZyhIVFRQV2FybmluZyk6CiAgICAiSVB2NiBpcyBub3QgYXZhaWxhYmxlIgogICAgcGFzcwoKCmNsYXNzIFNvY2tldFNlcnZlclRocmVhZCh0aHJlYWRpbmcuVGhyZWFkKToKICAgICIiIgogICAgOnBhcmFtIHNvY2tldF9oYW5kbGVyOiBDYWxsYWJsZSB3aGljaCByZWNlaXZlcyBhIHNvY2tldCBhcmd1bWVudCBmb3Igb25lCiAgICAgICAgcmVxdWVzdC4KICAgIDpwYXJhbSByZWFkeV9ldmVudDogRXZlbnQgd2hpY2ggZ2V0cyBzZXQgd2hlbiB0aGUgc29ja2V0IGhhbmRsZXIgaXMKICAgICAgICByZWFkeSB0byByZWNlaXZlIHJlcXVlc3RzLgogICAgIiIiCiAgICBVU0VfSVBWNiA9IEhBU19JUFY2X0FORF9ETlMKCiAgICBkZWYgX19pbml0X18oc2VsZiwgc29ja2V0X2hhbmRsZXIsIGhvc3Q9J2xvY2FsaG9zdCcsIHBvcnQ9ODA4MSwKICAgICAgICAgICAgICAgICByZWFkeV9ldmVudD1Ob25lKToKICAgICAgICB0aHJlYWRpbmcuVGhyZWFkLl9faW5pdF9fKHNlbGYpCiAgICAgICAgc2VsZi5kYWVtb24gPSBUcnVlCgogICAgICAgIHNlbGYuc29ja2V0X2hhbmRsZXIgPSBzb2NrZXRfaGFuZGxlcgogICAgICAgIHNlbGYuaG9zdCA9IGhvc3QKICAgICAgICBzZWxmLnJlYWR5X2V2ZW50ID0gcmVhZHlfZXZlbnQKCiAgICBkZWYgX3N0YXJ0X3NlcnZlcihzZWxmKToKICAgICAgICBpZiBzZWxmLlVTRV9JUFY2OgogICAgICAgICAgICBzb2NrID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVDYpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgd2FybmluZ3Mud2FybigiTm8gSVB2NiBzdXBwb3J0LiBGYWxsaW5nIGJhY2sgdG8gSVB2NC4iLAogICAgICAgICAgICAgICAgICAgICAgICAgIE5vSVB2Nldhcm5pbmcpCiAgICAgICAgICAgIHNvY2sgPSBzb2NrZXQuc29ja2V0KHNvY2tldC5BRl9JTkVUKQogICAgICAgIGlmIHN5cy5wbGF0Zm9ybSAhPSAnd2luMzInOgogICAgICAgICAgICBzb2NrLnNldHNvY2tvcHQoc29ja2V0LlNPTF9TT0NLRVQsIHNvY2tldC5TT19SRVVTRUFERFIsIDEpCiAgICAgICAgc29jay5iaW5kKChzZWxmLmhvc3QsIDApKQogICAgICAgIHNlbGYucG9ydCA9IHNvY2suZ2V0c29ja25hbWUoKVsxXQoKICAgICAgICAjIE9uY2UgbGlzdGVuKCkgcmV0dXJucywgdGhlIHNlcnZlciBzb2NrZXQgaXMgcmVhZHkKICAgICAgICBzb2NrLmxpc3RlbigxKQoKICAgICAgICBpZiBzZWxmLnJlYWR5X2V2ZW50OgogICAgICAgICAgICBzZWxmLnJlYWR5X2V2ZW50LnNldCgpCgogICAgICAgIHNlbGYuc29ja2V0X2hhbmRsZXIoc29jaykKICAgICAgICBzb2NrLmNsb3NlKCkKCiAgICBkZWYgcnVuKHNlbGYpOgogICAgICAgIHNlbGYuc2VydmVyID0gc2VsZi5fc3RhcnRfc2VydmVyKCkKCgojIEZJWE1FOiB0aGVyZSBpcyBhIHB1bGwgcmVxdWVzdCBwYXRjaGluZyBiaW5kX3NvY2tldHMgaW4gVG9ybmFkbyBkaXJlY3RseS4KIyBJZiBpdCBnZXRzIG1lcmdlZCBhbmQgcmVsZWFzZWQgd2UgY2FuIGRyb3AgdGhpcyBhbmQgdXNlCiMgYHRvcm5hZG8ubmV0dXRpbC5iaW5kX3NvY2tldHNgIGFnYWluLgojIGh0dHBzOi8vZ2l0aHViLmNvbS9mYWNlYm9vay90b3JuYWRvL3B1bGwvOTc3CgpkZWYgYmluZF9zb2NrZXRzKHBvcnQsIGFkZHJlc3M9Tm9uZSwgZmFtaWx5PXNvY2tldC5BRl9VTlNQRUMsIGJhY2tsb2c9MTI4LAogICAgICAgICAgICAgICAgIGZsYWdzPU5vbmUpOgogICAgIiIiQ3JlYXRlcyBsaXN0ZW5pbmcgc29ja2V0cyBib3VuZCB0byB0aGUgZ2l2ZW4gcG9ydCBhbmQgYWRkcmVzcy4KCiAgICBSZXR1cm5zIGEgbGlzdCBvZiBzb2NrZXQgb2JqZWN0cyAobXVsdGlwbGUgc29ja2V0cyBhcmUgcmV0dXJuZWQgaWYKICAgIHRoZSBnaXZlbiBhZGRyZXNzIG1hcHMgdG8gbXVsdGlwbGUgSVAgYWRkcmVzc2VzLCB3aGljaCBpcyBtb3N0IGNvbW1vbgogICAgZm9yIG1peGVkIElQdjQgYW5kIElQdjYgdXNlKS4KCiAgICBBZGRyZXNzIG1heSBiZSBlaXRoZXIgYW4gSVAgYWRkcmVzcyBvciBob3N0bmFtZS4gIElmIGl0J3MgYSBob3N0bmFtZSwKICAgIHRoZSBzZXJ2ZXIgd2lsbCBsaXN0ZW4gb24gYWxsIElQIGFkZHJlc3NlcyBhc3NvY2lhdGVkIHdpdGggdGhlCiAgICBuYW1lLiAgQWRkcmVzcyBtYXkgYmUgYW4gZW1wdHkgc3RyaW5nIG9yIE5vbmUgdG8gbGlzdGVuIG9uIGFsbAogICAgYXZhaWxhYmxlIGludGVyZmFjZXMuICBGYW1pbHkgbWF5IGJlIHNldCB0byBlaXRoZXIgYHNvY2tldC5BRl9JTkVUYAogICAgb3IgYHNvY2tldC5BRl9JTkVUNmAgdG8gcmVzdHJpY3QgdG8gSVB2NCBvciBJUHY2IGFkZHJlc3Nlcywgb3RoZXJ3aXNlCiAgICBib3RoIHdpbGwgYmUgdXNlZCBpZiBhdmFpbGFibGUuCgogICAgVGhlIGBgYmFja2xvZ2BgIGFyZ3VtZW50IGhhcyB0aGUgc2FtZSBtZWFuaW5nIGFzIGZvcgogICAgYHNvY2tldC5saXN0ZW4oKSA8c29ja2V0LnNvY2tldC5saXN0ZW4+YC4KCiAgICBgYGZsYWdzYGAgaXMgYSBiaXRtYXNrIG9mIEFJXyogZmxhZ3MgdG8gYH5zb2NrZXQuZ2V0YWRkcmluZm9gLCBsaWtlCiAgICBgYHNvY2tldC5BSV9QQVNTSVZFIHwgc29ja2V0LkFJX05VTUVSSUNIT1NUYGAuCiAgICAiIiIKICAgIHNvY2tldHMgPSBbXQogICAgaWYgYWRkcmVzcyA9PSAiIjoKICAgICAgICBhZGRyZXNzID0gTm9uZQogICAgaWYgbm90IEhBU19JUFY2IGFuZCBmYW1pbHkgPT0gc29ja2V0LkFGX1VOU1BFQzoKICAgICAgICAjIFB5dGhvbiBjYW4gYmUgY29tcGlsZWQgd2l0aCAtLWRpc2FibGUtaXB2Niwgd2hpY2ggY2F1c2VzCiAgICAgICAgIyBvcGVyYXRpb25zIG9uIEFGX0lORVQ2IHNvY2tldHMgdG8gZmFpbCwgYnV0IGRvZXMgbm90CiAgICAgICAgIyBhdXRvbWF0aWNhbGx5IGV4Y2x1ZGUgdGhvc2UgcmVzdWx0cyBmcm9tIGdldGFkZHJpbmZvCiAgICAgICAgIyByZXN1bHRzLgogICAgICAgICMgaHR0cDovL2J1Z3MucHl0aG9uLm9yZy9pc3N1ZTE2MjA4CiAgICAgICAgZmFtaWx5ID0gc29ja2V0LkFGX0lORVQKICAgIGlmIGZsYWdzIGlzIE5vbmU6CiAgICAgICAgZmxhZ3MgPSBzb2NrZXQuQUlfUEFTU0lWRQogICAgYmluZGVkX3BvcnQgPSBOb25lCiAgICBmb3IgcmVzIGluIHNldChzb2NrZXQuZ2V0YWRkcmluZm8oYWRkcmVzcywgcG9ydCwgZmFtaWx5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvY2tldC5TT0NLX1NUUkVBTSwgMCwgZmxhZ3MpKToKICAgICAgICBhZiwgc29ja3R5cGUsIHByb3RvLCBjYW5vbm5hbWUsIHNvY2thZGRyID0gcmVzCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzb2NrID0gc29ja2V0LnNvY2tldChhZiwgc29ja3R5cGUsIHByb3RvKQogICAgICAgIGV4Y2VwdCBzb2NrZXQuZXJyb3IgYXMgZToKICAgICAgICAgICAgaWYgZS5hcmdzWzBdID09IGVycm5vLkVBRk5PU1VQUE9SVDoKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIHJhaXNlCiAgICAgICAgc2V0X2Nsb3NlX2V4ZWMoc29jay5maWxlbm8oKSkKICAgICAgICBpZiBvcy5uYW1lICE9ICdudCc6CiAgICAgICAgICAgIHNvY2suc2V0c29ja29wdChzb2NrZXQuU09MX1NPQ0tFVCwgc29ja2V0LlNPX1JFVVNFQUREUiwgMSkKICAgICAgICBpZiBhZiA9PSBzb2NrZXQuQUZfSU5FVDY6CiAgICAgICAgICAgICMgT24gbGludXgsIGlwdjYgc29ja2V0cyBhY2NlcHQgaXB2NCB0b28gYnkgZGVmYXVsdCwKICAgICAgICAgICAgIyBidXQgdGhpcyBtYWtlcyBpdCBpbXBvc3NpYmxlIHRvIGJpbmQgdG8gYm90aAogICAgICAgICAgICAjIDAuMC4wLjAgaW4gaXB2NCBhbmQgOjogaW4gaXB2Ni4gIE9uIG90aGVyIHN5c3RlbXMsCiAgICAgICAgICAgICMgc2VwYXJhdGUgc29ja2V0cyAqbXVzdCogYmUgdXNlZCB0byBsaXN0ZW4gZm9yIGJvdGggaXB2NAogICAgICAgICAgICAjIGFuZCBpcHY2LiAgRm9yIGNvbnNpc3RlbmN5LCBhbHdheXMgZGlzYWJsZSBpcHY0IG9uIG91cgogICAgICAgICAgICAjIGlwdjYgc29ja2V0cyBhbmQgdXNlIGEgc2VwYXJhdGUgaXB2NCBzb2NrZXQgd2hlbiBuZWVkZWQuCiAgICAgICAgICAgICMKICAgICAgICAgICAgIyBQeXRob24gMi54IG9uIHdpbmRvd3MgZG9lc24ndCBoYXZlIElQUFJPVE9fSVBWNi4KICAgICAgICAgICAgaWYgaGFzYXR0cihzb2NrZXQsICJJUFBST1RPX0lQVjYiKToKICAgICAgICAgICAgICAgIHNvY2suc2V0c29ja29wdChzb2NrZXQuSVBQUk9UT19JUFY2LCBzb2NrZXQuSVBWNl9WNk9OTFksIDEpCgogICAgICAgICMgYXV0b21hdGljIHBvcnQgYWxsb2NhdGlvbiB3aXRoIHBvcnQ9Tm9uZQogICAgICAgICMgc2hvdWxkIGJpbmQgb24gdGhlIHNhbWUgcG9ydCBvbiBJUHY0IGFuZCBJUHY2CiAgICAgICAgaG9zdCwgcmVxdWVzdGVkX3BvcnQgPSBzb2NrYWRkcls6Ml0KICAgICAgICBpZiByZXF1ZXN0ZWRfcG9ydCA9PSAwIGFuZCBiaW5kZWRfcG9ydCBpcyBub3QgTm9uZToKICAgICAgICAgICAgc29ja2FkZHIgPSB0dXBsZShbaG9zdCwgYmluZGVkX3BvcnRdICsgbGlzdChzb2NrYWRkclsyOl0pKQoKICAgICAgICBzb2NrLnNldGJsb2NraW5nKDApCiAgICAgICAgc29jay5iaW5kKHNvY2thZGRyKQogICAgICAgIGJpbmRlZF9wb3J0ID0gc29jay5nZXRzb2NrbmFtZSgpWzFdCiAgICAgICAgc29jay5saXN0ZW4oYmFja2xvZykKICAgICAgICBzb2NrZXRzLmFwcGVuZChzb2NrKQogICAgcmV0dXJuIHNvY2tldHMKCgpkZWYgcnVuX3Rvcm5hZG9fYXBwKGFwcCwgaW9fbG9vcCwgY2VydHMsIHNjaGVtZSwgaG9zdCk6CiAgICAjIFdlIGNhbid0IHVzZSBmcm9tdGltZXN0YW1wKDApIGJlY2F1c2Ugb2YgQ1B5dGhvbiBpc3N1ZSAyOTA5Nywgc28gd2UnbGwKICAgICMganVzdCBjb25zdHJ1Y3QgdGhlIGRhdGV0aW1lIG9iamVjdCBkaXJlY3RseS4KICAgIGFwcC5sYXN0X3JlcSA9IGRhdGV0aW1lKDE5NzAsIDEsIDEpCgogICAgaWYgc2NoZW1lID09ICdodHRwcyc6CiAgICAgICAgaHR0cF9zZXJ2ZXIgPSB0b3JuYWRvLmh0dHBzZXJ2ZXIuSFRUUFNlcnZlcihhcHAsIHNzbF9vcHRpb25zPWNlcnRzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW9fbG9vcD1pb19sb29wKQogICAgZWxzZToKICAgICAgICBodHRwX3NlcnZlciA9IHRvcm5hZG8uaHR0cHNlcnZlci5IVFRQU2VydmVyKGFwcCwgaW9fbG9vcD1pb19sb29wKQoKICAgIHNvY2tldHMgPSBiaW5kX3NvY2tldHMoTm9uZSwgYWRkcmVzcz1ob3N0KQogICAgcG9ydCA9IHNvY2tldHNbMF0uZ2V0c29ja25hbWUoKVsxXQogICAgaHR0cF9zZXJ2ZXIuYWRkX3NvY2tldHMoc29ja2V0cykKICAgIHJldHVybiBodHRwX3NlcnZlciwgcG9ydAoKCmRlZiBydW5fbG9vcF9pbl90aHJlYWQoaW9fbG9vcCk6CiAgICB0ID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9aW9fbG9vcC5zdGFydCkKICAgIHQuc3RhcnQoKQogICAgcmV0dXJuIHQKCgpkZWYgZ2V0X3VucmVhY2hhYmxlX2FkZHJlc3MoKToKICAgIHdoaWxlIFRydWU6CiAgICAgICAgaG9zdCA9ICcnLmpvaW4ocmFuZG9tLmNob2ljZShzdHJpbmcuYXNjaWlfbG93ZXJjYXNlKQogICAgICAgICAgICAgICAgICAgICAgIGZvciBfIGluIHJhbmdlKDYwKSkKICAgICAgICBzb2NrYWRkciA9IChob3N0LCA1NDMyMSkKCiAgICAgICAgIyBjaGVjayBpZiB3ZSBhcmUgcmVhbGx5ICJsdWNreSIgYW5kIGhpdCBhbiBhY3R1YWwgc2VydmVyCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzID0gc29ja2V0LmNyZWF0ZV9jb25uZWN0aW9uKHNvY2thZGRyKQogICAgICAgIGV4Y2VwdCBzb2NrZXQuZXJyb3I6CiAgICAgICAgICAgIHJldHVybiBzb2NrYWRkcgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHMuY2xvc2UoKQoKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICAjIEZvciBkZWJ1Z2dpbmcgZHVtbXlzZXJ2ZXIgaXRzZWxmIC0gcHl0aG9uIC1tIGR1bW15c2VydmVyLnNlcnZlcgogICAgZnJvbSAudGVzdGNhc2UgaW1wb3J0IFRlc3RpbmdBcHAKICAgIGhvc3QgPSAnMTI3LjAuMC4xJwoKICAgIGlvX2xvb3AgPSB0b3JuYWRvLmlvbG9vcC5JT0xvb3AoKQogICAgYXBwID0gdG9ybmFkby53ZWIuQXBwbGljYXRpb24oWyhyIi4qIiwgVGVzdGluZ0FwcCldKQogICAgc2VydmVyLCBwb3J0ID0gcnVuX3Rvcm5hZG9fYXBwKGFwcCwgaW9fbG9vcCwgTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnaHR0cCcsIGhvc3QpCiAgICBzZXJ2ZXJfdGhyZWFkID0gcnVuX2xvb3BfaW5fdGhyZWFkKGlvX2xvb3ApCgogICAgcHJpbnQoIkxpc3RlbmluZyBvbiBodHRwOi8ve2hvc3R9Ontwb3J0fSIuZm9ybWF0KGhvc3Q9aG9zdCwgcG9ydD1wb3J0KSkK
